(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var ADDR_RE=/^\[?([^\]]+)\]?:(\d+)$/,cache={},size=0;module.exports=function(e){if(1e5===size&&module.exports.reset(),!cache[e]){var r=ADDR_RE.exec(e);if(!r)throw new Error("invalid addr: "+e);cache[e]=[r[1],Number(r[2])],size+=1}return cache[e]},module.exports.reset=function(){cache={},size=0};
},{}],2:[function(require,module,exports){
var asn1=exports;asn1.bignum=require("bn.js"),asn1.define=require("./asn1/api").define,asn1.base=require("./asn1/base"),asn1.constants=require("./asn1/constants"),asn1.decoders=require("./asn1/decoders"),asn1.encoders=require("./asn1/encoders");
},{"./asn1/api":3,"./asn1/base":5,"./asn1/constants":9,"./asn1/decoders":11,"./asn1/encoders":14,"bn.js":35}],3:[function(require,module,exports){
function Entity(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}var asn1=require("../asn1"),inherits=require("inherits"),api=exports;api.define=function(e,t){return new Entity(e,t)},Entity.prototype._createNamed=function(e){var t;try{t=require("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return inherits(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},Entity.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(asn1.decoders[e])),this.decoders[e]},Entity.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},Entity.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(asn1.encoders[e])),this.encoders[e]},Entity.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)};
},{"../asn1":2,"inherits":144,"vm":311}],4:[function(require,module,exports){
function DecoderBuffer(e,t){if(Reporter.call(this,t),!Buffer.isBuffer(e))return void this.error("Input not Buffer");this.base=e,this.offset=0,this.length=e.length}function EncoderBuffer(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof EncoderBuffer||(e=new EncoderBuffer(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=Buffer.byteLength(e);else{if(!Buffer.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}var inherits=require("inherits"),Reporter=require("../base").Reporter,Buffer=require("buffer").Buffer;inherits(DecoderBuffer,Reporter),exports.DecoderBuffer=DecoderBuffer,DecoderBuffer.prototype.save=function(){return{offset:this.offset,reporter:Reporter.prototype.save.call(this)}},DecoderBuffer.prototype.restore=function(e){var t=new DecoderBuffer(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,Reporter.prototype.restore.call(this,e.reporter),t},DecoderBuffer.prototype.isEmpty=function(){return this.offset===this.length},DecoderBuffer.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},DecoderBuffer.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var r=new DecoderBuffer(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},DecoderBuffer.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},exports.EncoderBuffer=EncoderBuffer,EncoderBuffer.prototype.join=function(e,t){return e||(e=new Buffer(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(r){r.join(e,t),t+=r.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):Buffer.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)};

},{"../base":5,"buffer":66,"inherits":144}],5:[function(require,module,exports){
var base=exports;base.Reporter=require("./reporter").Reporter,base.DecoderBuffer=require("./buffer").DecoderBuffer,base.EncoderBuffer=require("./buffer").EncoderBuffer,base.Node=require("./node");
},{"./buffer":4,"./node":6,"./reporter":7}],6:[function(require,module,exports){
function Node(e,t){var r={};this._baseState=r,r.enc=e,r.parent=t||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}var Reporter=require("../base").Reporter,EncoderBuffer=require("../base").EncoderBuffer,DecoderBuffer=require("../base").DecoderBuffer,assert=require("minimalistic-assert"),tags=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],methods=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(tags),overrided=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];module.exports=Node;var stateProps=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];Node.prototype.clone=function(){var e=this._baseState,t={};stateProps.forEach(function(r){t[r]=e[r]});var r=new this.constructor(t.parent);return r._baseState=t,r},Node.prototype._wrap=function(){var e=this._baseState;methods.forEach(function(t){this[t]=function(){var r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}},this)},Node.prototype._init=function(e){var t=this._baseState;assert(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),assert.equal(t.children.length,1,"Root node can have only one child")},Node.prototype._useArgs=function(e){var t=this._baseState,r=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==r.length&&(assert(null===t.children),t.children=r,r.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(assert(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(r){r==(0|r)&&(r|=0);var i=e[r];t[i]=r}),t}))},overrided.forEach(function(e){Node.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),tags.forEach(function(e){Node.prototype[e]=function(){var t=this._baseState,r=Array.prototype.slice.call(arguments);return assert(null===t.tag),t.tag=e,this._useArgs(r),this}}),Node.prototype.use=function(e){assert(e);var t=this._baseState;return assert(null===t.use),t.use=e,this},Node.prototype.optional=function(){return this._baseState.optional=!0,this},Node.prototype.def=function(e){var t=this._baseState;return assert(null===t.default),t.default=e,t.optional=!0,this},Node.prototype.explicit=function(e){var t=this._baseState;return assert(null===t.explicit&&null===t.implicit),t.explicit=e,this},Node.prototype.implicit=function(e){var t=this._baseState;return assert(null===t.explicit&&null===t.implicit),t.implicit=e,this},Node.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},Node.prototype.key=function(e){var t=this._baseState;return assert(null===t.key),t.key=e,this},Node.prototype.any=function(){return this._baseState.any=!0,this},Node.prototype.choice=function(e){var t=this._baseState;return assert(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},Node.prototype.contains=function(e){var t=this._baseState;return assert(null===t.use),t.contains=e,this},Node.prototype._decode=function(e,t){var r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));var i=r.default,n=!0,o=null;if(null!==r.key&&(o=e.enterKey(r.key)),r.optional){var s=null;if(null!==r.explicit?s=r.explicit:null!==r.implicit?s=r.implicit:null!==r.tag&&(s=r.tag),null!==s||r.any){if(n=this._peekTag(e,s,r.any),e.isError(n))return n}else{var a=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),n=!0}catch(e){n=!1}e.restore(a)}}var c;if(r.obj&&n&&(c=e.enterObject()),n){if(null!==r.explicit){var l=this._decodeTag(e,r.explicit);if(e.isError(l))return l;e=l}var u=e.offset;if(null===r.use&&null===r.choice){if(r.any)var a=e.save();var d=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(d))return d;r.any?i=e.raw(a):e=d}if(t&&t.track&&null!==r.tag&&t.track(e.path(),u,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),i=r.any?i:null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),e.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach(function(r){r._decode(e,t)}),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){var h=new DecoderBuffer(i);i=this._getUse(r.contains,e._reporterState.obj)._decode(h,t)}}return r.obj&&n&&(i=e.leaveObject(c)),null===r.key||null===i&&!0!==n?null!==o&&e.exitKey(o):e.leaveKey(o,r.key,i),i},Node.prototype._decodeGeneric=function(e,t,r){var i=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,i.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&i.args?this._decodeObjid(t,i.args[0],i.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,i.args&&i.args[0],r):null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},Node.prototype._getUse=function(e,t){var r=this._baseState;return r.useDecoder=this._use(e,t),assert(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},Node.prototype._decodeChoice=function(e,t){var r=this._baseState,i=null,n=!1;return Object.keys(r.choice).some(function(o){var s=e.save(),a=r.choice[o];try{var c=a._decode(e,t);if(e.isError(c))return!1;i={type:o,value:c},n=!0}catch(t){return e.restore(s),!1}return!0},this),n?i:e.error("Choice not matched")},Node.prototype._createEncoderBuffer=function(e){return new EncoderBuffer(e,this.reporter)},Node.prototype._encode=function(e,t,r){var i=this._baseState;if(null===i.default||i.default!==e){var n=this._encodeValue(e,t,r);if(void 0!==n&&!this._skipDefault(n,t,r))return n}},Node.prototype._encodeValue=function(e,t,r){var i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new Reporter);var n=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}var o=null,s=!1;if(i.any)n=this._createEncoderBuffer(e);else if(i.choice)n=this._encodeChoice(e,t);else if(i.contains)o=this._getUse(i.contains,r)._encode(e,t),s=!0;else if(i.children)o=i.children.map(function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");var i=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var n=r._encode(e[r._baseState.key],t,e);return t.leaveKey(i),n},this).filter(function(e){return e}),o=this._createEncoderBuffer(o);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var a=this.clone();a._baseState.implicit=null,o=this._createEncoderBuffer(e.map(function(r){var i=this._baseState;return this._getUse(i.args[0],e)._encode(r,t)},a))}else null!==i.use?n=this._getUse(i.use,r)._encode(e,t):(o=this._encodePrimitive(i.tag,e),s=!0);var n;if(!i.any&&null===i.choice){var c=null!==i.implicit?i.implicit:i.tag,l=null===i.implicit?"universal":"context";null===c?null===i.use&&t.error("Tag could be ommited only for .use()"):null===i.use&&(n=this._encodeComposite(c,s,l,o))}return null!==i.explicit&&(n=this._encodeComposite(i.explicit,!1,"context",n)),n},Node.prototype._encodeChoice=function(e,t){var r=this._baseState,i=r.choice[e.type];return i||assert(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),i._encode(e.value,t)},Node.prototype._encodePrimitive=function(e,t){var r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},Node.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},Node.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)};

},{"../base":5,"minimalistic-assert":170}],7:[function(require,module,exports){
function Reporter(r){this._reporterState={obj:null,path:[],options:r||{},errors:[]}}function ReporterError(r,t){this.path=r,this.rethrow(t)}var inherits=require("inherits");exports.Reporter=Reporter,Reporter.prototype.isError=function(r){return r instanceof ReporterError},Reporter.prototype.save=function(){var r=this._reporterState;return{obj:r.obj,pathLen:r.path.length}},Reporter.prototype.restore=function(r){var t=this._reporterState;t.obj=r.obj,t.path=t.path.slice(0,r.pathLen)},Reporter.prototype.enterKey=function(r){return this._reporterState.path.push(r)},Reporter.prototype.exitKey=function(r){var t=this._reporterState;t.path=t.path.slice(0,r-1)},Reporter.prototype.leaveKey=function(r,t,e){var o=this._reporterState;this.exitKey(r),null!==o.obj&&(o.obj[t]=e)},Reporter.prototype.path=function(){return this._reporterState.path.join("/")},Reporter.prototype.enterObject=function(){var r=this._reporterState,t=r.obj;return r.obj={},t},Reporter.prototype.leaveObject=function(r){var t=this._reporterState,e=t.obj;return t.obj=r,e},Reporter.prototype.error=function(r){var t,e=this._reporterState,o=r instanceof ReporterError;if(t=o?r:new ReporterError(e.path.map(function(r){return"["+JSON.stringify(r)+"]"}).join(""),r.message||r,r.stack),!e.options.partial)throw t;return o||e.errors.push(t),t},Reporter.prototype.wrapResult=function(r){var t=this._reporterState;return t.options.partial?{result:this.isError(r)?null:r,errors:t.errors}:r},inherits(ReporterError,Error),ReporterError.prototype.rethrow=function(r){if(this.message=r+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,ReporterError),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this};

},{"inherits":144}],8:[function(require,module,exports){
var constants=require("../constants");exports.tagClass={0:"universal",1:"application",2:"context",3:"private"},exports.tagClassByName=constants._reverse(exports.tagClass),exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},exports.tagByName=constants._reverse(exports.tag);

},{"../constants":9}],9:[function(require,module,exports){
var constants=exports;constants._reverse=function(r){var e={};return Object.keys(r).forEach(function(n){(0|n)==n&&(n|=0);var t=r[n];e[t]=n}),e},constants.der=require("./der");

},{"./der":8}],10:[function(require,module,exports){
function DERDecoder(r){this.enc="der",this.name=r.name,this.entity=r,this.tree=new DERNode,this.tree._init(r.body)}function DERNode(r){base.Node.call(this,"der",r)}function derDecodeTag(r,e){var t=r.readUInt8(e);if(r.isError(t))return t;var i=der.tagClass[t>>6],o=0==(32&t);if(31==(31&t)){var n=t;for(t=0;128==(128&n);){if(n=r.readUInt8(e),r.isError(n))return n;t<<=7,t|=127&n}}else t&=31;return{cls:i,primitive:o,tag:t,tagStr:der.tag[t]}}function derDecodeLen(r,e,t){var i=r.readUInt8(t);if(r.isError(i))return i;if(!e&&128===i)return null;if(0==(128&i))return i;var o=127&i;if(o>4)return r.error("length octect is too long");i=0;for(var n=0;n<o;n++){i<<=8;var s=r.readUInt8(t);if(r.isError(s))return s;i|=s}return i}var inherits=require("inherits"),asn1=require("../../asn1"),base=asn1.base,bignum=asn1.bignum,der=asn1.constants.der;module.exports=DERDecoder,DERDecoder.prototype.decode=function(r,e){return r instanceof base.DecoderBuffer||(r=new base.DecoderBuffer(r,e)),this.tree._decode(r,e)},inherits(DERNode,base.Node),DERNode.prototype._peekTag=function(r,e,t){if(r.isEmpty())return!1;var i=r.save(),o=derDecodeTag(r,'Failed to peek tag: "'+e+'"');return r.isError(o)?o:(r.restore(i),o.tag===e||o.tagStr===e||o.tagStr+"of"===e||t)},DERNode.prototype._decodeTag=function(r,e,t){var i=derDecodeTag(r,'Failed to decode tag of "'+e+'"');if(r.isError(i))return i;var o=derDecodeLen(r,i.primitive,'Failed to get length of "'+e+'"');if(r.isError(o))return o;if(!t&&i.tag!==e&&i.tagStr!==e&&i.tagStr+"of"!==e)return r.error('Failed to match tag: "'+e+'"');if(i.primitive||null!==o)return r.skip(o,'Failed to match body of: "'+e+'"');var n=r.save(),s=this._skipUntilEnd(r,'Failed to skip indefinite length body: "'+this.tag+'"');return r.isError(s)?s:(o=r.offset-n.offset,r.restore(n),r.skip(o,'Failed to match body of: "'+e+'"'))},DERNode.prototype._skipUntilEnd=function(r,e){for(;;){var t=derDecodeTag(r,e);if(r.isError(t))return t;var i=derDecodeLen(r,t.primitive,e);if(r.isError(i))return i;var o;if(o=t.primitive||null!==i?r.skip(i):this._skipUntilEnd(r,e),r.isError(o))return o;if("end"===t.tagStr)break}},DERNode.prototype._decodeList=function(r,e,t,i){for(var o=[];!r.isEmpty();){var n=this._peekTag(r,"end");if(r.isError(n))return n;var s=t.decode(r,"der",i);if(r.isError(s)&&n)break;o.push(s)}return o},DERNode.prototype._decodeStr=function(r,e){if("bitstr"===e){var t=r.readUInt8();return r.isError(t)?t:{unused:t,data:r.raw()}}if("bmpstr"===e){var i=r.raw();if(i.length%2==1)return r.error("Decoding of string type: bmpstr length mismatch");for(var o="",n=0;n<i.length/2;n++)o+=String.fromCharCode(i.readUInt16BE(2*n));return o}if("numstr"===e){var s=r.raw().toString("ascii");return this._isNumstr(s)?s:r.error("Decoding of string type: numstr unsupported characters")}if("octstr"===e)return r.raw();if("objDesc"===e)return r.raw();if("printstr"===e){var a=r.raw().toString("ascii");return this._isPrintstr(a)?a:r.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(e)?r.raw().toString():r.error("Decoding of string type: "+e+" unsupported")},DERNode.prototype._decodeObjid=function(r,e,t){for(var i,o=[],n=0;!r.isEmpty();){var s=r.readUInt8();n<<=7,n|=127&s,0==(128&s)&&(o.push(n),n=0)}128&s&&o.push(n);var a=o[0]/40|0,d=o[0]%40;if(i=t?o:[a,d].concat(o.slice(1)),e){var u=e[i.join(" ")];void 0===u&&(u=e[i.join(".")]),void 0!==u&&(i=u)}return i},DERNode.prototype._decodeTime=function(r,e){var t=r.raw().toString();if("gentime"===e)var i=0|t.slice(0,4),o=0|t.slice(4,6),n=0|t.slice(6,8),s=0|t.slice(8,10),a=0|t.slice(10,12),d=0|t.slice(12,14);else{if("utctime"!==e)return r.error("Decoding "+e+" time is not supported yet");var i=0|t.slice(0,2),o=0|t.slice(2,4),n=0|t.slice(4,6),s=0|t.slice(6,8),a=0|t.slice(8,10),d=0|t.slice(10,12);i=i<70?2e3+i:1900+i}return Date.UTC(i,o-1,n,s,a,d,0)},DERNode.prototype._decodeNull=function(r){return null},DERNode.prototype._decodeBool=function(r){var e=r.readUInt8();return r.isError(e)?e:0!==e},DERNode.prototype._decodeInt=function(r,e){var t=r.raw(),i=new bignum(t);return e&&(i=e[i.toString(10)]||i),i},DERNode.prototype._use=function(r,e){return"function"==typeof r&&(r=r(e)),r._getDecoder("der").tree};

},{"../../asn1":2,"inherits":144}],11:[function(require,module,exports){
var decoders=exports;decoders.der=require("./der"),decoders.pem=require("./pem");

},{"./der":10,"./pem":12}],12:[function(require,module,exports){
function PEMDecoder(e){DERDecoder.call(this,e),this.enc="pem"}var inherits=require("inherits"),Buffer=require("buffer").Buffer,DERDecoder=require("./der");inherits(PEMDecoder,DERDecoder),module.exports=PEMDecoder,PEMDecoder.prototype.decode=function(e,r){for(var o=e.toString().split(/[\r\n]+/g),i=r.label.toUpperCase(),t=/^-----(BEGIN|END) ([^-]+)-----$/,c=-1,n=-1,f=0;f<o.length;f++){var a=o[f].match(t);if(null!==a&&a[2]===i){if(-1!==c){if("END"!==a[1])break;n=f;break}if("BEGIN"!==a[1])break;c=f}}if(-1===c||-1===n)throw new Error("PEM section not found for: "+i);var d=o.slice(c+1,n).join("");d.replace(/[^a-z0-9\+\/=]+/gi,"");var D=new Buffer(d,"base64");return DERDecoder.prototype.decode.call(this,D,r)};

},{"./der":10,"buffer":66,"inherits":144}],13:[function(require,module,exports){
function DEREncoder(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new DERNode,this.tree._init(e.body)}function DERNode(e){base.Node.call(this,"der",e)}function two(e){return e<10?"0"+e:e}function encodeTag(e,r,t,n){var o;if("seqof"===e?e="seq":"setof"===e&&(e="set"),der.tagByName.hasOwnProperty(e))o=der.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);o=e}return o>=31?n.error("Multi-octet tag encoding unsupported"):(r||(o|=32),o|=der.tagClassByName[t||"universal"]<<6)}var inherits=require("inherits"),Buffer=require("buffer").Buffer,asn1=require("../../asn1"),base=asn1.base,der=asn1.constants.der;module.exports=DEREncoder,DEREncoder.prototype.encode=function(e,r){return this.tree._encode(e,r).join()},inherits(DERNode,base.Node),DERNode.prototype._encodeComposite=function(e,r,t,n){var o=encodeTag(e,r,t,this.reporter);if(n.length<128){var i=new Buffer(2);return i[0]=o,i[1]=n.length,this._createEncoderBuffer([i,n])}for(var f=1,s=n.length;s>=256;s>>=8)f++;var i=new Buffer(2+f);i[0]=o,i[1]=128|f;for(var s=1+f,u=n.length;u>0;s--,u>>=8)i[s]=255&u;return this._createEncoderBuffer([i,n])},DERNode.prototype._encodeStr=function(e,r){if("bitstr"===r)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===r){for(var t=new Buffer(2*e.length),n=0;n<e.length;n++)t.writeUInt16BE(e.charCodeAt(n),2*n);return this._createEncoderBuffer(t)}return"numstr"===r?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===r?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(e):"objDesc"===r?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+r+" unsupported")},DERNode.prototype._encodeObjid=function(e,r,t){if("string"==typeof e){if(!r)return this.reporter.error("string objid given, but no values map found");if(!r.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=r[e].split(/[\s\.]+/g);for(var n=0;n<e.length;n++)e[n]|=0}else if(Array.isArray(e)){e=e.slice();for(var n=0;n<e.length;n++)e[n]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!t){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}for(var o=0,n=0;n<e.length;n++){var i=e[n];for(o++;i>=128;i>>=7)o++}for(var f=new Buffer(o),s=f.length-1,n=e.length-1;n>=0;n--){var i=e[n];for(f[s--]=127&i;(i>>=7)>0;)f[s--]=128|127&i}return this._createEncoderBuffer(f)},DERNode.prototype._encodeTime=function(e,r){var t,n=new Date(e);return"gentime"===r?t=[two(n.getFullYear()),two(n.getUTCMonth()+1),two(n.getUTCDate()),two(n.getUTCHours()),two(n.getUTCMinutes()),two(n.getUTCSeconds()),"Z"].join(""):"utctime"===r?t=[two(n.getFullYear()%100),two(n.getUTCMonth()+1),two(n.getUTCDate()),two(n.getUTCHours()),two(n.getUTCMinutes()),two(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+r+" time is not supported yet"),this._encodeStr(t,"octstr")},DERNode.prototype._encodeNull=function(){return this._createEncoderBuffer("")},DERNode.prototype._encodeInt=function(e,r){if("string"==typeof e){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!r.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=r[e]}if("number"!=typeof e&&!Buffer.isBuffer(e)){var t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=new Buffer(t)}if(Buffer.isBuffer(e)){var n=e.length;0===e.length&&n++;var o=new Buffer(n);return e.copy(o),0===e.length&&(o[0]=0),this._createEncoderBuffer(o)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var n=1,i=e;i>=256;i>>=8)n++;for(var o=new Array(n),i=o.length-1;i>=0;i--)o[i]=255&e,e>>=8;return 128&o[0]&&o.unshift(0),this._createEncoderBuffer(new Buffer(o))},DERNode.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},DERNode.prototype._use=function(e,r){return"function"==typeof e&&(e=e(r)),e._getEncoder("der").tree},DERNode.prototype._skipDefault=function(e,r,t){var n,o=this._baseState;if(null===o.default)return!1;var i=e.join();if(void 0===o.defaultBuffer&&(o.defaultBuffer=this._encodeValue(o.default,r,t).join()),i.length!==o.defaultBuffer.length)return!1;for(n=0;n<i.length;n++)if(i[n]!==o.defaultBuffer[n])return!1;return!0};

},{"../../asn1":2,"buffer":66,"inherits":144}],14:[function(require,module,exports){
var encoders=exports;encoders.der=require("./der"),encoders.pem=require("./pem");

},{"./der":13,"./pem":15}],15:[function(require,module,exports){
function PEMEncoder(e){DEREncoder.call(this,e),this.enc="pem"}var inherits=require("inherits"),DEREncoder=require("./der");inherits(PEMEncoder,DEREncoder),module.exports=PEMEncoder,PEMEncoder.prototype.encode=function(e,r){for(var n=DEREncoder.prototype.encode.call(this,e),o=n.toString("base64"),E=["-----BEGIN "+r.label+"-----"],t=0;t<o.length;t+=64)E.push(o.slice(t,t+64));return E.push("-----END "+r.label+"-----"),E.join("\n")};

},{"./der":13,"inherits":144}],16:[function(require,module,exports){
"use strict";function placeHoldersCount(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===o[r-2]?2:"="===o[r-1]?1:0}function byteLength(o){return 3*o.length/4-placeHoldersCount(o)}function toByteArray(o){var r,e,t,u,n,p=o.length;u=placeHoldersCount(o),n=new Arr(3*p/4-u),e=u>0?p-4:p;var a=0;for(r=0;r<e;r+=4)t=revLookup[o.charCodeAt(r)]<<18|revLookup[o.charCodeAt(r+1)]<<12|revLookup[o.charCodeAt(r+2)]<<6|revLookup[o.charCodeAt(r+3)],n[a++]=t>>16&255,n[a++]=t>>8&255,n[a++]=255&t;return 2===u?(t=revLookup[o.charCodeAt(r)]<<2|revLookup[o.charCodeAt(r+1)]>>4,n[a++]=255&t):1===u&&(t=revLookup[o.charCodeAt(r)]<<10|revLookup[o.charCodeAt(r+1)]<<4|revLookup[o.charCodeAt(r+2)]>>2,n[a++]=t>>8&255,n[a++]=255&t),n}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,u=[],n=r;n<e;n+=3)t=(o[n]<<16)+(o[n+1]<<8)+o[n+2],u.push(tripletToBase64(t));return u.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,u="",n=[],p=0,a=e-t;p<a;p+=16383)n.push(encodeChunk(o,p,p+16383>a?a:p+16383));return 1===t?(r=o[e-1],u+=lookup[r>>2],u+=lookup[r<<4&63],u+="=="):2===t&&(r=(o[e-2]<<8)+o[e-1],u+=lookup[r>>10],u+=lookup[r>>4&63],u+=lookup[r<<2&63],u+="="),n.push(u),n.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;

},{}],17:[function(require,module,exports){
function browser(e){return new Uint8Array(atob(e).split("").map(charCodeAt))}function node(e){return new(require("buffer").Buffer)(e,"base64")}function charCodeAt(e){return e.charCodeAt(0)}module.exports="function"==typeof atob?browser:node;

},{"buffer":66}],18:[function(require,module,exports){
function inject(n){function r(r){for(var t="";r--;)t+=n[Math.floor(Math.random()*n.length)];return t}function t(r,t){for(var e="",i=0;;){var u=n.indexOf(r[i]),a=n.indexOf(t[i]);-1==u&&(u=0),-1==a&&(a=n.length-1),i++;var f=n[u+1<a?Math.round((u+a)/2):u];if(e+=f,r<e&&e<t&&f!=o.lo)return e}}function e(n,r){return n==r?0:n<r?-1:1}n=n||"!0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~",n=n.split("").sort().join("");var o=t;return o.between=t,o.randstr=r,o.between=t,o.strord=e,o.lo=n[0],o.hi=n[n.length-1],o.inject=inject,t.strord,t}module.exports=inject(null);

},{}],19:[function(require,module,exports){
module.exports=function(e,r,n,i,o){var l,t;if(void 0===i)i=0;else if((i|=0)<0||i>=e.length)throw new RangeError("invalid lower bound");if(void 0===o)o=e.length-1;else if((o|=0)<i||o>=e.length)throw new RangeError("invalid upper bound");for(;i<=o;)if(l=i+(o-i>>1),(t=+n(e[l],r,l,e))<0)i=l+1;else{if(!(t>0))return l;o=l-1}return~i};

},{}],20:[function(require,module,exports){
(function (Buffer){
function BitField(e,t){if(!(this instanceof BitField))return new BitField(e,t);0===arguments.length&&(e=0),this.grow=t&&(isFinite(t.grow)&&getByteSize(t.grow)||t.grow)||0,"number"!=typeof e&&void 0!==e||(e=new Container(getByteSize(e)),e.fill&&!e._isBuffer&&e.fill(0)),this.buffer=e}function getByteSize(e){var t=e>>3;return e%8!=0&&t++,t}var Container="undefined"!=typeof Buffer?Buffer:"undefined"!=typeof Int8Array?Int8Array:function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0};BitField.prototype.get=function(e){var t=e>>3;return t<this.buffer.length&&!!(this.buffer[t]&128>>e%8)},BitField.prototype.set=function(e,t){var i=e>>3;t||1===arguments.length?(this.buffer.length<i+1&&this._grow(Math.max(i+1,Math.min(2*this.buffer.length,this.grow))),this.buffer[i]|=128>>e%8):i<this.buffer.length&&(this.buffer[i]&=~(128>>e%8))},BitField.prototype._grow=function(e){if(this.buffer.length<e&&e<=this.grow){var t=new Container(e);if(t.fill&&t.fill(0),this.buffer.copy)this.buffer.copy(t,0);else for(var i=0;i<this.buffer.length;i++)t[i]=this.buffer[i];this.buffer=t}},"undefined"!=typeof module&&(module.exports=BitField);

}).call(this,require("buffer").Buffer)
},{"buffer":66}],21:[function(require,module,exports){
function Request(e,t,i,s){this.piece=e,this.offset=t,this.length=i,this.callback=s}function Wire(){if(!(this instanceof Wire))return new Wire;stream.Duplex.call(this),this._debugId=randombytes(4).toString("hex"),this._debug("new wire"),this.peerId=null,this.peerIdBuffer=null,this.type=null,this.amChoking=!0,this.amInterested=!1,this.peerChoking=!0,this.peerInterested=!1,this.peerPieces=new BitField(0,{grow:BITFIELD_GROW}),this.peerExtensions={},this.requests=[],this.peerRequests=[],this.extendedMapping={},this.peerExtendedMapping={},this.extendedHandshake={},this.peerExtendedHandshake={},this._ext={},this._nextExt=1,this.uploaded=0,this.downloaded=0,this.uploadSpeed=speedometer(),this.downloadSpeed=speedometer(),this._keepAliveInterval=null,this._timeout=null,this._timeoutMs=0,this.destroyed=!1,this._finished=!1,this._parserSize=0,this._parser=null,this._buffer=[],this._bufferSize=0,this.on("finish",this._onFinish),this._parseHandshake()}function pull(e,t,i,s){for(var n=0;n<e.length;n++){var r=e[n];if(r.piece===t&&r.offset===i&&r.length===s)return arrayRemove(e,n),r}return null}module.exports=Wire;var arrayRemove=require("unordered-array-remove"),bencode=require("bencode"),BitField=require("bitfield"),Buffer=require("safe-buffer").Buffer,debug=require("debug")("bittorrent-protocol"),extend=require("xtend"),inherits=require("inherits"),randombytes=require("randombytes"),speedometer=require("speedometer"),stream=require("readable-stream"),BITFIELD_GROW=4e5,KEEP_ALIVE_TIMEOUT=55e3,MESSAGE_PROTOCOL=Buffer.from("BitTorrent protocol"),MESSAGE_KEEP_ALIVE=Buffer.from([0,0,0,0]),MESSAGE_CHOKE=Buffer.from([0,0,0,1,0]),MESSAGE_UNCHOKE=Buffer.from([0,0,0,1,1]),MESSAGE_INTERESTED=Buffer.from([0,0,0,1,2]),MESSAGE_UNINTERESTED=Buffer.from([0,0,0,1,3]),MESSAGE_RESERVED=[0,0,0,0,0,0,0,0],MESSAGE_PORT=[0,0,0,3,9,0,0];inherits(Wire,stream.Duplex),Wire.prototype.setKeepAlive=function(e){var t=this;t._debug("setKeepAlive %s",e),clearInterval(t._keepAliveInterval),!1!==e&&(t._keepAliveInterval=setInterval(function(){t.keepAlive()},KEEP_ALIVE_TIMEOUT))},Wire.prototype.setTimeout=function(e,t){this._debug("setTimeout ms=%d unref=%s",e,t),this._clearTimeout(),this._timeoutMs=e,this._timeoutUnref=!!t,this._updateTimeout()},Wire.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this._debug("destroy"),this.emit("close"),this.end())},Wire.prototype.end=function(){this._debug("end"),this._onUninterested(),this._onChoke(),stream.Duplex.prototype.end.apply(this,arguments)},Wire.prototype.use=function(e){function t(){}var i=e.prototype.name;if(!i)throw new Error('Extension class requires a "name" property on the prototype');this._debug("use extension.name=%s",i);var s=this._nextExt,n=new e(this);"function"!=typeof n.onHandshake&&(n.onHandshake=t),"function"!=typeof n.onExtendedHandshake&&(n.onExtendedHandshake=t),"function"!=typeof n.onMessage&&(n.onMessage=t),this.extendedMapping[s]=i,this._ext[i]=n,this[i]=n,this._nextExt+=1},Wire.prototype.keepAlive=function(){this._debug("keep-alive"),this._push(MESSAGE_KEEP_ALIVE)},Wire.prototype.handshake=function(e,t,i){var s,n;if("string"==typeof e?s=Buffer.from(e,"hex"):(s=e,e=s.toString("hex")),"string"==typeof t?n=Buffer.from(t,"hex"):(n=t,t=n.toString("hex")),20!==s.length||20!==n.length)throw new Error("infoHash and peerId MUST have length 20");this._debug("handshake i=%s p=%s exts=%o",e,t,i);var r=Buffer.from(MESSAGE_RESERVED);r[5]|=16,i&&i.dht&&(r[7]|=1),this._push(Buffer.concat([MESSAGE_PROTOCOL,r,s,n])),this._handshakeSent=!0,this.peerExtensions.extended&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()},Wire.prototype._sendExtendedHandshake=function(){var e=extend(this.extendedHandshake);e.m={};for(var t in this.extendedMapping){var i=this.extendedMapping[t];e.m[i]=Number(t)}this.extended(0,bencode.encode(e)),this._extendedHandshakeSent=!0},Wire.prototype.choke=function(){if(!this.amChoking){for(this.amChoking=!0,this._debug("choke");this.peerRequests.length;)this.peerRequests.pop();this._push(MESSAGE_CHOKE)}},Wire.prototype.unchoke=function(){this.amChoking&&(this.amChoking=!1,this._debug("unchoke"),this._push(MESSAGE_UNCHOKE))},Wire.prototype.interested=function(){this.amInterested||(this.amInterested=!0,this._debug("interested"),this._push(MESSAGE_INTERESTED))},Wire.prototype.uninterested=function(){this.amInterested&&(this.amInterested=!1,this._debug("uninterested"),this._push(MESSAGE_UNINTERESTED))},Wire.prototype.have=function(e){this._debug("have %d",e),this._message(4,[e],null)},Wire.prototype.bitfield=function(e){this._debug("bitfield"),Buffer.isBuffer(e)||(e=e.buffer),this._message(5,[],e)},Wire.prototype.request=function(e,t,i,s){return s||(s=function(){}),this._finished?s(new Error("wire is closed")):this.peerChoking?s(new Error("peer is choking")):(this._debug("request index=%d offset=%d length=%d",e,t,i),this.requests.push(new Request(e,t,i,s)),this._updateTimeout(),void this._message(6,[e,t,i],null))},Wire.prototype.piece=function(e,t,i){this._debug("piece index=%d offset=%d",e,t),this.uploaded+=i.length,this.uploadSpeed(i.length),this.emit("upload",i.length),this._message(7,[e,t],i)},Wire.prototype.cancel=function(e,t,i){this._debug("cancel index=%d offset=%d length=%d",e,t,i),this._callback(pull(this.requests,e,t,i),new Error("request was cancelled"),null),this._message(8,[e,t,i],null)},Wire.prototype.port=function(e){this._debug("port %d",e);var t=Buffer.from(MESSAGE_PORT);t.writeUInt16BE(e,5),this._push(t)},Wire.prototype.extended=function(e,t){if(this._debug("extended ext=%s",e),"string"==typeof e&&this.peerExtendedMapping[e]&&(e=this.peerExtendedMapping[e]),"number"!=typeof e)throw new Error("Unrecognized extension: "+e);var i=Buffer.from([e]),s=Buffer.isBuffer(t)?t:bencode.encode(t);this._message(20,[],Buffer.concat([i,s]))},Wire.prototype._read=function(){},Wire.prototype._message=function(e,t,i){var s=i?i.length:0,n=Buffer.allocUnsafe(5+4*t.length);n.writeUInt32BE(n.length+s-4,0),n[4]=e;for(var r=0;r<t.length;r++)n.writeUInt32BE(t[r],5+4*r);this._push(n),i&&this._push(i)},Wire.prototype._push=function(e){if(!this._finished)return this.push(e)},Wire.prototype._onKeepAlive=function(){this._debug("got keep-alive"),this.emit("keep-alive")},Wire.prototype._onHandshake=function(e,t,i){var s=e.toString("hex"),n=t.toString("hex");this._debug("got handshake i=%s p=%s exts=%o",s,n,i),this.peerId=n,this.peerIdBuffer=t,this.peerExtensions=i,this.emit("handshake",s,n,i);var r;for(r in this._ext)this._ext[r].onHandshake(s,n,i);i.extended&&this._handshakeSent&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()},Wire.prototype._onChoke=function(){for(this.peerChoking=!0,this._debug("got choke"),this.emit("choke");this.requests.length;)this._callback(this.requests.pop(),new Error("peer is choking"),null)},Wire.prototype._onUnchoke=function(){this.peerChoking=!1,this._debug("got unchoke"),this.emit("unchoke")},Wire.prototype._onInterested=function(){this.peerInterested=!0,this._debug("got interested"),this.emit("interested")},Wire.prototype._onUninterested=function(){this.peerInterested=!1,this._debug("got uninterested"),this.emit("uninterested")},Wire.prototype._onHave=function(e){this.peerPieces.get(e)||(this._debug("got have %d",e),this.peerPieces.set(e,!0),this.emit("have",e))},Wire.prototype._onBitField=function(e){this.peerPieces=new BitField(e),this._debug("got bitfield"),this.emit("bitfield",this.peerPieces)},Wire.prototype._onRequest=function(e,t,i){var s=this;if(!s.amChoking){s._debug("got request index=%d offset=%d length=%d",e,t,i);var n=function(n,o){if(r===pull(s.peerRequests,e,t,i))return n?s._debug("error satisfying request index=%d offset=%d length=%d (%s)",e,t,i,n.message):void s.piece(e,t,o)},r=new Request(e,t,i,n);s.peerRequests.push(r),s.emit("request",e,t,i,n)}},Wire.prototype._onPiece=function(e,t,i){this._debug("got piece index=%d offset=%d",e,t),this._callback(pull(this.requests,e,t,i.length),null,i),this.downloaded+=i.length,this.downloadSpeed(i.length),this.emit("download",i.length),this.emit("piece",e,t,i)},Wire.prototype._onCancel=function(e,t,i){this._debug("got cancel index=%d offset=%d length=%d",e,t,i),pull(this.peerRequests,e,t,i),this.emit("cancel",e,t,i)},Wire.prototype._onPort=function(e){this._debug("got port %d",e),this.emit("port",e)},Wire.prototype._onExtended=function(e,t){if(0===e){var i;try{i=bencode.decode(t)}catch(e){this._debug("ignoring invalid extended handshake: %s",e.message||e)}if(!i)return;this.peerExtendedHandshake=i;var s;if("object"==typeof i.m)for(s in i.m)this.peerExtendedMapping[s]=Number(i.m[s].toString());for(s in this._ext)this.peerExtendedMapping[s]&&this._ext[s].onExtendedHandshake(this.peerExtendedHandshake);this._debug("got extended handshake"),this.emit("extended","handshake",this.peerExtendedHandshake)}else this.extendedMapping[e]&&(e=this.extendedMapping[e],this._ext[e]&&this._ext[e].onMessage(t)),this._debug("got extended message ext=%s",e),this.emit("extended",e,t)},Wire.prototype._onTimeout=function(){this._debug("request timed out"),this._callback(this.requests.shift(),new Error("request has timed out"),null),this.emit("timeout")},Wire.prototype._write=function(e,t,i){for(this._bufferSize+=e.length,this._buffer.push(e);this._bufferSize>=this._parserSize;){var s=1===this._buffer.length?this._buffer[0]:Buffer.concat(this._buffer);this._bufferSize-=this._parserSize,this._buffer=this._bufferSize?[s.slice(this._parserSize)]:[],this._parser(s.slice(0,this._parserSize))}i(null)},Wire.prototype._callback=function(e,t,i){e&&(this._clearTimeout(),this.peerChoking||this._finished||this._updateTimeout(),e.callback(t,i))},Wire.prototype._clearTimeout=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},Wire.prototype._updateTimeout=function(){var e=this;e._timeoutMs&&e.requests.length&&!e._timeout&&(e._timeout=setTimeout(function(){e._onTimeout()},e._timeoutMs),e._timeoutUnref&&e._timeout.unref&&e._timeout.unref())},Wire.prototype._parse=function(e,t){this._parserSize=e,this._parser=t},Wire.prototype._onMessageLength=function(e){var t=e.readUInt32BE(0);t>0?this._parse(t,this._onMessage):(this._onKeepAlive(),this._parse(4,this._onMessageLength))},Wire.prototype._onMessage=function(e){switch(this._parse(4,this._onMessageLength),e[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(e.readUInt32BE(1));case 5:return this._onBitField(e.slice(1));case 6:return this._onRequest(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 7:return this._onPiece(e.readUInt32BE(1),e.readUInt32BE(5),e.slice(9));case 8:return this._onCancel(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 9:return this._onPort(e.readUInt16BE(1));case 20:return this._onExtended(e.readUInt8(1),e.slice(2));default:return this._debug("got unknown message"),this.emit("unknownmessage",e)}},Wire.prototype._parseHandshake=function(){var e=this;e._parse(1,function(t){var i=t.readUInt8(0);e._parse(i+48,function(t){var s=t.slice(0,i);if("BitTorrent protocol"!==s.toString())return e._debug("Error: wire not speaking BitTorrent protocol (%s)",s.toString()),void e.end();t=t.slice(i),e._onHandshake(t.slice(8,28),t.slice(28,48),{dht:!!(1&t[7]),extended:!!(16&t[5])}),e._parse(4,e._onMessageLength)})})},Wire.prototype._onFinish=function(){for(this._finished=!0,this.push(null);this.read(););for(clearInterval(this._keepAliveInterval),this._parse(Number.MAX_VALUE,function(){});this.peerRequests.length;)this.peerRequests.pop();for(;this.requests.length;)this._callback(this.requests.pop(),new Error("wire was closed"),null)},Wire.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._debugId+"] "+e[0],debug.apply(null,e)};

},{"bencode":24,"bitfield":20,"debug":88,"inherits":144,"randombytes":223,"readable-stream":235,"safe-buffer":244,"speedometer":268,"unordered-array-remove":294,"xtend":324}],22:[function(require,module,exports){
(function (Buffer){
function getIntFromBuffer(e,d,o){for(var n=0,t=1,c=d;c<o;c++){var i=e[c];if(i<58&&i>=48)n=10*n+(i-48);else if(c!==d||43!==i){if(c!==d||45!==i){if(46===i)break;throw new Error("not a number: buffer["+c+"] = "+i)}t=-1}}return n*t}function decode(e,d,o,n){return null==e||0===e.length?null:("number"!=typeof d&&null==n&&(n=d,d=void 0),"number"!=typeof o&&null==n&&(n=o,o=void 0),decode.position=0,decode.encoding=n||null,decode.data=Buffer.isBuffer(e)?e.slice(d,o):new Buffer(e),decode.bytes=decode.data.length,decode.next())}const INTEGER_START=105,STRING_DELIM=58,DICTIONARY_START=100,LIST_START=108,END_OF_TYPE=101;decode.bytes=0,decode.position=0,decode.data=null,decode.encoding=null,decode.next=function(){switch(decode.data[decode.position]){case 100:return decode.dictionary();case 108:return decode.list();case 105:return decode.integer();default:return decode.buffer()}},decode.find=function(e){for(var d=decode.position,o=decode.data.length,n=decode.data;d<o;){if(n[d]===e)return d;d++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(e)+'" [0x'+e.toString(16)+"]")},decode.dictionary=function(){decode.position++;for(var e={};101!==decode.data[decode.position];)e[decode.buffer()]=decode.next();return decode.position++,e},decode.list=function(){decode.position++;for(var e=[];101!==decode.data[decode.position];)e.push(decode.next());return decode.position++,e},decode.integer=function(){var e=decode.find(101),d=getIntFromBuffer(decode.data,decode.position+1,e);return decode.position+=e+1-decode.position,d},decode.buffer=function(){var e=decode.find(58),d=getIntFromBuffer(decode.data,decode.position,e),o=++e+d;return decode.position=o,decode.encoding?decode.data.toString(decode.encoding,e,o):decode.data.slice(e,o)},module.exports=decode;

}).call(this,require("buffer").Buffer)
},{"buffer":66}],23:[function(require,module,exports){
function encode(e,f,o){var n=[],r=null;return encode._encode(n,e),r=Buffer.concat(n),encode.bytes=r.length,Buffer.isBuffer(f)?(r.copy(f,o),f):r}var Buffer=require("safe-buffer").Buffer;encode.bytes=-1,encode._floatConversionDetected=!1,encode._encode=function(e,f){if(Buffer.isBuffer(f))return e.push(Buffer.from(f.length+":")),void e.push(f);if(null!=f)switch(typeof f){case"string":encode.buffer(e,f);break;case"number":encode.number(e,f);break;case"object":f.constructor===Array?encode.list(e,f):encode.dict(e,f);break;case"boolean":encode.number(e,f?1:0)}};var buffE=Buffer.from("e"),buffD=Buffer.from("d"),buffL=Buffer.from("l");encode.buffer=function(e,f){e.push(Buffer.from(Buffer.byteLength(f)+":"+f))},encode.number=function(e,f){var o=f/2147483648<<0,n=f%2147483648<<0,r=2147483648*o+n;e.push(Buffer.from("i"+r+"e")),r===f||encode._floatConversionDetected||(encode._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+f+'":','Bencoding only defines support for integers, value was converted to "'+r+'"'),console.trace())},encode.dict=function(e,f){e.push(buffD);for(var o,n=0,r=Object.keys(f).sort(),u=r.length;n<u;n++)o=r[n],null!=f[o]&&(encode.buffer(e,o),encode._encode(e,f[o]));e.push(buffE)},encode.list=function(e,f){var o=0,n=f.length;for(e.push(buffL);o<n;o++)null!=f[o]&&encode._encode(e,f[o]);e.push(buffE)},module.exports=encode;

},{"safe-buffer":244}],24:[function(require,module,exports){
var bencode=module.exports;bencode.encode=require("./encode"),bencode.decode=require("./decode"),bencode.byteLength=bencode.encodingLength=function(e){return bencode.encode(e).length};

},{"./decode":22,"./encode":23}],25:[function(require,module,exports){
(function (process){
function Client(e){function n(e){process.nextTick(function(){r.emit("warning",e)})}var r=this;if(!(r instanceof Client))return new Client(e);if(EventEmitter.call(r),e||(e={}),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!process.browser&&!e.port)throw new Error("Option `port` is required");r.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),r._peerIdBuffer=Buffer.from(r.peerId,"hex"),r._peerIdBinary=r._peerIdBuffer.toString("binary"),r.infoHash="string"==typeof e.infoHash?e.infoHash:e.infoHash.toString("hex"),r._infoHashBuffer=Buffer.from(r.infoHash,"hex"),r._infoHashBinary=r._infoHashBuffer.toString("binary"),debug("new client %s",r.infoHash),r.destroyed=!1,r._port=e.port,r._getAnnounceOpts=e.getAnnounceOpts,r._rtcConfig=e.rtcConfig,r._userAgent=e.userAgent,r._wrtc="function"==typeof e.wrtc?e.wrtc():e.wrtc;var t="string"==typeof e.announce?[e.announce]:null==e.announce?[]:e.announce;t=t.map(function(e){return e=e.toString(),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e}),t=uniq(t);var o=!1!==r._wrtc&&(!!r._wrtc||Peer.WEBRTC_SUPPORT);r._trackers=t.map(function(e){var t=url.parse(e).protocol;return"http:"!==t&&"https:"!==t||"function"!=typeof HTTPTracker?"udp:"===t&&"function"==typeof UDPTracker?new UDPTracker(r,e):"ws:"!==t&&"wss:"!==t||!o?(n(new Error("Unsupported tracker protocol: "+e)),null):"ws:"===t&&"undefined"!=typeof window&&"https:"===window.location.protocol?(n(new Error("Unsupported tracker protocol: "+e)),null):new WebSocketTracker(r,e):new HTTPTracker(r,e)}).filter(Boolean)}module.exports=Client;var Buffer=require("safe-buffer").Buffer,debug=require("debug")("bittorrent-tracker:client"),EventEmitter=require("events").EventEmitter,extend=require("xtend"),inherits=require("inherits"),once=require("once"),parallel=require("run-parallel"),Peer=require("simple-peer"),uniq=require("uniq"),url=require("url"),common=require("./lib/common"),HTTPTracker=require("./lib/client/http-tracker"),UDPTracker=require("./lib/client/udp-tracker"),WebSocketTracker=require("./lib/client/websocket-tracker");inherits(Client,EventEmitter),Client.scrape=function(e,n){if(n=once(n),!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");var r=extend(e,{infoHash:Array.isArray(e.infoHash)?e.infoHash[0]:e.infoHash,peerId:Buffer.from("01234567890123456789"),port:6881}),t=new Client(r);t.once("error",n),t.once("warning",n);var o=Array.isArray(e.infoHash)?e.infoHash.length:1,i={};return t.on("scrape",function(e){if(o-=1,i[e.infoHash]=e,0===o){t.destroy();var r=Object.keys(i);1===r.length?n(null,i[r[0]]):n(null,i)}}),e.infoHash=Array.isArray(e.infoHash)?e.infoHash.map(function(e){return Buffer.from(e,"hex")}):Buffer.from(e.infoHash,"hex"),t.scrape({infoHash:e.infoHash}),t},Client.prototype.start=function(e){var n=this;debug("send `start`"),e=n._defaultAnnounceOpts(e),e.event="started",n._announce(e),n._trackers.forEach(function(e){e.setInterval()})},Client.prototype.stop=function(e){var n=this;debug("send `stop`"),e=n._defaultAnnounceOpts(e),e.event="stopped",n._announce(e)},Client.prototype.complete=function(e){var n=this;debug("send `complete`"),e||(e={}),e=n._defaultAnnounceOpts(e),e.event="completed",n._announce(e)},Client.prototype.update=function(e){var n=this;debug("send `update`"),e=n._defaultAnnounceOpts(e),e.event&&delete e.event,n._announce(e)},Client.prototype._announce=function(e){this._trackers.forEach(function(n){n.announce(e)})},Client.prototype.scrape=function(e){var n=this;debug("send `scrape`"),e||(e={}),n._trackers.forEach(function(n){n.scrape(e)})},Client.prototype.setInterval=function(e){var n=this;debug("setInterval %d",e),n._trackers.forEach(function(n){n.setInterval(e)})},Client.prototype.destroy=function(e){var n=this;if(!n.destroyed){n.destroyed=!0,debug("destroy");var r=n._trackers.map(function(e){return function(n){e.destroy(n)}});parallel(r,e),n._trackers=[],n._getAnnounceOpts=null}},Client.prototype._defaultAnnounceOpts=function(e){var n=this;return e||(e={}),null==e.numwant&&(e.numwant=common.DEFAULT_ANNOUNCE_PEERS),null==e.uploaded&&(e.uploaded=0),null==e.downloaded&&(e.downloaded=0),n._getAnnounceOpts&&(e=extend(e,n._getAnnounceOpts())),e};
}).call(this,require('_process'))
},{"./lib/client/http-tracker":37,"./lib/client/udp-tracker":37,"./lib/client/websocket-tracker":28,"./lib/common":29,"_process":205,"debug":88,"events":121,"inherits":144,"once":186,"run-parallel":242,"safe-buffer":244,"simple-peer":30,"uniq":293,"url":295,"xtend":324}],26:[function(require,module,exports){
var Client=require("./client"),Server=require("./server");module.exports=Client,module.exports.Client=Client,module.exports.Server=Server;

},{"./client":25,"./server":37}],27:[function(require,module,exports){
function Tracker(e,t){var n=this;EventEmitter.call(n),n.client=e,n.announceUrl=t,n.interval=null,n.destroyed=!1}module.exports=Tracker;var EventEmitter=require("events").EventEmitter,inherits=require("inherits");inherits(Tracker,EventEmitter),Tracker.prototype.setInterval=function(e){var t=this;null==e&&(e=t.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(t.interval),e&&(t.interval=setInterval(function(){t.announce(t.client._defaultAnnounceOpts())},e),t.interval.unref&&t.interval.unref())};
},{"events":121,"inherits":144}],28:[function(require,module,exports){
function WebSocketTracker(e,n,o){var r=this;Tracker.call(r,e,n),debug("new websocket tracker %s",n),r.peers={},r.socket=null,r.reconnecting=!1,r.retries=0,r.reconnectTimer=null,r.expectingResponse=!1,r._openSocket()}function noop(){}module.exports=WebSocketTracker;var debug=require("debug")("bittorrent-tracker:websocket-tracker"),extend=require("xtend"),inherits=require("inherits"),Peer=require("simple-peer"),randombytes=require("randombytes"),Socket=require("simple-websocket"),common=require("../common"),Tracker=require("./tracker"),socketPool={},RECONNECT_MINIMUM=15e3,RECONNECT_MAXIMUM=18e5,RECONNECT_VARIANCE=3e4,OFFER_TIMEOUT=5e4;inherits(WebSocketTracker,Tracker),WebSocketTracker.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,WebSocketTracker.prototype.announce=function(e){var n=this;if(!n.destroyed&&!n.reconnecting){if(!n.socket.connected)return void n.socket.once("connect",function(){n.announce(e)});var o=extend(e,{action:"announce",info_hash:n.client._infoHashBinary,peer_id:n.client._peerIdBinary});if(n._trackerId&&(o.trackerid=n._trackerId),"stopped"===e.event||"completed"===e.event)n._send(o);else{var r=Math.min(e.numwant,10);n._generateOffers(r,function(e){o.numwant=r,o.offers=e,n._send(o)})}}},WebSocketTracker.prototype.scrape=function(e){var n=this;if(!n.destroyed&&!n.reconnecting){if(!n.socket.connected)return void n.socket.once("connect",function(){n.scrape(e)});var o=Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(function(e){return e.toString("binary")}):e.infoHash&&e.infoHash.toString("binary")||n.client._infoHashBinary,r={action:"scrape",info_hash:o};n._send(r)}},WebSocketTracker.prototype.destroy=function(e){function n(){i&&(clearTimeout(i),i=null),c.removeListener("data",n),c.destroy(),c=null}var o=this;if(e||(e=noop),o.destroyed)return e(null);o.destroyed=!0,clearInterval(o.interval),clearTimeout(o.reconnectTimer);for(var r in o.peers){var t=o.peers[r];clearTimeout(t.trackerTimeout),t.destroy()}if(o.peers=null,o.socket&&(o.socket.removeListener("connect",o._onSocketConnectBound),o.socket.removeListener("data",o._onSocketDataBound),o.socket.removeListener("close",o._onSocketCloseBound),o.socket.removeListener("error",o._onSocketErrorBound),o.socket=null),o._onSocketConnectBound=null,o._onSocketErrorBound=null,o._onSocketDataBound=null,o._onSocketCloseBound=null,socketPool[o.announceUrl]&&(socketPool[o.announceUrl].consumers-=1),socketPool[o.announceUrl].consumers>0)return e();var c=socketPool[o.announceUrl];if(delete socketPool[o.announceUrl],c.on("error",noop),c.once("close",e),!o.expectingResponse)return n();var i=setTimeout(n,common.DESTROY_TIMEOUT);c.once("data",n)},WebSocketTracker.prototype._openSocket=function(){var e=this;e.destroyed=!1,e.peers||(e.peers={}),e._onSocketConnectBound=function(){e._onSocketConnect()},e._onSocketErrorBound=function(n){e._onSocketError(n)},e._onSocketDataBound=function(n){e._onSocketData(n)},e._onSocketCloseBound=function(){e._onSocketClose()},e.socket=socketPool[e.announceUrl],e.socket?socketPool[e.announceUrl].consumers+=1:(e.socket=socketPool[e.announceUrl]=new Socket(e.announceUrl),e.socket.consumers=1,e.socket.once("connect",e._onSocketConnectBound)),e.socket.on("data",e._onSocketDataBound),e.socket.once("close",e._onSocketCloseBound),e.socket.once("error",e._onSocketErrorBound)},WebSocketTracker.prototype._onSocketConnect=function(){var e=this;e.destroyed||e.reconnecting&&(e.reconnecting=!1,e.retries=0,e.announce(e.client._defaultAnnounceOpts()))},WebSocketTracker.prototype._onSocketData=function(e){var n=this;if(!n.destroyed){n.expectingResponse=!1;try{e=JSON.parse(e)}catch(e){return void n.client.emit("warning",new Error("Invalid tracker response"))}"announce"===e.action?n._onAnnounceResponse(e):"scrape"===e.action?n._onScrapeResponse(e):n._onSocketError(new Error("invalid action in WS response: "+e.action))}},WebSocketTracker.prototype._onAnnounceResponse=function(e){var n=this;if(e.info_hash!==n.client._infoHashBinary)return void debug("ignoring websocket data from %s for %s (looking for %s: reused socket)",n.announceUrl,common.binaryToHex(e.info_hash),n.client.infoHash);if(!e.peer_id||e.peer_id!==n.client._peerIdBinary){debug("received %s from %s for %s",JSON.stringify(e),n.announceUrl,n.client.infoHash);var o=e["failure reason"];if(o)return n.client.emit("warning",new Error(o));var r=e["warning message"];r&&n.client.emit("warning",new Error(r));var t=e.interval||e["min interval"];t&&n.setInterval(1e3*t);var c=e["tracker id"];c&&(n._trackerId=c),null!=e.complete&&n.client.emit("update",{announce:n.announceUrl,complete:e.complete,incomplete:e.incomplete});var i;if(e.offer&&e.peer_id&&(debug("creating peer (from remote offer)"),i=new Peer({trickle:!1,config:n.client._rtcConfig,wrtc:n.client._wrtc}),i.id=common.binaryToHex(e.peer_id),i.once("signal",function(o){var r={action:"announce",info_hash:n.client._infoHashBinary,peer_id:n.client._peerIdBinary,to_peer_id:e.peer_id,answer:o,offer_id:e.offer_id};n._trackerId&&(r.trackerid=n._trackerId),n._send(r)}),i.signal(e.offer),n.client.emit("peer",i)),e.answer&&e.peer_id){var a=common.binaryToHex(e.offer_id);i=n.peers[a],i?(i.id=common.binaryToHex(e.peer_id),i.signal(e.answer),n.client.emit("peer",i),clearTimeout(i.trackerTimeout),i.trackerTimeout=null,delete n.peers[a]):debug("got unexpected answer: "+JSON.stringify(e.answer))}}},WebSocketTracker.prototype._onScrapeResponse=function(e){var n=this;e=e.files||{};var o=Object.keys(e);if(0===o.length)return void n.client.emit("warning",new Error("invalid scrape response"));o.forEach(function(o){var r=e[o];n.client.emit("scrape",{announce:n.announceUrl,infoHash:common.binaryToHex(o),complete:r.complete,incomplete:r.incomplete,downloaded:r.downloaded})})},WebSocketTracker.prototype._onSocketClose=function(){var e=this;e.destroyed||(e.destroy(),e._startReconnectTimer())},WebSocketTracker.prototype._onSocketError=function(e){var n=this;n.destroyed||(n.destroy(),n.client.emit("warning",e),n._startReconnectTimer())},WebSocketTracker.prototype._startReconnectTimer=function(){var e=this,n=Math.floor(Math.random()*RECONNECT_VARIANCE)+Math.min(Math.pow(2,e.retries)*RECONNECT_MINIMUM,RECONNECT_MAXIMUM);e.reconnecting=!0,clearTimeout(e.reconnectTimer),e.reconnectTimer=setTimeout(function(){e.retries++,e._openSocket()},n),e.reconnectTimer.unref&&e.reconnectTimer.unref(),debug("reconnecting socket in %s ms",n)},WebSocketTracker.prototype._send=function(e){var n=this;if(!n.destroyed){n.expectingResponse=!0;var o=JSON.stringify(e);debug("send %s",o),n.socket.send(o)}},WebSocketTracker.prototype._generateOffers=function(e,n){function o(){t.length===e&&(debug("generated %s offers",e),n(t))}var r=this,t=[];debug("generating %s offers",e);for(var c=0;c<e;++c)!function(){var e=randombytes(20).toString("hex");debug("creating peer (from _generateOffers)");var n=r.peers[e]=new Peer({initiator:!0,trickle:!1,config:r.client._rtcConfig,wrtc:r.client._wrtc});n.once("signal",function(n){t.push({offer:n,offer_id:common.hexToBinary(e)}),o()}),n.trackerTimeout=setTimeout(function(){debug("tracker timeout: destroying peer"),n.trackerTimeout=null,delete r.peers[e],n.destroy()},OFFER_TIMEOUT),n.trackerTimeout.unref&&n.trackerTimeout.unref()}();o()};

},{"../common":29,"./tracker":27,"debug":88,"inherits":144,"randombytes":223,"simple-peer":30,"simple-websocket":259,"xtend":324}],29:[function(require,module,exports){
var Buffer=require("safe-buffer").Buffer,extend=require("xtend/mutable");exports.DEFAULT_ANNOUNCE_PEERS=50,exports.MAX_ANNOUNCE_PEERS=82,exports.binaryToHex=function(r){return"string"!=typeof r&&(r=String(r)),Buffer.from(r,"binary").toString("hex")},exports.hexToBinary=function(r){return"string"!=typeof r&&(r=String(r)),Buffer.from(r,"hex").toString("binary")};var config=require("./common-node");extend(exports,config);
},{"./common-node":37,"safe-buffer":244,"xtend/mutable":325}],30:[function(require,module,exports){
(function (Buffer){
function Peer(e){var n=this;if(!(n instanceof Peer))return new Peer(e);if(n._id=randombytes(4).toString("hex").slice(0,7),n._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),stream.Duplex.call(n,e),n.channelName=e.initiator?e.channelName||randombytes(20).toString("hex"):null,n._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,n.initiator=e.initiator||!1,n.channelConfig=e.channelConfig||Peer.channelConfig,n.config=e.config||Peer.config,n.constraints=n._transformConstraints(e.constraints||Peer.constraints),n.offerConstraints=n._transformConstraints(e.offerConstraints||{}),n.answerConstraints=n._transformConstraints(e.answerConstraints||{}),n.reconnectTimer=e.reconnectTimer||!1,n.sdpTransform=e.sdpTransform||function(e){return e},n.stream=e.stream||!1,n.trickle=void 0===e.trickle||e.trickle,n.destroyed=!1,n.connected=!1,n.remoteAddress=void 0,n.remoteFamily=void 0,n.remotePort=void 0,n.localAddress=void 0,n.localPort=void 0,n._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:getBrowserRTC(),!n._wrtc)throw"undefined"==typeof window?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser");if(n._pcReady=!1,n._channelReady=!1,n._iceComplete=!1,n._channel=null,n._pendingCandidates=[],n._previousStreams=[],n._chunk=null,n._cb=null,n._interval=null,n._reconnectTimeout=null,n._pc=new n._wrtc.RTCPeerConnection(n.config,n.constraints),n._isWrtc=Array.isArray(n._pc.RTCIceConnectionStates),n._isReactNativeWebrtc="number"==typeof n._pc._peerConnectionId,n._pc.oniceconnectionstatechange=function(){n._onIceConnectionStateChange()},n._pc.onsignalingstatechange=function(){n._onSignalingStateChange()},n._pc.onicecandidate=function(e){n._onIceCandidate(e)},n.initiator){var t=!1;n._pc.onnegotiationneeded=function(){t||n._createOffer(),t=!0},n._setupData({channel:n._pc.createDataChannel(n.channelName,n.channelConfig)})}else n._pc.ondatachannel=function(e){n._setupData(e)};"addTrack"in n._pc?(n.stream&&n.stream.getTracks().forEach(function(e){n._pc.addTrack(e,n.stream)}),n._pc.ontrack=function(e){n._onTrack(e)}):(n.stream&&n._pc.addStream(n.stream),n._pc.onaddstream=function(e){n._onAddStream(e)}),n.initiator&&n._isWrtc&&n._pc.onnegotiationneeded(),n._onFinishBound=function(){n._onFinish()},n.once("finish",n._onFinishBound)}function noop(){}module.exports=Peer;var debug=require("debug")("simple-peer"),getBrowserRTC=require("get-browser-rtc"),inherits=require("inherits"),randombytes=require("randombytes"),stream=require("readable-stream"),MAX_BUFFERED_AMOUNT=65536;inherits(Peer,stream.Duplex),Peer.WEBRTC_SUPPORT=!!getBrowserRTC(),Peer.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},Peer.constraints={},Peer.channelConfig={},Object.defineProperty(Peer.prototype,"bufferSize",{get:function(){var e=this;return e._channel&&e._channel.bufferedAmount||0}}),Peer.prototype.address=function(){var e=this;return{port:e.localPort,family:"IPv4",address:e.localAddress}},Peer.prototype.signal=function(e){var n=this;if(n.destroyed)throw new Error("cannot signal after peer is destroyed");if("string"==typeof e)try{e=JSON.parse(e)}catch(n){e={}}n._debug("signal()"),e.candidate&&(n._pc.remoteDescription?n._addIceCandidate(e.candidate):n._pendingCandidates.push(e.candidate)),e.sdp&&n._pc.setRemoteDescription(new n._wrtc.RTCSessionDescription(e),function(){n.destroyed||(n._pendingCandidates.forEach(function(e){n._addIceCandidate(e)}),n._pendingCandidates=[],"offer"===n._pc.remoteDescription.type&&n._createAnswer())},function(e){n._onError(e)}),e.sdp||e.candidate||n._destroy(new Error("signal() called with invalid signal data"))},Peer.prototype._addIceCandidate=function(e){var n=this;try{n._pc.addIceCandidate(new n._wrtc.RTCIceCandidate(e),noop,function(e){n._onError(e)})}catch(e){n._destroy(new Error("error adding candidate: "+e.message))}},Peer.prototype.send=function(e){var n=this;n._isWrtc&&Buffer.isBuffer(e)&&(e=new Uint8Array(e)),n._channel.send(e)},Peer.prototype.destroy=function(e){this._destroy(null,e)},Peer.prototype._destroy=function(e,n){var t=this;if(!t.destroyed){if(n&&t.once("close",n),t._debug("destroy (error: %s)",e&&e.message),t.readable=t.writable=!1,t._readableState.ended||t.push(null),t._writableState.finished||t.end(),t.destroyed=!0,t.connected=!1,t._pcReady=!1,t._channelReady=!1,t._previousStreams=null,clearInterval(t._interval),clearTimeout(t._reconnectTimeout),t._interval=null,t._reconnectTimeout=null,t._chunk=null,t._cb=null,t._onFinishBound&&t.removeListener("finish",t._onFinishBound),t._onFinishBound=null,t._pc){try{t._pc.close()}catch(e){}t._pc.oniceconnectionstatechange=null,t._pc.onsignalingstatechange=null,t._pc.onicecandidate=null,"addTrack"in t._pc?t._pc.ontrack=null:t._pc.onaddstream=null,t._pc.onnegotiationneeded=null,t._pc.ondatachannel=null}if(t._channel){try{t._channel.close()}catch(e){}t._channel.onmessage=null,t._channel.onopen=null,t._channel.onclose=null}t._pc=null,t._channel=null,e&&t.emit("error",e),t.emit("close")}},Peer.prototype._setupData=function(e){var n=this;if(!e.channel)return n._onError(new Error("Data channel event is missing `channel` property"));n._channel=e.channel,n._channel.binaryType="arraybuffer","number"==typeof n._channel.bufferedAmountLowThreshold&&(n._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),n.channelName=n._channel.label,n._channel.onmessage=function(e){n._onChannelMessage(e)},n._channel.onbufferedamountlow=function(){n._onChannelBufferedAmountLow()},n._channel.onopen=function(){n._onChannelOpen()},n._channel.onclose=function(){n._onChannelClose()}},Peer.prototype._read=function(){},Peer.prototype._write=function(e,n,t){var o=this;if(o.destroyed)return t(new Error("cannot write after peer is destroyed"));if(o.connected){try{o.send(e)}catch(e){return o._onError(e)}o._channel.bufferedAmount>MAX_BUFFERED_AMOUNT?(o._debug("start backpressure: bufferedAmount %d",o._channel.bufferedAmount),o._cb=t):t(null)}else o._debug("write before connect"),o._chunk=e,o._cb=t},Peer.prototype._onFinish=function(){function e(){setTimeout(function(){n._destroy()},100)}var n=this;n.destroyed||(n.connected?e():n.once("connect",e))},Peer.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(n){if(!e.destroyed){n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,noop,function(n){e._onError(n)});var t=function(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})};e.trickle||e._iceComplete?t():e.once("_iceComplete",t)}},function(n){e._onError(n)},e.offerConstraints)},Peer.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(n){function t(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})}e.destroyed||(n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,noop,function(n){e._onError(n)}),e.trickle||e._iceComplete?t():e.once("_iceComplete",t))},function(n){e._onError(n)},e.answerConstraints)},Peer.prototype._onIceConnectionStateChange=function(){var e=this;if(!e.destroyed){var n=e._pc.iceGatheringState,t=e._pc.iceConnectionState;e._debug("iceConnectionStateChange %s %s",n,t),e.emit("iceConnectionStateChange",n,t),"connected"!==t&&"completed"!==t||(clearTimeout(e._reconnectTimeout),e._pcReady=!0,e._maybeReady()),"disconnected"===t&&(e.reconnectTimer?(clearTimeout(e._reconnectTimeout),e._reconnectTimeout=setTimeout(function(){e._destroy()},e.reconnectTimer)):e._destroy()),"failed"===t&&e._destroy(new Error("Ice connection failed.")),"closed"===t&&e._destroy()}},Peer.prototype.getStats=function(e){var n=this;0===n._pc.getStats.length?n._pc.getStats().then(function(n){var t=[];n.forEach(function(e){t.push(e)}),e(null,t)},function(n){e(n)}):n._isReactNativeWebrtc?n._pc.getStats(null,function(n){var t=[];n.forEach(function(e){t.push(e)}),e(null,t)},function(n){e(n)}):n._pc.getStats.length>0?n._pc.getStats(function(n){var t=[];n.result().forEach(function(e){var n={};e.names().forEach(function(t){n[t]=e.stat(t)}),n.id=e.id,n.type=e.type,n.timestamp=e.timestamp,t.push(n)}),e(null,t)},function(n){e(n)}):e(null,[])},Peer.prototype._maybeReady=function(){var e=this;e._debug("maybeReady pc %s channel %s",e._pcReady,e._channelReady),!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,e.getStats(function(n,t){function o(n){var t=i[n.localCandidateId];t&&t.ip?(e.localAddress=t.ip,e.localPort=Number(t.port)):t&&t.ipAddress?(e.localAddress=t.ipAddress,e.localPort=Number(t.portNumber)):"string"==typeof n.googLocalAddress&&(t=n.googLocalAddress.split(":"),e.localAddress=t[0],e.localPort=Number(t[1]));var o=r[n.remoteCandidateId];o&&o.ip?(e.remoteAddress=o.ip,e.remotePort=Number(o.port)):o&&o.ipAddress?(e.remoteAddress=o.ipAddress,e.remotePort=Number(o.portNumber)):"string"==typeof n.googRemoteAddress&&(o=n.googRemoteAddress.split(":"),e.remoteAddress=o[0],e.remotePort=Number(o[1])),e.remoteFamily="IPv4",e._debug("connect local: %s:%s remote: %s:%s",e.localAddress,e.localPort,e.remoteAddress,e.remotePort)}n&&(t=[]),e._connecting=!1,e.connected=!0;var r={},i={},a={};if(t.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(r[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(i[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(a[e.id]=e)}),t.forEach(function(e){"transport"===e.type&&o(a[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),e._chunk){try{e.send(e._chunk)}catch(n){return e._onError(n)}e._chunk=null,e._debug('sent chunk from "write before connect"');var c=e._cb;e._cb=null,c(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}))},Peer.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT||this._onChannelBufferedAmountLow()},Peer.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||(e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},Peer.prototype._onIceCandidate=function(e){var n=this;n.destroyed||(e.candidate&&n.trickle?n.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||(n._iceComplete=!0,n.emit("_iceComplete")))},Peer.prototype._onChannelMessage=function(e){var n=this;if(!n.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=Buffer.from(t)),n.push(t)}},Peer.prototype._onChannelBufferedAmountLow=function(){var e=this;if(!e.destroyed&&e._cb){e._debug("ending backpressure: bufferedAmount %d",e._channel.bufferedAmount);var n=e._cb;e._cb=null,n(null)}},Peer.prototype._onChannelOpen=function(){var e=this;e.connected||e.destroyed||(e._debug("on channel open"),e._channelReady=!0,e._maybeReady())},Peer.prototype._onChannelClose=function(){var e=this;e.destroyed||(e._debug("on channel close"),e._destroy())},Peer.prototype._onAddStream=function(e){var n=this;n.destroyed||(n._debug("on add stream"),n.emit("stream",e.stream))},Peer.prototype._onTrack=function(e){var n=this;if(!n.destroyed){n._debug("on track");var t=e.streams[0].id;-1===n._previousStreams.indexOf(t)&&(n._previousStreams.push(t),n.emit("stream",e.streams[0]))}},Peer.prototype._onError=function(e){var n=this;n.destroyed||(n._debug("error %s",e.message||e),n._destroy(e))},Peer.prototype._debug=function(){var e=this,n=[].slice.call(arguments);n[0]="["+e._id+"] "+n[0],debug.apply(null,n)},Peer.prototype._transformConstraints=function(e){var n=this;if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!n._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!n._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"debug":88,"get-browser-rtc":125,"inherits":144,"randombytes":223,"readable-stream":235}],31:[function(require,module,exports){
function Blake2b(A,I,C,g,i){if(!(this instanceof Blake2b))return new Blake2b(A,I,C,g,i);if(!mod)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");A||(A=32),!0!==i&&(assert(A>=BYTES_MIN,"digestLength must be at least "+BYTES_MIN+", was given "+A),assert(A<=BYTES_MAX,"digestLength must be at most "+BYTES_MAX+", was given "+A),null!=I&&assert(I.length>=KEYBYTES_MIN,"key must be at least "+KEYBYTES_MIN+", was given "+I.length),null!=I&&assert(I.length<=KEYBYTES_MAX,"key must be at least "+KEYBYTES_MAX+", was given "+I.length),null!=C&&assert(C.length===SALTBYTES,"salt must be exactly "+SALTBYTES+", was given "+C.length),null!=g&&assert(g.length===PERSONALBYTES,"personal must be exactly "+PERSONALBYTES+", was given "+g.length)),freeList.length||(freeList.push(head),head+=216),this.digestLength=A,this.finalized=!1,this.pointer=freeList.pop(),memory.fill(0,0,64),memory[0]=this.digestLength,memory[1]=I?I.length:0,memory[2]=1,memory[3]=1,C&&memory.set(C,32),g&&memory.set(g,48),mod.blake2b_init(this.pointer,this.digestLength),I&&(this.update(I),memory.fill(0,head,head+I.length),memory[this.pointer+200]=128)}function noop(){}function hexSlice(A,I,C){for(var g="",i=0;i<C;i++)g+=toHex(A[I+i]);return g}function toHex(A){return A<16?"0"+A.toString(16):A.toString(16)}function setup(A){mod=A.instance.exports,memory=new Uint8Array(A.instance.exports.memory.buffer)}var assert=require("nanoassert"),toUint8Array=require("base64-to-uint8array"),buf=toUint8Array("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMK00AElgMAIABCADcDACAAQQhqQgA3AwAgAEEQakIANwMAIABBGGpCADcDACAAQSBqQgA3AwAgAEEoakIANwMAIABBMGpCADcDACAAQThqQgA3AwAgAEHAAGpCADcDACAAQcgAakIANwMAIABB0ABqQgA3AwAgAEHYAGpCADcDACAAQeAAakIANwMAIABB6ABqQgA3AwAgAEHwAGpCADcDACAAQfgAakIANwMAIABBgAFqQoiS853/zPmE6gBBACkDAIU3AwAgAEGIAWpCu86qptjQ67O7f0EIKQMAhTcDACAAQZABakKr8NP0r+68tzxBECkDAIU3AwAgAEGYAWpC8e30+KWn/aelf0EYKQMAhTcDACAAQaABakLRhZrv+s+Uh9EAQSApAwCFNwMAIABBqAFqQp/Y+dnCkdqCm39BKCkDAIU3AwAgAEGwAWpC6/qG2r+19sEfQTApAwCFNwMAIABBuAFqQvnC+JuRo7Pw2wBBOCkDAIU3AwAgAEHAAWpCADcDACAAQcgBakIANwMAIABB0AFqQgA3AwALbQEDfyAAQcABaiEDIABByAFqIQQgBCkDAKchBQJAA0AgASACRg0BIAVBgAFGBEAgAyADKQMAIAWtfDcDAEEAIQUgABADCyAAIAVqIAEtAAA6AAAgBUEBaiEFIAFBAWohAQwACwsgBCAFrTcDAAtkAQN/IABBwAFqIQEgAEHIAWohAiABIAEpAwAgAikDAHw3AwAgAEHQAWpCfzcDACACKQMApyEDAkADQCADQYABRg0BIAAgA2pBADoAACADQQFqIQMMAAsLIAIgA603AwAgABADC+U7AiB+CX8gAEGAAWohISAAQYgBaiEiIABBkAFqISMgAEGYAWohJCAAQaABaiElIABBqAFqISYgAEGwAWohJyAAQbgBaiEoICEpAwAhASAiKQMAIQIgIykDACEDICQpAwAhBCAlKQMAIQUgJikDACEGICcpAwAhByAoKQMAIQhCiJLznf/M+YTqACEJQrvOqqbY0Ouzu38hCkKr8NP0r+68tzwhC0Lx7fT4paf9p6V/IQxC0YWa7/rPlIfRACENQp/Y+dnCkdqCm38hDkLr+obav7X2wR8hD0L5wvibkaOz8NsAIRAgACkDACERIABBCGopAwAhEiAAQRBqKQMAIRMgAEEYaikDACEUIABBIGopAwAhFSAAQShqKQMAIRYgAEEwaikDACEXIABBOGopAwAhGCAAQcAAaikDACEZIABByABqKQMAIRogAEHQAGopAwAhGyAAQdgAaikDACEcIABB4ABqKQMAIR0gAEHoAGopAwAhHiAAQfAAaikDACEfIABB+ABqKQMAISAgDSAAQcABaikDAIUhDSAPIABB0AFqKQMAhSEPIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBx8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAZfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgHXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBF8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAWfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgE3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIICB8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAefHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgG3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB98fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAUfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgF3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBh8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCASfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBV8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAYfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgGnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBR8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiASfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIB18fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAcfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggH3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBN8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAXfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgFnx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBt8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAVfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggEXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFICB8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAZfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgGnx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBF8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAWfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGHx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBN8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAVfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggG3x8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIICB8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAffHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgEnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBx8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAdfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggF3x8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBl8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAUfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgHnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBN8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAdfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgF3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBt8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByARfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBl8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAUfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgFXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB58fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAYfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFnx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIICB8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAffHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgEnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBp8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAdfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgFnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBJ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAgfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgH3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIB58fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAVfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggG3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBF8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAYfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgF3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBR8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAafHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggE3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBl8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAcfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHnx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBx8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAYfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgH3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIB18fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByASfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggFHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBp8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAWfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgEXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHICB8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAVfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGXx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBd8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSATfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgG3x8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBd8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAgfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgH3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBp8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAcfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBF8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAZfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgHXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBN8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAefHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgGHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBJ8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAVfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgG3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBZ8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAbfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgE3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBl8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAVfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGHx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBd8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCASfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggFnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGICB8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAcfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgGnx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB98fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAUfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB58fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSARfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgEXx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBJ8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiATfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgFHx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBV8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAWfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggF3x8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBh8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAZfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgGnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBt8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAcfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHXx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB58fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAffHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgIHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB98fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAbfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBl8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAafHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgIHx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIB58fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAXfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEnx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIB18fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByARfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgE3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBx8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAYfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgFnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBR8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFICEgISkDACABIAmFhTcDACAiICIpAwAgAiAKhYU3AwAgIyAjKQMAIAMgC4WFNwMAICQgJCkDACAEIAyFhTcDACAlICUpAwAgBSANhYU3AwAgJiAmKQMAIAYgDoWFNwMAICcgJykDACAHIA+FhTcDACAoICgpAwAgCCAQhYU3AwAL"),rdy,head=64,mod=null,memory=null,freeList=[];module.exports=Blake2b;var BYTES_MIN=module.exports.BYTES_MIN=16,BYTES_MAX=module.exports.BYTES_MAX=64,BYTES=module.exports.BYTES=32,KEYBYTES_MIN=module.exports.KEYBYTES_MIN=16,KEYBYTES_MAX=module.exports.KEYBYTES_MAX=64,KEYBYTES=module.exports.KEYBYTES=32,SALTBYTES=module.exports.SALTBYTES=16,PERSONALBYTES=module.exports.PERSONALBYTES=16;Blake2b.prototype.ready=Blake2b.ready,Blake2b.prototype.update=function(A){return assert(!1===this.finalized,"Hash instance finalized"),assert(A,"input must be TypedArray or Buffer"),memory.set(A,head),mod.blake2b_update(this.pointer,head,head+A.length),this},Blake2b.prototype.digest=function(A){if(assert(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,freeList.push(this.pointer),mod.blake2b_final(this.pointer),!A||"binary"===A)return memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("hex"===A)return hexSlice(memory,this.pointer+128,this.digestLength);assert(A.length>=this.digestLength,"input must be TypedArray or Buffer");for(var I=0;I<this.digestLength;I++)A[I]=memory[this.pointer+128+I];return A},Blake2b.prototype.final=Blake2b.prototype.digest,Blake2b.WASM=buf,Blake2b.SUPPORTED="undefined"!=typeof WebAssembly,Blake2b.ready=function(A){return A||(A=noop),Blake2b.SUPPORTED?(rdy||(rdy=WebAssembly.instantiate(buf).then(setup)),rdy.then(A).catch(A)):A(new Error("WebAssembly not supported"))};
},{"base64-to-uint8array":17,"nanoassert":183}],32:[function(require,module,exports){
function ADD64AA(e,t,r){var a=e[t]+e[r],n=e[t+1]+e[r+1];a>=4294967296&&n++,e[t]=a,e[t+1]=n}function ADD64AC(e,t,r,a){var n=e[t]+r;r<0&&(n+=4294967296);var o=e[t+1]+a;n>=4294967296&&o++,e[t]=n,e[t+1]=o}function B2B_GET32(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function B2B_G(e,t,r,a,n,o){var s=m[n],l=m[n+1],A=m[o],u=m[o+1];ADD64AA(v,e,t),ADD64AC(v,e,s,l);var B=v[a]^v[e],S=v[a+1]^v[e+1];v[a]=S,v[a+1]=B,ADD64AA(v,r,a),B=v[t]^v[r],S=v[t+1]^v[r+1],v[t]=B>>>24^S<<8,v[t+1]=S>>>24^B<<8,ADD64AA(v,e,t),ADD64AC(v,e,A,u),B=v[a]^v[e],S=v[a+1]^v[e+1],v[a]=B>>>16^S<<16,v[a+1]=S>>>16^B<<16,ADD64AA(v,r,a),B=v[t]^v[r],S=v[t+1]^v[r+1],v[t]=S>>>31^B<<1,v[t+1]=B>>>31^S<<1}function blake2bCompress(e,t){var r=0;for(r=0;r<16;r++)v[r]=e.h[r],v[r+16]=BLAKE2B_IV32[r];for(v[24]=v[24]^e.t,v[25]=v[25]^e.t/4294967296,t&&(v[28]=~v[28],v[29]=~v[29]),r=0;r<32;r++)m[r]=B2B_GET32(e.b,4*r);for(r=0;r<12;r++)B2B_G(0,8,16,24,SIGMA82[16*r+0],SIGMA82[16*r+1]),B2B_G(2,10,18,26,SIGMA82[16*r+2],SIGMA82[16*r+3]),B2B_G(4,12,20,28,SIGMA82[16*r+4],SIGMA82[16*r+5]),B2B_G(6,14,22,30,SIGMA82[16*r+6],SIGMA82[16*r+7]),B2B_G(0,10,20,30,SIGMA82[16*r+8],SIGMA82[16*r+9]),B2B_G(2,12,22,24,SIGMA82[16*r+10],SIGMA82[16*r+11]),B2B_G(4,14,16,26,SIGMA82[16*r+12],SIGMA82[16*r+13]),B2B_G(6,8,18,28,SIGMA82[16*r+14],SIGMA82[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^v[r]^v[r+16]}function Blake2b(e,t,r,a){parameter_block.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=e,parameter_block[0]=e,t&&(parameter_block[1]=t.length),parameter_block[2]=1,parameter_block[3]=1,r&&parameter_block.set(r,32),a&&parameter_block.set(a,48);for(var n=0;n<16;n++)this.h[n]=BLAKE2B_IV32[n]^B2B_GET32(parameter_block,4*n);t&&(blake2bUpdate(this,t),this.c=128)}function blake2bUpdate(e,t){for(var r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,blake2bCompress(e,!1),e.c=0),e.b[e.c++]=t[r]}function blake2bFinal(e,t){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;blake2bCompress(e,!0);for(var r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function hexSlice(e){for(var t="",r=0;r<e.length;r++)t+=toHex(e[r]);return t}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}var assert=require("nanoassert"),b2wasm=require("blake2b-wasm"),BLAKE2B_IV32=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),SIGMA8=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],SIGMA82=new Uint8Array(SIGMA8.map(function(e){return 2*e})),v=new Uint32Array(32),m=new Uint32Array(32),parameter_block=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);Blake2b.prototype.update=function(e){return assert(null!=e,"input must be Uint8Array or Buffer"),blake2bUpdate(this,e),this},Blake2b.prototype.digest=function(e){var t=e&&"binary"!==e&&"hex"!==e?e:new Uint8Array(this.outlen);return assert(t.length>=this.outlen,"out must have at least outlen bytes of space"),blake2bFinal(this,t),"hex"===e?hexSlice(t):t},Blake2b.prototype.final=Blake2b.prototype.digest,Blake2b.ready=function(e){b2wasm.ready(function(){e()})};var Proto=Blake2b;module.exports=function(e,t,r,a,n){return!0!==n&&(assert(e>=BYTES_MIN,"outlen must be at least "+BYTES_MIN+", was given "+e),assert(e<=BYTES_MAX,"outlen must be at most "+BYTES_MAX+", was given "+e),null!=t&&assert(t.length>=KEYBYTES_MIN,"key must be at least "+KEYBYTES_MIN+", was given "+t.length),null!=t&&assert(t.length<=KEYBYTES_MAX,"key must be at least "+KEYBYTES_MAX+", was given "+t.length),null!=r&&assert(r.length===SALTBYTES,"salt must be exactly "+SALTBYTES+", was given "+r.length),null!=a&&assert(a.length===PERSONALBYTES,"personal must be exactly "+PERSONALBYTES+", was given "+a.length)),new Proto(e,t,r,a)},module.exports.ready=function(e){b2wasm.ready(function(){e()})},module.exports.WASM_SUPPORTED=b2wasm.SUPPORTED,module.exports.WASM_LOADED=!1;var BYTES_MIN=module.exports.BYTES_MIN=16,BYTES_MAX=module.exports.BYTES_MAX=64,BYTES=module.exports.BYTES=32,KEYBYTES_MIN=module.exports.KEYBYTES_MIN=16,KEYBYTES_MAX=module.exports.KEYBYTES_MAX=64,KEYBYTES=module.exports.KEYBYTES=32,SALTBYTES=module.exports.SALTBYTES=16,PERSONALBYTES=module.exports.PERSONALBYTES=16;b2wasm.ready(function(e){e||(module.exports.WASM_LOADED=!0,Proto=b2wasm)});

},{"blake2b-wasm":31,"nanoassert":183}],33:[function(require,module,exports){
(function (Buffer){
module.exports=function(e,r){function n(e){o.removeEventListener("loadend",n,!1),e.error?r(e.error):r(null,new Buffer(o.result))}if("undefined"==typeof Blob||!(e instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof r)throw new Error("second argument must be a function");var o=new FileReader;o.addEventListener("loadend",n,!1),o.readAsArrayBuffer(e)};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],34:[function(require,module,exports){
(function (Buffer){
function Block(e,s){if(!(this instanceof Block))return new Block(e,s);Transform.call(this),s||(s={}),"object"==typeof e&&(s=e,e=s.size),this.size=e||512,s.nopad?this._zeroPadding=!1:this._zeroPadding=defined(s.zeroPadding,!0),this._buffered=[],this._bufferedBytes=0}var inherits=require("inherits"),Transform=require("readable-stream").Transform,defined=require("defined");module.exports=Block,inherits(Block,Transform),Block.prototype._transform=function(e,s,i){for(this._bufferedBytes+=e.length,this._buffered.push(e);this._bufferedBytes>=this.size;){var t=Buffer.concat(this._buffered);this._bufferedBytes-=this.size,this.push(t.slice(0,this.size)),this._buffered=[t.slice(this.size,t.length)]}i()},Block.prototype._flush=function(){if(this._bufferedBytes&&this._zeroPadding){var e=new Buffer(this.size-this._bufferedBytes);e.fill(0),this._buffered.push(e),this.push(Buffer.concat(this._buffered)),this._buffered=null}else this._bufferedBytes&&(this.push(Buffer.concat(this._buffered)),this._buffered=null);this.push(null)};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"defined":90,"inherits":144,"readable-stream":235}],35:[function(require,module,exports){
!function(t,i){"use strict";function r(t,i){if(!t)throw new Error(i||"Assertion failed")}function h(t,i){t.super_=i;var r=function(){};r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t}function n(t,i,r){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==i&&"be"!==i||(r=i,i=10),this._init(t||0,i||10,r||"be"))}function e(t,i,r){for(var h=0,n=Math.min(t.length,r),e=i;e<n;e++){var o=t.charCodeAt(e)-48;h<<=4,h|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return h}function o(t,i,r,h){for(var n=0,e=Math.min(t.length,r),o=i;o<e;o++){var s=t.charCodeAt(o)-48;n*=h,n+=s>=49?s-49+10:s>=17?s-17+10:s}return n}function s(t){for(var i=new Array(t.bitLength()),r=0;r<i.length;r++){var h=r/26|0,n=r%26;i[r]=(t.words[h]&1<<n)>>>n}return i}function u(t,i,r){r.negative=i.negative^t.negative;var h=t.length+i.length|0;r.length=h,h=h-1|0;var n=0|t.words[0],e=0|i.words[0],o=n*e,s=67108863&o,u=o/67108864|0;r.words[0]=s;for(var a=1;a<h;a++){for(var l=u>>>26,m=67108863&u,f=Math.min(a,i.length-1),d=Math.max(0,a-t.length+1);d<=f;d++){var p=a-d|0;n=0|t.words[p],e=0|i.words[d],o=n*e+m,l+=o/67108864|0,m=67108863&o}r.words[a]=0|m,u=0|l}return 0!==u?r.words[a]=0|u:r.length--,r.strip()}function a(t,i,r){r.negative=i.negative^t.negative,r.length=t.length+i.length;for(var h=0,n=0,e=0;e<r.length-1;e++){var o=n;n=0;for(var s=67108863&h,u=Math.min(e,i.length-1),a=Math.max(0,e-t.length+1);a<=u;a++){var l=e-a,m=0|t.words[l],f=0|i.words[a],d=m*f,p=67108863&d;o=o+(d/67108864|0)|0,p=p+s|0,s=67108863&p,o=o+(p>>>26)|0,n+=o>>>26,o&=67108863}r.words[e]=s,h=o,o=n}return 0!==h?r.words[e]=h:r.length--,r.strip()}function l(t,i,r){return(new m).mulp(t,i,r)}function m(t,i){this.x=t,this.y=i}function f(t,i){this.name=t,this.p=new n(i,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function d(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function M(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function v(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function g(t){if("string"==typeof t){var i=n._prime(t);this.m=i.p,this.prime=i}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function c(t){g.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=n:i.BN=n,n.BN=n,n.wordSize=26;var w;try{w=require("buffer").Buffer}catch(t){}n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,i){return t.cmp(i)>0?t:i},n.min=function(t,i){return t.cmp(i)<0?t:i},n.prototype._init=function(t,i,h){if("number"==typeof t)return this._initNumber(t,i,h);if("object"==typeof t)return this._initArray(t,i,h);"hex"===i&&(i=16),r(i===(0|i)&&i>=2&&i<=36),t=t.toString().replace(/\s+/g,"");var n=0;"-"===t[0]&&n++,16===i?this._parseHex(t,n):this._parseBase(t,i,n),"-"===t[0]&&(this.negative=1),this.strip(),"le"===h&&this._initArray(this.toArray(),i,h)},n.prototype._initNumber=function(t,i,h){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===h&&this._initArray(this.toArray(),i,h)},n.prototype._initArray=function(t,i,h){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var e,o,s=0;if("be"===h)for(n=t.length-1,e=0;n>=0;n-=3)o=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,e++);else if("le"===h)for(n=0,e=0;n<t.length;n+=3)o=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,e++);return this.strip()},n.prototype._parseHex=function(t,i){this.length=Math.ceil((t.length-i)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var h,n,o=0;for(r=t.length-6,h=0;r>=i;r-=6)n=e(t,r,r+6),this.words[h]|=n<<o&67108863,this.words[h+1]|=n>>>26-o&4194303,(o+=24)>=26&&(o-=26,h++);r+6!==i&&(n=e(t,i,r+6),this.words[h]|=n<<o&67108863,this.words[h+1]|=n>>>26-o&4194303),this.strip()},n.prototype._parseBase=function(t,i,r){this.words=[0],this.length=1;for(var h=0,n=1;n<=67108863;n*=i)h++;h--,n=n/i|0;for(var e=t.length-r,s=e%h,u=Math.min(e,e-s)+r,a=0,l=r;l<u;l+=h)a=o(t,l,l+h,i),this.imuln(n),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==s){var m=1;for(a=o(t,l,t.length,i),l=0;l<s;l++)m*=i;this.imuln(m),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}},n.prototype.copy=function(t){t.words=new Array(this.length);for(var i=0;i<this.length;i++)t.words[i]=this.words[i];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(t,i){t=t||10,i=0|i||1;var h;if(16===t||"hex"===t){h="";for(var n=0,e=0,o=0;o<this.length;o++){var s=this.words[o],u=(16777215&(s<<n|e)).toString(16);e=s>>>24-n&16777215,h=0!==e||o!==this.length-1?y[6-u.length]+u+h:u+h,n+=2,n>=26&&(n-=26,o--)}for(0!==e&&(h=e.toString(16)+h);h.length%i!=0;)h="0"+h;return 0!==this.negative&&(h="-"+h),h}if(t===(0|t)&&t>=2&&t<=36){var a=b[t],l=_[t];h="";var m=this.clone();for(m.negative=0;!m.isZero();){var f=m.modn(l).toString(t);m=m.idivn(l),h=m.isZero()?f+h:y[a-f.length]+f+h}for(this.isZero()&&(h="0"+h);h.length%i!=0;)h="0"+h;return 0!==this.negative&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(t,i){return r(void 0!==w),this.toArrayLike(w,t,i)},n.prototype.toArray=function(t,i){return this.toArrayLike(Array,t,i)},n.prototype.toArrayLike=function(t,i,h){var n=this.byteLength(),e=h||Math.max(1,n);r(n<=e,"byte array longer than desired length"),r(e>0,"Requested array length <= 0"),this.strip();var o,s,u="le"===i,a=new t(e),l=this.clone();if(u){for(s=0;!l.isZero();s++)o=l.andln(255),l.iushrn(8),a[s]=o;for(;s<e;s++)a[s]=0}else{for(s=0;s<e-n;s++)a[s]=0;for(s=0;!l.isZero();s++)o=l.andln(255),l.iushrn(8),a[e-s-1]=o}return a},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var i=t,r=0;return i>=4096&&(r+=13,i>>>=13),i>=64&&(r+=7,i>>>=7),i>=8&&(r+=4,i>>>=4),i>=2&&(r+=2,i>>>=2),r+i},n.prototype._zeroBits=function(t){if(0===t)return 26;var i=t,r=0;return 0==(8191&i)&&(r+=13,i>>>=13),0==(127&i)&&(r+=7,i>>>=7),0==(15&i)&&(r+=4,i>>>=4),0==(3&i)&&(r+=2,i>>>=2),0==(1&i)&&r++,r},n.prototype.bitLength=function(){var t=this.words[this.length-1],i=this._countBits(t);return 26*(this.length-1)+i},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,i=0;i<this.length;i++){var r=this._zeroBits(this.words[i]);if(t+=r,26!==r)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]|t.words[i];return this.strip()},n.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var i;i=this.length>t.length?t:this;for(var r=0;r<i.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=i.length,this.strip()},n.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var i,r;this.length>t.length?(i=this,r=t):(i=t,r=this);for(var h=0;h<r.length;h++)this.words[h]=i.words[h]^r.words[h];if(this!==i)for(;h<i.length;h++)this.words[h]=i.words[h];return this.length=i.length,this.strip()},n.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var i=0|Math.ceil(t/26),h=t%26;this._expand(i),h>0&&i--;for(var n=0;n<i;n++)this.words[n]=67108863&~this.words[n];return h>0&&(this.words[n]=~this.words[n]&67108863>>26-h),this.strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,i){r("number"==typeof t&&t>=0);var h=t/26|0,n=t%26;return this._expand(h+1),this.words[h]=i?this.words[h]|1<<n:this.words[h]&~(1<<n),this.strip()},n.prototype.iadd=function(t){var i;if(0!==this.negative&&0===t.negative)return this.negative=0,i=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,i=this.isub(t),t.negative=1,i._normSign();var r,h;this.length>t.length?(r=this,h=t):(r=t,h=this);for(var n=0,e=0;e<h.length;e++)i=(0|r.words[e])+(0|h.words[e])+n,this.words[e]=67108863&i,n=i>>>26;for(;0!==n&&e<r.length;e++)i=(0|r.words[e])+n,this.words[e]=67108863&i,n=i>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;e<r.length;e++)this.words[e]=r.words[e];return this},n.prototype.add=function(t){var i;return 0!==t.negative&&0===this.negative?(t.negative=0,i=this.sub(t),t.negative^=1,i):0===t.negative&&0!==this.negative?(this.negative=0,i=t.sub(this),this.negative=1,i):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var i=this.iadd(t);return t.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r=this.cmp(t);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;var h,n;r>0?(h=this,n=t):(h=t,n=this);for(var e=0,o=0;o<n.length;o++)i=(0|h.words[o])-(0|n.words[o])+e,e=i>>26,this.words[o]=67108863&i;for(;0!==e&&o<h.length;o++)i=(0|h.words[o])+e,e=i>>26,this.words[o]=67108863&i;if(0===e&&o<h.length&&h!==this)for(;o<h.length;o++)this.words[o]=h.words[o];return this.length=Math.max(this.length,o),h!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var k=function(t,i,r){var h,n,e,o=t.words,s=i.words,u=r.words,a=0,l=0|o[0],m=8191&l,f=l>>>13,d=0|o[1],p=8191&d,M=d>>>13,v=0|o[2],g=8191&v,c=v>>>13,w=0|o[3],y=8191&w,b=w>>>13,_=0|o[4],k=8191&_,A=_>>>13,x=0|o[5],S=8191&x,Z=x>>>13,q=0|o[6],R=8191&q,B=q>>>13,N=0|o[7],L=8191&N,I=N>>>13,z=0|o[8],T=8191&z,E=z>>>13,O=0|o[9],j=8191&O,K=O>>>13,P=0|s[0],F=8191&P,C=P>>>13,D=0|s[1],H=8191&D,J=D>>>13,U=0|s[2],G=8191&U,Q=U>>>13,V=0|s[3],W=8191&V,X=V>>>13,Y=0|s[4],$=8191&Y,tt=Y>>>13,it=0|s[5],rt=8191&it,ht=it>>>13,nt=0|s[6],et=8191&nt,ot=nt>>>13,st=0|s[7],ut=8191&st,at=st>>>13,lt=0|s[8],mt=8191&lt,ft=lt>>>13,dt=0|s[9],pt=8191&dt,Mt=dt>>>13;r.negative=t.negative^i.negative,r.length=19,h=Math.imul(m,F),n=Math.imul(m,C),n=n+Math.imul(f,F)|0,e=Math.imul(f,C);var vt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,h=Math.imul(p,F),n=Math.imul(p,C),n=n+Math.imul(M,F)|0,e=Math.imul(M,C),h=h+Math.imul(m,H)|0,n=n+Math.imul(m,J)|0,n=n+Math.imul(f,H)|0,e=e+Math.imul(f,J)|0;var gt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,h=Math.imul(g,F),n=Math.imul(g,C),n=n+Math.imul(c,F)|0,e=Math.imul(c,C),h=h+Math.imul(p,H)|0,n=n+Math.imul(p,J)|0,n=n+Math.imul(M,H)|0,e=e+Math.imul(M,J)|0,h=h+Math.imul(m,G)|0,n=n+Math.imul(m,Q)|0,n=n+Math.imul(f,G)|0,e=e+Math.imul(f,Q)|0;var ct=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(ct>>>26)|0,ct&=67108863,h=Math.imul(y,F),n=Math.imul(y,C),n=n+Math.imul(b,F)|0,e=Math.imul(b,C),h=h+Math.imul(g,H)|0,n=n+Math.imul(g,J)|0,n=n+Math.imul(c,H)|0,e=e+Math.imul(c,J)|0,h=h+Math.imul(p,G)|0,n=n+Math.imul(p,Q)|0,n=n+Math.imul(M,G)|0,e=e+Math.imul(M,Q)|0,h=h+Math.imul(m,W)|0,n=n+Math.imul(m,X)|0,n=n+Math.imul(f,W)|0,e=e+Math.imul(f,X)|0;var wt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,h=Math.imul(k,F),n=Math.imul(k,C),n=n+Math.imul(A,F)|0,e=Math.imul(A,C),h=h+Math.imul(y,H)|0,n=n+Math.imul(y,J)|0,n=n+Math.imul(b,H)|0,e=e+Math.imul(b,J)|0,h=h+Math.imul(g,G)|0,n=n+Math.imul(g,Q)|0,n=n+Math.imul(c,G)|0,e=e+Math.imul(c,Q)|0,h=h+Math.imul(p,W)|0,n=n+Math.imul(p,X)|0,n=n+Math.imul(M,W)|0,e=e+Math.imul(M,X)|0,h=h+Math.imul(m,$)|0,n=n+Math.imul(m,tt)|0,n=n+Math.imul(f,$)|0,e=e+Math.imul(f,tt)|0;var yt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,h=Math.imul(S,F),n=Math.imul(S,C),n=n+Math.imul(Z,F)|0,e=Math.imul(Z,C),h=h+Math.imul(k,H)|0,n=n+Math.imul(k,J)|0,n=n+Math.imul(A,H)|0,e=e+Math.imul(A,J)|0,h=h+Math.imul(y,G)|0,n=n+Math.imul(y,Q)|0,n=n+Math.imul(b,G)|0,e=e+Math.imul(b,Q)|0,h=h+Math.imul(g,W)|0,n=n+Math.imul(g,X)|0,n=n+Math.imul(c,W)|0,e=e+Math.imul(c,X)|0,h=h+Math.imul(p,$)|0,n=n+Math.imul(p,tt)|0,n=n+Math.imul(M,$)|0,e=e+Math.imul(M,tt)|0,h=h+Math.imul(m,rt)|0,n=n+Math.imul(m,ht)|0,n=n+Math.imul(f,rt)|0,e=e+Math.imul(f,ht)|0;var bt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,h=Math.imul(R,F),n=Math.imul(R,C),n=n+Math.imul(B,F)|0,e=Math.imul(B,C),h=h+Math.imul(S,H)|0,n=n+Math.imul(S,J)|0,n=n+Math.imul(Z,H)|0,e=e+Math.imul(Z,J)|0,h=h+Math.imul(k,G)|0,n=n+Math.imul(k,Q)|0,n=n+Math.imul(A,G)|0,e=e+Math.imul(A,Q)|0,h=h+Math.imul(y,W)|0,n=n+Math.imul(y,X)|0,n=n+Math.imul(b,W)|0,e=e+Math.imul(b,X)|0,h=h+Math.imul(g,$)|0,n=n+Math.imul(g,tt)|0,n=n+Math.imul(c,$)|0,e=e+Math.imul(c,tt)|0,h=h+Math.imul(p,rt)|0,n=n+Math.imul(p,ht)|0,n=n+Math.imul(M,rt)|0,e=e+Math.imul(M,ht)|0,h=h+Math.imul(m,et)|0,n=n+Math.imul(m,ot)|0,n=n+Math.imul(f,et)|0,e=e+Math.imul(f,ot)|0;var _t=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,h=Math.imul(L,F),n=Math.imul(L,C),n=n+Math.imul(I,F)|0,e=Math.imul(I,C),h=h+Math.imul(R,H)|0,n=n+Math.imul(R,J)|0,n=n+Math.imul(B,H)|0,e=e+Math.imul(B,J)|0,h=h+Math.imul(S,G)|0,n=n+Math.imul(S,Q)|0,n=n+Math.imul(Z,G)|0,e=e+Math.imul(Z,Q)|0,h=h+Math.imul(k,W)|0,n=n+Math.imul(k,X)|0,n=n+Math.imul(A,W)|0,e=e+Math.imul(A,X)|0,h=h+Math.imul(y,$)|0,n=n+Math.imul(y,tt)|0,n=n+Math.imul(b,$)|0,e=e+Math.imul(b,tt)|0,h=h+Math.imul(g,rt)|0,n=n+Math.imul(g,ht)|0,n=n+Math.imul(c,rt)|0,e=e+Math.imul(c,ht)|0,h=h+Math.imul(p,et)|0,n=n+Math.imul(p,ot)|0,n=n+Math.imul(M,et)|0,e=e+Math.imul(M,ot)|0,h=h+Math.imul(m,ut)|0,n=n+Math.imul(m,at)|0,n=n+Math.imul(f,ut)|0,e=e+Math.imul(f,at)|0;var kt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,h=Math.imul(T,F),n=Math.imul(T,C),n=n+Math.imul(E,F)|0,e=Math.imul(E,C),h=h+Math.imul(L,H)|0,n=n+Math.imul(L,J)|0,n=n+Math.imul(I,H)|0,e=e+Math.imul(I,J)|0,h=h+Math.imul(R,G)|0,n=n+Math.imul(R,Q)|0,n=n+Math.imul(B,G)|0,e=e+Math.imul(B,Q)|0,h=h+Math.imul(S,W)|0,n=n+Math.imul(S,X)|0,n=n+Math.imul(Z,W)|0,e=e+Math.imul(Z,X)|0,h=h+Math.imul(k,$)|0,n=n+Math.imul(k,tt)|0,n=n+Math.imul(A,$)|0,e=e+Math.imul(A,tt)|0,h=h+Math.imul(y,rt)|0,n=n+Math.imul(y,ht)|0,n=n+Math.imul(b,rt)|0,e=e+Math.imul(b,ht)|0,h=h+Math.imul(g,et)|0,n=n+Math.imul(g,ot)|0,n=n+Math.imul(c,et)|0,e=e+Math.imul(c,ot)|0,h=h+Math.imul(p,ut)|0,n=n+Math.imul(p,at)|0,n=n+Math.imul(M,ut)|0,e=e+Math.imul(M,at)|0,h=h+Math.imul(m,mt)|0,n=n+Math.imul(m,ft)|0,n=n+Math.imul(f,mt)|0,e=e+Math.imul(f,ft)|0;var At=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(At>>>26)|0,At&=67108863,h=Math.imul(j,F),n=Math.imul(j,C),n=n+Math.imul(K,F)|0,e=Math.imul(K,C),h=h+Math.imul(T,H)|0,n=n+Math.imul(T,J)|0,n=n+Math.imul(E,H)|0,e=e+Math.imul(E,J)|0,h=h+Math.imul(L,G)|0,n=n+Math.imul(L,Q)|0,n=n+Math.imul(I,G)|0,e=e+Math.imul(I,Q)|0,h=h+Math.imul(R,W)|0,n=n+Math.imul(R,X)|0,n=n+Math.imul(B,W)|0,e=e+Math.imul(B,X)|0,h=h+Math.imul(S,$)|0,n=n+Math.imul(S,tt)|0,n=n+Math.imul(Z,$)|0,e=e+Math.imul(Z,tt)|0,h=h+Math.imul(k,rt)|0,n=n+Math.imul(k,ht)|0,n=n+Math.imul(A,rt)|0,e=e+Math.imul(A,ht)|0,h=h+Math.imul(y,et)|0,n=n+Math.imul(y,ot)|0,n=n+Math.imul(b,et)|0,e=e+Math.imul(b,ot)|0,h=h+Math.imul(g,ut)|0,n=n+Math.imul(g,at)|0,n=n+Math.imul(c,ut)|0,e=e+Math.imul(c,at)|0,h=h+Math.imul(p,mt)|0,n=n+Math.imul(p,ft)|0,n=n+Math.imul(M,mt)|0,e=e+Math.imul(M,ft)|0,h=h+Math.imul(m,pt)|0,n=n+Math.imul(m,Mt)|0,n=n+Math.imul(f,pt)|0,e=e+Math.imul(f,Mt)|0;var xt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,h=Math.imul(j,H),n=Math.imul(j,J),n=n+Math.imul(K,H)|0,e=Math.imul(K,J),h=h+Math.imul(T,G)|0,n=n+Math.imul(T,Q)|0,n=n+Math.imul(E,G)|0,e=e+Math.imul(E,Q)|0,h=h+Math.imul(L,W)|0,n=n+Math.imul(L,X)|0,n=n+Math.imul(I,W)|0,e=e+Math.imul(I,X)|0,h=h+Math.imul(R,$)|0,n=n+Math.imul(R,tt)|0,n=n+Math.imul(B,$)|0,e=e+Math.imul(B,tt)|0,h=h+Math.imul(S,rt)|0,n=n+Math.imul(S,ht)|0,n=n+Math.imul(Z,rt)|0,e=e+Math.imul(Z,ht)|0,h=h+Math.imul(k,et)|0,n=n+Math.imul(k,ot)|0,n=n+Math.imul(A,et)|0,e=e+Math.imul(A,ot)|0,h=h+Math.imul(y,ut)|0,n=n+Math.imul(y,at)|0,n=n+Math.imul(b,ut)|0,e=e+Math.imul(b,at)|0,h=h+Math.imul(g,mt)|0,n=n+Math.imul(g,ft)|0,n=n+Math.imul(c,mt)|0,e=e+Math.imul(c,ft)|0,h=h+Math.imul(p,pt)|0,n=n+Math.imul(p,Mt)|0,n=n+Math.imul(M,pt)|0,e=e+Math.imul(M,Mt)|0;var St=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(St>>>26)|0,St&=67108863,h=Math.imul(j,G),n=Math.imul(j,Q),n=n+Math.imul(K,G)|0,e=Math.imul(K,Q),h=h+Math.imul(T,W)|0,n=n+Math.imul(T,X)|0,n=n+Math.imul(E,W)|0,e=e+Math.imul(E,X)|0,h=h+Math.imul(L,$)|0,n=n+Math.imul(L,tt)|0,n=n+Math.imul(I,$)|0,e=e+Math.imul(I,tt)|0,h=h+Math.imul(R,rt)|0,n=n+Math.imul(R,ht)|0,n=n+Math.imul(B,rt)|0,e=e+Math.imul(B,ht)|0,h=h+Math.imul(S,et)|0,n=n+Math.imul(S,ot)|0,n=n+Math.imul(Z,et)|0,e=e+Math.imul(Z,ot)|0,h=h+Math.imul(k,ut)|0,n=n+Math.imul(k,at)|0,n=n+Math.imul(A,ut)|0,e=e+Math.imul(A,at)|0,h=h+Math.imul(y,mt)|0,n=n+Math.imul(y,ft)|0,n=n+Math.imul(b,mt)|0,e=e+Math.imul(b,ft)|0,h=h+Math.imul(g,pt)|0,n=n+Math.imul(g,Mt)|0,n=n+Math.imul(c,pt)|0,e=e+Math.imul(c,Mt)|0;var Zt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,h=Math.imul(j,W),n=Math.imul(j,X),n=n+Math.imul(K,W)|0,e=Math.imul(K,X),h=h+Math.imul(T,$)|0,n=n+Math.imul(T,tt)|0,n=n+Math.imul(E,$)|0,e=e+Math.imul(E,tt)|0,h=h+Math.imul(L,rt)|0,n=n+Math.imul(L,ht)|0,n=n+Math.imul(I,rt)|0,e=e+Math.imul(I,ht)|0,h=h+Math.imul(R,et)|0,n=n+Math.imul(R,ot)|0,n=n+Math.imul(B,et)|0,e=e+Math.imul(B,ot)|0,h=h+Math.imul(S,ut)|0,n=n+Math.imul(S,at)|0,n=n+Math.imul(Z,ut)|0,e=e+Math.imul(Z,at)|0,h=h+Math.imul(k,mt)|0,n=n+Math.imul(k,ft)|0,n=n+Math.imul(A,mt)|0,e=e+Math.imul(A,ft)|0,h=h+Math.imul(y,pt)|0,n=n+Math.imul(y,Mt)|0,n=n+Math.imul(b,pt)|0,e=e+Math.imul(b,Mt)|0;var qt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,h=Math.imul(j,$),n=Math.imul(j,tt),n=n+Math.imul(K,$)|0,e=Math.imul(K,tt),h=h+Math.imul(T,rt)|0,n=n+Math.imul(T,ht)|0,n=n+Math.imul(E,rt)|0,e=e+Math.imul(E,ht)|0,h=h+Math.imul(L,et)|0,n=n+Math.imul(L,ot)|0,n=n+Math.imul(I,et)|0,e=e+Math.imul(I,ot)|0,h=h+Math.imul(R,ut)|0,n=n+Math.imul(R,at)|0,n=n+Math.imul(B,ut)|0,e=e+Math.imul(B,at)|0,h=h+Math.imul(S,mt)|0,n=n+Math.imul(S,ft)|0,n=n+Math.imul(Z,mt)|0,e=e+Math.imul(Z,ft)|0,h=h+Math.imul(k,pt)|0,n=n+Math.imul(k,Mt)|0,n=n+Math.imul(A,pt)|0,e=e+Math.imul(A,Mt)|0;var Rt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,h=Math.imul(j,rt),n=Math.imul(j,ht),n=n+Math.imul(K,rt)|0,e=Math.imul(K,ht),h=h+Math.imul(T,et)|0,n=n+Math.imul(T,ot)|0,n=n+Math.imul(E,et)|0,e=e+Math.imul(E,ot)|0,h=h+Math.imul(L,ut)|0,n=n+Math.imul(L,at)|0,n=n+Math.imul(I,ut)|0,e=e+Math.imul(I,at)|0,h=h+Math.imul(R,mt)|0,n=n+Math.imul(R,ft)|0,n=n+Math.imul(B,mt)|0,e=e+Math.imul(B,ft)|0,h=h+Math.imul(S,pt)|0,n=n+Math.imul(S,Mt)|0,n=n+Math.imul(Z,pt)|0,e=e+Math.imul(Z,Mt)|0;var Bt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,h=Math.imul(j,et),n=Math.imul(j,ot),n=n+Math.imul(K,et)|0,e=Math.imul(K,ot),h=h+Math.imul(T,ut)|0,n=n+Math.imul(T,at)|0,n=n+Math.imul(E,ut)|0,e=e+Math.imul(E,at)|0,h=h+Math.imul(L,mt)|0,n=n+Math.imul(L,ft)|0,n=n+Math.imul(I,mt)|0,e=e+Math.imul(I,ft)|0,h=h+Math.imul(R,pt)|0,n=n+Math.imul(R,Mt)|0,n=n+Math.imul(B,pt)|0,e=e+Math.imul(B,Mt)|0;var Nt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,h=Math.imul(j,ut),n=Math.imul(j,at),n=n+Math.imul(K,ut)|0,e=Math.imul(K,at),h=h+Math.imul(T,mt)|0,n=n+Math.imul(T,ft)|0,n=n+Math.imul(E,mt)|0,e=e+Math.imul(E,ft)|0,h=h+Math.imul(L,pt)|0,n=n+Math.imul(L,Mt)|0,n=n+Math.imul(I,pt)|0,e=e+Math.imul(I,Mt)|0;var Lt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,h=Math.imul(j,mt),n=Math.imul(j,ft),n=n+Math.imul(K,mt)|0,e=Math.imul(K,ft),h=h+Math.imul(T,pt)|0,n=n+Math.imul(T,Mt)|0,n=n+Math.imul(E,pt)|0,e=e+Math.imul(E,Mt)|0;var It=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(It>>>26)|0,It&=67108863,h=Math.imul(j,pt),n=Math.imul(j,Mt),n=n+Math.imul(K,pt)|0,e=Math.imul(K,Mt);var zt=(a+h|0)+((8191&n)<<13)|0;return a=(e+(n>>>13)|0)+(zt>>>26)|0,zt&=67108863,u[0]=vt,u[1]=gt,u[2]=ct,u[3]=wt,u[4]=yt,u[5]=bt,u[6]=_t,u[7]=kt,u[8]=At,u[9]=xt,u[10]=St,u[11]=Zt,u[12]=qt,u[13]=Rt,u[14]=Bt,u[15]=Nt,u[16]=Lt,u[17]=It,u[18]=zt,0!==a&&(u[19]=a,r.length++),r};Math.imul||(k=u),n.prototype.mulTo=function(t,i){var r=this.length+t.length;return 10===this.length&&10===t.length?k(this,t,i):r<63?u(this,t,i):r<1024?a(this,t,i):l(this,t,i)},m.prototype.makeRBT=function(t){for(var i=new Array(t),r=n.prototype._countBits(t)-1,h=0;h<t;h++)i[h]=this.revBin(h,r,t);return i},m.prototype.revBin=function(t,i,r){if(0===t||t===r-1)return t;for(var h=0,n=0;n<i;n++)h|=(1&t)<<i-n-1,t>>=1;return h},m.prototype.permute=function(t,i,r,h,n,e){for(var o=0;o<e;o++)h[o]=i[t[o]],n[o]=r[t[o]]},m.prototype.transform=function(t,i,r,h,n,e){this.permute(e,t,i,r,h,n);for(var o=1;o<n;o<<=1)for(var s=o<<1,u=Math.cos(2*Math.PI/s),a=Math.sin(2*Math.PI/s),l=0;l<n;l+=s)for(var m=u,f=a,d=0;d<o;d++){var p=r[l+d],M=h[l+d],v=r[l+d+o],g=h[l+d+o],c=m*v-f*g;g=m*g+f*v,v=c,r[l+d]=p+v,h[l+d]=M+g,r[l+d+o]=p-v,h[l+d+o]=M-g,d!==s&&(c=u*m-a*f,f=u*f+a*m,m=c)}},m.prototype.guessLen13b=function(t,i){var r=1|Math.max(i,t),h=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+h},m.prototype.conjugate=function(t,i,r){if(!(r<=1))for(var h=0;h<r/2;h++){var n=t[h];t[h]=t[r-h-1],t[r-h-1]=n,n=i[h],i[h]=-i[r-h-1],i[r-h-1]=-n}},m.prototype.normalize13b=function(t,i){for(var r=0,h=0;h<i/2;h++){var n=8192*Math.round(t[2*h+1]/i)+Math.round(t[2*h]/i)+r;t[h]=67108863&n,r=n<67108864?0:n/67108864|0}return t},m.prototype.convert13b=function(t,i,h,n){for(var e=0,o=0;o<i;o++)e+=0|t[o],h[2*o]=8191&e,e>>>=13,h[2*o+1]=8191&e,e>>>=13;for(o=2*i;o<n;++o)h[o]=0;r(0===e),r(0==(-8192&e))},m.prototype.stub=function(t){for(var i=new Array(t),r=0;r<t;r++)i[r]=0;return i},m.prototype.mulp=function(t,i,r){var h=2*this.guessLen13b(t.length,i.length),n=this.makeRBT(h),e=this.stub(h),o=new Array(h),s=new Array(h),u=new Array(h),a=new Array(h),l=new Array(h),m=new Array(h),f=r.words;f.length=h,this.convert13b(t.words,t.length,o,h),this.convert13b(i.words,i.length,a,h),this.transform(o,e,s,u,h,n),this.transform(a,e,l,m,h,n);for(var d=0;d<h;d++){var p=s[d]*l[d]-u[d]*m[d];u[d]=s[d]*m[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,h),this.transform(s,u,f,e,h,n),this.conjugate(f,e,h),this.normalize13b(f,h),r.negative=t.negative^i.negative,r.length=t.length+i.length,r.strip()},n.prototype.mul=function(t){var i=new n(null);return i.words=new Array(this.length+t.length),this.mulTo(t,i)},n.prototype.mulf=function(t){var i=new n(null);return i.words=new Array(this.length+t.length),l(this,t,i)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){r("number"==typeof t),r(t<67108864);for(var i=0,h=0;h<this.length;h++){var n=(0|this.words[h])*t,e=(67108863&n)+(67108863&i);i>>=26,i+=n/67108864|0,i+=e>>>26,this.words[h]=67108863&e}return 0!==i&&(this.words[h]=i,this.length++),this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var i=s(t);if(0===i.length)return new n(1);for(var r=this,h=0;h<i.length&&0===i[h];h++,r=r.sqr());if(++h<i.length)for(var e=r.sqr();h<i.length;h++,e=e.sqr())0!==i[h]&&(r=r.mul(e));return r},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var i,h=t%26,n=(t-h)/26,e=67108863>>>26-h<<26-h;if(0!==h){var o=0;for(i=0;i<this.length;i++){var s=this.words[i]&e,u=(0|this.words[i])-s<<h;this.words[i]=u|o,o=s>>>26-h}o&&(this.words[i]=o,this.length++)}if(0!==n){for(i=this.length-1;i>=0;i--)this.words[i+n]=this.words[i];for(i=0;i<n;i++)this.words[i]=0;this.length+=n}return this.strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,i,h){r("number"==typeof t&&t>=0);var n;n=i?(i-i%26)/26:0;var e=t%26,o=Math.min((t-e)/26,this.length),s=67108863^67108863>>>e<<e,u=h;if(n-=o,n=Math.max(0,n),u){for(var a=0;a<o;a++)u.words[a]=this.words[a];u.length=o}if(0===o);else if(this.length>o)for(this.length-=o,a=0;a<this.length;a++)this.words[a]=this.words[a+o];else this.words[0]=0,this.length=1;var l=0;for(a=this.length-1;a>=0&&(0!==l||a>=n);a--){var m=0|this.words[a];this.words[a]=l<<26-e|m>>>e,l=m&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(t,i,h){return r(0===this.negative),this.iushrn(t,i,h)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var i=t%26,h=(t-i)/26,n=1<<i;return!(this.length<=h)&&!!(this.words[h]&n)},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var i=t%26,h=(t-i)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=h)return this;if(0!==i&&h++,this.length=Math.min(h,this.length),0!==i){var n=67108863^67108863>>>i<<i;this.words[this.length-1]&=n}return this.strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this.strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,i,h){var n,e=t.length+h;this._expand(e);var o,s=0;for(n=0;n<t.length;n++){o=(0|this.words[n+h])+s;var u=(0|t.words[n])*i;o-=67108863&u,s=(o>>26)-(u/67108864|0),this.words[n+h]=67108863&o}for(;n<this.length-h;n++)o=(0|this.words[n+h])+s,s=o>>26,this.words[n+h]=67108863&o;if(0===s)return this.strip();for(r(-1===s),s=0,n=0;n<this.length;n++)o=-(0|this.words[n])+s,s=o>>26,this.words[n]=67108863&o;return this.negative=1,this.strip()},n.prototype._wordDiv=function(t,i){var r=this.length-t.length,h=this.clone(),e=t,o=0|e.words[e.length-1];0!==(r=26-this._countBits(o))&&(e=e.ushln(r),h.iushln(r),o=0|e.words[e.length-1]);var s,u=h.length-e.length;if("mod"!==i){s=new n(null),s.length=u+1,s.words=new Array(s.length);for(var a=0;a<s.length;a++)s.words[a]=0}var l=h.clone()._ishlnsubmul(e,1,u);0===l.negative&&(h=l,s&&(s.words[u]=1));for(var m=u-1;m>=0;m--){var f=67108864*(0|h.words[e.length+m])+(0|h.words[e.length+m-1]);for(f=Math.min(f/o|0,67108863),h._ishlnsubmul(e,f,m);0!==h.negative;)f--,h.negative=0,h._ishlnsubmul(e,1,m),h.isZero()||(h.negative^=1);s&&(s.words[m]=f)}return s&&s.strip(),h.strip(),"div"!==i&&0!==r&&h.iushrn(r),{div:s||null,mod:h}},n.prototype.divmod=function(t,i,h){if(r(!t.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var e,o,s;return 0!==this.negative&&0===t.negative?(s=this.neg().divmod(t,i),"mod"!==i&&(e=s.div.neg()),"div"!==i&&(o=s.mod.neg(),h&&0!==o.negative&&o.iadd(t)),{div:e,mod:o}):0===this.negative&&0!==t.negative?(s=this.divmod(t.neg(),i),"mod"!==i&&(e=s.div.neg()),{div:e,mod:s.mod}):0!=(this.negative&t.negative)?(s=this.neg().divmod(t.neg(),i),"div"!==i&&(o=s.mod.neg(),h&&0!==o.negative&&o.isub(t)),{div:s.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===i?{div:this.divn(t.words[0]),mod:null}:"mod"===i?{div:null,mod:new n(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modn(t.words[0]))}:this._wordDiv(t,i)},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var i=this.divmod(t);if(i.mod.isZero())return i.div;var r=0!==i.div.negative?i.mod.isub(t):i.mod,h=t.ushrn(1),n=t.andln(1),e=r.cmp(h)
;return e<0||1===n&&0===e?i.div:0!==i.div.negative?i.div.isubn(1):i.div.iaddn(1)},n.prototype.modn=function(t){r(t<=67108863);for(var i=(1<<26)%t,h=0,n=this.length-1;n>=0;n--)h=(i*h+(0|this.words[n]))%t;return h},n.prototype.idivn=function(t){r(t<=67108863);for(var i=0,h=this.length-1;h>=0;h--){var n=(0|this.words[h])+67108864*i;this.words[h]=n/t|0,i=n%t}return this.strip()},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var i=this,h=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e=new n(1),o=new n(0),s=new n(0),u=new n(1),a=0;i.isEven()&&h.isEven();)i.iushrn(1),h.iushrn(1),++a;for(var l=h.clone(),m=i.clone();!i.isZero();){for(var f=0,d=1;0==(i.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(i.iushrn(f);f-- >0;)(e.isOdd()||o.isOdd())&&(e.iadd(l),o.isub(m)),e.iushrn(1),o.iushrn(1);for(var p=0,M=1;0==(h.words[0]&M)&&p<26;++p,M<<=1);if(p>0)for(h.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(m)),s.iushrn(1),u.iushrn(1);i.cmp(h)>=0?(i.isub(h),e.isub(s),o.isub(u)):(h.isub(i),s.isub(e),u.isub(o))}return{a:s,b:u,gcd:h.iushln(a)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var i=this,h=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e=new n(1),o=new n(0),s=h.clone();i.cmpn(1)>0&&h.cmpn(1)>0;){for(var u=0,a=1;0==(i.words[0]&a)&&u<26;++u,a<<=1);if(u>0)for(i.iushrn(u);u-- >0;)e.isOdd()&&e.iadd(s),e.iushrn(1);for(var l=0,m=1;0==(h.words[0]&m)&&l<26;++l,m<<=1);if(l>0)for(h.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(s),o.iushrn(1);i.cmp(h)>=0?(i.isub(h),e.isub(o)):(h.isub(i),o.isub(e))}var f;return f=0===i.cmpn(1)?e:o,f.cmpn(0)<0&&f.iadd(t),f},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var i=this.clone(),r=t.clone();i.negative=0,r.negative=0;for(var h=0;i.isEven()&&r.isEven();h++)i.iushrn(1),r.iushrn(1);for(;;){for(;i.isEven();)i.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=i.cmp(r);if(n<0){var e=i;i=r,r=e}else if(0===n||0===r.cmpn(1))break;i.isub(r)}return r.iushln(h)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var i=t%26,h=(t-i)/26,n=1<<i;if(this.length<=h)return this._expand(h+1),this.words[h]|=n,this;for(var e=n,o=h;0!==e&&o<this.length;o++){var s=0|this.words[o];s+=e,e=s>>>26,s&=67108863,this.words[o]=s}return 0!==e&&(this.words[o]=e,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;this.strip();var h;if(this.length>1)h=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var n=0|this.words[0];h=n===t?0:n<t?-1:1}return 0!==this.negative?0|-h:h},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var i=this.ucmp(t);return 0!==this.negative?0|-i:i},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var i=0,r=this.length-1;r>=0;r--){var h=0|this.words[r],n=0|t.words[r];if(h!==n){h<n?i=-1:h>n&&(i=1);break}}return i},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new g(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var A={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},f.prototype.ireduce=function(t){var i,r=t;do{this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),i=r.bitLength()}while(i>this.n);var h=i<this.n?-1:r.ucmp(this.p);return 0===h?(r.words[0]=0,r.length=1):h>0?r.isub(this.p):r.strip(),r},f.prototype.split=function(t,i){t.iushrn(this.n,0,i)},f.prototype.imulK=function(t){return t.imul(this.k)},h(d,f),d.prototype.split=function(t,i){for(var r=Math.min(t.length,9),h=0;h<r;h++)i.words[h]=t.words[h];if(i.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var n=t.words[9];for(i.words[i.length++]=4194303&n,h=10;h<t.length;h++){var e=0|t.words[h];t.words[h-10]=(4194303&e)<<4|n>>>22,n=e}n>>>=22,t.words[h-10]=n,0===n&&t.length>10?t.length-=10:t.length-=9},d.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var i=0,r=0;r<t.length;r++){var h=0|t.words[r];i+=977*h,t.words[r]=67108863&i,i=64*h+(i/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},h(p,f),h(M,f),h(v,f),v.prototype.imulK=function(t){for(var i=0,r=0;r<t.length;r++){var h=19*(0|t.words[r])+i,n=67108863&h;h>>>=26,t.words[r]=n,i=h}return 0!==i&&(t.words[t.length++]=i),t},n._prime=function(t){if(A[t])return A[t];var i;if("k256"===t)i=new d;else if("p224"===t)i=new p;else if("p192"===t)i=new M;else{if("p25519"!==t)throw new Error("Unknown prime "+t);i=new v}return A[t]=i,i},g.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},g.prototype._verify2=function(t,i){r(0==(t.negative|i.negative),"red works only with positives"),r(t.red&&t.red===i.red,"red works only with red numbers")},g.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},g.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},g.prototype.add=function(t,i){this._verify2(t,i);var r=t.add(i);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},g.prototype.iadd=function(t,i){this._verify2(t,i);var r=t.iadd(i);return r.cmp(this.m)>=0&&r.isub(this.m),r},g.prototype.sub=function(t,i){this._verify2(t,i);var r=t.sub(i);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},g.prototype.isub=function(t,i){this._verify2(t,i);var r=t.isub(i);return r.cmpn(0)<0&&r.iadd(this.m),r},g.prototype.shl=function(t,i){return this._verify1(t),this.imod(t.ushln(i))},g.prototype.imul=function(t,i){return this._verify2(t,i),this.imod(t.imul(i))},g.prototype.mul=function(t,i){return this._verify2(t,i),this.imod(t.mul(i))},g.prototype.isqr=function(t){return this.imul(t,t.clone())},g.prototype.sqr=function(t){return this.mul(t,t)},g.prototype.sqrt=function(t){if(t.isZero())return t.clone();var i=this.m.andln(3);if(r(i%2==1),3===i){var h=this.m.add(new n(1)).iushrn(2);return this.pow(t,h)}for(var e=this.m.subn(1),o=0;!e.isZero()&&0===e.andln(1);)o++,e.iushrn(1);r(!e.isZero());var s=new n(1).toRed(this),u=s.redNeg(),a=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);0!==this.pow(l,a).cmp(u);)l.redIAdd(u);for(var m=this.pow(l,e),f=this.pow(t,e.addn(1).iushrn(1)),d=this.pow(t,e),p=o;0!==d.cmp(s);){for(var M=d,v=0;0!==M.cmp(s);v++)M=M.redSqr();r(v<p);var g=this.pow(m,new n(1).iushln(p-v-1));f=f.redMul(g),m=g.redSqr(),d=d.redMul(m),p=v}return f},g.prototype.invm=function(t){var i=t._invmp(this.m);return 0!==i.negative?(i.negative=0,this.imod(i).redNeg()):this.imod(i)},g.prototype.pow=function(t,i){if(i.isZero())return new n(1).toRed(this);if(0===i.cmpn(1))return t.clone();var r=new Array(16);r[0]=new n(1).toRed(this),r[1]=t;for(var h=2;h<r.length;h++)r[h]=this.mul(r[h-1],t);var e=r[0],o=0,s=0,u=i.bitLength()%26;for(0===u&&(u=26),h=i.length-1;h>=0;h--){for(var a=i.words[h],l=u-1;l>=0;l--){var m=a>>l&1;e!==r[0]&&(e=this.sqr(e)),0!==m||0!==o?(o<<=1,o|=m,(4===++s||0===h&&0===l)&&(e=this.mul(e,r[o]),s=0,o=0)):s=0}u=26}return e},g.prototype.convertTo=function(t){var i=t.umod(this.m);return i===t?i.clone():i},g.prototype.convertFrom=function(t){var i=t.clone();return i.red=null,i},n.mont=function(t){return new c(t)},h(c,g),c.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},c.prototype.convertFrom=function(t){var i=this.imod(t.mul(this.rinv));return i.red=null,i},c.prototype.imul=function(t,i){if(t.isZero()||i.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(i),h=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(h).iushrn(this.shift),e=n;return n.cmp(this.m)>=0?e=n.isub(this.m):n.cmpn(0)<0&&(e=n.iadd(this.m)),e._forceRed(this)},c.prototype.mul=function(t,i){if(t.isZero()||i.isZero())return new n(0)._forceRed(this);var r=t.mul(i),h=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=r.isub(h).iushrn(this.shift),o=e;return e.cmp(this.m)>=0?o=e.isub(this.m):e.cmpn(0)<0&&(o=e.iadd(this.m)),o._forceRed(this)},c.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}("undefined"==typeof module||module,this);

},{"buffer":37}],36:[function(require,module,exports){
function Rand(t){this.rand=t}var r;if(module.exports=function(t){return r||(r=new Rand(null)),r.generate(t)},module.exports.Rand=Rand,Rand.prototype.generate=function(t){return this._rand(t)},Rand.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var r=new Uint8Array(t),e=0;e<r.length;e++)r[e]=this.rand.getByte();return r},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?Rand.prototype._rand=function(t){var r=new Uint8Array(t);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Rand.prototype._rand=function(t){var r=new Uint8Array(t);return self.msCrypto.getRandomValues(r),r}:"object"==typeof window&&(Rand.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var crypto=require("crypto");if("function"!=typeof crypto.randomBytes)throw new Error("Not supported");Rand.prototype._rand=function(t){return crypto.randomBytes(t)}}catch(t){}

},{"crypto":37}],37:[function(require,module,exports){

},{}],38:[function(require,module,exports){
(function (Buffer){
function fixup_uint32(t){var e;return t>uint_max||t<0?(e=Math.abs(t)%uint_max,t<0?uint_max-e:e):t}function scrub_vec(t){for(;0<t.length;t++)t[0]=0;return!1}function Global(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function bufferToArray(t){for(var e=t.length/4,i=new Array(e),r=-1;++r<e;)i[r]=t.readUInt32BE(4*r);return i}function AES(t){this._key=bufferToArray(t),this._doReset()}var uint_max=Math.pow(2,32);Global.prototype.init=function(){var t,e,i,r,n,S,u,_,o,h;for(t=function(){var t,i;for(i=[],e=t=0;t<256;e=++t)e<128?i.push(e<<1):i.push(e<<1^283);return i}(),n=0,o=0,e=h=0;h<256;e=++h)i=o^o<<1^o<<2^o<<3^o<<4,i=i>>>8^255&i^99,this.SBOX[n]=i,this.INV_SBOX[i]=n,S=t[n],u=t[S],_=t[u],r=257*t[i]^16843008*i,this.SUB_MIX[0][n]=r<<24|r>>>8,this.SUB_MIX[1][n]=r<<16|r>>>16,this.SUB_MIX[2][n]=r<<8|r>>>24,this.SUB_MIX[3][n]=r,r=16843009*_^65537*u^257*S^16843008*n,this.INV_SUB_MIX[0][i]=r<<24|r>>>8,this.INV_SUB_MIX[1][i]=r<<16|r>>>16,this.INV_SUB_MIX[2][i]=r<<8|r>>>24,this.INV_SUB_MIX[3][i]=r,0===n?n=o=1:(n=S^t[t[t[_^S]]],o^=t[t[o]]);return!0};var G=new Global;AES.blockSize=16,AES.prototype.blockSize=AES.blockSize,AES.keySize=32,AES.prototype.keySize=AES.keySize,AES.prototype._doReset=function(){var t,e,i,r,n,S;for(i=this._key,e=i.length,this._nRounds=e+6,n=4*(this._nRounds+1),this._keySchedule=[],r=0;r<n;r++)this._keySchedule[r]=r<e?i[r]:(S=this._keySchedule[r-1],r%e==0?(S=S<<8|S>>>24,S=G.SBOX[S>>>24]<<24|G.SBOX[S>>>16&255]<<16|G.SBOX[S>>>8&255]<<8|G.SBOX[255&S],S^=G.RCON[r/e|0]<<24):e>6&&r%e==4&&(S=G.SBOX[S>>>24]<<24|G.SBOX[S>>>16&255]<<16|G.SBOX[S>>>8&255]<<8|G.SBOX[255&S]),this._keySchedule[r-e]^S);for(this._invKeySchedule=[],t=0;t<n;t++)r=n-t,S=this._keySchedule[r-(t%4?0:4)],this._invKeySchedule[t]=t<4||r<=4?S:G.INV_SUB_MIX[0][G.SBOX[S>>>24]]^G.INV_SUB_MIX[1][G.SBOX[S>>>16&255]]^G.INV_SUB_MIX[2][G.SBOX[S>>>8&255]]^G.INV_SUB_MIX[3][G.SBOX[255&S]];return!0},AES.prototype.encryptBlock=function(t){t=bufferToArray(new Buffer(t));var e=this._doCryptBlock(t,this._keySchedule,G.SUB_MIX,G.SBOX),i=new Buffer(16);return i.writeUInt32BE(e[0],0),i.writeUInt32BE(e[1],4),i.writeUInt32BE(e[2],8),i.writeUInt32BE(e[3],12),i},AES.prototype.decryptBlock=function(t){t=bufferToArray(new Buffer(t));var e=[t[3],t[1]];t[1]=e[0],t[3]=e[1];var i=this._doCryptBlock(t,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX),r=new Buffer(16);return r.writeUInt32BE(i[0],0),r.writeUInt32BE(i[3],4),r.writeUInt32BE(i[2],8),r.writeUInt32BE(i[1],12),r},AES.prototype.scrub=function(){scrub_vec(this._keySchedule),scrub_vec(this._invKeySchedule),scrub_vec(this._key)},AES.prototype._doCryptBlock=function(t,e,i,r){var n,S,u,_,o,h,B,s,c;S=t[0]^e[0],u=t[1]^e[1],_=t[2]^e[2],o=t[3]^e[3],n=4;for(var f=1;f<this._nRounds;f++)h=i[0][S>>>24]^i[1][u>>>16&255]^i[2][_>>>8&255]^i[3][255&o]^e[n++],B=i[0][u>>>24]^i[1][_>>>16&255]^i[2][o>>>8&255]^i[3][255&S]^e[n++],s=i[0][_>>>24]^i[1][o>>>16&255]^i[2][S>>>8&255]^i[3][255&u]^e[n++],c=i[0][o>>>24]^i[1][S>>>16&255]^i[2][u>>>8&255]^i[3][255&_]^e[n++],S=h,u=B,_=s,o=c;return h=(r[S>>>24]<<24|r[u>>>16&255]<<16|r[_>>>8&255]<<8|r[255&o])^e[n++],B=(r[u>>>24]<<24|r[_>>>16&255]<<16|r[o>>>8&255]<<8|r[255&S])^e[n++],s=(r[_>>>24]<<24|r[o>>>16&255]<<16|r[S>>>8&255]<<8|r[255&u])^e[n++],c=(r[o>>>24]<<24|r[S>>>16&255]<<16|r[u>>>8&255]<<8|r[255&_])^e[n++],[fixup_uint32(h),fixup_uint32(B),fixup_uint32(s),fixup_uint32(c)]},exports.AES=AES;

}).call(this,require("buffer").Buffer)
},{"buffer":66}],39:[function(require,module,exports){
(function (Buffer){
function StreamCipher(t,e,r,h){if(!(this instanceof StreamCipher))return new StreamCipher(t,e,r);Transform.call(this),this._finID=Buffer.concat([r,new Buffer([0,0,0,1])]),r=Buffer.concat([r,new Buffer([0,0,0,2])]),this._cipher=new aes.AES(e),this._prev=new Buffer(r.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=h,this._alen=0,this._len=0,r.copy(this._prev),this._mode=t;var i=new Buffer(4);i.fill(0),this._ghash=new GHASH(this._cipher.encryptBlock(i)),this._authTag=null,this._called=!1}function xorTest(t,e){var r=0;t.length!==e.length&&r++;for(var h=Math.min(t.length,e.length),i=-1;++i<h;)r+=t[i]^e[i];return r}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),GHASH=require("./ghash"),xor=require("buffer-xor");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=new Buffer(e),e.fill(0),this._ghash.update(e))}this._called=!0;var r=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(r),this._len+=t.length,r},StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=xor(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(xorTest(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=t;this._cipher.scrub()},StreamCipher.prototype.getAuthTag=function(){if(!this._decrypt&&Buffer.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},StreamCipher.prototype.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=t},StreamCipher.prototype.setAAD=function(t){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(t),this._alen+=t.length};

}).call(this,require("buffer").Buffer)
},{"./aes":38,"./ghash":43,"buffer":66,"buffer-xor":65,"cipher-base":69,"inherits":144}],40:[function(require,module,exports){
function getCiphers(){return Object.keys(modes)}var ciphers=require("./encrypter");exports.createCipher=exports.Cipher=ciphers.createCipher,exports.createCipheriv=exports.Cipheriv=ciphers.createCipheriv;var deciphers=require("./decrypter");exports.createDecipher=exports.Decipher=deciphers.createDecipher,exports.createDecipheriv=exports.Decipheriv=deciphers.createDecipheriv;var modes=require("./modes");exports.listCiphers=exports.getCiphers=getCiphers;

},{"./decrypter":41,"./encrypter":42,"./modes":44}],41:[function(require,module,exports){
(function (Buffer){
function Decipher(e,r,t){if(!(this instanceof Decipher))return new Decipher(e,r,t);Transform.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),t.copy(this._prev),this._mode=e,this._autopadding=!0}function Splitter(){if(!(this instanceof Splitter))return new Splitter;this.cache=new Buffer("")}function unpad(e){for(var r=e[15],t=-1;++t<r;)if(e[t+(16-r)]!==r)throw new Error("unable to decrypt data");if(16!==r)return e.slice(0,16-r)}function createDecipheriv(e,r,t){var i=modes[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=new Buffer(t)),"string"==typeof r&&(r=new Buffer(r)),r.length!==i.key/8)throw new TypeError("invalid key length "+r.length);if(t.length!==i.iv)throw new TypeError("invalid iv length "+t.length);return"stream"===i.type?new StreamCipher(modelist[i.mode],r,t,!0):"auth"===i.type?new AuthCipher(modelist[i.mode],r,t,!0):new Decipher(modelist[i.mode],r,t)}function createDecipher(e,r){var t=modes[e.toLowerCase()];if(!t)throw new TypeError("invalid suite type");var i=ebtk(r,!1,t.key,t.iv);return createDecipheriv(e,i.key,i.iv)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),modes=require("./modes"),StreamCipher=require("./streamCipher"),AuthCipher=require("./authCipher"),ebtk=require("evp_bytestokey");inherits(Decipher,Transform),Decipher.prototype._update=function(e){this._cache.add(e);for(var r,t,i=[];r=this._cache.get(this._autopadding);)t=this._mode.decrypt(this,r),i.push(t);return Buffer.concat(i)},Decipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return unpad(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},Decipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},Splitter.prototype.get=function(e){var r;if(e){if(this.cache.length>16)return r=this.cache.slice(0,16),this.cache=this.cache.slice(16),r}else if(this.cache.length>=16)return r=this.cache.slice(0,16),this.cache=this.cache.slice(16),r;return null},Splitter.prototype.flush=function(){if(this.cache.length)return this.cache};var modelist={ECB:require("./modes/ecb"),CBC:require("./modes/cbc"),CFB:require("./modes/cfb"),CFB8:require("./modes/cfb8"),CFB1:require("./modes/cfb1"),OFB:require("./modes/ofb"),CTR:require("./modes/ctr"),GCM:require("./modes/ctr")};exports.createDecipher=createDecipher,exports.createDecipheriv=createDecipheriv;

}).call(this,require("buffer").Buffer)
},{"./aes":38,"./authCipher":39,"./modes":44,"./modes/cbc":45,"./modes/cfb":46,"./modes/cfb1":47,"./modes/cfb8":48,"./modes/ctr":49,"./modes/ecb":50,"./modes/ofb":51,"./streamCipher":52,"buffer":66,"cipher-base":69,"evp_bytestokey":122,"inherits":144}],42:[function(require,module,exports){
(function (Buffer){
function Cipher(e,r,t){if(!(this instanceof Cipher))return new Cipher(e,r,t);Transform.call(this),this._cache=new Splitter,this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),t.copy(this._prev),this._mode=e,this._autopadding=!0}function Splitter(){if(!(this instanceof Splitter))return new Splitter;this.cache=new Buffer("")}function createCipheriv(e,r,t){var i=modes[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=new Buffer(t)),"string"==typeof r&&(r=new Buffer(r)),r.length!==i.key/8)throw new TypeError("invalid key length "+r.length);if(t.length!==i.iv)throw new TypeError("invalid iv length "+t.length);return"stream"===i.type?new StreamCipher(modelist[i.mode],r,t):"auth"===i.type?new AuthCipher(modelist[i.mode],r,t):new Cipher(modelist[i.mode],r,t)}function createCipher(e,r){var t=modes[e.toLowerCase()];if(!t)throw new TypeError("invalid suite type");var i=ebtk(r,!1,t.key,t.iv);return createCipheriv(e,i.key,i.iv)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),modes=require("./modes"),ebtk=require("evp_bytestokey"),StreamCipher=require("./streamCipher"),AuthCipher=require("./authCipher");inherits(Cipher,Transform),Cipher.prototype._update=function(e){this._cache.add(e);for(var r,t,i=[];r=this._cache.get();)t=this._mode.encrypt(this,r),i.push(t);return Buffer.concat(i)},Cipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if("10101010101010101010101010101010"!==e.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},Cipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},Splitter.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},Splitter.prototype.flush=function(){for(var e=16-this.cache.length,r=new Buffer(e),t=-1;++t<e;)r.writeUInt8(e,t);return Buffer.concat([this.cache,r])};var modelist={ECB:require("./modes/ecb"),CBC:require("./modes/cbc"),CFB:require("./modes/cfb"),CFB8:require("./modes/cfb8"),CFB1:require("./modes/cfb1"),OFB:require("./modes/ofb"),CTR:require("./modes/ctr"),GCM:require("./modes/ctr")};exports.createCipheriv=createCipheriv,exports.createCipher=createCipher;

}).call(this,require("buffer").Buffer)
},{"./aes":38,"./authCipher":39,"./modes":44,"./modes/cbc":45,"./modes/cfb":46,"./modes/cfb1":47,"./modes/cfb8":48,"./modes/ctr":49,"./modes/ecb":50,"./modes/ofb":51,"./streamCipher":52,"buffer":66,"cipher-base":69,"evp_bytestokey":122,"inherits":144}],43:[function(require,module,exports){
(function (Buffer){
function GHASH(t){this.h=t,this.state=new Buffer(16),this.state.fill(0),this.cache=new Buffer("")}function toArray(t){return[t.readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)]}function fromArray(t){t=t.map(fixup_uint32);var r=new Buffer(16);return r.writeUInt32BE(t[0],0),r.writeUInt32BE(t[1],4),r.writeUInt32BE(t[2],8),r.writeUInt32BE(t[3],12),r}function fixup_uint32(t){var r;return t>uint_max||t<0?(r=Math.abs(t)%uint_max,t<0?uint_max-r:r):t}function xor(t,r){return[t[0]^r[0],t[1]^r[1],t[2]^r[2],t[3]^r[3]]}var zeros=new Buffer(16);zeros.fill(0),module.exports=GHASH,GHASH.prototype.ghash=function(t){for(var r=-1;++r<t.length;)this.state[r]^=t[r];this._multiply()},GHASH.prototype._multiply=function(){for(var t,r,e,i=toArray(this.h),a=[0,0,0,0],n=-1;++n<128;){for(r=0!=(this.state[~~(n/8)]&1<<7-n%8),r&&(a=xor(a,i)),e=0!=(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,e&&(i[0]=i[0]^225<<24)}this.state=fromArray(a)},GHASH.prototype.update=function(t){this.cache=Buffer.concat([this.cache,t]);for(var r;this.cache.length>=16;)r=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(r)},GHASH.prototype.final=function(t,r){return this.cache.length&&this.ghash(Buffer.concat([this.cache,zeros],16)),this.ghash(fromArray([0,t,0,r])),this.state};var uint_max=Math.pow(2,32);

}).call(this,require("buffer").Buffer)
},{"buffer":66}],44:[function(require,module,exports){
exports["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},exports["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},exports["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},exports["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},exports["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},exports["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},exports.aes128=exports["aes-128-cbc"],exports.aes192=exports["aes-192-cbc"],exports.aes256=exports["aes-256-cbc"],exports["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},exports["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},exports["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},exports["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},exports["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},exports["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},exports["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},exports["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},exports["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},exports["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},exports["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},exports["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},exports["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},exports["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},exports["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},exports["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},exports["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},exports["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"};

},{}],45:[function(require,module,exports){
var xor=require("buffer-xor");exports.encrypt=function(r,e){var p=xor(e,r._prev);return r._prev=r._cipher.encryptBlock(p),r._prev},exports.decrypt=function(r,e){var p=r._prev;r._prev=e;var c=r._cipher.decryptBlock(e);return xor(c,p)};
},{"buffer-xor":65}],46:[function(require,module,exports){
(function (Buffer){
function encryptStart(e,r,c){var t=r.length,n=xor(r,e._cache);return e._cache=e._cache.slice(t),e._prev=Buffer.concat([e._prev,c?r:n]),n}var xor=require("buffer-xor");exports.encrypt=function(e,r,c){for(var t,n=new Buffer("");r.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=new Buffer("")),!(e._cache.length<=r.length)){n=Buffer.concat([n,encryptStart(e,r,c)]);break}t=e._cache.length,n=Buffer.concat([n,encryptStart(e,r.slice(0,t),c)]),r=r.slice(t)}return n};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"buffer-xor":65}],47:[function(require,module,exports){
(function (Buffer){
function encryptByte(r,e,n){for(var t,f,c,u=-1,o=0;++u<8;)t=r._cipher.encryptBlock(r._prev),f=e&1<<7-u?128:0,c=t[0]^f,o+=(128&c)>>u%8,r._prev=shiftIn(r._prev,n?f:c);return o}function shiftIn(r,e){var n=r.length,t=-1,f=new Buffer(r.length);for(r=Buffer.concat([r,new Buffer([e])]);++t<n;)f[t]=r[t]<<1|r[t+1]>>7;return f}exports.encrypt=function(r,e,n){for(var t=e.length,f=new Buffer(t),c=-1;++c<t;)f[c]=encryptByte(r,e[c],n);return f};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],48:[function(require,module,exports){
(function (Buffer){
function encryptByte(e,r,n){var t=e._cipher.encryptBlock(e._prev),c=t[0]^r;return e._prev=Buffer.concat([e._prev.slice(1),new Buffer([n?r:c])]),c}exports.encrypt=function(e,r,n){for(var t=r.length,c=new Buffer(t),f=-1;++f<t;)c[f]=encryptByte(e,r[f],n);return c};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],49:[function(require,module,exports){
(function (Buffer){
function incr32(e){for(var r,c=e.length;c--;){if(255!==(r=e.readUInt8(c))){r++,e.writeUInt8(r,c);break}e.writeUInt8(0,c)}}function getBlock(e){var r=e._cipher.encryptBlock(e._prev);return incr32(e._prev),r}var xor=require("buffer-xor");exports.encrypt=function(e,r){for(;e._cache.length<r.length;)e._cache=Buffer.concat([e._cache,getBlock(e)]);var c=e._cache.slice(0,r.length);return e._cache=e._cache.slice(r.length),xor(r,c)};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"buffer-xor":65}],50:[function(require,module,exports){
exports.encrypt=function(r,c){return r._cipher.encryptBlock(c)},exports.decrypt=function(r,c){return r._cipher.decryptBlock(c)};

},{}],51:[function(require,module,exports){
(function (Buffer){
function getBlock(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}var xor=require("buffer-xor");exports.encrypt=function(e,c){for(;e._cache.length<c.length;)e._cache=Buffer.concat([e._cache,getBlock(e)]);var r=e._cache.slice(0,c.length);return e._cache=e._cache.slice(c.length),xor(c,r)};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"buffer-xor":65}],52:[function(require,module,exports){
(function (Buffer){
function StreamCipher(e,r,t,i){if(!(this instanceof StreamCipher))return new StreamCipher(e,r,t);Transform.call(this),this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=i,t.copy(this._prev),this._mode=e}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()};

}).call(this,require("buffer").Buffer)
},{"./aes":38,"buffer":66,"cipher-base":69,"inherits":144}],53:[function(require,module,exports){
function createCipher(e,r){var s,i;if(e=e.toLowerCase(),aesModes[e])s=aesModes[e].key,i=aesModes[e].iv;else{if(!desModes[e])throw new TypeError("invalid suite type");s=8*desModes[e].key,i=desModes[e].iv}var t=ebtk(r,!1,s,i);return createCipheriv(e,t.key,t.iv)}function createDecipher(e,r){var s,i;if(e=e.toLowerCase(),aesModes[e])s=aesModes[e].key,i=aesModes[e].iv;else{if(!desModes[e])throw new TypeError("invalid suite type");s=8*desModes[e].key,i=desModes[e].iv}var t=ebtk(r,!1,s,i);return createDecipheriv(e,t.key,t.iv)}function createCipheriv(e,r,s){if(e=e.toLowerCase(),aesModes[e])return aes.createCipheriv(e,r,s);if(desModes[e])return new DES({key:r,iv:s,mode:e});throw new TypeError("invalid suite type")}function createDecipheriv(e,r,s){if(e=e.toLowerCase(),aesModes[e])return aes.createDecipheriv(e,r,s);if(desModes[e])return new DES({key:r,iv:s,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}function getCiphers(){return Object.keys(desModes).concat(aes.getCiphers())}var ebtk=require("evp_bytestokey"),aes=require("browserify-aes/browser"),DES=require("browserify-des"),desModes=require("browserify-des/modes"),aesModes=require("browserify-aes/modes");exports.createCipher=exports.Cipher=createCipher,exports.createCipheriv=exports.Cipheriv=createCipheriv,exports.createDecipher=exports.Decipher=createDecipher,exports.createDecipheriv=exports.Decipheriv=createDecipheriv,exports.listCiphers=exports.getCiphers=getCiphers;

},{"browserify-aes/browser":40,"browserify-aes/modes":44,"browserify-des":54,"browserify-des/modes":55,"evp_bytestokey":122}],54:[function(require,module,exports){
(function (Buffer){
function DES(e){CipherBase.call(this);var s,d=e.mode.toLowerCase(),t=modes[d];s=e.decrypt?"decrypt":"encrypt";var r=e.key;"des-ede"!==d&&"des-ede-cbc"!==d||(r=Buffer.concat([r,r.slice(0,8)]));var i=e.iv;this._des=t.create({key:r,iv:i,type:s})}var CipherBase=require("cipher-base"),des=require("des.js"),inherits=require("inherits"),modes={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};modes.des=modes["des-cbc"],modes.des3=modes["des-ede3-cbc"],module.exports=DES,inherits(DES,CipherBase),DES.prototype._update=function(e){return new Buffer(this._des.update(e))},DES.prototype._final=function(){return new Buffer(this._des.final())};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"cipher-base":69,"des.js":91,"inherits":144}],55:[function(require,module,exports){
exports["des-ecb"]={key:8,iv:0},exports["des-cbc"]=exports.des={key:8,iv:8},exports["des-ede3-cbc"]=exports.des3={key:24,iv:8},exports["des-ede3"]={key:24,iv:0},exports["des-ede-cbc"]={key:16,iv:8},exports["des-ede"]={key:16,iv:0};

},{}],56:[function(require,module,exports){
(function (Buffer){
function blind(e){var n=getr(e);return{blinder:n.toRed(bn.mont(e.modulus)).redPow(new bn(e.publicExponent)).fromRed(),unblinder:n.invm(e.modulus)}}function crt(e,n){var r=blind(n),o=n.modulus.byteLength(),u=(bn.mont(n.modulus),new bn(e).mul(r.blinder).umod(n.modulus)),m=u.toRed(bn.mont(n.prime1)),d=u.toRed(bn.mont(n.prime2)),t=n.coefficient,i=n.prime1,b=n.prime2,l=m.redPow(n.exponent1),s=d.redPow(n.exponent2);l=l.fromRed(),s=s.fromRed();var p=l.isub(s).imul(t).umod(i);return p.imul(b),s.iadd(p),new Buffer(s.imul(r.unblinder).umod(n.modulus).toArray(!1,o))}function getr(e){for(var n=e.modulus.byteLength(),r=new bn(randomBytes(n));r.cmp(e.modulus)>=0||!r.umod(e.prime1)||!r.umod(e.prime2);)r=new bn(randomBytes(n));return r}var bn=require("bn.js"),randomBytes=require("randombytes");module.exports=crt,crt.getr=getr;

}).call(this,require("buffer").Buffer)
},{"bn.js":35,"buffer":66,"randombytes":223}],57:[function(require,module,exports){
module.exports=require("./browser/algorithms.json");
},{"./browser/algorithms.json":58}],58:[function(require,module,exports){
module.exports={
  "sha224WithRSAEncryption": {
    "sign": "rsa",
    "hash": "sha224",
    "id": "302d300d06096086480165030402040500041c"
  },
  "RSA-SHA224": {
    "sign": "ecdsa/rsa",
    "hash": "sha224",
    "id": "302d300d06096086480165030402040500041c"
  },
  "sha256WithRSAEncryption": {
    "sign": "rsa",
    "hash": "sha256",
    "id": "3031300d060960864801650304020105000420"
  },
  "RSA-SHA256": {
    "sign": "ecdsa/rsa",
    "hash": "sha256",
    "id": "3031300d060960864801650304020105000420"
  },
  "sha384WithRSAEncryption": {
    "sign": "rsa",
    "hash": "sha384",
    "id": "3041300d060960864801650304020205000430"
  },
  "RSA-SHA384": {
    "sign": "ecdsa/rsa",
    "hash": "sha384",
    "id": "3041300d060960864801650304020205000430"
  },
  "sha512WithRSAEncryption": {
    "sign": "rsa",
    "hash": "sha512",
    "id": "3051300d060960864801650304020305000440"
  },
  "RSA-SHA512": {
    "sign": "ecdsa/rsa",
    "hash": "sha512",
    "id": "3051300d060960864801650304020305000440"
  },
  "RSA-SHA1": {
    "sign": "rsa",
    "hash": "sha1",
    "id": "3021300906052b0e03021a05000414"
  },
  "ecdsa-with-SHA1": {
    "sign": "ecdsa",
    "hash": "sha1",
    "id": ""
  },
  "sha256": {
    "sign": "ecdsa",
    "hash": "sha256",
    "id": ""
  },
  "sha224": {
    "sign": "ecdsa",
    "hash": "sha224",
    "id": ""
  },
  "sha384": {
    "sign": "ecdsa",
    "hash": "sha384",
    "id": ""
  },
  "sha512": {
    "sign": "ecdsa",
    "hash": "sha512",
    "id": ""
  },
  "DSA-SHA": {
    "sign": "dsa",
    "hash": "sha1",
    "id": ""
  },
  "DSA-SHA1": {
    "sign": "dsa",
    "hash": "sha1",
    "id": ""
  },
  "DSA": {
    "sign": "dsa",
    "hash": "sha1",
    "id": ""
  },
  "DSA-WITH-SHA224": {
    "sign": "dsa",
    "hash": "sha224",
    "id": ""
  },
  "DSA-SHA224": {
    "sign": "dsa",
    "hash": "sha224",
    "id": ""
  },
  "DSA-WITH-SHA256": {
    "sign": "dsa",
    "hash": "sha256",
    "id": ""
  },
  "DSA-SHA256": {
    "sign": "dsa",
    "hash": "sha256",
    "id": ""
  },
  "DSA-WITH-SHA384": {
    "sign": "dsa",
    "hash": "sha384",
    "id": ""
  },
  "DSA-SHA384": {
    "sign": "dsa",
    "hash": "sha384",
    "id": ""
  },
  "DSA-WITH-SHA512": {
    "sign": "dsa",
    "hash": "sha512",
    "id": ""
  },
  "DSA-SHA512": {
    "sign": "dsa",
    "hash": "sha512",
    "id": ""
  },
  "DSA-RIPEMD160": {
    "sign": "dsa",
    "hash": "rmd160",
    "id": ""
  },
  "ripemd160WithRSA": {
    "sign": "rsa",
    "hash": "rmd160",
    "id": "3021300906052b2403020105000414"
  },
  "RSA-RIPEMD160": {
    "sign": "rsa",
    "hash": "rmd160",
    "id": "3021300906052b2403020105000414"
  },
  "md5WithRSAEncryption": {
    "sign": "rsa",
    "hash": "md5",
    "id": "3020300c06082a864886f70d020505000410"
  },
  "RSA-MD5": {
    "sign": "rsa",
    "hash": "md5",
    "id": "3020300c06082a864886f70d020505000410"
  }
}

},{}],59:[function(require,module,exports){
module.exports={
  "1.3.132.0.10": "secp256k1",
  "1.3.132.0.33": "p224",
  "1.2.840.10045.3.1.1": "p192",
  "1.2.840.10045.3.1.7": "p256",
  "1.3.132.0.34": "p384",
  "1.3.132.0.35": "p521"
}

},{}],60:[function(require,module,exports){
(function (Buffer){
function Sign(e){stream.Writable.call(this);var t=algorithms[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=createHash(t.hash),this._tag=t.id,this._signType=t.sign}function Verify(e){stream.Writable.call(this);var t=algorithms[e];if(!t)throw new Error("Unknown message digest");this._hash=createHash(t.hash),this._tag=t.id,this._signType=t.sign}function createSign(e){return new Sign(e)}function createVerify(e){return new Verify(e)}var createHash=require("create-hash"),stream=require("stream"),inherits=require("inherits"),sign=require("./sign"),verify=require("./verify"),algorithms=require("./algorithms.json");Object.keys(algorithms).forEach(function(e){algorithms[e].id=new Buffer(algorithms[e].id,"hex"),algorithms[e.toLowerCase()]=algorithms[e]}),inherits(Sign,stream.Writable),Sign.prototype._write=function(e,t,i){this._hash.update(e),i()},Sign.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},Sign.prototype.sign=function(e,t){this.end();var i=this._hash.digest(),r=sign(i,e,this._hashType,this._signType,this._tag);return t?r.toString(t):r},inherits(Verify,stream.Writable),Verify.prototype._write=function(e,t,i){this._hash.update(e),i()},Verify.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},Verify.prototype.verify=function(e,t,i){"string"==typeof t&&(t=new Buffer(t,i)),this.end();var r=this._hash.digest();return verify(t,r,e,this._signType,this._tag)},module.exports={Sign:createSign,Verify:createVerify,createSign:createSign,createVerify:createVerify};

}).call(this,require("buffer").Buffer)
},{"./algorithms.json":58,"./sign":61,"./verify":62,"buffer":66,"create-hash":78,"inherits":144,"stream":269}],61:[function(require,module,exports){
(function (Buffer){
function sign(e,r,t,n,a){var u=parseKeys(r);if(u.curve){if("ecdsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");return ecSign(e,u)}if("dsa"===u.type){if("dsa"!==n)throw new Error("wrong private key type");return dsaSign(e,u,t)}if("rsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");e=Buffer.concat([a,e]);for(var i=u.modulus.byteLength(),o=[0,1];e.length+o.length+1<i;)o.push(255);o.push(0);for(var c=-1;++c<e.length;)o.push(e[c]);return crt(o,u)}function ecSign(e,r){var t=curves[r.curve.join(".")];if(!t)throw new Error("unknown curve "+r.curve.join("."));var n=new EC(t),a=n.keyFromPrivate(r.privateKey),u=a.sign(e);return new Buffer(u.toDER())}function dsaSign(e,r,t){for(var n,a=r.params.priv_key,u=r.params.p,i=r.params.q,o=r.params.g,c=new BN(0),f=bits2int(e,i).mod(i),s=!1,g=getKey(a,i,e,t);!1===s;)n=makeKey(i,g,t),c=makeR(o,n,u,i),s=n.invm(i).imul(f.add(a.mul(c))).mod(i),0===s.cmpn(0)&&(s=!1,c=new BN(0));return toDER(c,s)}function toDER(e,r){e=e.toArray(),r=r.toArray(),128&e[0]&&(e=[0].concat(e)),128&r[0]&&(r=[0].concat(r));var t=e.length+r.length+4,n=[48,t,2,e.length];return n=n.concat(e,[2,r.length],r),new Buffer(n)}function getKey(e,r,t,n){if(e=new Buffer(e.toArray()),e.length<r.byteLength()){var a=new Buffer(r.byteLength()-e.length);a.fill(0),e=Buffer.concat([a,e])}var u=t.length,i=bits2octets(t,r),o=new Buffer(u);o.fill(1);var c=new Buffer(u);return c.fill(0),c=createHmac(n,c).update(o).update(new Buffer([0])).update(e).update(i).digest(),o=createHmac(n,c).update(o).digest(),c=createHmac(n,c).update(o).update(new Buffer([1])).update(e).update(i).digest(),o=createHmac(n,c).update(o).digest(),{k:c,v:o}}function bits2int(e,r){var t=new BN(e),n=(e.length<<3)-r.bitLength();return n>0&&t.ishrn(n),t}function bits2octets(e,r){e=bits2int(e,r),e=e.mod(r);var t=new Buffer(e.toArray());if(t.length<r.byteLength()){var n=new Buffer(r.byteLength()-t.length);n.fill(0),t=Buffer.concat([n,t])}return t}function makeKey(e,r,t){var n,a;do{for(n=new Buffer(0);8*n.length<e.bitLength();)r.v=createHmac(t,r.k).update(r.v).digest(),n=Buffer.concat([n,r.v]);a=bits2int(n,e),r.k=createHmac(t,r.k).update(r.v).update(new Buffer([0])).digest(),r.v=createHmac(t,r.k).update(r.v).digest()}while(-1!==a.cmp(e));return a}function makeR(e,r,t,n){return e.toRed(BN.mont(t)).redPow(r).fromRed().mod(n)}var createHmac=require("create-hmac"),crt=require("browserify-rsa"),EC=require("elliptic").ec,BN=require("bn.js"),parseKeys=require("parse-asn1"),curves=require("./curves.json");module.exports=sign,module.exports.getKey=getKey,module.exports.makeKey=makeKey;

}).call(this,require("buffer").Buffer)
},{"./curves.json":59,"bn.js":35,"browserify-rsa":56,"buffer":66,"create-hmac":81,"elliptic":104,"parse-asn1":191}],62:[function(require,module,exports){
(function (Buffer){
function verify(e,r,n,a,t){var o=parseKeys(n);if("ec"===o.type){if("ecdsa"!==a&&"ecdsa/rsa"!==a)throw new Error("wrong public key type");return ecVerify(e,r,o)}if("dsa"===o.type){if("dsa"!==a)throw new Error("wrong public key type");return dsaVerify(e,r,o)}if("rsa"!==a&&"ecdsa/rsa"!==a)throw new Error("wrong public key type");r=Buffer.concat([t,r]);for(var u=o.modulus.byteLength(),i=[1],d=0;r.length+i.length+2<u;)i.push(255),d++;i.push(0);for(var c=-1;++c<r.length;)i.push(r[c]);i=new Buffer(i);var s=BN.mont(o.modulus);e=new BN(e).toRed(s),e=e.redPow(new BN(o.publicExponent)),e=new Buffer(e.fromRed().toArray());var f=d<8?1:0;for(u=Math.min(e.length,i.length),e.length!==i.length&&(f=1),c=-1;++c<u;)f|=e[c]^i[c];return 0===f}function ecVerify(e,r,n){var a=curves[n.data.algorithm.curve.join(".")];if(!a)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var t=new EC(a),o=n.data.subjectPrivateKey.data;return t.verify(r,e,o)}function dsaVerify(e,r,n){var a=n.data.p,t=n.data.q,o=n.data.g,u=n.data.pub_key,i=parseKeys.signature.decode(e,"der"),d=i.s,c=i.r;checkValue(d,t),checkValue(c,t);var s=BN.mont(a),f=d.invm(t);return 0===o.toRed(s).redPow(new BN(r).mul(f).mod(t)).fromRed().mul(u.toRed(s).redPow(c.mul(f).mod(t)).fromRed()).mod(a).mod(t).cmp(c)}function checkValue(e,r){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(r)>=r)throw new Error("invalid sig")}var BN=require("bn.js"),EC=require("elliptic").ec,parseKeys=require("parse-asn1"),curves=require("./curves.json");module.exports=verify;

}).call(this,require("buffer").Buffer)
},{"./curves.json":59,"bn.js":35,"buffer":66,"elliptic":104,"parse-asn1":191}],63:[function(require,module,exports){
arguments[4][37][0].apply(exports,arguments)
},{"dup":37}],64:[function(require,module,exports){
function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";e=e.slice(r,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var h=t.charCodeAt(t.length-1);if(!(h>=55296&&h<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,h=t.charCodeAt(i);if(h>=55296&&h<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,i)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};
},{"buffer":66}],65:[function(require,module,exports){
(function (Buffer){
module.exports=function(e,n){for(var r=Math.min(e.length,n.length),t=new Buffer(r),f=0;f<r;++f)t[f]=e[f]^n[f];return t};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],66:[function(require,module,exports){
(function (global){
"use strict";function typedArraySupport(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=Buffer.prototype):(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}return from(this,t,e,r)}function from(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,r,n):"string"==typeof e?fromString(t,e,r):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,r,n){return assertSize(e),e<=0?createBuffer(t,e):void 0!==r?"string"==typeof n?createBuffer(t,e).fill(r,n):createBuffer(t,e).fill(r):createBuffer(t,e)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function fromString(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(e,r);t=createBuffer(t,n);var f=t.write(e,r);return f!==n&&(t=t.slice(0,f)),t}function fromArrayLike(t,e){var r=e.length<0?0:0|checked(e.length);t=createBuffer(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function fromArrayBuffer(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),Buffer.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=Buffer.prototype):t=fromArrayLike(t,e),t}function fromObject(t,e){if(Buffer.isBuffer(e)){var r=0|checked(e.length);return t=createBuffer(t,r),0===t.length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function byteLength(t,e){if(Buffer.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"latin1":case"binary":return latin1Slice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function swap(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function bidirectionalIndexOf(t,e,r,n,f){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=f?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(f)return-1;r=t.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,n)),Buffer.isBuffer(e))return 0===e.length?-1:arrayIndexOf(t,e,r,n,f);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):arrayIndexOf(t,[e],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(t,e,r,n,f){function i(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,u=t.length,s=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,u/=2,s/=2,r/=2}var a;if(f){var h=-1;for(a=r;a<u;a++)if(i(t,a)===i(e,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===s)return h*o}else-1!==h&&(a-=a-h),h=-1}else for(r+s>u&&(r=u-s),a=r;a>=0;a--){for(var c=!0,l=0;l<s;l++)if(i(t,a+l)!==i(e,l)){c=!1;break}if(c)return a}return-1}function hexWrite(t,e,r,n){r=Number(r)||0;var f=t.length-r;n?(n=Number(n))>f&&(n=f):n=f;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))return o;t[r+o]=u}return o}function utf8Write(t,e,r,n){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,n)}function asciiWrite(t,e,r,n){return blitBuffer(asciiToBytes(e),t,r,n)}function latin1Write(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){return blitBuffer(base64ToBytes(e),t,r,n)}function ucs2Write(t,e,r,n){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,n)}function base64Slice(t,e,r){return 0===e&&r===t.length?base64.fromByteArray(t):base64.fromByteArray(t.slice(e,r))}function utf8Slice(t,e,r){r=Math.min(t.length,r);for(var n=[],f=e;f<r;){var i=t[f],o=null,u=i>239?4:i>223?3:i>191?2:1;if(f+u<=r){var s,a,h,c;switch(u){case 1:i<128&&(o=i);break;case 2:s=t[f+1],128==(192&s)&&(c=(31&i)<<6|63&s)>127&&(o=c);break;case 3:s=t[f+1],a=t[f+2],128==(192&s)&&128==(192&a)&&(c=(15&i)<<12|(63&s)<<6|63&a)>2047&&(c<55296||c>57343)&&(o=c);break;case 4:s=t[f+1],a=t[f+2],h=t[f+3],128==(192&s)&&128==(192&a)&&128==(192&h)&&(c=(15&i)<<18|(63&s)<<12|(63&a)<<6|63&h)>65535&&c<1114112&&(o=c)}}null===o?(o=65533,u=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),f+=u}return decodeCodePointsArray(n)}function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(127&t[f]);return n}function latin1Slice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(t[f]);return n}function hexSlice(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=e;i<r;++i)f+=toHex(t[i]);return f}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,f,i){if(!Buffer.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>f||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,r,n){e<0&&(e=65535+e+1);for(var f=0,i=Math.min(t.length-r,2);f<i;++f)t[r+f]=(e&255<<8*(n?f:1-f))>>>8*(n?f:1-f)}function objectWriteUInt32(t,e,r,n){e<0&&(e=4294967295+e+1);for(var f=0,i=Math.min(t.length-r,4);f<i;++f)t[r+f]=e>>>8*(n?f:3-f)&255}function checkIEEE754(t,e,r,n,f,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(t,e,r,n,f){return f||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,f){return f||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){e=e||1/0;for(var r,n=t.length,f=null,i=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!f){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(e-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,f,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n){for(var f=0;f<n&&!(f+r>=e.length||f>=t.length);++f)e[f+r]=t[f];return f}function isnan(t){return t!==t}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,r){return from(null,t,e,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(t,e,r){return alloc(null,t,e,r)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,f=0,i=Math.min(r,n);f<i;++f)if(t[f]!==e[f]){r=t[f],n=e[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=Buffer.allocUnsafe(e),f=0;for(r=0;r<t.length;++r){var i=t[r];if(!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,r,n,f){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),e<0||r>t.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&e>=r)return 0;if(n>=f)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,f>>>=0,this===t)return 0;for(var i=f-n,o=r-e,u=Math.min(i,o),s=this.slice(n,f),a=t.slice(e,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Buffer.prototype.indexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-e;if((void 0===r||r>f)&&(r=f),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"latin1":case"binary":return latin1Write(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=Buffer.prototype;else{var f=e-t;n=new Buffer(f,void 0);for(var i=0;i<f;++i)n[i]=this[i+t]}return n},Buffer.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return n},Buffer.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],f=1;e>0&&(f*=256);)n+=this[t+--e]*f;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return f*=128,n>=f&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=e,f=1,i=this[t+--n];n>0&&(f*=256);)i+=this[t+--n]*f;return f*=128,i>=f&&(i-=Math.pow(2,8*e)),i},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){checkInt(this,t,e,r,Math.pow(2,8*r)-1,0)}var f=1,i=0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=t/f&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){checkInt(this,t,e,r,Math.pow(2,8*r)-1,0)}var f=r-1,i=1;for(this[e+f]=255&t;--f>=0&&(i*=256);)this[e+f]=t/i&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=0,o=1,u=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===u&&0!==this[e+i-1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===u&&0!==this[e+i+1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var f,i=n-r;if(this===t&&r<e&&e<n)for(f=i-1;f>=0;--f)t[f+e]=this[f+r];else if(i<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(f=0;f<i;++f)t[f+e]=this[f+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},Buffer.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var f=t.charCodeAt(0);f<256&&(t=f)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var i;if("number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=Buffer.isBuffer(t)?t:utf8ToBytes(new Buffer(t,n).toString()),u=o.length;for(i=0;i<r-e;++i)this[i+e]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"base64-js":16,"ieee754":141,"isarray":149}],67:[function(require,module,exports){
module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"};
},{}],68:[function(require,module,exports){
function ChunkStoreWriteStream(t,e,r){function o(e){i.destroyed||(t.put(n,e),n+=1)}var i=this;if(!(i instanceof ChunkStoreWriteStream))return new ChunkStoreWriteStream(t,e,r);if(stream.Writable.call(i,r),r||(r={}),!t||!t.put||!t.get)throw new Error("First argument must be an abstract-chunk-store compliant store");if(!(e=Number(e)))throw new Error("Second argument must be a chunk length");i._blockstream=new BlockStream(e,{zeroPadding:!1}),i._blockstream.on("data",o).on("error",function(t){i.destroy(t)});var n=0;i.on("finish",function(){this._blockstream.end()})}module.exports=ChunkStoreWriteStream;var BlockStream=require("block-stream2"),inherits=require("inherits"),stream=require("readable-stream");inherits(ChunkStoreWriteStream,stream.Writable),ChunkStoreWriteStream.prototype._write=function(t,e,r){this._blockstream.write(t,e,r)},ChunkStoreWriteStream.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,t&&this.emit("error",t),this.emit("close"))};
},{"block-stream2":34,"inherits":144,"readable-stream":235}],69:[function(require,module,exports){
function CipherBase(t){Transform.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}var Buffer=require("safe-buffer").Buffer,Transform=require("stream").Transform,StringDecoder=require("string_decoder").StringDecoder,inherits=require("inherits");inherits(CipherBase,Transform),CipherBase.prototype.update=function(t,e,r){"string"==typeof t&&(t=Buffer.from(t,e));var i=this._update(t);return this.hashMode?this:(r&&(i=this._toString(i,r)),i)},CipherBase.prototype.setAutoPadding=function(){},CipherBase.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},CipherBase.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},CipherBase.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},CipherBase.prototype._transform=function(t,e,r){var i;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){i=t}finally{r(i)}},CipherBase.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},CipherBase.prototype._finalOrDigest=function(t){var e=this.__final()||Buffer.alloc(0);return t&&(e=this._toString(e,t,!0)),e},CipherBase.prototype._toString=function(t,e,r){if(this._decoder||(this._decoder=new StringDecoder(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var i=this._decoder.write(t);return r&&(i+=this._decoder.end()),i},module.exports=CipherBase;
},{"inherits":144,"safe-buffer":244,"stream":269,"string_decoder":64}],70:[function(require,module,exports){
function closest(s,t,a){for(var e,o,r,l=1/0,n=0,b=t.length-1;n<=b&&(e=n+(b-n>>1),r=t[e]-s,r<0?n=e+1:r>0&&(b=e-1),r=abs(r),r<l&&(l=r,o=e),t[e]!==s););return a?o:t[o]}var abs=Math.abs;module.exports=closest;

},{}],71:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../is-buffer/index.js")})
},{"../../is-buffer/index.js":146}],72:[function(require,module,exports){
function merge(t,e){for(var r in e)t[r]=e[r];return t}function order(t,e){return between.strord(t[1],e[1])||between.strord(t[2],e[2])}function Doc(t){if(!(this instanceof Doc))return new Doc(t);this.rows={},this.hist={},this.sets=new EventEmitter,this.setMaxListeners(1/0),this.sets.setMaxListeners(1/0),Scuttlebutt.call(this,t)}function _set(t,e,r,i){var o="string"==typeof e&&e+":"+r;if(o&&t.sets[o])return t.sets[o];var s=new i(t,e,r);return o&&(t.sets[o]=s),s}var inherits=require("util").inherits,Row=require("./row"),between=require("between"),Set=require("./set"),Seq=require("./seq"),Scuttlebutt=require("scuttlebutt"),EventEmitter=require("events").EventEmitter,createId=require("scuttlebutt/util").createId;inherits(Doc,Scuttlebutt),module.exports=Doc,Doc.prototype.add=function(t){var e=void 0===t.id?createId():t.id;if("__proto__"===e)throw new Error("__proto__ is illegial id");var r=this._add(e,"local");return r._set(t,"local"),r},Doc.prototype._add=function(t,e,r){function i(t,e){o.localUpdate([s.id,t])}var o=this;if("__proto__"===t)throw new Error("__proto__ is illegial id");if(this.rows[t])return this.rows[t];var s=t instanceof Row?t:new Row(t);return this.rows[s.id]=s,s.on("preupdate",i),s.on("remove",function(){s.removeAllListeners("preupdate")}),s._new=!0,s},Doc.prototype.timeUpdated=function(t,e){var r=this.hist[t.id];if(r)return r[e][2]},Doc.prototype.set=function(t,e){if("__proto__"===t)throw new Error("__proto__ is illegial id");return this._add(t,"local",e).set(e)},Doc.prototype.rm=function(t){this.set(t,null)},Doc.prototype.applyUpdate=function(t,e){if(!Array.isArray(t[0])||"string"!=typeof t[0][0])return this.emit("invalid",new Error("invalid update"));var r=t[0][0],i=t[0][1];t[1],t[2];if("__proto__"===r)return this.emit("invalid",new Error("__proto__ is illegial id"));var o={},s=this._add(r,e),n=this.hist[r]=this.hist[r]||{},a=!1;if(null===i){for(var _ in s.state)s.state.hasOwnProperty(_)&&(!n[_]||order(n[_],t)<0)&&(n[_]&&this.emit("_remove",n[_]),n[_]=[null,t[1],t[2]],a=!0);for(var u in this.sets){var h=u.indexOf(":")>0,d=this.sets[u];h&&d&&d.get(s.id)&&d.rm(s)}delete this.rows[r],s.emit("removed"),this.emit("remove",s)}else{var p=[];for(var _ in i)if(i.hasOwnProperty(_)){var c=i[_];(!n[_]||order(n[_],t)<0)&&(n[_]&&!~p.indexOf(n[_])&&p.push(n[_]),n[_]=t,o[_]=c,a=!0)}var l=this.history(),f=this;p.forEach(function(t){~l.indexOf(t)||f.emit("_remove",t)})}merge(s.state,o);for(var w in o)this.sets.emit(w,s,o);a&&(s._new&&(this.emit("add",s),this.emit("create",s),s._new=!1),this.emit("_update",t),s.emit("update",t,o),s.emit("changes",i,o),s.emit("change",o),this.emit("update",t,e),this.emit("row_update",s))},Doc.prototype.history=function(t){var e=[];for(var r in this.hist){var i=this.hist[r];for(var o in i)!~e.indexOf(i[o])&&Scuttlebutt.filter(i[o],t)&&e.push(i[o])}return e.sort(order)},Doc.prototype.createSet=function(t,e){if("__proto__"===t)throw new Error("__proto__ is invalid key");return _set(this,t,e,Set)},Doc.prototype.createSeq=function(t,e){if("__proto__"===t)throw new Error("__proto__ is invalid key");return _set(this,t,e,Seq)},Doc.prototype.toJSON=function(){var t={};for(var e in this.rows)this.rows.hasOwnProperty(e)&&(t[e]=this.rows[e].state);return t},Doc.prototype.get=function(t){if("__proto__"===t)throw new Error("__proto__ is illegal id");return this.rows[t]=this.rows[t]||this._add(new Row(t),"local")};

},{"./row":74,"./seq":75,"./set":76,"between":18,"events":121,"scuttlebutt":245,"scuttlebutt/util":246,"util":304}],73:[function(require,module,exports){
"use strict";function sync(e,r){var t=e.createStream(),s=r.createStream();return t.pipe(s).pipe(t)}var inherits=require("util").inherits,EventEmitter=require("events").EventEmitter;exports=module.exports=require("./doc"),exports.Row=require("./row"),exports.sync=sync,exports.Set=require("./set"),exports.Seq=require("./seq"),exports.Doc=exports,exports.createStream=function(e,r){return e.createStream(r)};

},{"./doc":72,"./row":74,"./seq":75,"./set":76,"events":121,"util":304}],74:[function(require,module,exports){
"use strict";function Row(t){this.id=t,this.state={id:t},this.setMaxListeners(1/0)}var inherits=require("util").inherits,EventEmitter=require("events").EventEmitter;module.exports=Row,inherits(Row,EventEmitter),Row.prototype.set=function(t,e){if(2==arguments.length){var i=t;if("__proto__"===i)return this;t={},t[i]=e}if(null!==t&&t.id&&t.id!==this.state.id)throw new Error("id cannot be changed");return this._set(t,"local"),this},Row.prototype.validate=function(t){try{return this.emit("validate",t),!0}catch(t){return console.error("validation",t.message),!1}},Row.prototype._set=function(t,e){return this.emit("preupdate",t,e),this},Row.prototype.get=function(t){return t?this.state[t]:this.state},Row.prototype.toJSON=function(){return this.state};

},{"events":121,"util":304}],75:[function(require,module,exports){
"use strict";function sort(t){return t.sort(function(t,r){return between.strord(t.get("_sort"),r.get("_sort"))})}function find(t,r){for(var e in t){var n=t[e];if(r(n,e,t))return n}return null}function Seq(t,r,e){if("__proto__"==r)throw new Error("__proto__ is invalid key");Set.call(this,t,r,e),"string"!=typeof r&&(r=null);var n=this;this.on("changes",function(t,r){if(r._sort){sort(n._array);var e=find(n._array,function(r){return r!=t&&r.get("_sort")==t.get("_sort")});e?n.insert(t,e,n.next(t)):n.emit("move",t)}}),this.insert=function(n,o,i){o=toKey(this.get(o)||"!"),i=toKey(this.get(i)||"~"),"string"==typeof n&&(n=t.rows[n]);var s,u,a=between.between(o,i)+between.randstr(3);return n instanceof Row?(s=n,u={_sort:a},r&&s.get(r)!=e&&(u[r]=e),s.set(u)):(n._sort=a,r&&(n[r]=e),s=t.set(id(n),n)),sort(this._array),s}}function toKey(t){return"string"==typeof t?t:t instanceof Row?t.get()._sort:t?t._sort:null}function max(t,r,e){var n=null,o=-1;if(t.length){for(var i=0;i<t.length;i++)r(n,t[i])&&(n=t[o=i]);return e?o:n}}function id(t){return t.id||t._id||"_"+Date.now()+"_"+Math.round(1e3*Math.random())}var Set=require("./set"),Row=require("./row"),inherits=require("util").inherits,between=require("between");module.exports=Seq,inherits(Seq,Set),Seq.prototype.prev=function(t){return t=toKey(this.get(t)||"~"),max(this._array,function(r,e){if(toKey(e)<t)return!r||toKey(e)>toKey(r)})},Seq.prototype.next=function(t){return t=toKey(this.get(t)||"!"),max(this._array,function(r,e){if(toKey(e)>t)return!r||toKey(e)<toKey(r)})},Seq.prototype.asArray=function(){return sort(this._array)},Seq.prototype.before=function(t,r){return this.insert(t,this.prev(r),r)},Seq.prototype.after=function(t,r){return this.insert(t,r,this.next(r))},Seq.prototype.first=function(){return this._array[0]},Seq.prototype.last=function(){return this._array[this._array.length-1]},Seq.prototype.indexOf=function(t){return this._array.indexOf("string"==typeof t?this.rows[t]:t)},Seq.prototype.at=function(t){if("__proto__"===t)throw new Error("__proto__ invalid index");return this._array[t]},Seq.prototype.unshift=function(t){return this.insert(t,"!",this.first())},Seq.prototype.push=function(t){return this.insert(t,this.last(),"~")},Seq.prototype.length=function(){return this._array.length},Seq.prototype.pop=function(){return this.remove(this.last())},Seq.prototype.shift=function(){return this.remove(this.first())};

},{"./row":74,"./set":76,"between":18,"util":304}],76:[function(require,module,exports){
"use strict";function Set(t,e,r){function i(t){function i(h,u){if(e&&t.state[e]===r||o&&o(t.state))return void a.emit("changes",t,u);delete s[t.id];var f=n.indexOf(t);~f&&n.splice(f,1),a.emit("changes",t,u),a.emit("remove",t),t.removeListener("changes",i)}s[t.id]||(n.push(t),s[t.id]=t,a.emit("add",t),t.on("changes",i))}var o,n=this._array=[],s=this.rows={},a=this;if("function"==typeof e)o=this.filter=e,e=null;else{if("__proto__"===e)throw new Error("__proto__ is illegal key");this.key=e,this.value=r}o?t.on("create",function(t){o(t.state)&&i(t)}):t.sets.on(e,function(t,o){o[e]===r&&i(t)}),this.rm=this.remove=function(t){if(t=this.get(t)){if(e)return t.set(e,null);throw new Error("Set cannot remove rows with arbitary filters")}};for(var h in t.rows){var u=t.get(h);e&&u.get(e)===r?i(u):o&&o(u.state)&&i(u)}this.setMaxListeners(1/0)}var inherits=require("util").inherits,EventEmitter=require("events").EventEmitter,Row=require("./row"),between=require("between");inherits(Set,EventEmitter),module.exports=Set,Set.prototype.onEach=function(t){this.forEach(t),this.on("add",t)},Set.prototype.asArray=function(){return this._array},Set.prototype.toJSON=function(){return this._array.map(function(t){return t.state}).sort(function(t,e){return between.strord(t._sort||t.id,e._sort||e.id)})},Set.prototype.each=Set.prototype.forEach=function(t){return this._array.forEach(t)},Set.prototype.get=function(t){if(!arguments.length)return this.array;if("__proto__"===t)throw new Error("__proto__ is invalid id");return"string"==typeof t?this.rows[t]:"number"==typeof t?this.rows[t]:t&&t.id?this.rows[t.id]:null},Set.prototype.has=function(t){return this.get(t)};

},{"./row":74,"between":18,"events":121,"util":304}],77:[function(require,module,exports){
(function (Buffer){
function ECDH(e){this.curveType=aliases[e],this.curveType||(this.curveType={name:e}),this.curve=new elliptic.ec(this.curveType.name),this.keys=void 0}function formatReturnValue(e,t,r){Array.isArray(e)||(e=e.toArray());var i=new Buffer(e);if(r&&i.length<r){var s=new Buffer(r-i.length);s.fill(0),i=Buffer.concat([s,i])}return t?i.toString(t):i}var elliptic=require("elliptic"),BN=require("bn.js");module.exports=function(e){return new ECDH(e)};var aliases={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};aliases.p224=aliases.secp224r1,aliases.p256=aliases.secp256r1=aliases.prime256v1,aliases.p192=aliases.secp192r1=aliases.prime192v1,aliases.p384=aliases.secp384r1,aliases.p521=aliases.secp521r1,ECDH.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},ECDH.prototype.computeSecret=function(e,t,r){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),formatReturnValue(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},ECDH.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(r[r.length-1]%2?r[0]=7:r[0]=6),formatReturnValue(r,e)},ECDH.prototype.getPrivateKey=function(e){return formatReturnValue(this.keys.getPrivate(),e)},ECDH.prototype.setPublicKey=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.keys._importPublic(e),this},ECDH.prototype.setPrivateKey=function(e,t){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var r=new BN(e);return r=r.toString(16),this.keys._importPrivate(r),this};

}).call(this,require("buffer").Buffer)
},{"bn.js":35,"buffer":66,"elliptic":104}],78:[function(require,module,exports){
(function (Buffer){
"use strict";function HashNoConstructor(s){Base.call(this,"digest"),this._hash=s,this.buffers=[]}function Hash(s){Base.call(this,"digest"),this._hash=s}var inherits=require("inherits"),md5=require("./md5"),RIPEMD160=require("ripemd160"),sha=require("sha.js"),Base=require("cipher-base");inherits(HashNoConstructor,Base),HashNoConstructor.prototype._update=function(s){this.buffers.push(s)},HashNoConstructor.prototype._final=function(){var s=Buffer.concat(this.buffers),t=this._hash(s);return this.buffers=null,t},inherits(Hash,Base),Hash.prototype._update=function(s){this._hash.update(s)},Hash.prototype._final=function(){return this._hash.digest()},module.exports=function(s){return s=s.toLowerCase(),"md5"===s?new HashNoConstructor(md5):new Hash("rmd160"===s||"ripemd160"===s?new RIPEMD160:sha(s))};

}).call(this,require("buffer").Buffer)
},{"./md5":80,"buffer":66,"cipher-base":69,"inherits":144,"ripemd160":240,"sha.js":248}],79:[function(require,module,exports){
(function (Buffer){
"use strict";function toArray(e){if(e.length%intSize!=0){var r=e.length+(intSize-e.length%intSize);e=Buffer.concat([e,zeroBuffer],r)}for(var t=new Array(e.length>>>2),n=0,i=0;n<e.length;n+=intSize,i++)t[i]=e.readInt32LE(n);return t}var intSize=4,zeroBuffer=new Buffer(intSize);zeroBuffer.fill(0);var charSize=8,hashSize=16;module.exports=function(e,r){var t=r(toArray(e),e.length*charSize);e=new Buffer(hashSize);for(var n=0;n<t.length;n++)e.writeInt32LE(t[n],n<<2,!0);return e};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],80:[function(require,module,exports){
"use strict";function core_md5(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,i=-1732584194,h=271733878,g=0;g<d.length;g+=16){var n=m,r=f,e=i,a=h;m=md5_ff(m,f,i,h,d[g+0],7,-680876936),h=md5_ff(h,m,f,i,d[g+1],12,-389564586),i=md5_ff(i,h,m,f,d[g+2],17,606105819),f=md5_ff(f,i,h,m,d[g+3],22,-1044525330),m=md5_ff(m,f,i,h,d[g+4],7,-176418897),h=md5_ff(h,m,f,i,d[g+5],12,1200080426),i=md5_ff(i,h,m,f,d[g+6],17,-1473231341),f=md5_ff(f,i,h,m,d[g+7],22,-45705983),m=md5_ff(m,f,i,h,d[g+8],7,1770035416),h=md5_ff(h,m,f,i,d[g+9],12,-1958414417),i=md5_ff(i,h,m,f,d[g+10],17,-42063),f=md5_ff(f,i,h,m,d[g+11],22,-1990404162),m=md5_ff(m,f,i,h,d[g+12],7,1804603682),h=md5_ff(h,m,f,i,d[g+13],12,-40341101),i=md5_ff(i,h,m,f,d[g+14],17,-1502002290),f=md5_ff(f,i,h,m,d[g+15],22,1236535329),m=md5_gg(m,f,i,h,d[g+1],5,-165796510),h=md5_gg(h,m,f,i,d[g+6],9,-1069501632),i=md5_gg(i,h,m,f,d[g+11],14,643717713),f=md5_gg(f,i,h,m,d[g+0],20,-373897302),m=md5_gg(m,f,i,h,d[g+5],5,-701558691),h=md5_gg(h,m,f,i,d[g+10],9,38016083),i=md5_gg(i,h,m,f,d[g+15],14,-660478335),f=md5_gg(f,i,h,m,d[g+4],20,-405537848),m=md5_gg(m,f,i,h,d[g+9],5,568446438),h=md5_gg(h,m,f,i,d[g+14],9,-1019803690),i=md5_gg(i,h,m,f,d[g+3],14,-187363961),f=md5_gg(f,i,h,m,d[g+8],20,1163531501),m=md5_gg(m,f,i,h,d[g+13],5,-1444681467),h=md5_gg(h,m,f,i,d[g+2],9,-51403784),i=md5_gg(i,h,m,f,d[g+7],14,1735328473),f=md5_gg(f,i,h,m,d[g+12],20,-1926607734),m=md5_hh(m,f,i,h,d[g+5],4,-378558),h=md5_hh(h,m,f,i,d[g+8],11,-2022574463),i=md5_hh(i,h,m,f,d[g+11],16,1839030562),f=md5_hh(f,i,h,m,d[g+14],23,-35309556),m=md5_hh(m,f,i,h,d[g+1],4,-1530992060),h=md5_hh(h,m,f,i,d[g+4],11,1272893353),i=md5_hh(i,h,m,f,d[g+7],16,-155497632),f=md5_hh(f,i,h,m,d[g+10],23,-1094730640),m=md5_hh(m,f,i,h,d[g+13],4,681279174),h=md5_hh(h,m,f,i,d[g+0],11,-358537222),i=md5_hh(i,h,m,f,d[g+3],16,-722521979),f=md5_hh(f,i,h,m,d[g+6],23,76029189),m=md5_hh(m,f,i,h,d[g+9],4,-640364487),h=md5_hh(h,m,f,i,d[g+12],11,-421815835),i=md5_hh(i,h,m,f,d[g+15],16,530742520),f=md5_hh(f,i,h,m,d[g+2],23,-995338651),m=md5_ii(m,f,i,h,d[g+0],6,-198630844),h=md5_ii(h,m,f,i,d[g+7],10,1126891415),i=md5_ii(i,h,m,f,d[g+14],15,-1416354905),f=md5_ii(f,i,h,m,d[g+5],21,-57434055),m=md5_ii(m,f,i,h,d[g+12],6,1700485571),h=md5_ii(h,m,f,i,d[g+3],10,-1894986606),i=md5_ii(i,h,m,f,d[g+10],15,-1051523),f=md5_ii(f,i,h,m,d[g+1],21,-2054922799),m=md5_ii(m,f,i,h,d[g+8],6,1873313359),h=md5_ii(h,m,f,i,d[g+15],10,-30611744),i=md5_ii(i,h,m,f,d[g+6],15,-1560198380),f=md5_ii(f,i,h,m,d[g+13],21,1309151649),m=md5_ii(m,f,i,h,d[g+4],6,-145523070),h=md5_ii(h,m,f,i,d[g+11],10,-1120210379),i=md5_ii(i,h,m,f,d[g+2],15,718787259),f=md5_ii(f,i,h,m,d[g+9],21,-343485551),m=safe_add(m,n),f=safe_add(f,r),i=safe_add(i,e),h=safe_add(h,a)}return[m,f,i,h]}function md5_cmn(d,_,m,f,i,h){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,h)),i),m)}function md5_ff(d,_,m,f,i,h,g){return md5_cmn(_&m|~_&f,d,_,i,h,g)}function md5_gg(d,_,m,f,i,h,g){return md5_cmn(_&f|m&~f,d,_,i,h,g)}function md5_hh(d,_,m,f,i,h,g){return md5_cmn(_^m^f,d,_,i,h,g)}function md5_ii(d,_,m,f,i,h,g){return md5_cmn(m^(_|~f),d,_,i,h,g)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}var makeHash=require("./make-hash");module.exports=function(d){return makeHash(d,core_md5)};
},{"./make-hash":79}],81:[function(require,module,exports){
"use strict";function Hmac(e,a){Base.call(this,"digest"),"string"==typeof a&&(a=Buffer.from(a));var r="sha512"===e||"sha384"===e?128:64;if(this._alg=e,this._key=a,a.length>r){a=("rmd160"===e?new RIPEMD160:sha(e)).update(a).digest()}else a.length<r&&(a=Buffer.concat([a,ZEROS],r));for(var s=this._ipad=Buffer.allocUnsafe(r),t=this._opad=Buffer.allocUnsafe(r),i=0;i<r;i++)s[i]=54^a[i],t[i]=92^a[i];this._hash="rmd160"===e?new RIPEMD160:sha(e),this._hash.update(s)}var inherits=require("inherits"),Legacy=require("./legacy"),Base=require("cipher-base"),Buffer=require("safe-buffer").Buffer,md5=require("create-hash/md5"),RIPEMD160=require("ripemd160"),sha=require("sha.js"),ZEROS=Buffer.alloc(128);inherits(Hmac,Base),Hmac.prototype._update=function(e){this._hash.update(e)},Hmac.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new RIPEMD160:sha(this._alg)).update(this._opad).update(e).digest()},module.exports=function(e,a){return e=e.toLowerCase(),"rmd160"===e||"ripemd160"===e?new Hmac("rmd160",a):"md5"===e?new Legacy(md5,a):new Hmac(e,a)};

},{"./legacy":82,"cipher-base":69,"create-hash/md5":80,"inherits":144,"ripemd160":240,"safe-buffer":244,"sha.js":248}],82:[function(require,module,exports){
"use strict";function Hmac(e,s){Base.call(this,"digest"),"string"==typeof s&&(s=Buffer.from(s)),this._alg=e,this._key=s,s.length>blocksize?s=e(s):s.length<blocksize&&(s=Buffer.concat([s,ZEROS],blocksize));for(var i=this._ipad=Buffer.allocUnsafe(blocksize),t=this._opad=Buffer.allocUnsafe(blocksize),a=0;a<blocksize;a++)i[a]=54^s[a],t[a]=92^s[a];this._hash=[i]}var inherits=require("inherits"),Buffer=require("safe-buffer").Buffer,Base=require("cipher-base"),ZEROS=Buffer.alloc(128),blocksize=64;inherits(Hmac,Base),Hmac.prototype._update=function(e){this._hash.push(e)},Hmac.prototype._final=function(){var e=this._alg(Buffer.concat(this._hash));return this._alg(Buffer.concat([this._opad,e]))},module.exports=Hmac;

},{"cipher-base":69,"inherits":144,"safe-buffer":244}],83:[function(require,module,exports){
(function (process,global,Buffer){
function createTorrent(e,t,n){if("function"==typeof t)return createTorrent(e,null,t);t=t?extend(t):{},_parseInput(e,t,function(e,r,i){if(e)return n(e);t.singleFileTorrent=i,onFiles(r,t,n)})}function parseInput(e,t,n){if("function"==typeof t)return parseInput(e,null,t);t=t?extend(t):{},_parseInput(e,t,n)}function _parseInput(e,t,n){function r(){parallel(e.map(function(e){return function(t){var n={};if(isBlob(e))n.getStream=getBlobStream(e),n.length=e.size;else if(Buffer.isBuffer(e))n.getStream=getBufferStream(e),n.length=e.length;else{if(!isReadable(e)){if("string"==typeof e){if("function"!=typeof fs.stat)throw new Error("filesystem paths do not work in the browser");var r=o>1||a;return void getFiles(e,r,t)}throw new Error("invalid input type")}n.getStream=getStreamStream(e,n),n.length=0}n.path=e.path,t(null,n)}}),function(e,t){if(e)return n(e);t=flatten(t),n(null,t,a)})}if(Array.isArray(e)&&0===e.length)throw new Error("invalid input type");isFileList(e)&&(e=Array.prototype.slice.call(e)),Array.isArray(e)||(e=[e]),e=e.map(function(e){return isBlob(e)&&"string"==typeof e.path&&"function"==typeof fs.stat?e.path:e}),1!==e.length||"string"==typeof e[0]||e[0].name||(e[0].name=t.name);var i=null;e.forEach(function(t,n){if("string"!=typeof t){var r=t.fullPath||t.name;r||(r="Unknown File "+(n+1),t.unknownName=!0),t.path=r.split("/"),t.path[0]||t.path.shift(),t.path.length<2?i=null:0===n&&e.length>1?i=t.path[0]:t.path[0]!==i&&(i=null)}}),e=e.filter(function(e){if("string"==typeof e)return!0;var t=e.path[e.path.length-1];return notHidden(t)&&junk.not(t)}),i&&e.forEach(function(e){var t=(Buffer.isBuffer(e)||isReadable(e))&&!e.path;"string"==typeof e||t||e.path.shift()}),!t.name&&i&&(t.name=i),t.name||e.some(function(e){return"string"==typeof e?(t.name=corePath.basename(e),!0):e.unknownName?void 0:(t.name=e.path[e.path.length-1],!0)}),t.name||(t.name="Unnamed Torrent "+Date.now());var o=e.reduce(function(e,t){return e+Number("string"==typeof t)},0),a=1===e.length;if(1===e.length&&"string"==typeof e[0]){if("function"!=typeof fs.stat)throw new Error("filesystem paths do not work in the browser");isFile(e[0],function(e,t){if(e)return n(e);a=t,r()})}else process.nextTick(function(){r()})}function getFiles(e,t,n){traversePath(e,getFileInfo,function(r,i){if(r)return n(r);i=Array.isArray(i)?flatten(i):[i],e=corePath.normalize(e),t&&(e=e.slice(0,e.lastIndexOf(corePath.sep)+1)),e[e.length-1]!==corePath.sep&&(e+=corePath.sep),i.forEach(function(t){t.getStream=getFilePathStream(t.path),t.path=t.path.replace(e,"").split(corePath.sep)}),n(null,i)})}function getFileInfo(e,t){t=once(t),fs.stat(e,function(n,r){if(n)return t(n);var i={length:r.size,path:e};t(null,i)})}function traversePath(e,t,n){fs.stat(e,function(r,i){if(r)return n(r);i.isDirectory()?fs.readdir(e,function(r,i){if(r)return n(r);parallel(i.filter(notHidden).filter(junk.not).map(function(n){return function(r){traversePath(corePath.join(e,n),t,r)}}),n)}):i.isFile()&&t(e,n)})}function notHidden(e){return"."!==e[0]}function getPieceList(e,t,n){function r(e){s+=e.length;var t=p;sha1(e,function(e){f[t]=e,c-=1,u()}),c+=1,p+=1}function i(){h=!0,u()}function o(e){a(),n(e)}function a(){m.removeListener("error",o),g.removeListener("data",r),g.removeListener("end",i),g.removeListener("error",o)}function u(){h&&0===c&&(a(),n(null,Buffer.from(f.join(""),"hex"),s))}n=once(n);var f=[],s=0,l=e.map(function(e){return e.getStream}),c=0,p=0,h=!1,m=new MultiStream(l),g=new BlockStream(t,{zeroPadding:!1});m.on("error",o),m.pipe(g).on("data",r).on("end",i).on("error",o)}function onFiles(e,t,n){var r=t.announceList;r||("string"==typeof t.announce?r=[[t.announce]]:Array.isArray(t.announce)&&(r=t.announce.map(function(e){return[e]}))),r||(r=[]),global.WEBTORRENT_ANNOUNCE&&("string"==typeof global.WEBTORRENT_ANNOUNCE?r.push([[global.WEBTORRENT_ANNOUNCE]]):Array.isArray(global.WEBTORRENT_ANNOUNCE)&&(r=r.concat(global.WEBTORRENT_ANNOUNCE.map(function(e){return[e]})))),void 0===t.announce&&void 0===t.announceList&&(r=r.concat(module.exports.announceList)),"string"==typeof t.urlList&&(t.urlList=[t.urlList]);var i={info:{name:t.name},"creation date":Math.ceil((Number(t.creationDate)||Date.now())/1e3),encoding:"UTF-8"};0!==r.length&&(i.announce=r[0][0],i["announce-list"]=r),void 0!==t.comment&&(i.comment=t.comment),void 0!==t.createdBy&&(i["created by"]=t.createdBy),void 0!==t.private&&(i.info.private=Number(t.private)),void 0!==t.sslCert&&(i.info["ssl-cert"]=t.sslCert),void 0!==t.urlList&&(i["url-list"]=t.urlList);var o=t.pieceLength||calcPieceLength(e.reduce(sumLength,0));i.info["piece length"]=o,getPieceList(e,o,function(r,o,a){if(r)return n(r);i.info.pieces=o,e.forEach(function(e){delete e.getStream}),t.singleFileTorrent?i.info.length=a:i.info.files=e,n(null,bencode.encode(i))})}function sumLength(e,t){return e+t.length}function isBlob(e){return"undefined"!=typeof Blob&&e instanceof Blob}function isFileList(e){return"undefined"!=typeof FileList&&e instanceof FileList}function isReadable(e){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}function getBlobStream(e){return function(){return new FileReadStream(e)}}function getBufferStream(e){return function(){var t=new stream.PassThrough;return t.end(e),t}}function getFilePathStream(e){return function(){return fs.createReadStream(e)}}function getStreamStream(e,t){return function(){var n=new stream.Transform;return n._transform=function(e,n,r){t.length+=e.length,this.push(e),r()},e.pipe(n),n}}module.exports=createTorrent,module.exports.parseInput=parseInput,module.exports.announceList=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.fastcast.nz"]];var bencode=require("bencode"),BlockStream=require("block-stream2"),calcPieceLength=require("piece-length"),corePath=require("path"),extend=require("xtend"),FileReadStream=require("filestream/read"),flatten=require("flatten"),fs=require("fs"),isFile=require("is-file"),junk=require("junk"),MultiStream=require("multistream"),once=require("once"),parallel=require("run-parallel"),sha1=require("simple-sha1"),stream=require("readable-stream");

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"_process":205,"bencode":86,"block-stream2":34,"buffer":66,"filestream/read":123,"flatten":124,"fs":63,"is-file":147,"junk":164,"multistream":181,"once":186,"path":197,"piece-length":203,"readable-stream":235,"run-parallel":242,"simple-sha1":258,"xtend":324}],84:[function(require,module,exports){
arguments[4][22][0].apply(exports,arguments)
},{"buffer":66,"dup":22}],85:[function(require,module,exports){
arguments[4][23][0].apply(exports,arguments)
},{"dup":23,"safe-buffer":244}],86:[function(require,module,exports){
arguments[4][24][0].apply(exports,arguments)
},{"./decode":84,"./encode":85,"dup":24}],87:[function(require,module,exports){
"use strict";exports.randomBytes=exports.rng=exports.pseudoRandomBytes=exports.prng=require("randombytes"),exports.createHash=exports.Hash=require("create-hash"),exports.createHmac=exports.Hmac=require("create-hmac");var algos=require("browserify-sign/algos"),algoKeys=Object.keys(algos),hashes=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(algoKeys);exports.getHashes=function(){return hashes};var p=require("pbkdf2");exports.pbkdf2=p.pbkdf2,exports.pbkdf2Sync=p.pbkdf2Sync;var aes=require("browserify-cipher");exports.Cipher=aes.Cipher,exports.createCipher=aes.createCipher,exports.Cipheriv=aes.Cipheriv,exports.createCipheriv=aes.createCipheriv,exports.Decipher=aes.Decipher,exports.createDecipher=aes.createDecipher,exports.Decipheriv=aes.Decipheriv,exports.createDecipheriv=aes.createDecipheriv,exports.getCiphers=aes.getCiphers,exports.listCiphers=aes.listCiphers;var dh=require("diffie-hellman");exports.DiffieHellmanGroup=dh.DiffieHellmanGroup,exports.createDiffieHellmanGroup=dh.createDiffieHellmanGroup,exports.getDiffieHellman=dh.getDiffieHellman,exports.createDiffieHellman=dh.createDiffieHellman,exports.DiffieHellman=dh.DiffieHellman;var sign=require("browserify-sign");exports.createSign=sign.createSign,exports.Sign=sign.Sign,exports.createVerify=sign.createVerify,exports.Verify=sign.Verify,exports.createECDH=require("create-ecdh");var publicEncrypt=require("public-encrypt");exports.publicEncrypt=publicEncrypt.publicEncrypt,exports.privateEncrypt=publicEncrypt.privateEncrypt,exports.publicDecrypt=publicEncrypt.publicDecrypt,exports.privateDecrypt=publicEncrypt.privateDecrypt,exports.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},exports.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6};

},{"browserify-cipher":53,"browserify-sign":60,"browserify-sign/algos":57,"create-ecdh":77,"create-hash":78,"create-hmac":81,"diffie-hellman":97,"pbkdf2":198,"public-encrypt":206,"randombytes":223}],88:[function(require,module,exports){
(function (process){
function useColors(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function formatArgs(e){var o=this.useColors;if(e[0]=(o?"%c":"")+this.namespace+(o?" %c":" ")+e[0]+(o?"%c ":" ")+"+"+exports.humanize(this.diff),o){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(t++,"%c"===e&&(n=t))}),e.splice(n,0,r)}}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(e){try{null==e?exports.storage.removeItem("debug"):exports.storage.debug=e}catch(e){}}function load(){var e;try{e=exports.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}function localstorage(){try{return window.localStorage}catch(e){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},exports.enable(load());
}).call(this,require('_process'))
},{"./debug":89,"_process":205}],89:[function(require,module,exports){
function selectColor(e){var r,t=0;for(r in e)t=(t<<5)-t+e.charCodeAt(r),t|=0;return exports.colors[Math.abs(t)%exports.colors.length]}function createDebug(e){function r(){if(r.enabled){var e=r,t=+new Date,o=t-(prevTime||t);e.diff=o,e.prev=prevTime,e.curr=t,prevTime=t;for(var s=new Array(arguments.length),n=0;n<s.length;n++)s[n]=arguments[n];s[0]=exports.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var p=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,t){if("%%"===r)return r;p++;var o=exports.formatters[t];if("function"==typeof o){var n=s[p];r=o.call(e,n),s.splice(p,1),p--}return r}),exports.formatArgs.call(e,s);(r.log||exports.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=exports.enabled(e),r.useColors=exports.useColors(),r.color=selectColor(e),"function"==typeof exports.init&&exports.init(r),r}function enable(e){exports.save(e),exports.names=[],exports.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),t=r.length,o=0;o<t;o++)r[o]&&(e=r[o].replace(/\*/g,".*?"),"-"===e[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,t;for(r=0,t=exports.skips.length;r<t;r++)if(exports.skips[r].test(e))return!1;for(r=0,t=exports.names.length;r<t;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}exports=module.exports=createDebug.debug=createDebug.default=createDebug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime;

},{"ms":179}],90:[function(require,module,exports){
module.exports=function(){for(var o=0;o<arguments.length;o++)if(void 0!==arguments[o])return arguments[o]};

},{}],91:[function(require,module,exports){
"use strict";exports.utils=require("./des/utils"),exports.Cipher=require("./des/cipher"),exports.DES=require("./des/des"),exports.CBC=require("./des/cbc"),exports.EDE=require("./des/ede");
},{"./des/cbc":92,"./des/cipher":93,"./des/des":94,"./des/ede":95,"./des/utils":96}],92:[function(require,module,exports){
"use strict";function CBCState(t){assert.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var i=0;i<this.iv.length;i++)this.iv[i]=t[i]}function instantiate(t){function i(i){t.call(this,i),this._cbcInit()}inherits(i,t);for(var e=Object.keys(proto),r=0;r<e.length;r++){var n=e[r];i.prototype[n]=proto[n]}return i.create=function(t){return new i(t)},i}var assert=require("minimalistic-assert"),inherits=require("inherits"),proto={};exports.instantiate=instantiate,proto._cbcInit=function(){var t=new CBCState(this.options.iv);this._cbcState=t},proto._update=function(t,i,e,r){var n=this._cbcState,s=this.constructor.super_.prototype,o=n.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)o[a]^=t[i+a];s._update.call(this,o,0,e,r);for(var a=0;a<this.blockSize;a++)o[a]=e[r+a]}else{s._update.call(this,t,i,e,r);for(var a=0;a<this.blockSize;a++)e[r+a]^=o[a];for(var a=0;a<this.blockSize;a++)o[a]=t[i+a]}};

},{"inherits":144,"minimalistic-assert":170}],93:[function(require,module,exports){
"use strict";function Cipher(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var assert=require("minimalistic-assert");module.exports=Cipher,Cipher.prototype._init=function(){},Cipher.prototype.update=function(t){return 0===t.length?[]:"decrypt"===this.type?this._updateDecrypt(t):this._updateEncrypt(t)},Cipher.prototype._buffer=function(t,e){for(var r=Math.min(this.buffer.length-this.bufferOff,t.length-e),i=0;i<r;i++)this.buffer[this.bufferOff+i]=t[e+i];return this.bufferOff+=r,r},Cipher.prototype._flushBuffer=function(t,e){return this._update(this.buffer,0,t,e),this.bufferOff=0,this.blockSize},Cipher.prototype._updateEncrypt=function(t){var e=0,r=0,i=(this.bufferOff+t.length)/this.blockSize|0,f=new Array(i*this.blockSize);0!==this.bufferOff&&(e+=this._buffer(t,e),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(f,r)));for(var h=t.length-(t.length-e)%this.blockSize;e<h;e+=this.blockSize)this._update(t,e,f,r),r+=this.blockSize;for(;e<t.length;e++,this.bufferOff++)this.buffer[this.bufferOff]=t[e];return f},Cipher.prototype._updateDecrypt=function(t){for(var e=0,r=0,i=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,f=new Array(i*this.blockSize);i>0;i--)e+=this._buffer(t,e),r+=this._flushBuffer(f,r);return e+=this._buffer(t,e),f},Cipher.prototype.final=function(t){var e;t&&(e=this.update(t));var r;return r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),e?e.concat(r):r},Cipher.prototype._pad=function(t,e){if(0===e)return!1;for(;e<t.length;)t[e++]=0;return!0},Cipher.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},Cipher.prototype._unpad=function(t){return t},Cipher.prototype._finalDecrypt=function(){assert.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)};

},{"minimalistic-assert":170}],94:[function(require,module,exports){
"use strict";function DESState(){this.tmp=new Array(2),this.keys=null}function DES(t){Cipher.call(this,t);var e=new DESState;this._desState=e,this.deriveKeys(e,t.key)}var assert=require("minimalistic-assert"),inherits=require("inherits"),des=require("../des"),utils=des.utils,Cipher=des.Cipher;inherits(DES,Cipher),module.exports=DES,DES.create=function(t){return new DES(t)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function(t,e){t.keys=new Array(32),assert.equal(e.length,this.blockSize,"Invalid key length");var r=utils.readUInt32BE(e,0),s=utils.readUInt32BE(e,4);utils.pc1(r,s,t.tmp,0),r=t.tmp[0],s=t.tmp[1];for(var i=0;i<t.keys.length;i+=2){var n=shiftTable[i>>>1];r=utils.r28shl(r,n),s=utils.r28shl(s,n),utils.pc2(r,s,t.keys,i)}},DES.prototype._update=function(t,e,r,s){var i=this._desState,n=utils.readUInt32BE(t,e),p=utils.readUInt32BE(t,e+4);utils.ip(n,p,i.tmp,0),n=i.tmp[0],p=i.tmp[1],"encrypt"===this.type?this._encrypt(i,n,p,i.tmp,0):this._decrypt(i,n,p,i.tmp,0),n=i.tmp[0],p=i.tmp[1],utils.writeUInt32BE(r,n,s),utils.writeUInt32BE(r,p,s+4)},DES.prototype._pad=function(t,e){for(var r=t.length-e,s=e;s<t.length;s++)t[s]=r;return!0},DES.prototype._unpad=function(t){for(var e=t[t.length-1],r=t.length-e;r<t.length;r++)assert.equal(t[r],e);return t.slice(0,t.length-e)},DES.prototype._encrypt=function(t,e,r,s,i){for(var n=e,p=r,u=0;u<t.keys.length;u+=2){var l=t.keys[u],a=t.keys[u+1];utils.expand(p,t.tmp,0),l^=t.tmp[0],a^=t.tmp[1];var h=utils.substitute(l,a),o=utils.permute(h),y=p;p=(n^o)>>>0,n=y}utils.rip(p,n,s,i)},DES.prototype._decrypt=function(t,e,r,s,i){for(var n=r,p=e,u=t.keys.length-2;u>=0;u-=2){var l=t.keys[u],a=t.keys[u+1];utils.expand(n,t.tmp,0),l^=t.tmp[0],a^=t.tmp[1];var h=utils.substitute(l,a),o=utils.permute(h),y=n;n=(p^o)>>>0,p=y}utils.rip(n,p,s,i)};

},{"../des":91,"inherits":144,"minimalistic-assert":170}],95:[function(require,module,exports){
"use strict";function EDEState(e,t){assert.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),p=t.slice(8,16),i=t.slice(16,24);this.ciphers="encrypt"===e?[DES.create({type:"encrypt",key:r}),DES.create({type:"decrypt",key:p}),DES.create({type:"encrypt",key:i})]:[DES.create({type:"decrypt",key:i}),DES.create({type:"encrypt",key:p}),DES.create({type:"decrypt",key:r})]}function EDE(e){Cipher.call(this,e);var t=new EDEState(this.type,this.options.key);this._edeState=t}var assert=require("minimalistic-assert"),inherits=require("inherits"),des=require("../des"),Cipher=des.Cipher,DES=des.DES;inherits(EDE,Cipher),module.exports=EDE,EDE.create=function(e){return new EDE(e)},EDE.prototype._update=function(e,t,r,p){var i=this._edeState;i.ciphers[0]._update(e,t,r,p),i.ciphers[1]._update(r,p,r,p),i.ciphers[2]._update(r,p,r,p)},EDE.prototype._pad=DES.prototype._pad,EDE.prototype._unpad=DES.prototype._unpad;

},{"../des":91,"inherits":144,"minimalistic-assert":170}],96:[function(require,module,exports){
"use strict";exports.readUInt32BE=function(r,o){return(r[0+o]<<24|r[1+o]<<16|r[2+o]<<8|r[3+o])>>>0},exports.writeUInt32BE=function(r,o,t){r[0+t]=o>>>24,r[1+t]=o>>>16&255,r[2+t]=o>>>8&255,r[3+t]=255&o},exports.ip=function(r,o,t,a){for(var e=0,f=0,n=6;n>=0;n-=2){for(var v=0;v<=24;v+=8)e<<=1,e|=o>>>v+n&1;for(var v=0;v<=24;v+=8)e<<=1,e|=r>>>v+n&1}for(var n=6;n>=0;n-=2){for(var v=1;v<=25;v+=8)f<<=1,f|=o>>>v+n&1;for(var v=1;v<=25;v+=8)f<<=1,f|=r>>>v+n&1}t[a+0]=e>>>0,t[a+1]=f>>>0},exports.rip=function(r,o,t,a){for(var e=0,f=0,n=0;n<4;n++)for(var v=24;v>=0;v-=8)e<<=1,e|=o>>>v+n&1,e<<=1,e|=r>>>v+n&1;for(var n=4;n<8;n++)for(var v=24;v>=0;v-=8)f<<=1,f|=o>>>v+n&1,f<<=1,f|=r>>>v+n&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.pc1=function(r,o,t,a){for(var e=0,f=0,n=7;n>=5;n--){for(var v=0;v<=24;v+=8)e<<=1,e|=o>>v+n&1;for(var v=0;v<=24;v+=8)e<<=1,e|=r>>v+n&1}for(var v=0;v<=24;v+=8)e<<=1,e|=o>>v+n&1;for(var n=1;n<=3;n++){for(var v=0;v<=24;v+=8)f<<=1,f|=o>>v+n&1;for(var v=0;v<=24;v+=8)f<<=1,f|=r>>v+n&1}for(var v=0;v<=24;v+=8)f<<=1,f|=r>>v+n&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.r28shl=function(r,o){return r<<o&268435455|r>>>28-o};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];exports.pc2=function(r,o,t,a){for(var e=0,f=0,n=pc2table.length>>>1,v=0;v<n;v++)e<<=1,e|=r>>>pc2table[v]&1;for(var v=n;v<pc2table.length;v++)f<<=1,f|=o>>>pc2table[v]&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.expand=function(r,o,t){var a=0,e=0;a=(1&r)<<5|r>>>27;for(var f=23;f>=15;f-=4)a<<=6,a|=r>>>f&63;for(var f=11;f>=3;f-=4)e|=r>>>f&63,e<<=6;e|=(31&r)<<1|r>>>31,o[t+0]=a>>>0,o[t+1]=e>>>0};var sTable=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];exports.substitute=function(r,o){for(var t=0,a=0;a<4;a++){var e=r>>>18-6*a&63,f=sTable[64*a+e];t<<=4,t|=f}for(var a=0;a<4;a++){var e=o>>>18-6*a&63,f=sTable[256+64*a+e];t<<=4,t|=f}return t>>>0};var permuteTable=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];exports.permute=function(r){for(var o=0,t=0;t<permuteTable.length;t++)o<<=1,o|=r>>>permuteTable[t]&1;return o>>>0},exports.padSplit=function(r,o,t){for(var a=r.toString(2);a.length<o;)a="0"+a;for(var e=[],f=0;f<o;f+=t)e.push(a.slice(f,f+t));return e.join(" ")};

},{}],97:[function(require,module,exports){
(function (Buffer){
function getDiffieHellman(e){var r=new Buffer(primes[e].prime,"hex"),f=new Buffer(primes[e].gen,"hex");return new DH(r,f)}function createDiffieHellman(e,r,f,i){return Buffer.isBuffer(r)||void 0===ENCODINGS[r]?createDiffieHellman(e,"binary",r,f):(r=r||"binary",i=i||"binary",f=f||new Buffer([2]),Buffer.isBuffer(f)||(f=new Buffer(f,i)),"number"==typeof e?new DH(generatePrime(e,f),f,!0):(Buffer.isBuffer(e)||(e=new Buffer(e,r)),new DH(e,f,!0)))}var generatePrime=require("./lib/generatePrime"),primes=require("./lib/primes.json"),DH=require("./lib/dh"),ENCODINGS={binary:!0,hex:!0,base64:!0};exports.DiffieHellmanGroup=exports.createDiffieHellmanGroup=exports.getDiffieHellman=getDiffieHellman,exports.createDiffieHellman=exports.DiffieHellman=createDiffieHellman;

}).call(this,require("buffer").Buffer)
},{"./lib/dh":98,"./lib/generatePrime":99,"./lib/primes.json":100,"buffer":66}],98:[function(require,module,exports){
(function (Buffer){
function setPublicKey(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this._pub=new BN(e),this}function setPrivateKey(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this._priv=new BN(e),this}function checkPrime(e,r){var t=r.toString("hex"),i=[t,e.toString(16)].join("_");if(i in primeCache)return primeCache[i];var n=0;if(e.isEven()||!primes.simpleSieve||!primes.fermatTest(e)||!millerRabin.test(e))return n+=1,n+="02"===t||"05"===t?8:4,primeCache[i]=n,n;millerRabin.test(e.shrn(1))||(n+=2);var u;switch(t){case"02":e.mod(TWENTYFOUR).cmp(ELEVEN)&&(n+=8);break;case"05":u=e.mod(TEN),u.cmp(THREE)&&u.cmp(SEVEN)&&(n+=8);break;default:n+=4}return primeCache[i]=n,n}function DH(e,r,t){this.setGenerator(r),this.__prime=new BN(e),this._prime=BN.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,t?(this.setPublicKey=setPublicKey,this.setPrivateKey=setPrivateKey):this._primeCode=8}function formatReturnValue(e,r){var t=new Buffer(e.toArray());return r?t.toString(r):t}var BN=require("bn.js"),MillerRabin=require("miller-rabin"),millerRabin=new MillerRabin,TWENTYFOUR=new BN(24),ELEVEN=new BN(11),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),primes=require("./generatePrime"),randomBytes=require("randombytes");module.exports=DH;var primeCache={};Object.defineProperty(DH.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=checkPrime(this.__prime,this.__gen)),this._primeCode}}),DH.prototype.generateKeys=function(){return this._priv||(this._priv=new BN(randomBytes(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},DH.prototype.computeSecret=function(e){e=new BN(e),e=e.toRed(this._prime);var r=e.redPow(this._priv).fromRed(),t=new Buffer(r.toArray()),i=this.getPrime();if(t.length<i.length){var n=new Buffer(i.length-t.length);n.fill(0),t=Buffer.concat([n,t])}return t},DH.prototype.getPublicKey=function(e){return formatReturnValue(this._pub,e)},DH.prototype.getPrivateKey=function(e){return formatReturnValue(this._priv,e)},DH.prototype.getPrime=function(e){return formatReturnValue(this.__prime,e)},DH.prototype.getGenerator=function(e){return formatReturnValue(this._gen,e)},DH.prototype.setGenerator=function(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this.__gen=e,this._gen=new BN(e),this};

}).call(this,require("buffer").Buffer)
},{"./generatePrime":99,"bn.js":35,"buffer":66,"miller-rabin":169,"randombytes":223}],99:[function(require,module,exports){
function _getPrimes(){if(null!==primes)return primes;var e=[];e[0]=2;for(var r=1,i=3;i<1048576;i+=2){for(var n=Math.ceil(Math.sqrt(i)),t=0;t<r&&e[t]<=n&&i%e[t]!=0;t++);r!==t&&e[t]<=n||(e[r++]=i)}return primes=e,e}function simpleSieve(e){for(var r=_getPrimes(),i=0;i<r.length;i++)if(0===e.modn(r[i]))return 0===e.cmpn(r[i]);return!0}function fermatTest(e){var r=BN.mont(e);return 0===TWO.toRed(r).redPow(e.subn(1)).fromRed().cmpn(1)}function findPrime(e,r){if(e<16)return new BN(2===r||5===r?[140,123]:[140,39]);r=new BN(r);for(var i,n;;){for(i=new BN(randomBytes(Math.ceil(e/8)));i.bitLength()>e;)i.ishrn(1);if(i.isEven()&&i.iadd(ONE),i.testn(1)||i.iadd(TWO),r.cmp(TWO)){if(!r.cmp(FIVE))for(;i.mod(TEN).cmp(THREE);)i.iadd(FOUR)}else for(;i.mod(TWENTYFOUR).cmp(ELEVEN);)i.iadd(FOUR);if(n=i.shrn(1),simpleSieve(n)&&simpleSieve(i)&&fermatTest(n)&&fermatTest(i)&&millerRabin.test(n)&&millerRabin.test(i))return i}}var randomBytes=require("randombytes");module.exports=findPrime,findPrime.simpleSieve=simpleSieve,findPrime.fermatTest=fermatTest;var BN=require("bn.js"),TWENTYFOUR=new BN(24),MillerRabin=require("miller-rabin"),millerRabin=new MillerRabin,ONE=new BN(1),TWO=new BN(2),FIVE=new BN(5),SIXTEEN=new BN(16),EIGHT=new BN(8),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),ELEVEN=new BN(11),FOUR=new BN(4),TWELVE=new BN(12),primes=null;

},{"bn.js":35,"miller-rabin":169,"randombytes":223}],100:[function(require,module,exports){
module.exports={
    "modp1": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"
    },
    "modp2": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"
    },
    "modp5": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"
    },
    "modp14": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"
    },
    "modp15": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"
    },
    "modp16": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"
    },
    "modp17": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"
    },
    "modp18": {
        "gen": "02",
        "prime": "ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"
    }
}
},{}],101:[function(require,module,exports){
function dragDrop(e,r){function t(e){return r.onDragEnter&&r.onDragEnter(e),e.stopPropagation(),e.preventDefault(),!1}function n(t){if(t.stopPropagation(),t.preventDefault(),t.dataTransfer.items){var n=toArray(t.dataTransfer.items),a=n.filter(function(e){return"file"===e.kind}),o=n.filter(function(e){return"string"===e.kind});if(0===a.length&&!r.onDropText)return;if(0===o.length&&!r.onDrop)return;if(0===a.length&&0===o.length)return}return e.classList.add("drag"),clearTimeout(l),r.onDragOver&&r.onDragOver(t),t.dataTransfer.dropEffect="copy",!1}function a(e){return e.stopPropagation(),e.preventDefault(),r.onDragLeave&&r.onDragLeave(e),clearTimeout(l),l=setTimeout(i,50),!1}function o(e){e.stopPropagation(),e.preventDefault(),r.onDragLeave&&r.onDragLeave(e),clearTimeout(l),i();var t={x:e.clientX,y:e.clientY},n=e.dataTransfer.getData("text");if(n&&r.onDropText&&r.onDropText(n,t),e.dataTransfer.items){var a=toArray(e.dataTransfer.items).filter(function(e){return"file"===e.kind});if(0===a.length)return;parallel(a.map(function(e){return function(r){processEntry(e.webkitGetAsEntry(),r)}}),function(e,n){if(e)throw e;r.onDrop&&r.onDrop(flatten(n),t)})}else{var o=toArray(e.dataTransfer.files);if(0===o.length)return;o.forEach(function(e){e.fullPath="/"+e.name}),r.onDrop&&r.onDrop(o,t)}return!1}function i(){e.classList.remove("drag")}if("string"==typeof e){var f=e;if(!(e=window.document.querySelector(e)))throw new Error('"'+f+'" does not match any HTML elements')}if(!e)throw new Error('"'+e+'" is not a valid HTML element');"function"==typeof r&&(r={onDrop:r});var l;return e.addEventListener("dragenter",t,!1),e.addEventListener("dragover",n,!1),e.addEventListener("dragleave",a,!1),e.addEventListener("drop",o,!1),function(){i(),e.removeEventListener("dragenter",t,!1),e.removeEventListener("dragover",n,!1),e.removeEventListener("dragleave",a,!1),e.removeEventListener("drop",o,!1)}}function processEntry(e,r){function t(){o.readEntries(function(e){e.length>0?(a=a.concat(toArray(e)),t()):n()})}function n(){parallel(a.map(function(e){return function(r){processEntry(e,r)}}),r)}var a=[];if(e.isFile)e.file(function(t){t.fullPath=e.fullPath,r(null,t)},function(e){r(e)});else if(e.isDirectory){var o=e.createReader();t()}}function toArray(e){return Array.prototype.slice.call(e||[],0)}module.exports=dragDrop;var flatten=require("flatten"),parallel=require("run-parallel");
},{"flatten":124,"run-parallel":242}],102:[function(require,module,exports){
(function (process){
var Stream=require("stream");module.exports=function(e,n){var t,a=new Stream,r=[],u=!1,d=!1;a.writable=a.readable=!0,a.paused=!1,a._paused=!1,a.buffer=r,a.on("pause",function(){a._paused=!0}).on("drain",function(){a._paused=!1}),e&&a.on("_data",e),n&&a.on("_end",n),a.once("end",function(){a.readable=!1,a.writable||process.nextTick(function(){a.destroy()})}),a.once("_end",function(){a.writable=!1,a.readable||a.destroy()}),a._data=function(e){return a.paused||r.length?r.push(e):a.emit("data",e),!(a.paused||r.length)},a._end=function(e){e&&a._data(e),t||(t=!0,a.drain())},a.write=function(e){return a.emit("_data",e),!a._paused},a.end=function(){a.writable=!1,a.ended||(a.ended=!0,a.emit("_end"))},a.drain=function(){if(r.length||t)for(;!a.paused;){if(!r.length)return!t||!a.readable||(a.readable=!1,void a.emit("end"));a.emit("data",r.shift()),0==r.length&&a.emit("_drain")}};var i=!1;a.resume=function(){return i=!0,a.paused=!1,a.drain(),a},a.destroy=function(){d||(d=u=!0,r.length=0,a.emit("close"))};return a.pause=function(){return i=!0,a.paused=!0,a.emit("_pause"),a},a._pause=function(){return a._paused||(a._paused=!0,a.emit("pause")),this},a.paused=!0,process.nextTick(function(){i||a.resume()}),a};

}).call(this,require('_process'))
},{"_process":205,"stream":269}],103:[function(require,module,exports){
(function (process,Buffer){
var stream=require("readable-stream"),eos=require("end-of-stream"),inherits=require("inherits"),shift=require("stream-shift"),SIGNAL_FLUSH=new Buffer([0]),onuncork=function(e,t){e._corked?e.once("uncork",t):t()},destroyer=function(e,t){return function(i){i?e.destroy("premature close"===i.message?null:i):t&&!e._ended&&e.end()}},end=function(e,t){return e?e._writableState&&e._writableState.finished?t():e._writableState?e.end(t):(e.end(),void t()):t()},toStreams2=function(e){return new stream.Readable({objectMode:!0,highWaterMark:16}).wrap(e)},Duplexify=function(e,t,i){if(!(this instanceof Duplexify))return new Duplexify(e,t,i);stream.Duplex.call(this,i),this._writable=null,this._readable=null,this._readable2=null,this._forwardDestroy=!i||!1!==i.destroy,this._forwardEnd=!i||!1!==i.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};inherits(Duplexify,stream.Duplex),Duplexify.obj=function(e,t,i){return i||(i={}),i.objectMode=!0,i.highWaterMark=16,new Duplexify(e,t,i)},Duplexify.prototype.cork=function(){1==++this._corked&&this.emit("cork")},Duplexify.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},Duplexify.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)return void(e&&e.destroy&&e.destroy());if(null===e||!1===e)return void this.end();var t=this,i=eos(e,{writable:!0,readable:!1},destroyer(this,this._forwardEnd)),r=function(){var e=t._ondrain;t._ondrain=null,e&&e()},n=function(){t._writable.removeListener("drain",r),i()};this._unwrite&&process.nextTick(r),this._writable=e,this._writable.on("drain",r),this._unwrite=n,this.uncork()},Duplexify.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)return void(e&&e.destroy&&e.destroy());if(null===e||!1===e)return this.push(null),void this.resume();var t=this,i=eos(e,{writable:!1,readable:!0},destroyer(this)),r=function(){t._forward()},n=function(){t.push(null)},s=function(){t._readable2.removeListener("readable",r),t._readable2.removeListener("end",n),i()};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:toStreams2(e),this._readable2.on("readable",r),this._readable2.on("end",n),this._unread=s,this._forward()},Duplexify.prototype._read=function(){this._drained=!0,this._forward()},Duplexify.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){this._forwarding=!0;for(var e;this._drained&&null!==(e=shift(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},Duplexify.prototype.destroy=function(e){if(!this.destroyed){this.destroyed=!0;var t=this;process.nextTick(function(){t._destroy(e)})}},Duplexify.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},Duplexify.prototype._write=function(e,t,i){return this.destroyed?i():this._corked?onuncork(this,this._write.bind(this,e,t,i)):e===SIGNAL_FLUSH?this._finish(i):this._writable?void(!1===this._writable.write(e)?this._ondrain=i:i()):i()},Duplexify.prototype._finish=function(e){var t=this;this.emit("preend"),onuncork(this,function(){end(t._forwardEnd&&t._writable,function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),onuncork(t,e)})})},Duplexify.prototype.end=function(e,t,i){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this.write(SIGNAL_FLUSH),stream.Writable.prototype.end.call(this,i))},module.exports=Duplexify;

}).call(this,require('_process'),require("buffer").Buffer)
},{"_process":205,"buffer":66,"end-of-stream":120,"inherits":144,"readable-stream":235,"stream-shift":275}],104:[function(require,module,exports){
"use strict";var elliptic=exports;elliptic.version=require("../package.json").version,elliptic.utils=require("./elliptic/utils"),elliptic.rand=require("brorand"),elliptic.curve=require("./elliptic/curve"),elliptic.curves=require("./elliptic/curves"),elliptic.ec=require("./elliptic/ec"),elliptic.eddsa=require("./elliptic/eddsa");
},{"../package.json":119,"./elliptic/curve":107,"./elliptic/curves":110,"./elliptic/ec":111,"./elliptic/eddsa":114,"./elliptic/utils":118,"brorand":36}],105:[function(require,module,exports){
"use strict";function BaseCurve(t,e){this.type=t,this.p=new BN(e.p,16),this.red=e.prime?BN.red(e.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=e.n&&new BN(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function BasePoint(t,e){this.curve=t,this.type=e,this.precomputed=null}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,getNAF=utils.getNAF,getJSF=utils.getJSF,assert=utils.assert;module.exports=BaseCurve,BaseCurve.prototype.point=function(){throw new Error("Not implemented")},BaseCurve.prototype.validate=function(){throw new Error("Not implemented")},BaseCurve.prototype._fixedNafMul=function(t,e){assert(t.precomputed);var r=t._getDoubles(),n=getNAF(e,1),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;for(var o=[],s=0;s<n.length;s+=r.step){for(var a=0,e=s+r.step-1;e>=s;e--)a=(a<<1)+n[e];o.push(a)}for(var p=this.jpoint(null,null,null),u=this.jpoint(null,null,null),d=i;d>0;d--){for(var s=0;s<o.length;s++){var a=o[s];a===d?u=u.mixedAdd(r.points[s]):a===-d&&(u=u.mixedAdd(r.points[s].neg()))}p=p.add(u)}return p.toP()},BaseCurve.prototype._wnafMul=function(t,e){var r=4,n=t._getNAFPoints(r);r=n.wnd;for(var i=n.points,o=getNAF(e,r),s=this.jpoint(null,null,null),a=o.length-1;a>=0;a--){for(var e=0;a>=0&&0===o[a];a--)e++;if(a>=0&&e++,s=s.dblp(e),a<0)break;var p=o[a];assert(0!==p),s="affine"===t.type?p>0?s.mixedAdd(i[p-1>>1]):s.mixedAdd(i[-p-1>>1].neg()):p>0?s.add(i[p-1>>1]):s.add(i[-p-1>>1].neg())}return"affine"===t.type?s.toP():s},BaseCurve.prototype._wnafMulAdd=function(t,e,r,n,i){for(var o=this._wnafT1,s=this._wnafT2,a=this._wnafT3,p=0,u=0;u<n;u++){var d=e[u],l=d._getNAFPoints(t);o[u]=l.wnd,s[u]=l.points}for(var u=n-1;u>=1;u-=2){var h=u-1,f=u;if(1===o[h]&&1===o[f]){var c=[e[h],null,null,e[f]];0===e[h].y.cmp(e[f].y)?(c[1]=e[h].add(e[f]),c[2]=e[h].toJ().mixedAdd(e[f].neg())):0===e[h].y.cmp(e[f].y.redNeg())?(c[1]=e[h].toJ().mixedAdd(e[f]),c[2]=e[h].add(e[f].neg())):(c[1]=e[h].toJ().mixedAdd(e[f]),c[2]=e[h].toJ().mixedAdd(e[f].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],g=getJSF(r[h],r[f]);p=Math.max(g[0].length,p),a[h]=new Array(p),a[f]=new Array(p);for(var m=0;m<p;m++){var y=0|g[0][m],w=0|g[1][m];a[h][m]=v[3*(y+1)+(w+1)],a[f][m]=0,s[h]=c}}else a[h]=getNAF(r[h],o[h]),a[f]=getNAF(r[f],o[f]),p=Math.max(a[h].length,p),p=Math.max(a[f].length,p)}for(var B=this.jpoint(null,null,null),A=this._wnafT4,u=p;u>=0;u--){for(var b=0;u>=0;){for(var N=!0,m=0;m<n;m++)A[m]=0|a[m][u],0!==A[m]&&(N=!1);if(!N)break;b++,u--}if(u>=0&&b++,B=B.dblp(b),u<0)break;for(var m=0;m<n;m++){var d,_=A[m];0!==_&&(_>0?d=s[m][_-1>>1]:_<0&&(d=s[m][-_-1>>1].neg()),B="affine"===d.type?B.mixedAdd(d):B.add(d))}}for(var u=0;u<n;u++)s[u]=null;return i?B:B.toP()},BaseCurve.BasePoint=BasePoint,BasePoint.prototype.eq=function(){throw new Error("Not implemented")},BasePoint.prototype.validate=function(){return this.curve.validate(this)},BaseCurve.prototype.decodePoint=function(t,e){t=utils.toArray(t,e);var r=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*r){6===t[0]?assert(t[t.length-1]%2==0):7===t[0]&&assert(t[t.length-1]%2==1);return this.point(t.slice(1,1+r),t.slice(1+r,1+2*r))}if((2===t[0]||3===t[0])&&t.length-1===r)return this.pointFromX(t.slice(1,1+r),3===t[0]);throw new Error("Unknown point format")},BasePoint.prototype.encodeCompressed=function(t){return this.encode(t,!0)},BasePoint.prototype._encode=function(t){var e=this.curve.p.byteLength(),r=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",e))},BasePoint.prototype.encode=function(t,e){return utils.encode(this._encode(e),t)},BasePoint.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},BasePoint.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},BasePoint.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<e;i+=t){for(var o=0;o<t;o++)n=n.dbl();r.push(n)}return{step:t,points:r}},BasePoint.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],r=(1<<t)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)e[i]=e[i-1].add(n);return{wnd:t,points:e}},BasePoint.prototype._getBeta=function(){return null},BasePoint.prototype.dblp=function(t){for(var e=this,r=0;r<t;r++)e=e.dbl();return e};
},{"../../elliptic":104,"bn.js":35}],106:[function(require,module,exports){
"use strict";function EdwardsCurve(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,Base.call(this,"edwards",t),this.a=new BN(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function Point(t,r,e,i,d){Base.BasePoint.call(this,t,"projective"),null===r&&null===e&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN(r,16),this.y=new BN(e,16),this.z=i?new BN(i,16):this.curve.one,this.t=d&&new BN(d,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var curve=require("../curve"),elliptic=require("../../elliptic"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(EdwardsCurve,Base),module.exports=EdwardsCurve,EdwardsCurve.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},EdwardsCurve.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},EdwardsCurve.prototype.jpoint=function(t,r,e,i){return this.point(t,r,e,i)},EdwardsCurve.prototype.pointFromX=function(t,r){t=new BN(t,16),t.red||(t=t.toRed(this.red));var e=t.redSqr(),i=this.c2.redSub(this.a.redMul(e)),d=this.one.redSub(this.c2.redMul(this.d).redMul(e)),s=i.redMul(d.redInvm()),u=s.redSqrt();if(0!==u.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var n=u.fromRed().isOdd();return(r&&!n||!r&&n)&&(u=u.redNeg()),this.point(t,u)},EdwardsCurve.prototype.pointFromY=function(t,r){t=new BN(t,16),t.red||(t=t.toRed(this.red));var e=t.redSqr(),i=e.redSub(this.one),d=e.redMul(this.d).redAdd(this.one),s=i.redMul(d.redInvm());if(0===s.cmp(this.zero)){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var u=s.redSqrt();if(0!==u.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return u.isOdd()!==r&&(u=u.redNeg()),this.point(u,t)},EdwardsCurve.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),e=t.y.redSqr(),i=r.redMul(this.a).redAdd(e),d=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(e)));return 0===i.cmp(d)},inherits(Point,Base.BasePoint),EdwardsCurve.prototype.pointFromJSON=function(t){return Point.fromJSON(this,t)},EdwardsCurve.prototype.point=function(t,r,e,i){return new Point(this,t,r,e,i)},Point.fromJSON=function(t,r){return new Point(t,r[0],r[1],r[2])},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},Point.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),e=this.z.redSqr();e=e.redIAdd(e);var i=this.curve._mulA(t),d=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),s=i.redAdd(r),u=s.redSub(e),n=i.redSub(r),h=d.redMul(u),o=s.redMul(n),l=d.redMul(n),c=u.redMul(s);return this.curve.point(h,o,c,l)},Point.prototype._projDbl=function(){var t,r,e,i=this.x.redAdd(this.y).redSqr(),d=this.x.redSqr(),s=this.y.redSqr();if(this.curve.twisted){var u=this.curve._mulA(d),n=u.redAdd(s);if(this.zOne)t=i.redSub(d).redSub(s).redMul(n.redSub(this.curve.two)),r=n.redMul(u.redSub(s)),e=n.redSqr().redSub(n).redSub(n);else{var h=this.z.redSqr(),o=n.redSub(h).redISub(h);t=i.redSub(d).redISub(s).redMul(o),r=n.redMul(u.redSub(s)),e=n.redMul(o)}}else{var u=d.redAdd(s),h=this.curve._mulC(this.c.redMul(this.z)).redSqr(),o=u.redSub(h).redSub(h);t=this.curve._mulC(i.redISub(u)).redMul(o),r=this.curve._mulC(u).redMul(d.redISub(s)),e=u.redMul(o)}return this.curve.point(t,r,e)},Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Point.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),e=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),d=this.z.redMul(t.z.redAdd(t.z)),s=e.redSub(r),u=d.redSub(i),n=d.redAdd(i),h=e.redAdd(r),o=s.redMul(u),l=n.redMul(h),c=s.redMul(h),p=u.redMul(n);return this.curve.point(o,l,p,c)},Point.prototype._projAdd=function(t){var r,e,i=this.z.redMul(t.z),d=i.redSqr(),s=this.x.redMul(t.x),u=this.y.redMul(t.y),n=this.curve.d.redMul(s).redMul(u),h=d.redSub(n),o=d.redAdd(n),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(s).redISub(u),c=i.redMul(h).redMul(l);return this.curve.twisted?(r=i.redMul(o).redMul(u.redSub(this.curve._mulA(s))),e=h.redMul(o)):(r=i.redMul(o).redMul(u.redSub(s)),e=this.curve._mulC(h).redMul(o)),this.curve.point(c,r,e)},Point.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},Point.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},Point.prototype.mulAdd=function(t,r,e){return this.curve._wnafMulAdd(1,[this,r],[t,e],2,!1)},Point.prototype.jmulAdd=function(t,r,e){return this.curve._wnafMulAdd(1,[this,r],[t,e],2,!0)},Point.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Point.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},Point.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(r))return!0;for(var e=t.clone(),i=this.curve.redN.redMul(this.z);;){if(e.iadd(this.curve.n),e.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}return!1},Point.prototype.toP=Point.prototype.normalize,Point.prototype.mixedAdd=Point.prototype.add;

},{"../../elliptic":104,"../curve":107,"bn.js":35,"inherits":144}],107:[function(require,module,exports){
"use strict";var curve=exports;curve.base=require("./base"),curve.short=require("./short"),curve.mont=require("./mont"),curve.edwards=require("./edwards");
},{"./base":105,"./edwards":106,"./mont":108,"./short":109}],108:[function(require,module,exports){
"use strict";function MontCurve(t){Base.call(this,"mont",t),this.a=new BN(t.a,16).toRed(this.red),this.b=new BN(t.b,16).toRed(this.red),this.i4=new BN(4).toRed(this.red).redInvm(),this.two=new BN(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function Point(t,r,e){Base.BasePoint.call(this,t,"projective"),null===r&&null===e?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN(r,16),this.z=new BN(e,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var curve=require("../curve"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,elliptic=require("../../elliptic"),utils=elliptic.utils;inherits(MontCurve,Base),module.exports=MontCurve,MontCurve.prototype.validate=function(t){var r=t.normalize().x,e=r.redSqr(),i=e.redMul(r).redAdd(e.redMul(this.a)).redAdd(r);return 0===i.redSqrt().redSqr().cmp(i)},inherits(Point,Base.BasePoint),MontCurve.prototype.decodePoint=function(t,r){return this.point(utils.toArray(t,r),1)},MontCurve.prototype.point=function(t,r){return new Point(this,t,r)},MontCurve.prototype.pointFromJSON=function(t){return Point.fromJSON(this,t)},Point.prototype.precompute=function(){},Point.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Point.fromJSON=function(t,r){return new Point(t,r[0],r[1]||t.one)},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},Point.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),e=this.x.redSub(this.z),i=e.redSqr(),o=r.redSub(i),n=r.redMul(i),u=o.redMul(i.redAdd(this.curve.a24.redMul(o)));return this.curve.point(n,u)},Point.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.diffAdd=function(t,r){var e=this.x.redAdd(this.z),i=this.x.redSub(this.z),o=t.x.redAdd(t.z),n=t.x.redSub(t.z),u=n.redMul(e),d=o.redMul(i),s=r.z.redMul(u.redAdd(d).redSqr()),h=r.x.redMul(u.redISub(d).redSqr());return this.curve.point(s,h)},Point.prototype.mul=function(t){for(var r=t.clone(),e=this,i=this.curve.point(null,null),o=this,n=[];0!==r.cmpn(0);r.iushrn(1))n.push(r.andln(1));for(var u=n.length-1;u>=0;u--)0===n[u]?(e=e.diffAdd(i,o),i=i.dbl()):(i=e.diffAdd(i,o),e=e.dbl());return i},Point.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},Point.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()};

},{"../../elliptic":104,"../curve":107,"bn.js":35,"inherits":144}],109:[function(require,module,exports){
"use strict";function ShortCurve(r){Base.call(this,"short",r),this.a=new BN(r.a,16).toRed(this.red),this.b=new BN(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function Point(r,e,t,d){Base.BasePoint.call(this,r,"affine"),null===e&&null===t?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(e,16),this.y=new BN(t,16),d&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function JPoint(r,e,t,d){Base.BasePoint.call(this,r,"jacobian"),null===e&&null===t&&null===d?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(e,16),this.y=new BN(t,16),this.z=new BN(d,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var curve=require("../curve"),elliptic=require("../../elliptic"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(ShortCurve,Base),module.exports=ShortCurve,ShortCurve.prototype._getEndomorphism=function(r){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,t;if(r.beta)e=new BN(r.beta,16).toRed(this.red);else{var d=this._getEndoRoots(this.p);e=d[0].cmp(d[1])<0?d[0]:d[1],e=e.toRed(this.red)}if(r.lambda)t=new BN(r.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(e))?t=i[0]:(t=i[1],assert(0===this.g.mul(t).x.cmp(this.g.x.redMul(e))))}var n;return n=r.basis?r.basis.map(function(r){return{a:new BN(r.a,16),b:new BN(r.b,16)}}):this._getEndoBasis(t),{beta:e,lambda:t,basis:n}}},ShortCurve.prototype._getEndoRoots=function(r){var e=r===this.p?this.red:BN.mont(r),t=new BN(2).toRed(e).redInvm(),d=t.redNeg(),i=new BN(3).toRed(e).redNeg().redSqrt().redMul(t);return[d.redAdd(i).fromRed(),d.redSub(i).fromRed()]},ShortCurve.prototype._getEndoBasis=function(r){for(var e,t,d,i,n,u,s,o,h,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),p=r,a=this.n.clone(),c=new BN(1),f=new BN(0),v=new BN(0),S=new BN(1),b=0;0!==p.cmpn(0);){var I=a.div(p);o=a.sub(I.mul(p)),h=v.sub(I.mul(c));var y=S.sub(I.mul(f));if(!d&&o.cmp(l)<0)e=s.neg(),t=c,d=o.neg(),i=h;else if(d&&2==++b)break;s=o,a=p,p=o,v=c,c=h,S=f,f=y}n=o.neg(),u=h;var A=d.sqr().add(i.sqr());return n.sqr().add(u.sqr()).cmp(A)>=0&&(n=e,u=t),d.negative&&(d=d.neg(),i=i.neg()),n.negative&&(n=n.neg(),u=u.neg()),[{a:d,b:i},{a:n,b:u}]},ShortCurve.prototype._endoSplit=function(r){var e=this.endo.basis,t=e[0],d=e[1],i=d.b.mul(r).divRound(this.n),n=t.b.neg().mul(r).divRound(this.n),u=i.mul(t.a),s=n.mul(d.a),o=i.mul(t.b),h=n.mul(d.b);return{k1:r.sub(u).sub(s),k2:o.add(h).neg()}},ShortCurve.prototype.pointFromX=function(r,e){r=new BN(r,16),r.red||(r=r.toRed(this.red));var t=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),d=t.redSqrt();if(0!==d.redSqr().redSub(t).cmp(this.zero))throw new Error("invalid point");var i=d.fromRed().isOdd();return(e&&!i||!e&&i)&&(d=d.redNeg()),this.point(r,d)},ShortCurve.prototype.validate=function(r){if(r.inf)return!0;var e=r.x,t=r.y,d=this.a.redMul(e),i=e.redSqr().redMul(e).redIAdd(d).redIAdd(this.b);return 0===t.redSqr().redISub(i).cmpn(0)},ShortCurve.prototype._endoWnafMulAdd=function(r,e,t){for(var d=this._endoWnafT1,i=this._endoWnafT2,n=0;n<r.length;n++){var u=this._endoSplit(e[n]),s=r[n],o=s._getBeta();u.k1.negative&&(u.k1.ineg(),s=s.neg(!0)),u.k2.negative&&(u.k2.ineg(),o=o.neg(!0)),d[2*n]=s,d[2*n+1]=o,i[2*n]=u.k1,i[2*n+1]=u.k2}for(var h=this._wnafMulAdd(1,d,i,2*n,t),l=0;l<2*n;l++)d[l]=null,i[l]=null;return h},inherits(Point,Base.BasePoint),ShortCurve.prototype.point=function(r,e,t){return new Point(this,r,e,t)},ShortCurve.prototype.pointFromJSON=function(r,e){return Point.fromJSON(this,r,e)},Point.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var t=this.curve,d=function(r){return t.point(r.x.redMul(t.endo.beta),r.y)};r.beta=e,e.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(d)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(d)}}}return e}},Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Point.fromJSON=function(r,e,t){function d(e){return r.point(e[0],e[1],t)}"string"==typeof e&&(e=JSON.parse(e));var i=r.point(e[0],e[1],t);if(!e[2])return i;var n=e[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(d))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(d))}},i},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return this.inf},Point.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(0===this.x.cmp(r.x))return this.curve.point(null,null);var e=this.y.redSub(r.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(r.x).redInvm()));var t=e.redSqr().redISub(this.x).redISub(r.x),d=e.redMul(this.x.redSub(t)).redISub(this.y);return this.curve.point(t,d)},Point.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(0===r.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,t=this.x.redSqr(),d=r.redInvm(),i=t.redAdd(t).redIAdd(t).redIAdd(e).redMul(d),n=i.redSqr().redISub(this.x.redAdd(this.x)),u=i.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,u)},Point.prototype.getX=function(){return this.x.fromRed()},Point.prototype.getY=function(){return this.y.fromRed()},Point.prototype.mul=function(r){return r=new BN(r,16),this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},Point.prototype.mulAdd=function(r,e,t){var d=[this,e],i=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(d,i):this.curve._wnafMulAdd(1,d,i,2)},Point.prototype.jmulAdd=function(r,e,t){var d=[this,e],i=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(d,i,!0):this.curve._wnafMulAdd(1,d,i,2,!0)},Point.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||0===this.x.cmp(r.x)&&0===this.y.cmp(r.y))},Point.prototype.neg=function(r){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var t=this.precomputed,d=function(r){return r.neg()};e.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(d)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(d)}}}return e},Point.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},inherits(JPoint,Base.BasePoint),ShortCurve.prototype.jpoint=function(r,e,t){return new JPoint(this,r,e,t)},JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),e=r.redSqr(),t=this.x.redMul(e),d=this.y.redMul(e).redMul(r);return this.curve.point(t,d)},JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},JPoint.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var e=r.z.redSqr(),t=this.z.redSqr(),d=this.x.redMul(e),i=r.x.redMul(t),n=this.y.redMul(e.redMul(r.z)),u=r.y.redMul(t.redMul(this.z)),s=d.redSub(i),o=n.redSub(u);if(0===s.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=s.redSqr(),l=h.redMul(s),p=d.redMul(h),a=o.redSqr().redIAdd(l).redISub(p).redISub(p),c=o.redMul(p.redISub(a)).redISub(n.redMul(l)),f=this.z.redMul(r.z).redMul(s);return this.curve.jpoint(a,c,f)},JPoint.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var e=this.z.redSqr(),t=this.x,d=r.x.redMul(e),i=this.y,n=r.y.redMul(e).redMul(this.z),u=t.redSub(d),s=i.redSub(n);if(0===u.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var o=u.redSqr(),h=o.redMul(u),l=t.redMul(o),p=s.redSqr().redIAdd(h).redISub(l).redISub(l),a=s.redMul(l.redISub(p)).redISub(i.redMul(h)),c=this.z.redMul(u);return this.curve.jpoint(p,a,c)},JPoint.prototype.dblp=function(r){if(0===r)return this;if(this.isInfinity())return this;if(!r)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var e=this,t=0;t<r;t++)e=e.dbl();return e}for(var d=this.curve.a,i=this.curve.tinv,n=this.x,u=this.y,s=this.z,o=s.redSqr().redSqr(),h=u.redAdd(u),t=0;t<r;t++){var l=n.redSqr(),p=h.redSqr(),a=p.redSqr(),c=l.redAdd(l).redIAdd(l).redIAdd(d.redMul(o)),f=n.redMul(p),v=c.redSqr().redISub(f.redAdd(f)),S=f.redISub(v),b=c.redMul(S);b=b.redIAdd(b).redISub(a);var I=h.redMul(s);t+1<r&&(o=o.redMul(a)),n=v,s=I,h=b}return this.curve.jpoint(n,h.redMul(i),s)},JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},JPoint.prototype._zeroDbl=function(){var r,e,t;if(this.zOne){var d=this.x.redSqr(),i=this.y.redSqr(),n=i.redSqr(),u=this.x.redAdd(i).redSqr().redISub(d).redISub(n);u=u.redIAdd(u);var s=d.redAdd(d).redIAdd(d),o=s.redSqr().redISub(u).redISub(u),h=n.redIAdd(n);h=h.redIAdd(h),h=h.redIAdd(h),r=o,e=s.redMul(u.redISub(o)).redISub(h),t=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),p=this.y.redSqr(),a=p.redSqr(),c=this.x.redAdd(p).redSqr().redISub(l).redISub(a);c=c.redIAdd(c);var f=l.redAdd(l).redIAdd(l),v=f.redSqr(),S=a.redIAdd(a);S=S.redIAdd(S),S=S.redIAdd(S),r=v.redISub(c).redISub(c),e=f.redMul(c.redISub(r)).redISub(S),t=this.y.redMul(this.z),t=t.redIAdd(t)}return this.curve.jpoint(r,e,t)},JPoint.prototype._threeDbl=function(){var r,e,t;if(this.zOne){var d=this.x.redSqr(),i=this.y.redSqr(),n=i.redSqr(),u=this.x.redAdd(i).redSqr().redISub(d).redISub(n);u=u.redIAdd(u);var s=d.redAdd(d).redIAdd(d).redIAdd(this.curve.a),o=s.redSqr().redISub(u).redISub(u);r=o;var h=n.redIAdd(n);h=h.redIAdd(h),h=h.redIAdd(h),e=s.redMul(u.redISub(o)).redISub(h),t=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),p=this.y.redSqr(),a=this.x.redMul(p),c=this.x.redSub(l).redMul(this.x.redAdd(l));c=c.redAdd(c).redIAdd(c);var f=a.redIAdd(a);f=f.redIAdd(f);var v=f.redAdd(f);r=c.redSqr().redISub(v),t=this.y.redAdd(this.z).redSqr().redISub(p).redISub(l);var S=p.redSqr();S=S.redIAdd(S),S=S.redIAdd(S),S=S.redIAdd(S),e=c.redMul(f.redISub(r)).redISub(S)}return this.curve.jpoint(r,e,t)},JPoint.prototype._dbl=function(){var r=this.curve.a,e=this.x,t=this.y,d=this.z,i=d.redSqr().redSqr(),n=e.redSqr(),u=t.redSqr(),s=n.redAdd(n).redIAdd(n).redIAdd(r.redMul(i)),o=e.redAdd(e);o=o.redIAdd(o);var h=o.redMul(u),l=s.redSqr().redISub(h.redAdd(h)),p=h.redISub(l),a=u.redSqr();a=a.redIAdd(a),a=a.redIAdd(a),a=a.redIAdd(a);var c=s.redMul(p).redISub(a),f=t.redAdd(t).redMul(d);return this.curve.jpoint(l,c,f)},JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),e=this.y.redSqr(),t=this.z.redSqr(),d=e.redSqr(),i=r.redAdd(r).redIAdd(r),n=i.redSqr(),u=this.x.redAdd(e).redSqr().redISub(r).redISub(d);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(n);var s=u.redSqr(),o=d.redIAdd(d);o=o.redIAdd(o),o=o.redIAdd(o),o=o.redIAdd(o);var h=i.redIAdd(u).redSqr().redISub(n).redISub(s).redISub(o),l=e.redMul(h);l=l.redIAdd(l),l=l.redIAdd(l);var p=this.x.redMul(s).redISub(l);p=p.redIAdd(p),p=p.redIAdd(p);var a=this.y.redMul(h.redMul(o.redISub(h)).redISub(u.redMul(s)));a=a.redIAdd(a),a=a.redIAdd(a),a=a.redIAdd(a);var c=this.z.redAdd(u).redSqr().redISub(t).redISub(s);return this.curve.jpoint(p,a,c)},JPoint.prototype.mul=function(r,e){return r=new BN(r,e),this.curve._wnafMul(this,r)},JPoint.prototype.eq=function(r){if("affine"===r.type)return this.eq(r.toJ());if(this===r)return!0;var e=this.z.redSqr(),t=r.z.redSqr();if(0!==this.x.redMul(t).redISub(r.x.redMul(e)).cmpn(0))return!1;var d=e.redMul(this.z),i=t.redMul(r.z);return 0===this.y.redMul(i).redISub(r.y.redMul(d)).cmpn(0)},JPoint.prototype.eqXToP=function(r){var e=this.z.redSqr(),t=r.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(t))return!0;for(var d=r.clone(),i=this.curve.redN.redMul(e);;){if(d.iadd(this.curve.n),d.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}return!1},JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},JPoint.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};

},{"../../elliptic":104,"../curve":107,"bn.js":35,"inherits":144}],110:[function(require,module,exports){
"use strict";function PresetCurve(f){"short"===f.type?this.curve=new elliptic.curve.short(f):"edwards"===f.type?this.curve=new elliptic.curve.edwards(f):this.curve=new elliptic.curve.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,assert(this.g.validate(),"Invalid curve"),assert(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function defineCurve(f,e){Object.defineProperty(curves,f,{configurable:!0,enumerable:!0,get:function(){var a=new PresetCurve(e);return Object.defineProperty(curves,f,{configurable:!0,enumerable:!0,value:a}),a}})}var curves=exports,hash=require("hash.js"),elliptic=require("../elliptic"),assert=elliptic.utils.assert;curves.PresetCurve=PresetCurve,defineCurve("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),defineCurve("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),defineCurve("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),defineCurve("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),defineCurve("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),defineCurve("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["9"]}),defineCurve("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var pre;try{pre=require("./precomputed/secp256k1")}catch(f){pre=void 0}defineCurve("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pre]});

},{"../elliptic":104,"./precomputed/secp256k1":117,"hash.js":127}],111:[function(require,module,exports){
"use strict";function EC(e){if(!(this instanceof EC))return new EC(e);"string"==typeof e&&(assert(elliptic.curves.hasOwnProperty(e),"Unknown curve "+e),e=elliptic.curves[e]),e instanceof elliptic.curves.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var BN=require("bn.js"),HmacDRBG=require("hmac-drbg"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,KeyPair=require("./key"),Signature=require("./signature");module.exports=EC,EC.prototype.keyPair=function(e){return new KeyPair(this,e)},EC.prototype.keyFromPrivate=function(e,t){return KeyPair.fromPrivate(this,e,t)},EC.prototype.keyFromPublic=function(e,t){return KeyPair.fromPublic(this,e,t)},EC.prototype.genKeyPair=function(e){e||(e={});for(var t=new HmacDRBG({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||elliptic.rand(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),n=this.n.sub(new BN(2));;){var i=new BN(t.generate(r));if(!(i.cmp(n)>0))return i.iaddn(1),this.keyFromPrivate(i)}},EC.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},EC.prototype.sign=function(e,t,r,n){"object"==typeof r&&(n=r,r=null),n||(n={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new BN(e,16));for(var i=this.n.byteLength(),s=t.getPrivate().toArray("be",i),u=e.toArray("be",i),o=new HmacDRBG({hash:this.hash,entropy:s,nonce:u,pers:n.pers,persEnc:n.persEnc||"utf8"}),c=this.n.sub(new BN(1)),h=0;!0;h++){var a=n.k?n.k(h):new BN(o.generate(this.n.byteLength()));if(a=this._truncateToN(a,!0),!(a.cmpn(1)<=0||a.cmp(c)>=0)){var p=this.g.mul(a);if(!p.isInfinity()){var m=p.getX(),v=m.umod(this.n);if(0!==v.cmpn(0)){var y=a.invm(this.n).mul(v.mul(t.getPrivate()).iadd(e));if(y=y.umod(this.n),0!==y.cmpn(0)){var l=(p.getY().isOdd()?1:0)|(0!==m.cmp(v)?2:0);return n.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),l^=1),new Signature({r:v,s:y,recoveryParam:l})}}}}}},EC.prototype.verify=function(e,t,r,n){e=this._truncateToN(new BN(e,16)),r=this.keyFromPublic(r,n),t=new Signature(t,"hex");var i=t.r,s=t.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var u=s.invm(this.n),o=u.mul(e).umod(this.n),c=u.mul(i).umod(this.n);if(!this.curve._maxwellTrick){var h=this.g.mulAdd(o,r.getPublic(),c);return!h.isInfinity()&&0===h.getX().umod(this.n).cmp(i)}var h=this.g.jmulAdd(o,r.getPublic(),c);return!h.isInfinity()&&h.eqXToP(i)},EC.prototype.recoverPubKey=function(e,t,r,n){assert((3&r)===r,"The recovery param is more than two bits"),t=new Signature(t,n);var i=this.n,s=new BN(e),u=t.r,o=t.s,c=1&r,h=r>>1;if(u.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");u=h?this.curve.pointFromX(u.add(this.curve.n),c):this.curve.pointFromX(u,c);var a=t.r.invm(i),p=i.sub(s).mul(a).umod(i),m=o.mul(a).umod(i);return this.g.mulAdd(p,u,m)},EC.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Signature(t,n),null!==t.recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch(e){continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")};

},{"../../elliptic":104,"./key":112,"./signature":113,"bn.js":35,"hmac-drbg":139}],112:[function(require,module,exports){
"use strict";function KeyPair(i,t){this.ec=i,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=KeyPair,KeyPair.fromPublic=function(i,t,e){return t instanceof KeyPair?t:new KeyPair(i,{pub:t,pubEnc:e})},KeyPair.fromPrivate=function(i,t,e){return t instanceof KeyPair?t:new KeyPair(i,{priv:t,privEnc:e})},KeyPair.prototype.validate=function(){var i=this.getPublic();return i.isInfinity()?{result:!1,reason:"Invalid public key"}:i.validate()?i.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},KeyPair.prototype.getPublic=function(i,t){return"string"==typeof i&&(t=i,i=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,i):this.pub},KeyPair.prototype.getPrivate=function(i){return"hex"===i?this.priv.toString(16,2):this.priv},KeyPair.prototype._importPrivate=function(i,t){this.priv=new BN(i,t||16),this.priv=this.priv.umod(this.ec.curve.n)},KeyPair.prototype._importPublic=function(i,t){if(i.x||i.y)return"mont"===this.ec.curve.type?assert(i.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||assert(i.x&&i.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(i.x,i.y));this.pub=this.ec.curve.decodePoint(i,t)},KeyPair.prototype.derive=function(i){return i.mul(this.priv).getX()},KeyPair.prototype.sign=function(i,t,e){return this.ec.sign(i,this,t,e)},KeyPair.prototype.verify=function(i,t){return this.ec.verify(i,t,this)},KeyPair.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};

},{"../../elliptic":104,"bn.js":35}],113:[function(require,module,exports){
"use strict";function Signature(t,r){if(t instanceof Signature)return t;this._importDER(t,r)||(assert(t.r&&t.s,"Signature without r or s"),this.r=new BN(t.r,16),this.s=new BN(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function Position(){this.place=0}function getLength(t,r){var e=t[r.place++];if(!(128&e))return e;for(var n=15&e,i=0,a=0,c=r.place;a<n;a++,c++)i<<=8,i|=t[c];return r.place=c,i}function rmPadding(t){for(var r=0,e=t.length-1;!t[r]&&!(128&t[r+1])&&r<e;)r++;return 0===r?t:t.slice(r)}function constructLength(t,r){if(r<128)return void t.push(r);var e=1+(Math.log(r)/Math.LN2>>>3);for(t.push(128|e);--e;)t.push(r>>>(e<<3)&255);t.push(r)}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=Signature,Signature.prototype._importDER=function(t,r){t=utils.toArray(t,r);var e=new Position;if(48!==t[e.place++])return!1;if(getLength(t,e)+e.place!==t.length)return!1;if(2!==t[e.place++])return!1;var n=getLength(t,e),i=t.slice(e.place,n+e.place);if(e.place+=n,2!==t[e.place++])return!1;var a=getLength(t,e);if(t.length!==a+e.place)return!1;var c=t.slice(e.place,a+e.place);return 0===i[0]&&128&i[1]&&(i=i.slice(1)),0===c[0]&&128&c[1]&&(c=c.slice(1)),this.r=new BN(i),this.s=new BN(c),this.recoveryParam=null,!0},Signature.prototype.toDER=function(t){var r=this.r.toArray(),e=this.s.toArray();for(128&r[0]&&(r=[0].concat(r)),128&e[0]&&(e=[0].concat(e)),r=rmPadding(r),e=rmPadding(e);!(e[0]||128&e[1]);)e=e.slice(1);var n=[2];constructLength(n,r.length),n=n.concat(r),n.push(2),constructLength(n,e.length);var i=n.concat(e),a=[48];return constructLength(a,i.length),a=a.concat(i),utils.encode(a,t)};

},{"../../elliptic":104,"bn.js":35}],114:[function(require,module,exports){
"use strict";function EDDSA(t){if(assert("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(t);var t=elliptic.curves[t].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=hash.sha512}var hash=require("hash.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,KeyPair=require("./key"),Signature=require("./signature");module.exports=EDDSA,EDDSA.prototype.sign=function(t,e){t=parseBytes(t);var i=this.keyFromSecret(e),r=this.hashInt(i.messagePrefix(),t),n=this.g.mul(r),s=this.encodePoint(n),o=this.hashInt(s,i.pubBytes(),t).mul(i.priv()),u=r.add(o).umod(this.curve.n);return this.makeSignature({R:n,S:u,Rencoded:s})},EDDSA.prototype.verify=function(t,e,i){t=parseBytes(t),e=this.makeSignature(e);var r=this.keyFromPublic(i),n=this.hashInt(e.Rencoded(),r.pubBytes(),t),s=this.g.mul(e.S());return e.R().add(r.pub().mul(n)).eq(s)},EDDSA.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return utils.intFromLE(t.digest()).umod(this.curve.n)},EDDSA.prototype.keyFromPublic=function(t){return KeyPair.fromPublic(this,t)},EDDSA.prototype.keyFromSecret=function(t){return KeyPair.fromSecret(this,t)},EDDSA.prototype.makeSignature=function(t){return t instanceof Signature?t:new Signature(this,t)},EDDSA.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},EDDSA.prototype.decodePoint=function(t){t=utils.parseBytes(t);var e=t.length-1,i=t.slice(0,e).concat(-129&t[e]),r=0!=(128&t[e]),n=utils.intFromLE(i);return this.curve.pointFromY(n,r)},EDDSA.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},EDDSA.prototype.decodeInt=function(t){return utils.intFromLE(t)},EDDSA.prototype.isPoint=function(t){return t instanceof this.pointClass};

},{"../../elliptic":104,"./key":115,"./signature":116,"hash.js":127}],115:[function(require,module,exports){
"use strict";function KeyPair(e,t){this.eddsa=e,this._secret=parseBytes(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=parseBytes(t.pub)}var elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,cachedProperty=utils.cachedProperty;KeyPair.fromPublic=function(e,t){return t instanceof KeyPair?t:new KeyPair(e,{pub:t})},KeyPair.fromSecret=function(e,t){return t instanceof KeyPair?t:new KeyPair(e,{secret:t})},KeyPair.prototype.secret=function(){return this._secret},cachedProperty(KeyPair,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),cachedProperty(KeyPair,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),cachedProperty(KeyPair,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[i]&=127,r[i]|=64,r}),cachedProperty(KeyPair,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),cachedProperty(KeyPair,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),cachedProperty(KeyPair,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),KeyPair.prototype.sign=function(e){return assert(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},KeyPair.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},KeyPair.prototype.getSecret=function(e){return assert(this._secret,"KeyPair is public only"),utils.encode(this.secret(),e)},KeyPair.prototype.getPublic=function(e){return utils.encode(this.pubBytes(),e)},module.exports=KeyPair;

},{"../../elliptic":104}],116:[function(require,module,exports){
"use strict";function Signature(e,t){this.eddsa=e,"object"!=typeof t&&(t=parseBytes(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),assert(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof BN&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,cachedProperty=utils.cachedProperty,parseBytes=utils.parseBytes;cachedProperty(Signature,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),cachedProperty(Signature,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),cachedProperty(Signature,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),cachedProperty(Signature,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Signature.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Signature.prototype.toHex=function(){return utils.encode(this.toBytes(),"hex").toUpperCase()},module.exports=Signature;

},{"../../elliptic":104,"bn.js":35}],117:[function(require,module,exports){
module.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}};
},{}],118:[function(require,module,exports){
"use strict";function getNAF(t,r){for(var i=[],e=1<<r+1,n=t.clone();n.cmpn(1)>=0;){var s;if(n.isOdd()){var u=n.andln(e-1);s=u>(e>>1)-1?(e>>1)-u:u,n.isubn(s)}else s=0;i.push(s);for(var l=0!==n.cmpn(0)&&0===n.andln(e-1)?r+1:1,a=1;a<l;a++)i.push(0);n.iushrn(l)}return i}function getJSF(t,r){var i=[[],[]];t=t.clone(),r=r.clone();for(var e=0,n=0;t.cmpn(-e)>0||r.cmpn(-n)>0;){var s=t.andln(3)+e&3,u=r.andln(3)+n&3;3===s&&(s=-1),3===u&&(u=-1);var l;if(0==(1&s))l=0;else{var a=t.andln(7)+e&7;l=3!==a&&5!==a||2!==u?s:-s}i[0].push(l);var o;if(0==(1&u))o=0;else{var a=r.andln(7)+n&7;o=3!==a&&5!==a||2!==s?u:-u}i[1].push(o),2*e===l+1&&(e=1-e),2*n===o+1&&(n=1-n),t.iushrn(1),r.iushrn(1)}return i}function cachedProperty(t,r,i){var e="_"+r;t.prototype[r]=function(){return void 0!==this[e]?this[e]:this[e]=i.call(this)}}function parseBytes(t){return"string"==typeof t?utils.toArray(t,"hex"):t}function intFromLE(t){return new BN(t,"hex","le")}var utils=exports,BN=require("bn.js"),minAssert=require("minimalistic-assert"),minUtils=require("minimalistic-crypto-utils");utils.assert=minAssert,utils.toArray=minUtils.toArray,utils.zero2=minUtils.zero2,utils.toHex=minUtils.toHex,utils.encode=minUtils.encode,utils.getNAF=getNAF,utils.getJSF=getJSF,utils.cachedProperty=cachedProperty,utils.parseBytes=parseBytes,utils.intFromLE=intFromLE;

},{"bn.js":35,"minimalistic-assert":170,"minimalistic-crypto-utils":171}],119:[function(require,module,exports){
module.exports={
  "_args": [
    [
      {
        "raw": "elliptic@^6.0.0",
        "scope": null,
        "escapedName": "elliptic",
        "name": "elliptic",
        "rawSpec": "^6.0.0",
        "spec": ">=6.0.0 <7.0.0",
        "type": "range"
      },
      "/Users/ben/Documents/bitbucket/peertunes/node_modules/browserify-sign"
    ]
  ],
  "_from": "elliptic@>=6.0.0 <7.0.0",
  "_id": "elliptic@6.4.0",
  "_inCache": true,
  "_location": "/elliptic",
  "_nodeVersion": "7.0.0",
  "_npmOperationalInternal": {
    "host": "packages-18-east.internal.npmjs.com",
    "tmp": "tmp/elliptic-6.4.0.tgz_1487798866428_0.30510620190761983"
  },
  "_npmUser": {
    "name": "indutny",
    "email": "fedor@indutny.com"
  },
  "_npmVersion": "3.10.8",
  "_phantomChildren": {},
  "_requested": {
    "raw": "elliptic@^6.0.0",
    "scope": null,
    "escapedName": "elliptic",
    "name": "elliptic",
    "rawSpec": "^6.0.0",
    "spec": ">=6.0.0 <7.0.0",
    "type": "range"
  },
  "_requiredBy": [
    "/browserify-sign",
    "/create-ecdh"
  ],
  "_resolved": "https://registry.npmjs.org/elliptic/-/elliptic-6.4.0.tgz",
  "_shasum": "cac9af8762c85836187003c8dfe193e5e2eae5df",
  "_shrinkwrap": null,
  "_spec": "elliptic@^6.0.0",
  "_where": "/Users/ben/Documents/bitbucket/peertunes/node_modules/browserify-sign",
  "author": {
    "name": "Fedor Indutny",
    "email": "fedor@indutny.com"
  },
  "bugs": {
    "url": "https://github.com/indutny/elliptic/issues"
  },
  "dependencies": {
    "bn.js": "^4.4.0",
    "brorand": "^1.0.1",
    "hash.js": "^1.0.0",
    "hmac-drbg": "^1.0.0",
    "inherits": "^2.0.1",
    "minimalistic-assert": "^1.0.0",
    "minimalistic-crypto-utils": "^1.0.0"
  },
  "description": "EC cryptography",
  "devDependencies": {
    "brfs": "^1.4.3",
    "coveralls": "^2.11.3",
    "grunt": "^0.4.5",
    "grunt-browserify": "^5.0.0",
    "grunt-cli": "^1.2.0",
    "grunt-contrib-connect": "^1.0.0",
    "grunt-contrib-copy": "^1.0.0",
    "grunt-contrib-uglify": "^1.0.1",
    "grunt-mocha-istanbul": "^3.0.1",
    "grunt-saucelabs": "^8.6.2",
    "istanbul": "^0.4.2",
    "jscs": "^2.9.0",
    "jshint": "^2.6.0",
    "mocha": "^2.1.0"
  },
  "directories": {},
  "dist": {
    "shasum": "cac9af8762c85836187003c8dfe193e5e2eae5df",
    "tarball": "https://registry.npmjs.org/elliptic/-/elliptic-6.4.0.tgz"
  },
  "files": [
    "lib"
  ],
  "gitHead": "6b0d2b76caae91471649c8e21f0b1d3ba0f96090",
  "homepage": "https://github.com/indutny/elliptic",
  "keywords": [
    "EC",
    "Elliptic",
    "curve",
    "Cryptography"
  ],
  "license": "MIT",
  "main": "lib/elliptic.js",
  "maintainers": [
    {
      "name": "indutny",
      "email": "fedor@indutny.com"
    }
  ],
  "name": "elliptic",
  "optionalDependencies": {},
  "readme": "ERROR: No README data found!",
  "repository": {
    "type": "git",
    "url": "git+ssh://git@github.com/indutny/elliptic.git"
  },
  "scripts": {
    "jscs": "jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",
    "jshint": "jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",
    "lint": "npm run jscs && npm run jshint",
    "test": "npm run lint && npm run unit",
    "unit": "istanbul test _mocha --reporter=spec test/index.js",
    "version": "grunt dist && git add dist/"
  },
  "version": "6.4.0"
}

},{}],120:[function(require,module,exports){
var once=require("once"),noop=function(){},isRequest=function(e){return e.setHeader&&"function"==typeof e.abort},isChildProcess=function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length},eos=function(e,r,n){if("function"==typeof r)return eos(e,null,r);r||(r={}),n=once(n||noop);var o=e._writableState,t=e._readableState,i=r.readable||!1!==r.readable&&e.readable,s=r.writable||!1!==r.writable&&e.writable,l=function(){e.writable||c()},c=function(){s=!1,i||n.call(e)},a=function(){i=!1,s||n.call(e)},u=function(r){n.call(e,r?new Error("exited with error code: "+r):null)},d=function(){return(!i||t&&t.ended)&&(!s||o&&o.ended)?void 0:n.call(e,new Error("premature close"))},f=function(){e.req.on("finish",c)};return isRequest(e)?(e.on("complete",c),e.on("abort",d),e.req?f():e.on("request",f)):s&&!o&&(e.on("end",l),e.on("close",l)),isChildProcess(e)&&e.on("exit",u),e.on("end",a),e.on("finish",c),!1!==r.error&&e.on("error",n),e.on("close",d),function(){e.removeListener("complete",c),e.removeListener("abort",d),e.removeListener("request",f),e.req&&e.req.removeListener("finish",c),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",c),e.removeListener("exit",u),e.removeListener("end",a),e.removeListener("error",n),e.removeListener("close",d)}};module.exports=eos;

},{"once":186}],121:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,i,n,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(i=this._events[e],isUndefined(i))return!1;if(isFunction(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(isObject(i))for(s=Array.prototype.slice.call(arguments,1),o=i.slice(),n=o.length,r=0;r<n;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var i;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(i=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},EventEmitter.prototype.removeListener=function(e,t){var i,n,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,n=-1,i===t||isFunction(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(i)){for(r=s;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){n=r;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],isFunction(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){return this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};

},{}],122:[function(require,module,exports){
(function (Buffer){
function EVP_BytesToKey(e,f,r,u){Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),f&&!Buffer.isBuffer(f)&&(f=new Buffer(f,"binary")),r/=8,u=u||0;for(var i,n,a=0,t=0,B=new Buffer(r),o=new Buffer(u),h=0,s=[];;){if(h++>0&&s.push(i),s.push(e),f&&s.push(f),i=md5(Buffer.concat(s)),s=[],n=0,r>0)for(;;){if(0===r)break;if(n===i.length)break;B[a++]=i[n],r--,n++}if(u>0&&n!==i.length)for(;;){if(0===u)break;if(n===i.length)break;o[t++]=i[n],u--,n++}if(0===r&&0===u)break}for(n=0;n<i.length;n++)i[n]=0;return{key:B,iv:o}}var md5=require("create-hash/md5");module.exports=EVP_BytesToKey;
}).call(this,require("buffer").Buffer)
},{"buffer":66,"create-hash/md5":80}],123:[function(require,module,exports){
function FileReadStream(e,r){var i=this;if(!(this instanceof FileReadStream))return new FileReadStream(e,r);r=r||{},Readable.call(this,r),this._offset=0,this._ready=!1,this._file=e,this._size=e.size,this._chunkSize=r.chunkSize||Math.max(this._size/1e3,204800),this.reader=new FileReader,this._generateHeaderBlocks(e,r,function(e,r){if(e)return i.emit("error",e);Array.isArray(r)&&r.forEach(function(e){i.push(e)}),i._ready=!0,i.emit("_ready")})}var Readable=require("readable-stream").Readable,inherits=require("inherits"),reExtension=/^.*\.(\w+)$/,toBuffer=require("typedarray-to-buffer");inherits(FileReadStream,Readable),module.exports=FileReadStream,FileReadStream.prototype._generateHeaderBlocks=function(e,r,i){i(null,[])},FileReadStream.prototype._read=function(){if(!this._ready)return void this.once("_ready",this._read.bind(this));var e=this,r=this.reader,i=this._offset,t=this._offset+this._chunkSize;if(t>this._size&&(t=this._size),i===this._size)return this.destroy(),void this.push(null);r.onload=function(){e._offset=t,e.push(toBuffer(r.result))},r.onerror=function(){e.emit("error",r.error)},r.readAsArrayBuffer(this._file.slice(i,t))},FileReadStream.prototype.destroy=function(){if(this._file=null,this.reader){this.reader.onload=null,this.reader.onerror=null;try{this.reader.abort()}catch(e){}}this.reader=null};

},{"inherits":144,"readable-stream":235,"typedarray-to-buffer":291}],124:[function(require,module,exports){
module.exports=function(r,n){function t(r,u){return r.reduce(function(r,e){return Array.isArray(e)&&u<n?r.concat(t(e,u+1)):r.concat(e)},[])}return n="number"==typeof n?n:1/0,n?t(r,1):Array.isArray(r)?r.map(function(r){return r}):r};

},{}],125:[function(require,module,exports){
module.exports=function(){if("undefined"==typeof window)return null;var n={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null};

},{}],126:[function(require,module,exports){
(function (Buffer){
"use strict";function HashBase(t){Transform.call(this),this._block=new Buffer(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}var Transform=require("stream").Transform,inherits=require("inherits");inherits(HashBase,Transform),HashBase.prototype._transform=function(t,e,r){var s=null;try{"buffer"!==e&&(t=new Buffer(t,e)),this.update(t)}catch(t){s=t}r(s)},HashBase.prototype._flush=function(t){var e=null;try{this.push(this._digest())}catch(t){e=t}t(e)},HashBase.prototype.update=function(t,e){if(!Buffer.isBuffer(t)&&"string"!=typeof t)throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");Buffer.isBuffer(t)||(t=new Buffer(t,e||"binary"));for(var r=this._block,s=0;this._blockOffset+t.length-s>=this._blockSize;){for(var i=this._blockOffset;i<this._blockSize;)r[i++]=t[s++];this._update(),this._blockOffset=0}for(;s<t.length;)r[this._blockOffset++]=t[s++];for(var o=0,a=8*t.length;a>0;++o)this._length[o]+=a,(a=this._length[o]/4294967296|0)>0&&(this._length[o]-=4294967296*a);return this},HashBase.prototype._update=function(t){throw new Error("_update is not implemented")},HashBase.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();return void 0!==t&&(e=e.toString(t)),e},HashBase.prototype._digest=function(){throw new Error("_digest is not implemented")},module.exports=HashBase;
}).call(this,require("buffer").Buffer)
},{"buffer":66,"inherits":144,"stream":269}],127:[function(require,module,exports){
var hash=exports;hash.utils=require("./hash/utils"),hash.common=require("./hash/common"),hash.sha=require("./hash/sha"),hash.ripemd=require("./hash/ripemd"),hash.hmac=require("./hash/hmac"),hash.sha1=hash.sha.sha1,hash.sha256=hash.sha.sha256,hash.sha224=hash.sha.sha224,hash.sha384=hash.sha.sha384,hash.sha512=hash.sha.sha512,hash.ripemd160=hash.ripemd.ripemd160;

},{"./hash/common":128,"./hash/hmac":129,"./hash/ripemd":130,"./hash/sha":131,"./hash/utils":138}],128:[function(require,module,exports){
"use strict";function BlockHash(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var utils=require("./utils"),assert=require("minimalistic-assert");exports.BlockHash=BlockHash,BlockHash.prototype.update=function(t,i){if(t=utils.toArray(t,i),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var n=t.length%this._delta8;this.pending=t.slice(t.length-n,t.length),0===this.pending.length&&(this.pending=null),t=utils.join32(t,0,t.length-n,this.endian);for(var s=0;s<t.length;s+=this._delta32)this._update(t,s,s+this._delta32)}return this},BlockHash.prototype.digest=function(t){return this.update(this._pad()),assert(null===this.pending),this._digest(t)},BlockHash.prototype._pad=function(){var t=this.pendingTotal,i=this._delta8,n=i-(t+this.padLength)%i,s=new Array(n+this.padLength);s[0]=128;for(var e=1;e<n;e++)s[e]=0;if(t<<=3,"big"===this.endian){for(var h=8;h<this.padLength;h++)s[e++]=0;s[e++]=0,s[e++]=0,s[e++]=0,s[e++]=0,s[e++]=t>>>24&255,s[e++]=t>>>16&255,s[e++]=t>>>8&255,s[e++]=255&t}else for(s[e++]=255&t,s[e++]=t>>>8&255,s[e++]=t>>>16&255,s[e++]=t>>>24&255,s[e++]=0,s[e++]=0,s[e++]=0,s[e++]=0,h=8;h<this.padLength;h++)s[e++]=0;return s};

},{"./utils":138,"minimalistic-assert":170}],129:[function(require,module,exports){
"use strict";function Hmac(t,i,e){if(!(this instanceof Hmac))return new Hmac(t,i,e);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(utils.toArray(i,e))}var utils=require("./utils"),assert=require("minimalistic-assert");module.exports=Hmac,Hmac.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),assert(t.length<=this.blockSize);for(var i=t.length;i<this.blockSize;i++)t.push(0);for(i=0;i<t.length;i++)t[i]^=54;for(this.inner=(new this.Hash).update(t),i=0;i<t.length;i++)t[i]^=106;this.outer=(new this.Hash).update(t)},Hmac.prototype.update=function(t,i){return this.inner.update(t,i),this},Hmac.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};

},{"./utils":138,"minimalistic-assert":170}],130:[function(require,module,exports){
"use strict";function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(t,s,h,i){return t<=15?s^h^i:t<=31?s&h|~s&i:t<=47?(s|~h)^i:t<=63?s&i|h&~i:s^(h|~i)}function K(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function Kh(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var utils=require("./utils"),common=require("./common"),rotl32=utils.rotl32,sum32=utils.sum32,sum32_3=utils.sum32_3,sum32_4=utils.sum32_4,BlockHash=common.BlockHash;utils.inherits(RIPEMD160,BlockHash),exports.ripemd160=RIPEMD160,RIPEMD160.blockSize=512,RIPEMD160.outSize=160,RIPEMD160.hmacStrength=192,RIPEMD160.padLength=64,RIPEMD160.prototype._update=function(t,h){for(var i=this.h[0],u=this.h[1],o=this.h[2],e=this.h[3],l=this.h[4],n=i,m=u,c=o,a=e,_=l,D=0;D<80;D++){var E=sum32(rotl32(sum32_4(i,f(D,u,o,e),t[r[D]+h],K(D)),s[D]),l);i=l,l=e,e=rotl32(o,10),o=u,u=E,E=sum32(rotl32(sum32_4(n,f(79-D,m,c,a),t[rh[D]+h],Kh(D)),sh[D]),_),n=_,_=a,a=rotl32(c,10),c=m,m=E}E=sum32_3(this.h[1],o,a),this.h[1]=sum32_3(this.h[2],e,_),this.h[2]=sum32_3(this.h[3],l,n),this.h[3]=sum32_3(this.h[4],i,m),this.h[4]=sum32_3(this.h[0],u,c),this.h[0]=E},RIPEMD160.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"little"):utils.split32(this.h,"little")};var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];

},{"./common":128,"./utils":138}],131:[function(require,module,exports){
"use strict";exports.sha1=require("./sha/1"),exports.sha224=require("./sha/224"),exports.sha256=require("./sha/256"),exports.sha384=require("./sha/384"),exports.sha512=require("./sha/512");

},{"./sha/1":132,"./sha/224":133,"./sha/256":134,"./sha/384":135,"./sha/512":136}],132:[function(require,module,exports){
"use strict";function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}var utils=require("../utils"),common=require("../common"),shaCommon=require("./common"),rotl32=utils.rotl32,sum32=utils.sum32,sum32_5=utils.sum32_5,ft_1=shaCommon.ft_1,BlockHash=common.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];utils.inherits(SHA1,BlockHash),module.exports=SHA1,SHA1.blockSize=512,SHA1.outSize=160,SHA1.hmacStrength=80,SHA1.padLength=64,SHA1.prototype._update=function(t,h){for(var s=this.W,i=0;i<16;i++)s[i]=t[h+i];for(;i<s.length;i++)s[i]=rotl32(s[i-3]^s[i-8]^s[i-14]^s[i-16],1);var o=this.h[0],r=this.h[1],u=this.h[2],e=this.h[3],l=this.h[4];for(i=0;i<s.length;i++){var m=~~(i/20),n=sum32_5(rotl32(o,5),ft_1(m,r,u,e),l,s[i],sha1_K[m]);l=e,e=u,u=rotl32(r,30),r=o,o=n}this.h[0]=sum32(this.h[0],o),this.h[1]=sum32(this.h[1],r),this.h[2]=sum32(this.h[2],u),this.h[3]=sum32(this.h[3],e),this.h[4]=sum32(this.h[4],l)},SHA1.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")};
},{"../common":128,"../utils":138,"./common":137}],133:[function(require,module,exports){
"use strict";function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}var utils=require("../utils"),SHA256=require("./256");utils.inherits(SHA224,SHA256),module.exports=SHA224,SHA224.blockSize=512,SHA224.outSize=224,SHA224.hmacStrength=192,SHA224.padLength=64,SHA224.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h.slice(0,7),"big"):utils.split32(this.h.slice(0,7),"big")};

},{"../utils":138,"./256":134}],134:[function(require,module,exports){
"use strict";function SHA256(){if(!(this instanceof SHA256))return new SHA256;BlockHash.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}var utils=require("../utils"),common=require("../common"),shaCommon=require("./common"),assert=require("minimalistic-assert"),sum32=utils.sum32,sum32_4=utils.sum32_4,sum32_5=utils.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash=common.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];utils.inherits(SHA256,BlockHash),module.exports=SHA256,SHA256.blockSize=512,SHA256.outSize=256,SHA256.hmacStrength=192,SHA256.padLength=64,SHA256.prototype._update=function(s,h){for(var t=this.W,i=0;i<16;i++)t[i]=s[h+i];for(;i<t.length;i++)t[i]=sum32_4(g1_256(t[i-2]),t[i-7],g0_256(t[i-15]),t[i-16]);var m=this.h[0],o=this.h[1],u=this.h[2],e=this.h[3],n=this.h[4],a=this.h[5],r=this.h[6],l=this.h[7];for(assert(this.k.length===t.length),i=0;i<t.length;i++){var _=sum32_5(l,s1_256(n),ch32(n,a,r),this.k[i],t[i]),c=sum32(s0_256(m),maj32(m,o,u));l=r,r=a,a=n,n=sum32(e,_),e=u,u=o,o=m,m=sum32(_,c)}this.h[0]=sum32(this.h[0],m),this.h[1]=sum32(this.h[1],o),this.h[2]=sum32(this.h[2],u),this.h[3]=sum32(this.h[3],e),this.h[4]=sum32(this.h[4],n),this.h[5]=sum32(this.h[5],a),this.h[6]=sum32(this.h[6],r),this.h[7]=sum32(this.h[7],l)},SHA256.prototype._digest=function(s){return"hex"===s?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")};

},{"../common":128,"../utils":138,"./common":137,"minimalistic-assert":170}],135:[function(require,module,exports){
"use strict";function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}var utils=require("../utils"),SHA512=require("./512");utils.inherits(SHA384,SHA512),module.exports=SHA384,SHA384.blockSize=1024,SHA384.outSize=384,SHA384.hmacStrength=192,SHA384.padLength=128,SHA384.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h.slice(0,12),"big"):utils.split32(this.h.slice(0,12),"big")};

},{"../utils":138,"./512":136}],136:[function(require,module,exports){
"use strict";function SHA512(){if(!(this instanceof SHA512))return new SHA512;BlockHash.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}function ch64_hi(t,h,r,i,s){var _=t&r^~t&s;return _<0&&(_+=4294967296),_}function ch64_lo(t,h,r,i,s,_){var o=h&i^~h&_;return o<0&&(o+=4294967296),o}function maj64_hi(t,h,r,i,s){var _=t&r^t&s^r&s;return _<0&&(_+=4294967296),_}function maj64_lo(t,h,r,i,s,_){var o=h&i^h&_^i&_;return o<0&&(o+=4294967296),o}function s0_512_hi(t,h){var r=rotr64_hi(t,h,28),i=rotr64_hi(h,t,2),s=rotr64_hi(h,t,7),_=r^i^s;return _<0&&(_+=4294967296),_}function s0_512_lo(t,h){var r=rotr64_lo(t,h,28),i=rotr64_lo(h,t,2),s=rotr64_lo(h,t,7),_=r^i^s;return _<0&&(_+=4294967296),_}function s1_512_hi(t,h){var r=rotr64_hi(t,h,14),i=rotr64_hi(t,h,18),s=rotr64_hi(h,t,9),_=r^i^s;return _<0&&(_+=4294967296),_}function s1_512_lo(t,h){var r=rotr64_lo(t,h,14),i=rotr64_lo(t,h,18),s=rotr64_lo(h,t,9),_=r^i^s;return _<0&&(_+=4294967296),_}function g0_512_hi(t,h){var r=rotr64_hi(t,h,1),i=rotr64_hi(t,h,8),s=shr64_hi(t,h,7),_=r^i^s;return _<0&&(_+=4294967296),_}function g0_512_lo(t,h){var r=rotr64_lo(t,h,1),i=rotr64_lo(t,h,8),s=shr64_lo(t,h,7),_=r^i^s;return _<0&&(_+=4294967296),_}function g1_512_hi(t,h){var r=rotr64_hi(t,h,19),i=rotr64_hi(h,t,29),s=shr64_hi(t,h,6),_=r^i^s;return _<0&&(_+=4294967296),_}function g1_512_lo(t,h){var r=rotr64_lo(t,h,19),i=rotr64_lo(h,t,29),s=shr64_lo(t,h,6),_=r^i^s;return _<0&&(_+=4294967296),_}var utils=require("../utils"),common=require("../common"),assert=require("minimalistic-assert"),rotr64_hi=utils.rotr64_hi,rotr64_lo=utils.rotr64_lo,shr64_hi=utils.shr64_hi,shr64_lo=utils.shr64_lo,sum64=utils.sum64,sum64_hi=utils.sum64_hi,sum64_lo=utils.sum64_lo,sum64_4_hi=utils.sum64_4_hi,sum64_4_lo=utils.sum64_4_lo,sum64_5_hi=utils.sum64_5_hi,sum64_5_lo=utils.sum64_5_lo,BlockHash=common.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];utils.inherits(SHA512,BlockHash),module.exports=SHA512,SHA512.blockSize=1024,SHA512.outSize=512,SHA512.hmacStrength=192,SHA512.padLength=128,SHA512.prototype._prepareBlock=function(t,h){for(var r=this.W,i=0;i<32;i++)r[i]=t[h+i];for(;i<r.length;i+=2){var s=g1_512_hi(r[i-4],r[i-3]),_=g1_512_lo(r[i-4],r[i-3]),o=r[i-14],u=r[i-13],l=g0_512_hi(r[i-30],r[i-29]),n=g0_512_lo(r[i-30],r[i-29]),e=r[i-32],m=r[i-31];r[i]=sum64_4_hi(s,_,o,u,l,n,e,m),r[i+1]=sum64_4_lo(s,_,o,u,l,n,e,m)}},SHA512.prototype._update=function(t,h){this._prepareBlock(t,h);var r=this.W,i=this.h[0],s=this.h[1],_=this.h[2],o=this.h[3],u=this.h[4],l=this.h[5],n=this.h[6],e=this.h[7],m=this.h[8],a=this.h[9],c=this.h[10],f=this.h[11],v=this.h[12],g=this.h[13],H=this.h[14],S=this.h[15];assert(this.k.length===r.length);for(var p=0;p<r.length;p+=2){var A=H,k=S,B=s1_512_hi(m,a),d=s1_512_lo(m,a),j=ch64_hi(m,a,c,f,v,g),y=ch64_lo(m,a,c,f,v,g),b=this.k[p],q=this.k[p+1],x=r[p],W=r[p+1],w=sum64_5_hi(A,k,B,d,j,y,b,q,x,W),z=sum64_5_lo(A,k,B,d,j,y,b,q,x,W);A=s0_512_hi(i,s),k=s0_512_lo(i,s),B=maj64_hi(i,s,_,o,u,l),d=maj64_lo(i,s,_,o,u,l);var K=sum64_hi(A,k,B,d),L=sum64_lo(A,k,B,d);H=v,S=g,v=c,g=f,c=m,f=a,m=sum64_hi(n,e,w,z),a=sum64_lo(e,e,w,z),n=u,e=l,u=_,l=o,_=i,o=s,i=sum64_hi(w,z,K,L),s=sum64_lo(w,z,K,L)}sum64(this.h,0,i,s),sum64(this.h,2,_,o),sum64(this.h,4,u,l),sum64(this.h,6,n,e),sum64(this.h,8,m,a),sum64(this.h,10,c,f),sum64(this.h,12,v,g),sum64(this.h,14,H,S)},SHA512.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")};

},{"../common":128,"../utils":138,"minimalistic-assert":170}],137:[function(require,module,exports){
"use strict";function ft_1(r,t,o,n){return 0===r?ch32(t,o,n):1===r||3===r?p32(t,o,n):2===r?maj32(t,o,n):void 0}function ch32(r,t,o){return r&t^~r&o}function maj32(r,t,o){return r&t^r&o^t&o}function p32(r,t,o){return r^t^o}function s0_256(r){return rotr32(r,2)^rotr32(r,13)^rotr32(r,22)}function s1_256(r){return rotr32(r,6)^rotr32(r,11)^rotr32(r,25)}function g0_256(r){return rotr32(r,7)^rotr32(r,18)^r>>>3}function g1_256(r){return rotr32(r,17)^rotr32(r,19)^r>>>10}var utils=require("../utils"),rotr32=utils.rotr32;exports.ft_1=ft_1,exports.ch32=ch32,exports.maj32=maj32,exports.p32=p32,exports.s0_256=s0_256,exports.s1_256=s1_256,exports.g0_256=g0_256,exports.g1_256=g1_256;
},{"../utils":138}],138:[function(require,module,exports){
"use strict";function toArray(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var o=[];if("string"==typeof r)if(t){if("hex"===t)for(r=r.replace(/[^a-z0-9]+/gi,""),r.length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)o.push(parseInt(r[n]+r[n+1],16))}else for(var n=0;n<r.length;n++){var e=r.charCodeAt(n),s=e>>8,u=255&e;s?o.push(s,u):o.push(u)}else for(n=0;n<r.length;n++)o[n]=0|r[n];return o}function toHex(r){for(var t="",o=0;o<r.length;o++)t+=zero2(r[o].toString(16));return t}function htonl(r){return(r>>>24|r>>>8&65280|r<<8&16711680|(255&r)<<24)>>>0}function toHex32(r,t){for(var o="",n=0;n<r.length;n++){var e=r[n];"little"===t&&(e=htonl(e)),o+=zero8(e.toString(16))}return o}function zero2(r){return 1===r.length?"0"+r:r}function zero8(r){return 7===r.length?"0"+r:6===r.length?"00"+r:5===r.length?"000"+r:4===r.length?"0000"+r:3===r.length?"00000"+r:2===r.length?"000000"+r:1===r.length?"0000000"+r:r}function join32(r,t,o,n){var e=o-t;assert(e%4==0);for(var s=new Array(e/4),u=0,i=t;u<s.length;u++,i+=4){var h;h="big"===n?r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]:r[i+3]<<24|r[i+2]<<16|r[i+1]<<8|r[i],s[u]=h>>>0}return s}function split32(r,t){for(var o=new Array(4*r.length),n=0,e=0;n<r.length;n++,e+=4){var s=r[n];"big"===t?(o[e]=s>>>24,o[e+1]=s>>>16&255,o[e+2]=s>>>8&255,o[e+3]=255&s):(o[e+3]=s>>>24,o[e+2]=s>>>16&255,o[e+1]=s>>>8&255,o[e]=255&s)}return o}function rotr32(r,t){return r>>>t|r<<32-t}function rotl32(r,t){return r<<t|r>>>32-t}function sum32(r,t){return r+t>>>0}function sum32_3(r,t,o){return r+t+o>>>0}function sum32_4(r,t,o,n){return r+t+o+n>>>0}function sum32_5(r,t,o,n,e){return r+t+o+n+e>>>0}function sum64(r,t,o,n){var e=r[t],s=r[t+1],u=n+s>>>0,i=(u<n?1:0)+o+e;r[t]=i>>>0,r[t+1]=u}function sum64_hi(r,t,o,n){return(t+n>>>0<t?1:0)+r+o>>>0}function sum64_lo(r,t,o,n){return t+n>>>0}function sum64_4_hi(r,t,o,n,e,s,u,i){var h=0,_=t;return _=_+n>>>0,h+=_<t?1:0,_=_+s>>>0,h+=_<s?1:0,_=_+i>>>0,h+=_<i?1:0,r+o+e+u+h>>>0}function sum64_4_lo(r,t,o,n,e,s,u,i){return t+n+s+i>>>0}function sum64_5_hi(r,t,o,n,e,s,u,i,h,_){var l=0,f=t;return f=f+n>>>0,l+=f<t?1:0,f=f+s>>>0,l+=f<s?1:0,f=f+i>>>0,l+=f<i?1:0,f=f+_>>>0,l+=f<_?1:0,r+o+e+u+h+l>>>0}function sum64_5_lo(r,t,o,n,e,s,u,i,h,_){return t+n+s+i+_>>>0}function rotr64_hi(r,t,o){return(t<<32-o|r>>>o)>>>0}function rotr64_lo(r,t,o){return(r<<32-o|t>>>o)>>>0}function shr64_hi(r,t,o){return r>>>o}function shr64_lo(r,t,o){return(r<<32-o|t>>>o)>>>0}var assert=require("minimalistic-assert"),inherits=require("inherits");exports.inherits=inherits,exports.toArray=toArray,exports.toHex=toHex,exports.htonl=htonl,exports.toHex32=toHex32,exports.zero2=zero2,exports.zero8=zero8,exports.join32=join32,exports.split32=split32,exports.rotr32=rotr32,exports.rotl32=rotl32,exports.sum32=sum32,exports.sum32_3=sum32_3,exports.sum32_4=sum32_4,exports.sum32_5=sum32_5,exports.sum64=sum64,exports.sum64_hi=sum64_hi,exports.sum64_lo=sum64_lo,exports.sum64_4_hi=sum64_4_hi,exports.sum64_4_lo=sum64_4_lo,exports.sum64_5_hi=sum64_5_hi,exports.sum64_5_lo=sum64_5_lo,exports.rotr64_hi=rotr64_hi,exports.rotr64_lo=rotr64_lo,exports.shr64_hi=shr64_hi,exports.shr64_lo=shr64_lo;
},{"inherits":144,"minimalistic-assert":170}],139:[function(require,module,exports){
"use strict";function HmacDRBG(t){if(!(this instanceof HmacDRBG))return new HmacDRBG(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=utils.toArray(t.entropy,t.entropyEnc||"hex"),i=utils.toArray(t.nonce,t.nonceEnc||"hex"),s=utils.toArray(t.pers,t.persEnc||"hex");assert(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,i,s)}var hash=require("hash.js"),utils=require("minimalistic-crypto-utils"),assert=require("minimalistic-assert");module.exports=HmacDRBG,HmacDRBG.prototype._init=function(t,e,i){var s=t.concat(e).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656},HmacDRBG.prototype._hmac=function(){return new hash.hmac(this.hash,this.K)},HmacDRBG.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},HmacDRBG.prototype.reseed=function(t,e,i,s){"string"!=typeof e&&(s=i,i=e,e=null),t=utils.toArray(t,e),i=utils.toArray(i,s),assert(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(i||[])),this._reseed=1},HmacDRBG.prototype.generate=function(t,e,i,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(s=i,i=e,e=null),i&&(i=utils.toArray(i,s||"hex"),this._update(i));for(var h=[];h.length<t;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var r=h.slice(0,t);return this._update(i),this._reseed++,utils.encode(r,e)};

},{"hash.js":127,"minimalistic-assert":170,"minimalistic-crypto-utils":171}],140:[function(require,module,exports){
var http=require("http"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);https.request=function(t,e){return t||(t={}),t.scheme="https",t.protocol="https:",http.request.call(this,t,e)};

},{"http":270}],141:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),o+=p+N>=1?n/f:n*Math.pow(2,1-N),o*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],142:[function(require,module,exports){
(function (process){
function ImmediateStore(t){if(!(this instanceof ImmediateStore))return new ImmediateStore(t);if(this.store=t,this.chunkLength=t.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.mem=[]}function nextTick(t,e,o){process.nextTick(function(){t&&t(e,o)})}module.exports=ImmediateStore,ImmediateStore.prototype.put=function(t,e,o){var i=this;i.mem[t]=e,i.store.put(t,e,function(e){i.mem[t]=null,o&&o(e)})},ImmediateStore.prototype.get=function(t,e,o){if("function"==typeof e)return this.get(t,null,e);var i=e&&e.offset||0,n=e&&e.length&&i+e.length,r=this.mem[t];if(r)return nextTick(o,null,e?r.slice(i,n):r);this.store.get(t,e,o)},ImmediateStore.prototype.close=function(t){this.store.close(t)},ImmediateStore.prototype.destroy=function(t){this.store.destroy(t)};

}).call(this,require('_process'))
},{"_process":205}],143:[function(require,module,exports){
var indexOf=[].indexOf;module.exports=function(e,n){if(indexOf)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1};

},{}],144:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],145:[function(require,module,exports){
var MAX_ASCII_CHAR_CODE=127;module.exports=function(r){for(var A=0,C=r.length;A<C;++A)if(r.charCodeAt(A)>MAX_ASCII_CHAR_CODE)return!1;return!0};

},{}],146:[function(require,module,exports){
function isBuffer(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}function isSlowBuffer(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&isBuffer(f.slice(0,0))}module.exports=function(f){return null!=f&&(isBuffer(f)||isSlowBuffer(f)||!!f._isBuffer)};

},{}],147:[function(require,module,exports){
"use strict";function isFileSync(s){return fs.existsSync(s)&&fs.statSync(s).isFile()}var fs=require("fs");module.exports=function(s,i){if(!i)return isFileSync(s);fs.stat(s,function(s,e){return s?i(s):i(null,e.isFile())})},module.exports.sync=isFileSync;

},{"fs":63}],148:[function(require,module,exports){
function isTypedArray(r){return isStrictTypedArray(r)||isLooseTypedArray(r)}function isStrictTypedArray(r){return r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array}function isLooseTypedArray(r){return names[toString.call(r)]}module.exports=isTypedArray,isTypedArray.strict=isStrictTypedArray,isTypedArray.loose=isLooseTypedArray;var toString=Object.prototype.toString,names={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};
},{}],149:[function(require,module,exports){
var toString={}.toString;module.exports=Array.isArray||function(r){return"[object Array]"==toString.call(r)};

},{}],150:[function(require,module,exports){
function rx(r){return r instanceof RX?function(n){var t=r.exec(n);return t&&(t[1]?t[1]:t[0])}:r}var each=exports.each=function(r,n){Object.keys(r).forEach(function(t){n(r[t],t,r)})},RX=/sadf/.constructor,times=exports.times=function(){var r,n,t=[].slice.call(arguments),e=rx(t.pop()),i=t.pop(),f=t.shift(),o=t.shift(),u=[];if(f="number"==typeof f?f:1,r=o?o-f:1,n=f<i,i==f)throw new Error("steps cannot be the same: "+i+", "+f);for(;n?f<=i:i<=f;f+=r)u.push(e(f));return u},map=exports.map=function(r,n){if(n=rx(n),Array.isArray(r))return r.map(n);if("number"==typeof r)return times.apply(null,[].slice.call(arguments));var t=Object.keys(r),e={};return t.forEach(function(t){e[t]=n(r[t],t,r)}),e},findReturn=exports.findReturn=function(r,n){if(n=rx(n),null!=r)for(var t=Object.keys(r),e=t.length,i=0;i<e;i++){var f=t[i],o=r[f],u=n(o,f);if(u)return u}},find=exports.find=function(r,n){return n=rx(n),findReturn(r,function(r,t){if(n(r,t))return r})},findKey=exports.findKey=function(r,n){return n=rx(n),findReturn(r,function(r,t){if(n(r,t))return t})},filter=exports.filter=function(r,n){if(n=rx(n),Array.isArray(r))return r.filter(n);var t=Object.keys(r),e={};return t.forEach(function(t){var i;n(i=r[t],t,r)&&(e[t]=i)}),e},mapKeys=exports.mapKeys=function(r,n){var t={};return n=rx(n),each(r,function(r,e){t[r]=n(r,e)}),t},mapToArray=exports.mapToArray=function(r,n){var t=[];return n=rx(n),each(r,function(r,e){t.push(n(r,e))}),t},path=exports.path=function(r,n){for(var t in n){if(null==r)return;r=r[n[t]]}return r},setPath=exports.setPath=function(r,n,t){for(var e in n){var i=n[e];null==r[i]&&(r[i]=e+1==n.length?t:{}),r=r[i]}},join=exports.join=function(r,n,t){each(r,function(r,e){each(n,function(n,i){t(r,n,e,i)})})};

},{}],151:[function(require,module,exports){
(function (Buffer){
'use strict';

var MediaFileReader = require('./MediaFileReader');

class ArrayFileReader extends MediaFileReader {

  constructor(array) {
    super();
    this._array = array;
    this._size = array.length;
    this._isInitialized = true;
  }

  static canReadFile(file) {
    return Array.isArray(file) || typeof Buffer === 'function' && Buffer.isBuffer(file);
  }

  init(callbacks) {
    setTimeout(callbacks.onSuccess, 0);
  }

  loadRange(range, callbacks) {
    setTimeout(callbacks.onSuccess, 0);
  }

  getByteAt(offset) {
    if (offset >= this._array.length) {
      throw new Error("Offset " + offset + " hasn't been loaded yet.");
    }
    return this._array[offset];
  }
}

module.exports = ArrayFileReader;
}).call(this,require("buffer").Buffer)
},{"./MediaFileReader":158,"buffer":66}],152:[function(require,module,exports){
'use strict';

const ChunkedFileData = require('./ChunkedFileData');
const MediaFileReader = require('./MediaFileReader');

class BlobFileReader extends MediaFileReader {

  constructor(blob) {
    super();
    this._blob = blob;
    this._fileData = new ChunkedFileData();
  }

  static canReadFile(file) {
    return typeof Blob !== "undefined" && file instanceof Blob ||
    // File extends Blob but it seems that File instanceof Blob doesn't
    // quite work as expected in Cordova/PhoneGap.
    typeof File !== "undefined" && file instanceof File;
  }

  _init(callbacks) {
    this._size = this._blob.size;
    setTimeout(callbacks.onSuccess, 1);
  }

  loadRange(range, callbacks) {
    var self = this;
    // $FlowIssue - flow isn't aware of mozSlice or webkitSlice
    var blobSlice = this._blob.slice || this._blob.mozSlice || this._blob.webkitSlice;
    var blob = blobSlice.call(this._blob, range[0], range[1] + 1);
    var browserFileReader = new FileReader();

    browserFileReader.onloadend = function (event) {
      var intArray = new Uint8Array(browserFileReader.result);
      self._fileData.addData(range[0], intArray);
      callbacks.onSuccess();
    };
    browserFileReader.onerror = browserFileReader.onabort = function (event) {
      if (callbacks.onError) {
        callbacks.onError({ "type": "blob", "info": browserFileReader.error });
      }
    };

    browserFileReader.readAsArrayBuffer(blob);
  }

  getByteAt(offset) {
    return this._fileData.getByteAt(offset);
  }
}

module.exports = BlobFileReader;
},{"./ChunkedFileData":153,"./MediaFileReader":158}],153:[function(require,module,exports){
/**
 * This class represents a file that might not have all its data loaded yet.
 * It is used when loading the entire file is not an option because it's too
 * expensive. Instead, parts of the file are loaded and added only when needed.
 * From a reading point of view is as if the entire file is loaded. The
 * exception is when the data is not available yet, an error will be thrown.
 * This class does not load the data, it just manages it. It provides operations
 * to add and read data from the file.
 *
 * 
 */
'use strict';

const NOT_FOUND = -1;

class ChunkedFileData {
  // $FlowIssue - get/set properties not yet supported
  static get NOT_FOUND() {
    return NOT_FOUND;
  }


  constructor() {
    this._fileData = [];
  }

  /**
   * Adds data to the file storage at a specific offset.
   */
  addData(offset, data) {
    var offsetEnd = offset + data.length - 1;
    var chunkRange = this._getChunkRange(offset, offsetEnd);

    if (chunkRange.startIx === NOT_FOUND) {
      this._fileData.splice(chunkRange.insertIx || 0, 0, {
        offset: offset,
        data: data
      });
    } else {
      // If the data to add collides with existing chunks we prepend and
      // append data from the half colliding chunks to make the collision at
      // 100%. The new data can then replace all the colliding chunkes.
      var firstChunk = this._fileData[chunkRange.startIx];
      var lastChunk = this._fileData[chunkRange.endIx];
      var needsPrepend = offset > firstChunk.offset;
      var needsAppend = offsetEnd < lastChunk.offset + lastChunk.data.length - 1;

      var chunk = {
        offset: Math.min(offset, firstChunk.offset),
        data: data
      };

      if (needsPrepend) {
        var slicedData = this._sliceData(firstChunk.data, 0, offset - firstChunk.offset);
        chunk.data = this._concatData(slicedData, data);
      }

      if (needsAppend) {
        // Use the lastChunk because the slice logic is easier to handle.
        var slicedData = this._sliceData(chunk.data, 0, lastChunk.offset - chunk.offset);
        chunk.data = this._concatData(slicedData, lastChunk.data);
      }

      this._fileData.splice(chunkRange.startIx, chunkRange.endIx - chunkRange.startIx + 1, chunk);
    }
  }

  _concatData(dataA, dataB) {
    // TypedArrays don't support concat.
    if (typeof ArrayBuffer !== "undefined" && ArrayBuffer.isView && ArrayBuffer.isView(dataA)) {
      // $FlowIssue - flow thinks dataAandB is a string but it's not
      var dataAandB = new dataA.constructor(dataA.length + dataB.length);
      // $FlowIssue - flow thinks dataAandB is a string but it's not
      dataAandB.set(dataA, 0);
      // $FlowIssue - flow thinks dataAandB is a string but it's not
      dataAandB.set(dataB, dataA.length);
      return dataAandB;
    } else {
      // $FlowIssue - flow thinks dataAandB is a TypedArray but it's not
      return dataA.concat(dataB);
    }
  }

  _sliceData(data, begin, end) {
    // Some TypeArray implementations do not support slice yet.
    if (data.slice) {
      return data.slice(begin, end);
    } else {
      // $FlowIssue - flow thinks data is a string but it's not
      return data.subarray(begin, end);
    }
  }

  /**
   * Finds the chunk range that overlaps the [offsetStart-1,offsetEnd+1] range.
   * When a chunk is adjacent to the offset we still consider it part of the
   * range (this is the situation of offsetStart-1 or offsetEnd+1).
   * When no chunks are found `insertIx` denotes the index where the data
   * should be inserted in the data list (startIx == NOT_FOUND and endIX ==
   * NOT_FOUND).
   */
  _getChunkRange(offsetStart, offsetEnd) {
    var startChunkIx = NOT_FOUND;
    var endChunkIx = NOT_FOUND;
    var insertIx = 0;

    // Could use binary search but not expecting that many blocks to exist.
    for (var i = 0; i < this._fileData.length; i++, insertIx = i) {
      var chunkOffsetStart = this._fileData[i].offset;
      var chunkOffsetEnd = chunkOffsetStart + this._fileData[i].data.length;

      if (offsetEnd < chunkOffsetStart - 1) {
        // This offset range doesn't overlap with any chunks.
        break;
      }
      // If it is adjacent we still consider it part of the range because
      // we're going end up with a single block with all contiguous data.
      if (offsetStart <= chunkOffsetEnd + 1 && offsetEnd >= chunkOffsetStart - 1) {
        startChunkIx = i;
        break;
      }
    }

    // No starting chunk was found, meaning that the offset is either before
    // or after the current stored chunks.
    if (startChunkIx === NOT_FOUND) {
      return {
        startIx: NOT_FOUND,
        endIx: NOT_FOUND,
        insertIx: insertIx
      };
    }

    // Find the ending chunk.
    for (var i = startChunkIx; i < this._fileData.length; i++) {
      var chunkOffsetStart = this._fileData[i].offset;
      var chunkOffsetEnd = chunkOffsetStart + this._fileData[i].data.length;

      if (offsetEnd >= chunkOffsetStart - 1) {
        // Candidate for the end chunk, it doesn't mean it is yet.
        endChunkIx = i;
      }
      if (offsetEnd <= chunkOffsetEnd + 1) {
        break;
      }
    }

    if (endChunkIx === NOT_FOUND) {
      endChunkIx = startChunkIx;
    }

    return {
      startIx: startChunkIx,
      endIx: endChunkIx
    };
  }

  hasDataRange(offsetStart, offsetEnd) {
    for (var i = 0; i < this._fileData.length; i++) {
      var chunk = this._fileData[i];
      if (offsetEnd < chunk.offset) {
        return false;
      }

      if (offsetStart >= chunk.offset && offsetEnd < chunk.offset + chunk.data.length) {
        return true;
      }
    }

    return false;
  }

  getByteAt(offset) {
    var dataChunk;

    for (var i = 0; i < this._fileData.length; i++) {
      var dataChunkStart = this._fileData[i].offset;
      var dataChunkEnd = dataChunkStart + this._fileData[i].data.length - 1;

      if (offset >= dataChunkStart && offset <= dataChunkEnd) {
        dataChunk = this._fileData[i];
        break;
      }
    }

    if (dataChunk) {
      return dataChunk.data[offset - dataChunk.offset];
    }

    throw new Error("Offset " + offset + " hasn't been loaded yet.");
  }
}

module.exports = ChunkedFileData;
},{}],154:[function(require,module,exports){
'use strict';

var MediaTagReader = require('./MediaTagReader');
var MediaFileReader = require('./MediaFileReader');

class ID3v1TagReader extends MediaTagReader {
  static getTagIdentifierByteRange() {
    // The identifier is TAG and is at offset: -128. However, to avoid a
    // fetch for the tag identifier and another for the data, we load the
    // entire data since it's so small.
    return {
      offset: -128,
      length: 128
    };
  }

  static canReadTagFormat(tagIdentifier) {
    var id = String.fromCharCode.apply(String, tagIdentifier.slice(0, 3));
    return id === "TAG";
  }

  _loadData(mediaFileReader, callbacks) {
    var fileSize = mediaFileReader.getSize();
    mediaFileReader.loadRange([fileSize - 128, fileSize - 1], callbacks);
  }

  _parseData(data, tags) {
    var offset = data.getSize() - 128;

    var title = data.getStringWithCharsetAt(offset + 3, 30).toString();
    var artist = data.getStringWithCharsetAt(offset + 33, 30).toString();
    var album = data.getStringWithCharsetAt(offset + 63, 30).toString();
    var year = data.getStringWithCharsetAt(offset + 93, 4).toString();

    var trackFlag = data.getByteAt(offset + 97 + 28);
    var track = data.getByteAt(offset + 97 + 29);
    if (trackFlag == 0 && track != 0) {
      var version = "1.1";
      var comment = data.getStringWithCharsetAt(offset + 97, 28).toString();
    } else {
      var version = "1.0";
      var comment = data.getStringWithCharsetAt(offset + 97, 30).toString();
      track = 0;
    }

    var genreIdx = data.getByteAt(offset + 97 + 30);
    if (genreIdx < 255) {
      var genre = GENRES[genreIdx];
    } else {
      var genre = "";
    }

    var tag = {
      "type": "ID3",
      "version": version,
      "tags": {
        "title": title,
        "artist": artist,
        "album": album,
        "year": year,
        "comment": comment,
        "genre": genre
      }
    };

    if (track) {
      // $FlowIssue - flow is not happy with adding properties
      tag.tags.track = track;
    }

    return tag;
  }
}

var GENRES = ["Blues", "Classic Rock", "Country", "Dance", "Disco", "Funk", "Grunge", "Hip-Hop", "Jazz", "Metal", "New Age", "Oldies", "Other", "Pop", "R&B", "Rap", "Reggae", "Rock", "Techno", "Industrial", "Alternative", "Ska", "Death Metal", "Pranks", "Soundtrack", "Euro-Techno", "Ambient", "Trip-Hop", "Vocal", "Jazz+Funk", "Fusion", "Trance", "Classical", "Instrumental", "Acid", "House", "Game", "Sound Clip", "Gospel", "Noise", "AlternRock", "Bass", "Soul", "Punk", "Space", "Meditative", "Instrumental Pop", "Instrumental Rock", "Ethnic", "Gothic", "Darkwave", "Techno-Industrial", "Electronic", "Pop-Folk", "Eurodance", "Dream", "Southern Rock", "Comedy", "Cult", "Gangsta", "Top 40", "Christian Rap", "Pop/Funk", "Jungle", "Native American", "Cabaret", "New Wave", "Psychadelic", "Rave", "Showtunes", "Trailer", "Lo-Fi", "Tribal", "Acid Punk", "Acid Jazz", "Polka", "Retro", "Musical", "Rock & Roll", "Hard Rock", "Folk", "Folk-Rock", "National Folk", "Swing", "Fast Fusion", "Bebob", "Latin", "Revival", "Celtic", "Bluegrass", "Avantgarde", "Gothic Rock", "Progressive Rock", "Psychedelic Rock", "Symphonic Rock", "Slow Rock", "Big Band", "Chorus", "Easy Listening", "Acoustic", "Humour", "Speech", "Chanson", "Opera", "Chamber Music", "Sonata", "Symphony", "Booty Bass", "Primus", "Porn Groove", "Satire", "Slow Jam", "Club", "Tango", "Samba", "Folklore", "Ballad", "Power Ballad", "Rhythmic Soul", "Freestyle", "Duet", "Punk Rock", "Drum Solo", "Acapella", "Euro-House", "Dance Hall"];

module.exports = ID3v1TagReader;
},{"./MediaFileReader":158,"./MediaTagReader":159}],155:[function(require,module,exports){
'use strict';

var MediaFileReader = require('./MediaFileReader');
const StringUtils = require('./StringUtils');
var ArrayFileReader = require('./ArrayFileReader');

const FRAME_DESCRIPTIONS = {
  // v2.2
  "BUF": "Recommended buffer size",
  "CNT": "Play counter",
  "COM": "Comments",
  "CRA": "Audio encryption",
  "CRM": "Encrypted meta frame",
  "ETC": "Event timing codes",
  "EQU": "Equalization",
  "GEO": "General encapsulated object",
  "IPL": "Involved people list",
  "LNK": "Linked information",
  "MCI": "Music CD Identifier",
  "MLL": "MPEG location lookup table",
  "PIC": "Attached picture",
  "POP": "Popularimeter",
  "REV": "Reverb",
  "RVA": "Relative volume adjustment",
  "SLT": "Synchronized lyric/text",
  "STC": "Synced tempo codes",
  "TAL": "Album/Movie/Show title",
  "TBP": "BPM (Beats Per Minute)",
  "TCM": "Composer",
  "TCO": "Content type",
  "TCR": "Copyright message",
  "TDA": "Date",
  "TDY": "Playlist delay",
  "TEN": "Encoded by",
  "TFT": "File type",
  "TIM": "Time",
  "TKE": "Initial key",
  "TLA": "Language(s)",
  "TLE": "Length",
  "TMT": "Media type",
  "TOA": "Original artist(s)/performer(s)",
  "TOF": "Original filename",
  "TOL": "Original Lyricist(s)/text writer(s)",
  "TOR": "Original release year",
  "TOT": "Original album/Movie/Show title",
  "TP1": "Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",
  "TP2": "Band/Orchestra/Accompaniment",
  "TP3": "Conductor/Performer refinement",
  "TP4": "Interpreted, remixed, or otherwise modified by",
  "TPA": "Part of a set",
  "TPB": "Publisher",
  "TRC": "ISRC (International Standard Recording Code)",
  "TRD": "Recording dates",
  "TRK": "Track number/Position in set",
  "TSI": "Size",
  "TSS": "Software/hardware and settings used for encoding",
  "TT1": "Content group description",
  "TT2": "Title/Songname/Content description",
  "TT3": "Subtitle/Description refinement",
  "TXT": "Lyricist/text writer",
  "TXX": "User defined text information frame",
  "TYE": "Year",
  "UFI": "Unique file identifier",
  "ULT": "Unsychronized lyric/text transcription",
  "WAF": "Official audio file webpage",
  "WAR": "Official artist/performer webpage",
  "WAS": "Official audio source webpage",
  "WCM": "Commercial information",
  "WCP": "Copyright/Legal information",
  "WPB": "Publishers official webpage",
  "WXX": "User defined URL link frame",
  // v2.3
  "AENC": "Audio encryption",
  "APIC": "Attached picture",
  "ASPI": "Audio seek point index",
  "CHAP": "Chapter",
  "CTOC": "Table of contents",
  "COMM": "Comments",
  "COMR": "Commercial frame",
  "ENCR": "Encryption method registration",
  "EQU2": "Equalisation (2)",
  "EQUA": "Equalization",
  "ETCO": "Event timing codes",
  "GEOB": "General encapsulated object",
  "GRID": "Group identification registration",
  "IPLS": "Involved people list",
  "LINK": "Linked information",
  "MCDI": "Music CD identifier",
  "MLLT": "MPEG location lookup table",
  "OWNE": "Ownership frame",
  "PRIV": "Private frame",
  "PCNT": "Play counter",
  "POPM": "Popularimeter",
  "POSS": "Position synchronisation frame",
  "RBUF": "Recommended buffer size",
  "RVA2": "Relative volume adjustment (2)",
  "RVAD": "Relative volume adjustment",
  "RVRB": "Reverb",
  "SEEK": "Seek frame",
  "SYLT": "Synchronized lyric/text",
  "SYTC": "Synchronized tempo codes",
  "TALB": "Album/Movie/Show title",
  "TBPM": "BPM (beats per minute)",
  "TCOM": "Composer",
  "TCON": "Content type",
  "TCOP": "Copyright message",
  "TDAT": "Date",
  "TDLY": "Playlist delay",
  "TDRC": "Recording time",
  "TDRL": "Release time",
  "TDTG": "Tagging time",
  "TENC": "Encoded by",
  "TEXT": "Lyricist/Text writer",
  "TFLT": "File type",
  "TIME": "Time",
  "TIPL": "Involved people list",
  "TIT1": "Content group description",
  "TIT2": "Title/songname/content description",
  "TIT3": "Subtitle/Description refinement",
  "TKEY": "Initial key",
  "TLAN": "Language(s)",
  "TLEN": "Length",
  "TMCL": "Musician credits list",
  "TMED": "Media type",
  "TMOO": "Mood",
  "TOAL": "Original album/movie/show title",
  "TOFN": "Original filename",
  "TOLY": "Original lyricist(s)/text writer(s)",
  "TOPE": "Original artist(s)/performer(s)",
  "TORY": "Original release year",
  "TOWN": "File owner/licensee",
  "TPE1": "Lead performer(s)/Soloist(s)",
  "TPE2": "Band/orchestra/accompaniment",
  "TPE3": "Conductor/performer refinement",
  "TPE4": "Interpreted, remixed, or otherwise modified by",
  "TPOS": "Part of a set",
  "TPRO": "Produced notice",
  "TPUB": "Publisher",
  "TRCK": "Track number/Position in set",
  "TRDA": "Recording dates",
  "TRSN": "Internet radio station name",
  "TRSO": "Internet radio station owner",
  "TSOA": "Album sort order",
  "TSOP": "Performer sort order",
  "TSOT": "Title sort order",
  "TSIZ": "Size",
  "TSRC": "ISRC (international standard recording code)",
  "TSSE": "Software/Hardware and settings used for encoding",
  "TSST": "Set subtitle",
  "TYER": "Year",
  "TXXX": "User defined text information frame",
  "UFID": "Unique file identifier",
  "USER": "Terms of use",
  "USLT": "Unsychronized lyric/text transcription",
  "WCOM": "Commercial information",
  "WCOP": "Copyright/Legal information",
  "WOAF": "Official audio file webpage",
  "WOAR": "Official artist/performer webpage",
  "WOAS": "Official audio source webpage",
  "WORS": "Official internet radio station homepage",
  "WPAY": "Payment",
  "WPUB": "Publishers official webpage",
  "WXXX": "User defined URL link frame"
};

class ID3v2FrameReader {
  static getFrameReaderFunction(frameId) {
    if (frameId in frameReaderFunctions) {
      return frameReaderFunctions[frameId];
    } else if (frameId[0] === "T") {
      // All frame ids starting with T are text tags.
      return frameReaderFunctions["T*"];
    } else if (frameId[0] === "W") {
      // All frame ids starting with W are url tags.
      return frameReaderFunctions["W*"];
    } else {
      return null;
    }
  }
  /**
   * All the frames consists of a frame header followed by one or more fields
   * containing the actual information.
   * The frame ID made out of the characters capital A-Z and 0-9. Identifiers
   * beginning with "X", "Y" and "Z" are for experimental use and free for
   * everyone to use, without the need to set the experimental bit in the tag
   * header. Have in mind that someone else might have used the same identifier
   * as you. All other identifiers are either used or reserved for future use.
   * The frame ID is followed by a size descriptor, making a total header size
   * of ten bytes in every frame. The size is calculated as frame size excluding
   * frame header (frame size - 10).
   */
  static readFrames(offset, end, data, id3header, tags) {
    var frames = {};
    var frameHeaderSize = this._getFrameHeaderSize(id3header);
    // console.log('header', id3header);
    while (
    // we should be able to read at least the frame header
    offset < end - frameHeaderSize) {
      var header = this._readFrameHeader(data, offset, id3header);
      var frameId = header.id;

      // No frame ID sometimes means it's the last frame (GTFO).
      if (!frameId) {
        break;
      }

      var flags = header.flags;
      var frameSize = header.size;
      var frameDataOffset = offset + header.headerSize;
      var frameData = data;

      // console.log(offset, frameId, header.size + header.headerSize, flags && flags.format.unsynchronisation);
      // advance data offset to the next frame data
      offset += header.headerSize + header.size;

      // skip unwanted tags
      if (tags && tags.indexOf(frameId) === -1) {
        continue;
      }
      // Workaround: MP3ext V3.3.17 places a non-compliant padding string at
      // the end of the ID3v2 header. A string like "MP3ext V3.3.19(ansi)"
      // is added multiple times at the end of the ID3 tag. More information
      // about this issue can be found at
      // https://github.com/aadsm/jsmediatags/issues/58#issuecomment-313865336
      if (frameId === 'MP3e' || frameId === '\x00MP3' || frameId === '\x00\x00MP' || frameId === ' MP3') {
        break;
      }

      var unsyncData;
      if (flags && flags.format.unsynchronisation) {
        frameData = this.getUnsyncFileReader(frameData, frameDataOffset, frameSize);
        frameDataOffset = 0;
        frameSize = frameData.getSize();
      }

      // the first 4 bytes are the real data size
      // (after unsynchronisation && encryption)
      if (flags && flags.format.data_length_indicator) {
        // var frameDataSize = frameData.getSynchsafeInteger32At(frameDataOffset);
        frameDataOffset += 4;
        frameSize -= 4;
      }

      var readFrameFunc = ID3v2FrameReader.getFrameReaderFunction(frameId);
      var parsedData = readFrameFunc ? readFrameFunc.apply(this, [frameDataOffset, frameSize, frameData, flags, id3header]) : null;
      var desc = this._getFrameDescription(frameId);

      var frame = {
        id: frameId,
        size: frameSize,
        description: desc,
        data: parsedData
      };

      if (frameId in frames) {
        if (frames[frameId].id) {
          frames[frameId] = [frames[frameId]];
        }
        frames[frameId].push(frame);
      } else {
        frames[frameId] = frame;
      }
    }

    return frames;
  }

  static _getFrameHeaderSize(id3header) {
    var major = id3header.major;

    if (major == 2) {
      return 6;
    } else if (major == 3 || major == 4) {
      return 10;
    } else {
      return 0;
    }
  }

  static _readFrameHeader(data, offset, id3header) {
    var major = id3header.major;
    var flags = null;
    var frameHeaderSize = this._getFrameHeaderSize(id3header);

    switch (major) {
      case 2:
        var frameId = data.getStringAt(offset, 3);
        var frameSize = data.getInteger24At(offset + 3, true);
        break;

      case 3:
        var frameId = data.getStringAt(offset, 4);
        var frameSize = data.getLongAt(offset + 4, true);
        break;

      case 4:
        var frameId = data.getStringAt(offset, 4);
        var frameSize = data.getSynchsafeInteger32At(offset + 4);
        break;
    }

    if (frameId == String.fromCharCode(0, 0, 0) || frameId == String.fromCharCode(0, 0, 0, 0)) {
      frameId = "";
    }

    // if frameId is empty then it's the last frame
    if (frameId) {
      // read frame message and format flags
      if (major > 2) {
        flags = this._readFrameFlags(data, offset + 8);
      }
    }

    return {
      "id": frameId || "",
      "size": frameSize || 0,
      "headerSize": frameHeaderSize || 0,
      "flags": flags
    };
  }

  static _readFrameFlags(data, offset) {
    return {
      message: {
        tag_alter_preservation: data.isBitSetAt(offset, 6),
        file_alter_preservation: data.isBitSetAt(offset, 5),
        read_only: data.isBitSetAt(offset, 4)
      },
      format: {
        grouping_identity: data.isBitSetAt(offset + 1, 7),
        compression: data.isBitSetAt(offset + 1, 3),
        encryption: data.isBitSetAt(offset + 1, 2),
        unsynchronisation: data.isBitSetAt(offset + 1, 1),
        data_length_indicator: data.isBitSetAt(offset + 1, 0)
      }
    };
  }

  static _getFrameDescription(frameId) {
    if (frameId in FRAME_DESCRIPTIONS) {
      return FRAME_DESCRIPTIONS[frameId];
    } else {
      return 'Unknown';
    }
  }

  static getUnsyncFileReader(data, offset, size) {
    var frameData = data.getBytesAt(offset, size);
    for (var i = 0; i < frameData.length - 1; i++) {
      if (frameData[i] === 0xff && frameData[i + 1] === 0x00) {
        frameData.splice(i + 1, 1);
      }
    }

    return new ArrayFileReader(frameData);
  }
};

var frameReaderFunctions = {};

frameReaderFunctions['APIC'] = function readPictureFrame(offset, length, data, flags, id3header) {
  var start = offset;
  var charset = getTextEncoding(data.getByteAt(offset));
  switch (id3header && id3header.major) {
    case 2:
      var format = data.getStringAt(offset + 1, 3);
      offset += 4;
      break;

    case 3:
    case 4:
      var format = data.getStringWithCharsetAt(offset + 1, length - 1);
      offset += 1 + format.bytesReadCount;
      break;

    default:
      throw new Error("Couldn't read ID3v2 major version.");
  }
  var bite = data.getByteAt(offset, 1);
  var type = PICTURE_TYPE[bite];
  var desc = data.getStringWithCharsetAt(offset + 1, length - (offset - start) - 1, charset);

  offset += 1 + desc.bytesReadCount;

  return {
    "format": format.toString(),
    "type": type,
    "description": desc.toString(),
    "data": data.getBytesAt(offset, start + length - offset)
  };
};

// ID3v2 chapters according to http://id3.org/id3v2-chapters-1.0
frameReaderFunctions['CHAP'] = function readChapterFrame(offset, length, data, flags, id3header) {
  var originalOffset = offset;
  var result = {};
  var id = StringUtils.readNullTerminatedString(data.getBytesAt(offset, length));
  result.id = id.toString();
  offset += id.bytesReadCount;
  result.startTime = data.getLongAt(offset, true);
  offset += 4;
  result.endTime = data.getLongAt(offset, true);
  offset += 4;
  result.startOffset = data.getLongAt(offset, true);
  offset += 4;
  result.endOffset = data.getLongAt(offset, true);
  offset += 4;

  var remainingLength = length - (offset - originalOffset);
  result.subFrames = this.readFrames(offset, offset + remainingLength, data, id3header);
  return result;
};

// ID3v2 table of contents according to http://id3.org/id3v2-chapters-1.0
frameReaderFunctions['CTOC'] = function readTableOfContentsFrame(offset, length, data, flags, id3header) {
  var originalOffset = offset;
  var result = { childElementIds: [] };
  var id = StringUtils.readNullTerminatedString(data.getBytesAt(offset, length));
  result.id = id.toString();
  offset += id.bytesReadCount;
  result.topLevel = data.isBitSetAt(offset, 1);
  result.ordered = data.isBitSetAt(offset, 0);
  offset++;
  result.entryCount = data.getByteAt(offset);
  offset++;
  for (var i = 0; i < result.entryCount; i++) {
    var childId = StringUtils.readNullTerminatedString(data.getBytesAt(offset, length - (offset - originalOffset)));
    result.childElementIds.push(childId.toString());
    offset += childId.bytesReadCount;
  }

  var remainingLength = length - (offset - originalOffset);
  result.subFrames = this.readFrames(offset, offset + remainingLength, data, id3header);
  return result;
};

frameReaderFunctions['COMM'] = function readCommentsFrame(offset, length, data, flags, id3header) {
  var start = offset;
  var charset = getTextEncoding(data.getByteAt(offset));
  var language = data.getStringAt(offset + 1, 3);
  var shortdesc = data.getStringWithCharsetAt(offset + 4, length - 4, charset);

  offset += 4 + shortdesc.bytesReadCount;
  var text = data.getStringWithCharsetAt(offset, start + length - offset, charset);

  return {
    language: language,
    short_description: shortdesc.toString(),
    text: text.toString()
  };
};

frameReaderFunctions['COM'] = frameReaderFunctions['COMM'];

frameReaderFunctions['PIC'] = function (offset, length, data, flags, id3header) {
  return frameReaderFunctions['APIC'](offset, length, data, flags, id3header);
};

frameReaderFunctions['PCNT'] = function readCounterFrame(offset, length, data, flags, id3header) {
  // FIXME: implement the rest of the spec
  return data.getLongAt(offset, false);
};

frameReaderFunctions['CNT'] = frameReaderFunctions['PCNT'];

frameReaderFunctions['T*'] = function readTextFrame(offset, length, data, flags, id3header) {
  var charset = getTextEncoding(data.getByteAt(offset));

  return data.getStringWithCharsetAt(offset + 1, length - 1, charset).toString();
};

frameReaderFunctions['TXXX'] = function readTextFrame(offset, length, data, flags, id3header) {
  var charset = getTextEncoding(data.getByteAt(offset));

  return getUserDefinedFields(offset, length, data, charset);
};

frameReaderFunctions['W*'] = function readUrlFrame(offset, length, data, flags, id3header) {
  // charset is only defined for user-defined URL link frames (http://id3.org/id3v2.3.0#User_defined_URL_link_frame)
  // for the other URL link frames it is always iso-8859-1
  var charset = getTextEncoding(data.getByteAt(offset));

  if (charset !== undefined) {
    return getUserDefinedFields(offset, length, data, charset);
  } else {
    return data.getStringWithCharsetAt(offset, length, charset).toString();
  }
};

frameReaderFunctions['TCON'] = function readGenreFrame(offset, length, data, flags) {
  var text = frameReaderFunctions['T*'].apply(this, arguments);
  return text.replace(/^\(\d+\)/, '');
};

frameReaderFunctions['TCO'] = frameReaderFunctions['TCON'];

frameReaderFunctions['USLT'] = function readLyricsFrame(offset, length, data, flags, id3header) {
  var start = offset;
  var charset = getTextEncoding(data.getByteAt(offset));
  var language = data.getStringAt(offset + 1, 3);
  var descriptor = data.getStringWithCharsetAt(offset + 4, length - 4, charset);

  offset += 4 + descriptor.bytesReadCount;
  var lyrics = data.getStringWithCharsetAt(offset, start + length - offset, charset);

  return {
    language: language,
    descriptor: descriptor.toString(),
    lyrics: lyrics.toString()
  };
};

frameReaderFunctions['ULT'] = frameReaderFunctions['USLT'];

frameReaderFunctions['UFID'] = function readLyricsFrame(offset, length, data, flags, id3header) {
  var ownerIdentifier = StringUtils.readNullTerminatedString(data.getBytesAt(offset, length));
  offset += ownerIdentifier.bytesReadCount;
  var identifier = data.getBytesAt(offset, length - ownerIdentifier.bytesReadCount);

  return {
    ownerIdentifier: ownerIdentifier.toString(),
    identifier: identifier
  };
};

function getTextEncoding(bite) {
  var charset;

  switch (bite) {
    case 0x00:
      charset = 'iso-8859-1';
      break;

    case 0x01:
      charset = 'utf-16';
      break;

    case 0x02:
      charset = 'utf-16be';
      break;

    case 0x03:
      charset = 'utf-8';
      break;
  }

  return charset;
}

// Handles reading description/data from either http://id3.org/id3v2.3.0#User_defined_text_information_frame
// and http://id3.org/id3v2.3.0#User_defined_URL_link_frame
function getUserDefinedFields(offset, length, data, charset) {
  var userDesc = data.getStringWithCharsetAt(offset + 1, length - 1, charset);
  var userDefinedData = data.getStringWithCharsetAt(offset + 1 + userDesc.bytesReadCount, length - 1 - userDesc.bytesReadCount);

  return {
    user_description: userDesc.toString(),
    data: userDefinedData.toString()
  };
}

var PICTURE_TYPE = ["Other", "32x32 pixels 'file icon' (PNG only)", "Other file icon", "Cover (front)", "Cover (back)", "Leaflet page", "Media (e.g. label side of CD)", "Lead artist/lead performer/soloist", "Artist/performer", "Conductor", "Band/Orchestra", "Composer", "Lyricist/text writer", "Recording Location", "During recording", "During performance", "Movie/video screen capture", "A bright coloured fish", "Illustration", "Band/artist logotype", "Publisher/Studio logotype"];

module.exports = ID3v2FrameReader;
},{"./ArrayFileReader":151,"./MediaFileReader":158,"./StringUtils":161}],156:[function(require,module,exports){
'use strict';

var MediaTagReader = require('./MediaTagReader');
var MediaFileReader = require('./MediaFileReader');
var ID3v2FrameReader = require('./ID3v2FrameReader');

const ID3_HEADER_SIZE = 10;

class ID3v2TagReader extends MediaTagReader {
  static getTagIdentifierByteRange() {
    // ID3 header
    return {
      offset: 0,
      length: ID3_HEADER_SIZE
    };
  }

  static canReadTagFormat(tagIdentifier) {
    var id = String.fromCharCode.apply(String, tagIdentifier.slice(0, 3));
    return id === 'ID3';
  }

  _loadData(mediaFileReader, callbacks) {
    mediaFileReader.loadRange([6, 9], {
      onSuccess: function () {
        mediaFileReader.loadRange(
        // The tag size does not include the header size.
        [0, ID3_HEADER_SIZE + mediaFileReader.getSynchsafeInteger32At(6) - 1], callbacks);
      },
      onError: callbacks.onError
    });
  }

  _parseData(data, tags) {
    var offset = 0;
    var major = data.getByteAt(offset + 3);
    if (major > 4) {
      return { "type": "ID3", "version": ">2.4", "tags": {} };
    }
    var revision = data.getByteAt(offset + 4);
    var unsynch = data.isBitSetAt(offset + 5, 7);
    var xheader = data.isBitSetAt(offset + 5, 6);
    var xindicator = data.isBitSetAt(offset + 5, 5);
    var size = data.getSynchsafeInteger32At(offset + 6);
    offset += 10;

    if (xheader) {
      // TODO: support 2.4
      var xheadersize = data.getLongAt(offset, true);
      // The 'Extended header size', currently 6 or 10 bytes, excludes itself.
      offset += xheadersize + 4;
    }

    var id3 = {
      "type": "ID3",
      "version": '2.' + major + '.' + revision,
      "major": major,
      "revision": revision,
      "flags": {
        "unsynchronisation": unsynch,
        "extended_header": xheader,
        "experimental_indicator": xindicator,
        // TODO: footer_present
        "footer_present": false
      },
      "size": size,
      "tags": {}
    };

    if (tags) {
      var expandedTags = this._expandShortcutTags(tags);
    }

    var offsetEnd = size + 10 /*header size*/;
    // When this flag is set the entire tag needs to be un-unsynchronised
    // before parsing each individual frame. Individual frame sizes might not
    // take unsynchronisation into consideration when it's set on the tag
    // header.
    if (id3.flags.unsynchronisation) {
      data = ID3v2FrameReader.getUnsyncFileReader(data, offset, size);
      offset = 0;
      offsetEnd = data.getSize();
    }

    var frames = ID3v2FrameReader.readFrames(offset, offsetEnd, data, id3, expandedTags);
    // create shortcuts for most common data.
    for (var name in SHORTCUTS) if (SHORTCUTS.hasOwnProperty(name)) {
      var frameData = this._getFrameData(frames, SHORTCUTS[name]);
      if (frameData) {
        id3.tags[name] = frameData;
      }
    }

    for (var frame in frames) if (frames.hasOwnProperty(frame)) {
      id3.tags[frame] = frames[frame];
    }

    return id3;
  }

  _getFrameData(frames, ids) {
    var frame;
    for (var i = 0, id; id = ids[i]; i++) {
      if (id in frames) {
        if (frames[id] instanceof Array) {
          frame = frames[id][0];
        } else {
          frame = frames[id];
        }
        return frame.data;
      }
    }
  }

  getShortcuts() {
    return SHORTCUTS;
  }
}

const SHORTCUTS = {
  "title": ["TIT2", "TT2"],
  "artist": ["TPE1", "TP1"],
  "album": ["TALB", "TAL"],
  "year": ["TYER", "TYE"],
  "comment": ["COMM", "COM"],
  "track": ["TRCK", "TRK"],
  "genre": ["TCON", "TCO"],
  "picture": ["APIC", "PIC"],
  "lyrics": ["USLT", "ULT"]
};

module.exports = ID3v2TagReader;
},{"./ID3v2FrameReader":155,"./MediaFileReader":158,"./MediaTagReader":159}],157:[function(require,module,exports){
/**
 * Support for iTunes-style m4a tags
 * See:
 *   http://atomicparsley.sourceforge.net/mpeg-4files.html
 *   http://developer.apple.com/mac/library/documentation/QuickTime/QTFF/Metadata/Metadata.html
 * Authored by Joshua Kifer <joshua.kifer gmail.com>
 * 
 */
'use strict';

var MediaTagReader = require('./MediaTagReader');
var MediaFileReader = require('./MediaFileReader');

class MP4TagReader extends MediaTagReader {
  static getTagIdentifierByteRange() {
    // The tag identifier is located in [4, 8] but since we'll need to reader
    // the header of the first block anyway, we load it instead to avoid
    // making two requests.
    return {
      offset: 0,
      length: 16
    };
  }

  static canReadTagFormat(tagIdentifier) {
    var id = String.fromCharCode.apply(String, tagIdentifier.slice(4, 8));
    return id === "ftyp";
  }

  _loadData(mediaFileReader, callbacks) {
    // MP4 metadata isn't located in a specific location of the file. Roughly
    // speaking, it's composed of blocks chained together like a linked list.
    // These blocks are called atoms (or boxes).
    // Each atom of the list can have its own child linked list. Atoms in this
    // situation do not possess any data and are called "container" as they only
    // contain other atoms.
    // Other atoms represent a particular set of data, like audio, video or
    // metadata. In order to find and load all the interesting atoms we need
    // to traverse the entire linked list of atoms and only load the ones
    // associated with metadata.
    // The metadata atoms can be find under the "moov.udta.meta.ilst" hierarchy.

    var self = this;
    // Load the header of the first atom
    mediaFileReader.loadRange([0, 16], {
      onSuccess: function () {
        self._loadAtom(mediaFileReader, 0, "", callbacks);
      },
      onError: callbacks.onError
    });
  }

  _loadAtom(mediaFileReader, offset, parentAtomFullName, callbacks) {
    if (offset >= mediaFileReader.getSize()) {
      callbacks.onSuccess();
      return;
    }

    var self = this;
    // 8 is the size of the atomSize and atomName fields.
    // When reading the current block we always read 8 more bytes in order
    // to also read the header of the next block.
    var atomSize = mediaFileReader.getLongAt(offset, true);
    if (atomSize == 0 || isNaN(atomSize)) {
      callbacks.onSuccess();
      return;
    }
    var atomName = mediaFileReader.getStringAt(offset + 4, 4);
    // console.log(parentAtomFullName, atomName, atomSize);
    // Container atoms (no actual data)
    if (this._isContainerAtom(atomName)) {
      if (atomName == "meta") {
        // The "meta" atom breaks convention and is a container with data.
        offset += 4; // next_item_id (uint32)
      }
      var atomFullName = (parentAtomFullName ? parentAtomFullName + "." : "") + atomName;
      if (atomFullName === "moov.udta.meta.ilst") {
        mediaFileReader.loadRange([offset, offset + atomSize], callbacks);
      } else {
        mediaFileReader.loadRange([offset + 8, offset + 8 + 8], {
          onSuccess: function () {
            self._loadAtom(mediaFileReader, offset + 8, atomFullName, callbacks);
          },
          onError: callbacks.onError
        });
      }
    } else {
      mediaFileReader.loadRange([offset + atomSize, offset + atomSize + 8], {
        onSuccess: function () {
          self._loadAtom(mediaFileReader, offset + atomSize, parentAtomFullName, callbacks);
        },
        onError: callbacks.onError
      });
    }
  }

  _isContainerAtom(atomName) {
    return ["moov", "udta", "meta", "ilst"].indexOf(atomName) >= 0;
  }

  _canReadAtom(atomName) {
    return atomName !== "----";
  }

  _parseData(data, tagsToRead) {
    var tags = {};

    tagsToRead = this._expandShortcutTags(tagsToRead);
    this._readAtom(tags, data, 0, data.getSize(), tagsToRead);

    // create shortcuts for most common data.
    for (var name in SHORTCUTS) if (SHORTCUTS.hasOwnProperty(name)) {
      var tag = tags[SHORTCUTS[name]];
      if (tag) {
        if (name === "track") {
          tags[name] = tag.data.track;
        } else {
          tags[name] = tag.data;
        }
      }
    }

    return {
      "type": "MP4",
      "ftyp": data.getStringAt(8, 4),
      "version": data.getLongAt(12, true),
      "tags": tags
    };
  }

  _readAtom(tags, data, offset, length, tagsToRead, parentAtomFullName, indent) {
    indent = indent === undefined ? "" : indent + "  ";

    var seek = offset;
    while (seek < offset + length) {
      var atomSize = data.getLongAt(seek, true);
      if (atomSize == 0) {
        return;
      }
      var atomName = data.getStringAt(seek + 4, 4);

      // console.log(seek, parentAtomFullName, atomName, atomSize);
      if (this._isContainerAtom(atomName)) {
        if (atomName == "meta") {
          seek += 4; // next_item_id (uint32)
        }
        var atomFullName = (parentAtomFullName ? parentAtomFullName + "." : "") + atomName;
        this._readAtom(tags, data, seek + 8, atomSize - 8, tagsToRead, atomFullName, indent);
        return;
      }

      // Value atoms
      if ((!tagsToRead || tagsToRead.indexOf(atomName) >= 0) && parentAtomFullName === "moov.udta.meta.ilst" && this._canReadAtom(atomName)) {
        tags[atomName] = this._readMetadataAtom(data, seek);
      }

      seek += atomSize;
    }
  }

  _readMetadataAtom(data, offset) {
    // 16: name + size + "data" + size (4 bytes each)
    const METADATA_HEADER = 16;

    var atomSize = data.getLongAt(offset, true);
    var atomName = data.getStringAt(offset + 4, 4);

    var klass = data.getInteger24At(offset + METADATA_HEADER + 1, true);
    var type = TYPES[klass];
    var atomData;

    if (atomName == "trkn") {
      atomData = {
        "track": data.getByteAt(offset + METADATA_HEADER + 11),
        "total": data.getByteAt(offset + METADATA_HEADER + 13)
      };
    } else if (atomName == "disk") {
      atomData = {
        "disk": data.getByteAt(offset + METADATA_HEADER + 11),
        "total": data.getByteAt(offset + METADATA_HEADER + 13)
      };
    } else {
      // 4: atom version (1 byte) + atom flags (3 bytes)
      // 4: NULL (usually locale indicator)
      var atomHeader = METADATA_HEADER + 4 + 4;
      var dataStart = offset + atomHeader;
      var dataLength = atomSize - atomHeader;
      var atomData;

      // Workaround for covers being parsed as 'uint8' type despite being an 'covr' atom
      if (atomName === 'covr' && type === 'uint8') {
        type = 'jpeg';
      }

      switch (type) {
        case "text":
          atomData = data.getStringWithCharsetAt(dataStart, dataLength, "utf-8").toString();
          break;

        case "uint8":
          atomData = data.getShortAt(dataStart, false);
          break;

        case "int":
        case "uint":
          // Though the QuickTime spec doesn't state it, there are 64-bit values
          // such as plID (Playlist/Collection ID). With its single 64-bit floating
          // point number type, these are hard to parse and pass in JavaScript.
          // The high word of plID seems to always be zero, so, as this is the
          // only current 64-bit atom handled, it is parsed from its 32-bit
          // low word as an unsigned long.
          //
          var intReader = type == 'int' ? dataLength == 1 ? data.getSByteAt : dataLength == 2 ? data.getSShortAt : dataLength == 4 ? data.getSLongAt : data.getLongAt : dataLength == 1 ? data.getByteAt : dataLength == 2 ? data.getShortAt : data.getLongAt;

          atomData = intReader.call(data, dataStart + (dataLength == 8 ? 4 : 0), true);
          break;

        case "jpeg":
        case "png":
          atomData = {
            "format": "image/" + type,
            "data": data.getBytesAt(dataStart, dataLength)
          };
          break;
      }
    }

    return {
      id: atomName,
      size: atomSize,
      description: ATOM_DESCRIPTIONS[atomName] || "Unknown",
      data: atomData
    };
  }

  getShortcuts() {
    return SHORTCUTS;
  }
}

/*
 * https://developer.apple.com/library/content/documentation/QuickTime/QTFF/Metadata/Metadata.html#//apple_ref/doc/uid/TP40000939-CH1-SW35
*/
const TYPES = {
  "0": "uint8",
  "1": "text",
  "13": "jpeg",
  "14": "png",
  "21": "int",
  "22": "uint"
};

const ATOM_DESCRIPTIONS = {
  "alb": "Album",
  "ART": "Artist",
  "aART": "Album Artist",
  "day": "Release Date",
  "nam": "Title",
  "gen": "Genre",
  "gnre": "Genre",
  "trkn": "Track Number",
  "wrt": "Composer",
  "too": "Encoding Tool",
  "enc": "Encoded By",
  "cprt": "Copyright",
  "covr": "Cover Art",
  "grp": "Grouping",
  "keyw": "Keywords",
  "lyr": "Lyrics",
  "cmt": "Comment",
  "tmpo": "Tempo",
  "cpil": "Compilation",
  "disk": "Disc Number",
  "tvsh": "TV Show Name",
  "tven": "TV Episode ID",
  "tvsn": "TV Season",
  "tves": "TV Episode",
  "tvnn": "TV Network",
  "desc": "Description",
  "ldes": "Long Description",
  "sonm": "Sort Name",
  "soar": "Sort Artist",
  "soaa": "Sort Album",
  "soco": "Sort Composer",
  "sosn": "Sort Show",
  "purd": "Purchase Date",
  "pcst": "Podcast",
  "purl": "Podcast URL",
  "catg": "Category",
  "hdvd": "HD Video",
  "stik": "Media Type",
  "rtng": "Content Rating",
  "pgap": "Gapless Playback",
  "apID": "Purchase Account",
  "sfID": "Country Code",
  "atID": "Artist ID",
  "cnID": "Catalog ID",
  "plID": "Collection ID",
  "geID": "Genre ID",
  "xid ": "Vendor Information",
  "flvr": "Codec Flavor"
};

const UNSUPPORTED_ATOMS = {
  "----": 1
};

const SHORTCUTS = {
  "title": "nam",
  "artist": "ART",
  "album": "alb",
  "year": "day",
  "comment": "cmt",
  "track": "trkn",
  "genre": "gen",
  "picture": "covr",
  "lyrics": "lyr"
};

module.exports = MP4TagReader;
},{"./MediaFileReader":158,"./MediaTagReader":159}],158:[function(require,module,exports){
'use strict';

const StringUtils = require('./StringUtils');

class MediaFileReader {

  constructor() {
    this._isInitialized = false;
    this._size = 0;
  }

  /**
   * Decides if this media file reader is able to read the given file.
   */
  static canReadFile(file) {
    throw new Error("Must implement canReadFile function");
  }

  /**
   * This function needs to be called before any other function.
   * Loads the necessary initial information from the file.
   */
  init(callbacks) {
    var self = this;

    if (this._isInitialized) {
      setTimeout(callbacks.onSuccess, 1);
    } else {
      return this._init({
        onSuccess: function () {
          self._isInitialized = true;
          callbacks.onSuccess();
        },
        onError: callbacks.onError
      });
    }
  }

  _init(callbacks) {
    throw new Error("Must implement init function");
  }

  /**
   * @param range The start and end indexes of the range to load.
   *        Ex: [0, 7] load bytes 0 to 7 inclusive.
   */
  loadRange(range, callbacks) {
    throw new Error("Must implement loadRange function");
  }

  /**
   * @return The size of the file in bytes.
   */
  getSize() {
    if (!this._isInitialized) {
      throw new Error("init() must be called first.");
    }

    return this._size;
  }

  getByteAt(offset) {
    throw new Error("Must implement getByteAt function");
  }

  getBytesAt(offset, length) {
    var bytes = new Array(length);
    for (var i = 0; i < length; i++) {
      bytes[i] = this.getByteAt(offset + i);
    }
    return bytes;
  }

  isBitSetAt(offset, bit) {
    var iByte = this.getByteAt(offset);
    return (iByte & 1 << bit) != 0;
  }

  getSByteAt(offset) {
    var iByte = this.getByteAt(offset);
    if (iByte > 127) {
      return iByte - 256;
    } else {
      return iByte;
    }
  }

  getShortAt(offset, isBigEndian) {
    var iShort = isBigEndian ? (this.getByteAt(offset) << 8) + this.getByteAt(offset + 1) : (this.getByteAt(offset + 1) << 8) + this.getByteAt(offset);
    if (iShort < 0) {
      iShort += 65536;
    }
    return iShort;
  }

  getSShortAt(offset, isBigEndian) {
    var iUShort = this.getShortAt(offset, isBigEndian);
    if (iUShort > 32767) {
      return iUShort - 65536;
    } else {
      return iUShort;
    }
  }

  getLongAt(offset, isBigEndian) {
    var iByte1 = this.getByteAt(offset),
        iByte2 = this.getByteAt(offset + 1),
        iByte3 = this.getByteAt(offset + 2),
        iByte4 = this.getByteAt(offset + 3);

    var iLong = isBigEndian ? (((iByte1 << 8) + iByte2 << 8) + iByte3 << 8) + iByte4 : (((iByte4 << 8) + iByte3 << 8) + iByte2 << 8) + iByte1;

    if (iLong < 0) {
      iLong += 4294967296;
    }

    return iLong;
  }

  getSLongAt(offset, isBigEndian) {
    var iULong = this.getLongAt(offset, isBigEndian);

    if (iULong > 2147483647) {
      return iULong - 4294967296;
    } else {
      return iULong;
    }
  }

  getInteger24At(offset, isBigEndian) {
    var iByte1 = this.getByteAt(offset),
        iByte2 = this.getByteAt(offset + 1),
        iByte3 = this.getByteAt(offset + 2);

    var iInteger = isBigEndian ? ((iByte1 << 8) + iByte2 << 8) + iByte3 : ((iByte3 << 8) + iByte2 << 8) + iByte1;

    if (iInteger < 0) {
      iInteger += 16777216;
    }

    return iInteger;
  }

  getStringAt(offset, length) {
    var string = [];
    for (var i = offset, j = 0; i < offset + length; i++, j++) {
      string[j] = String.fromCharCode(this.getByteAt(i));
    }
    return string.join("");
  }

  getStringWithCharsetAt(offset, length, charset) {
    var bytes = this.getBytesAt(offset, length);
    var string;

    switch ((charset || '').toLowerCase()) {
      case "utf-16":
      case "utf-16le":
      case "utf-16be":
        string = StringUtils.readUTF16String(bytes, charset === "utf-16be");
        break;

      case "utf-8":
        string = StringUtils.readUTF8String(bytes);
        break;

      default:
        string = StringUtils.readNullTerminatedString(bytes);
        break;
    }

    return string;
  }

  getCharAt(offset) {
    return String.fromCharCode(this.getByteAt(offset));
  }

  /**
   * The ID3v2 tag/frame size is encoded with four bytes where the most
   * significant bit (bit 7) is set to zero in every byte, making a total of 28
   * bits. The zeroed bits are ignored, so a 257 bytes long tag is represented
   * as $00 00 02 01.
   */
  getSynchsafeInteger32At(offset) {
    var size1 = this.getByteAt(offset);
    var size2 = this.getByteAt(offset + 1);
    var size3 = this.getByteAt(offset + 2);
    var size4 = this.getByteAt(offset + 3);
    // 0x7f = 0b01111111
    var size = size4 & 0x7f | (size3 & 0x7f) << 7 | (size2 & 0x7f) << 14 | (size1 & 0x7f) << 21;

    return size;
  }
}

module.exports = MediaFileReader;
},{"./StringUtils":161}],159:[function(require,module,exports){
'use strict';

const MediaFileReader = require('./MediaFileReader');

class MediaTagReader {

  constructor(mediaFileReader) {
    this._mediaFileReader = mediaFileReader;
    this._tags = null;
  }

  /**
   * Returns the byte range that needs to be loaded and fed to
   * _canReadTagFormat in order to identify if the file contains tag
   * information that can be read.
   */
  static getTagIdentifierByteRange() {
    throw new Error("Must implement");
  }

  /**
   * Given a tag identifier (read from the file byte positions speficied by
   * getTagIdentifierByteRange) this function checks if it can read the tag
   * format or not.
   */
  static canReadTagFormat(tagIdentifier) {
    throw new Error("Must implement");
  }

  setTagsToRead(tags) {
    this._tags = tags;
    return this;
  }

  read(callbacks) {
    var self = this;

    this._mediaFileReader.init({
      onSuccess: function () {
        self._loadData(self._mediaFileReader, {
          onSuccess: function () {
            try {
              var tags = self._parseData(self._mediaFileReader, self._tags);
            } catch (ex) {
              if (callbacks.onError) {
                callbacks.onError({
                  "type": "parseData",
                  "info": ex.message
                });
                return;
              }
            }

            // TODO: destroy mediaFileReader
            callbacks.onSuccess(tags);
          },
          onError: callbacks.onError
        });
      },
      onError: callbacks.onError
    });
  }

  getShortcuts() {
    return {};
  }

  /**
   * Load the necessary bytes from the media file.
   */
  _loadData(mediaFileReader, callbacks) {
    throw new Error("Must implement _loadData function");
  }

  /**
   * Parse the loaded data to read the media tags.
   */
  _parseData(mediaFileReader, tags) {
    throw new Error("Must implement _parseData function");
  }

  _expandShortcutTags(tagsWithShortcuts) {
    if (!tagsWithShortcuts) {
      return null;
    }

    var tags = [];
    var shortcuts = this.getShortcuts();
    for (var i = 0, tagOrShortcut; tagOrShortcut = tagsWithShortcuts[i]; i++) {
      tags = tags.concat(shortcuts[tagOrShortcut] || [tagOrShortcut]);
    }

    return tags;
  }
}

module.exports = MediaTagReader;
},{"./MediaFileReader":158}],160:[function(require,module,exports){
(function (process,Buffer){
'use strict';

const fs = require('fs');

const ChunkedFileData = require('./ChunkedFileData');
const MediaFileReader = require('./MediaFileReader');

class NodeFileReader extends MediaFileReader {

  constructor(path) {
    super();
    this._path = path;
    this._fileData = new ChunkedFileData();
  }

  static canReadFile(file) {
    return typeof file === 'string' && !/^[a-z]+:\/\//i.test(file);
  }

  getByteAt(offset) {
    return this._fileData.getByteAt(offset);
  }

  _init(callbacks) {
    var self = this;

    fs.stat(self._path, function (err, stats) {
      if (err) {
        if (callbacks.onError) {
          callbacks.onError({ "type": "fs", "info": err });
        }
      } else {
        self._size = stats.size;
        callbacks.onSuccess();
      }
    });
  }

  loadRange(range, callbacks) {
    var fd = -1;
    var self = this;
    var fileData = this._fileData;

    var length = range[1] - range[0] + 1;
    var onSuccess = callbacks.onSuccess;
    var onError = callbacks.onError || function () {};

    if (fileData.hasDataRange(range[0], range[1])) {
      process.nextTick(onSuccess);
      return;
    }

    var readData = function (err, _fd) {
      if (err) {
        onError({ "type": "fs", "info": err });
        return;
      }

      fd = _fd;
      // TODO: Should create a pool of Buffer objects across all instances of
      //       NodeFileReader. This is fine for now.
      var buffer = new Buffer(length);
      fs.read(_fd, buffer, 0, length, range[0], processData);
    };

    var processData = function (err, bytesRead, buffer) {
      fs.close(fd, function (err) {
        if (err) {
          console.error(err);
        }
      });

      if (err) {
        onError({ "type": "fs", "info": err });
        return;
      }

      storeBuffer(buffer);
      onSuccess();
    };

    var storeBuffer = function (buffer) {
      var data = Array.prototype.slice.call(buffer, 0, length);
      fileData.addData(range[0], data);
    };

    fs.open(this._path, "r", undefined, readData);
  }
}

module.exports = NodeFileReader;
}).call(this,require('_process'),require("buffer").Buffer)
},{"./ChunkedFileData":153,"./MediaFileReader":158,"_process":205,"buffer":66,"fs":63}],161:[function(require,module,exports){
'use strict';

class InternalDecodedString {

  constructor(value, bytesReadCount) {
    this._value = value;
    this.bytesReadCount = bytesReadCount;
    this.length = value.length;
  }

  toString() {
    return this._value;
  }
}

var StringUtils = {
  readUTF16String: function (bytes, bigEndian, maxBytes) {
    var ix = 0;
    var offset1 = 1,
        offset2 = 0;

    maxBytes = Math.min(maxBytes || bytes.length, bytes.length);

    if (bytes[0] == 0xFE && bytes[1] == 0xFF) {
      bigEndian = true;
      ix = 2;
    } else if (bytes[0] == 0xFF && bytes[1] == 0xFE) {
      bigEndian = false;
      ix = 2;
    }
    if (bigEndian) {
      offset1 = 0;
      offset2 = 1;
    }

    var arr = [];
    for (var j = 0; ix < maxBytes; j++) {
      var byte1 = bytes[ix + offset1];
      var byte2 = bytes[ix + offset2];
      var word1 = (byte1 << 8) + byte2;
      ix += 2;
      if (word1 == 0x0000) {
        break;
      } else if (byte1 < 0xD8 || byte1 >= 0xE0) {
        arr[j] = String.fromCharCode(word1);
      } else {
        var byte3 = bytes[ix + offset1];
        var byte4 = bytes[ix + offset2];
        var word2 = (byte3 << 8) + byte4;
        ix += 2;
        arr[j] = String.fromCharCode(word1, word2);
      }
    }
    return new InternalDecodedString(arr.join(""), ix);
  },

  readUTF8String: function (bytes, maxBytes) {
    var ix = 0;
    maxBytes = Math.min(maxBytes || bytes.length, bytes.length);

    if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) {
      ix = 3;
    }

    var arr = [];
    for (var j = 0; ix < maxBytes; j++) {
      var byte1 = bytes[ix++];
      if (byte1 == 0x00) {
        break;
      } else if (byte1 < 0x80) {
        arr[j] = String.fromCharCode(byte1);
      } else if (byte1 >= 0xC2 && byte1 < 0xE0) {
        var byte2 = bytes[ix++];
        arr[j] = String.fromCharCode(((byte1 & 0x1F) << 6) + (byte2 & 0x3F));
      } else if (byte1 >= 0xE0 && byte1 < 0xF0) {
        var byte2 = bytes[ix++];
        var byte3 = bytes[ix++];
        arr[j] = String.fromCharCode(((byte1 & 0xFF) << 12) + ((byte2 & 0x3F) << 6) + (byte3 & 0x3F));
      } else if (byte1 >= 0xF0 && byte1 < 0xF5) {
        var byte2 = bytes[ix++];
        var byte3 = bytes[ix++];
        var byte4 = bytes[ix++];
        var codepoint = ((byte1 & 0x07) << 18) + ((byte2 & 0x3F) << 12) + ((byte3 & 0x3F) << 6) + (byte4 & 0x3F) - 0x10000;
        arr[j] = String.fromCharCode((codepoint >> 10) + 0xD800, (codepoint & 0x3FF) + 0xDC00);
      }
    }
    return new InternalDecodedString(arr.join(""), ix);
  },

  readNullTerminatedString: function (bytes, maxBytes) {
    var arr = [];
    maxBytes = maxBytes || bytes.length;
    for (var i = 0; i < maxBytes;) {
      var byte1 = bytes[i++];
      if (byte1 == 0x00) {
        break;
      }
      arr[i - 1] = String.fromCharCode(byte1);
    }
    return new InternalDecodedString(arr.join(""), i);
  }
};

module.exports = StringUtils;
},{}],162:[function(require,module,exports){
'use strict';

const ChunkedFileData = require('./ChunkedFileData');
const MediaFileReader = require('./MediaFileReader');

const CHUNK_SIZE = 1024;

class XhrFileReader extends MediaFileReader {

  constructor(url) {
    super();
    this._url = url;
    this._fileData = new ChunkedFileData();
  }

  static canReadFile(file) {
    return typeof file === 'string' && /^[a-z]+:\/\//i.test(file);
  }

  static setConfig(config) {
    for (var key in config) if (config.hasOwnProperty(key)) {
      this._config[key] = config[key];
    }

    var disallowedXhrHeaders = this._config.disallowedXhrHeaders;
    for (var i = 0; i < disallowedXhrHeaders.length; i++) {
      disallowedXhrHeaders[i] = disallowedXhrHeaders[i].toLowerCase();
    }
  }

  _init(callbacks) {
    if (XhrFileReader._config.avoidHeadRequests) {
      this._fetchSizeWithGetRequest(callbacks);
    } else {
      this._fetchSizeWithHeadRequest(callbacks);
    }
  }

  _fetchSizeWithHeadRequest(callbacks) {
    var self = this;

    this._makeXHRRequest("HEAD", null, {
      onSuccess: function (xhr) {
        var contentLength = self._parseContentLength(xhr);
        if (contentLength) {
          self._size = contentLength;
          callbacks.onSuccess();
        } else {
          // Content-Length not provided by the server, fallback to
          // GET requests.
          self._fetchSizeWithGetRequest(callbacks);
        }
      },
      onError: callbacks.onError
    });
  }

  _fetchSizeWithGetRequest(callbacks) {
    var self = this;
    var range = this._roundRangeToChunkMultiple([0, 0]);

    this._makeXHRRequest("GET", range, {
      onSuccess: function (xhr) {
        var contentRange = self._parseContentRange(xhr);
        var data = self._getXhrResponseContent(xhr);

        if (contentRange) {
          if (contentRange.instanceLength == null) {
            // Last resort, server is not able to tell us the content length,
            // need to fetch entire file then.
            self._fetchEntireFile(callbacks);
            return;
          }
          self._size = contentRange.instanceLength;
        } else {
          // Range request not supported, we got the entire file
          self._size = data.length;
        }

        self._fileData.addData(0, data);
        callbacks.onSuccess();
      },
      onError: callbacks.onError
    });
  }

  _fetchEntireFile(callbacks) {
    var self = this;
    this._makeXHRRequest("GET", null, {
      onSuccess: function (xhr) {
        var data = self._getXhrResponseContent(xhr);
        self._size = data.length;
        self._fileData.addData(0, data);
        callbacks.onSuccess();
      },
      onError: callbacks.onError
    });
  }

  _getXhrResponseContent(xhr) {
    return xhr.responseBody || xhr.responseText || "";
  }

  _parseContentLength(xhr) {
    var contentLength = this._getResponseHeader(xhr, "Content-Length");

    if (contentLength == null) {
      return contentLength;
    } else {
      return parseInt(contentLength, 10);
    }
  }

  _parseContentRange(xhr) {
    var contentRange = this._getResponseHeader(xhr, "Content-Range");

    if (contentRange) {
      var parsedContentRange = contentRange.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);
      if (!parsedContentRange) {
        throw new Error("FIXME: Unknown Content-Range syntax: ", contentRange);
      }

      return {
        firstBytePosition: parseInt(parsedContentRange[1], 10),
        lastBytePosition: parseInt(parsedContentRange[2], 10),
        instanceLength: parsedContentRange[3] ? parseInt(parsedContentRange[3], 10) : null
      };
    } else {
      return null;
    }
  }

  loadRange(range, callbacks) {
    var self = this;

    if (self._fileData.hasDataRange(range[0], Math.min(self._size, range[1]))) {
      setTimeout(callbacks.onSuccess, 1);
      return;
    }

    // Always download in multiples of CHUNK_SIZE. If we're going to make a
    // request might as well get a chunk that makes sense. The big cost is
    // establishing the connection so getting 10bytes or 1K doesn't really
    // make a difference.
    range = this._roundRangeToChunkMultiple(range);

    // Upper range should not be greater than max file size
    range[1] = Math.min(self._size, range[1]);

    this._makeXHRRequest("GET", range, {
      onSuccess: function (xhr) {
        var data = self._getXhrResponseContent(xhr);
        self._fileData.addData(range[0], data);
        callbacks.onSuccess();
      },
      onError: callbacks.onError
    });
  }

  _roundRangeToChunkMultiple(range) {
    var length = range[1] - range[0] + 1;
    var newLength = Math.ceil(length / CHUNK_SIZE) * CHUNK_SIZE;
    return [range[0], range[0] + newLength - 1];
  }

  _makeXHRRequest(method, range, callbacks) {
    var xhr = this._createXHRObject();

    var onXHRLoad = function () {
      // 200 - OK
      // 206 - Partial Content
      // $FlowIssue - xhr will not be null here
      if (xhr.status === 200 || xhr.status === 206) {
        callbacks.onSuccess(xhr);
      } else if (callbacks.onError) {
        callbacks.onError({
          "type": "xhr",
          "info": "Unexpected HTTP status " + xhr.status + ".",
          "xhr": xhr
        });
      }
      xhr = null;
    };

    if (typeof xhr.onload !== 'undefined') {
      xhr.onload = onXHRLoad;
      xhr.onerror = function () {
        if (callbacks.onError) {
          callbacks.onError({
            "type": "xhr",
            "info": "Generic XHR error, check xhr object.",
            "xhr": xhr
          });
        }
      };
    } else {
      xhr.onreadystatechange = function () {
        // $FlowIssue - xhr will not be null here
        if (xhr.readyState === 4) {
          onXHRLoad();
        }
      };
    }

    if (XhrFileReader._config.timeoutInSec) {
      xhr.timeout = XhrFileReader._config.timeoutInSec * 1000;
      xhr.ontimeout = function () {
        if (callbacks.onError) {
          callbacks.onError({
            "type": "xhr",
            // $FlowIssue - xhr.timeout will not be null
            "info": "Timeout after " + xhr.timeout / 1000 + "s. Use jsmediatags.Config.setXhrTimeout to override.",
            "xhr": xhr
          });
        }
      };
    }

    xhr.open(method, this._url);
    xhr.overrideMimeType("text/plain; charset=x-user-defined");
    if (range) {
      this._setRequestHeader(xhr, "Range", "bytes=" + range[0] + "-" + range[1]);
    }
    this._setRequestHeader(xhr, "If-Modified-Since", "Sat, 01 Jan 1970 00:00:00 GMT");
    xhr.send(null);
  }

  _setRequestHeader(xhr, headerName, headerValue) {
    if (XhrFileReader._config.disallowedXhrHeaders.indexOf(headerName.toLowerCase()) < 0) {
      xhr.setRequestHeader(headerName, headerValue);
    }
  }

  _hasResponseHeader(xhr, headerName) {
    var allResponseHeaders = xhr.getAllResponseHeaders();

    if (!allResponseHeaders) {
      return false;
    }

    var headers = allResponseHeaders.split("\r\n");
    var headerNames = [];
    for (var i = 0; i < headers.length; i++) {
      headerNames[i] = headers[i].split(":")[0].toLowerCase();
    }

    return headerNames.indexOf(headerName.toLowerCase()) >= 0;
  }

  _getResponseHeader(xhr, headerName) {
    if (!this._hasResponseHeader(xhr, headerName)) {
      return null;
    }

    return xhr.getResponseHeader(headerName);
  }

  getByteAt(offset) {
    var character = this._fileData.getByteAt(offset);
    return character.charCodeAt(0) & 0xff;
  }

  _isWebWorker() {
    return typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope;
  }

  _createXHRObject() {
    if (typeof window === "undefined" && !this._isWebWorker()) {
      // $FlowIssue - flow is not able to recognize this module.
      return new (require("xhr2").XMLHttpRequest)();
    }

    if (typeof XMLHttpRequest !== "undefined") {
      return new XMLHttpRequest();
    }

    throw new Error("XMLHttpRequest is not supported");
  }
}

XhrFileReader._config = {
  avoidHeadRequests: false,
  disallowedXhrHeaders: [],
  timeoutInSec: 30
};

module.exports = XhrFileReader;
},{"./ChunkedFileData":153,"./MediaFileReader":158,"xhr2":321}],163:[function(require,module,exports){
(function (process){
'use strict';

const MediaFileReader = require("./MediaFileReader");
const NodeFileReader = require("./NodeFileReader");
const XhrFileReader = require("./XhrFileReader");
const BlobFileReader = require("./BlobFileReader");
const ArrayFileReader = require("./ArrayFileReader");
const MediaTagReader = require("./MediaTagReader");
const ID3v1TagReader = require("./ID3v1TagReader");
const ID3v2TagReader = require("./ID3v2TagReader");
const MP4TagReader = require("./MP4TagReader");

var mediaFileReaders = [];
var mediaTagReaders = [];

function read(location, callbacks) {
  new Reader(location).read(callbacks);
}

function isRangeValid(range, fileSize) {
  const invalidPositiveRange = range.offset >= 0 && range.offset + range.length >= fileSize;

  const invalidNegativeRange = range.offset < 0 && (-range.offset > fileSize || range.offset + range.length > 0);

  return !(invalidPositiveRange || invalidNegativeRange);
}

class Reader {

  constructor(file) {
    this._file = file;
  }

  setTagsToRead(tagsToRead) {
    this._tagsToRead = tagsToRead;
    return this;
  }

  setFileReader(fileReader) {
    this._fileReader = fileReader;
    return this;
  }

  setTagReader(tagReader) {
    this._tagReader = tagReader;
    return this;
  }

  read(callbacks) {
    var FileReader = this._getFileReader();
    var fileReader = new FileReader(this._file);
    var self = this;

    fileReader.init({
      onSuccess: function () {
        self._getTagReader(fileReader, {
          onSuccess: function (TagReader) {
            new TagReader(fileReader).setTagsToRead(self._tagsToRead).read(callbacks);
          },
          onError: callbacks.onError
        });
      },
      onError: callbacks.onError
    });
  }

  _getFileReader() {
    if (this._fileReader) {
      return this._fileReader;
    } else {
      return this._findFileReader();
    }
  }

  _findFileReader() {
    for (var i = 0; i < mediaFileReaders.length; i++) {
      if (mediaFileReaders[i].canReadFile(this._file)) {
        return mediaFileReaders[i];
      }
    }

    throw new Error("No suitable file reader found for ", this._file);
  }

  _getTagReader(fileReader, callbacks) {
    if (this._tagReader) {
      var tagReader = this._tagReader;
      setTimeout(function () {
        callbacks.onSuccess(tagReader);
      }, 1);
    } else {
      this._findTagReader(fileReader, callbacks);
    }
  }

  _findTagReader(fileReader, callbacks) {
    // We don't want to make multiple fetches per tag reader to get the tag
    // identifier. The strategy here is to combine all the tag identifier
    // ranges into one and make a single fetch. This is particularly important
    // in file readers that have expensive loads like the XHR one.
    // However, with this strategy we run into the problem of loading the
    // entire file because tag identifiers might be at the start or end of
    // the file.
    // To get around this we divide the tag readers into two categories, the
    // ones that read their tag identifiers from the start of the file and the
    // ones that read from the end of the file.
    var tagReadersAtFileStart = [];
    var tagReadersAtFileEnd = [];
    var fileSize = fileReader.getSize();

    for (var i = 0; i < mediaTagReaders.length; i++) {
      var range = mediaTagReaders[i].getTagIdentifierByteRange();
      if (!isRangeValid(range, fileSize)) {
        continue;
      }

      if (range.offset >= 0 && range.offset < fileSize / 2 || range.offset < 0 && range.offset < -fileSize / 2) {
        tagReadersAtFileStart.push(mediaTagReaders[i]);
      } else {
        tagReadersAtFileEnd.push(mediaTagReaders[i]);
      }
    }

    var tagsLoaded = false;
    var loadTagIdentifiersCallbacks = {
      onSuccess: function () {
        if (!tagsLoaded) {
          // We're expecting to load two sets of tag identifiers. This flag
          // indicates when the first one has been loaded.
          tagsLoaded = true;
          return;
        }

        for (var i = 0; i < mediaTagReaders.length; i++) {
          var range = mediaTagReaders[i].getTagIdentifierByteRange();
          if (!isRangeValid(range, fileSize)) {
            continue;
          }

          try {
            var tagIndentifier = fileReader.getBytesAt(range.offset >= 0 ? range.offset : range.offset + fileSize, range.length);
          } catch (ex) {
            if (callbacks.onError) {
              callbacks.onError({
                "type": "fileReader",
                "info": ex.message
              });
              return;
            }
          }

          if (mediaTagReaders[i].canReadTagFormat(tagIndentifier)) {
            callbacks.onSuccess(mediaTagReaders[i]);
            return;
          }
        }

        if (callbacks.onError) {
          callbacks.onError({
            "type": "tagFormat",
            "info": "No suitable tag reader found"
          });
        }
      },
      onError: callbacks.onError
    };

    this._loadTagIdentifierRanges(fileReader, tagReadersAtFileStart, loadTagIdentifiersCallbacks);
    this._loadTagIdentifierRanges(fileReader, tagReadersAtFileEnd, loadTagIdentifiersCallbacks);
  }

  _loadTagIdentifierRanges(fileReader, tagReaders, callbacks) {
    if (tagReaders.length === 0) {
      // Force async
      setTimeout(callbacks.onSuccess, 1);
      return;
    }

    var tagIdentifierRange = [Number.MAX_VALUE, 0];
    var fileSize = fileReader.getSize();

    // Create a super set of all ranges so we can load them all at once.
    // Might need to rethink this approach if there are tag ranges too far
    // a part from each other. We're good for now though.
    for (var i = 0; i < tagReaders.length; i++) {
      var range = tagReaders[i].getTagIdentifierByteRange();
      var start = range.offset >= 0 ? range.offset : range.offset + fileSize;
      var end = start + range.length - 1;

      tagIdentifierRange[0] = Math.min(start, tagIdentifierRange[0]);
      tagIdentifierRange[1] = Math.max(end, tagIdentifierRange[1]);
    }

    fileReader.loadRange(tagIdentifierRange, callbacks);
  }
}

class Config {
  static addFileReader(fileReader) {
    mediaFileReaders.push(fileReader);
    return Config;
  }

  static addTagReader(tagReader) {
    mediaTagReaders.push(tagReader);
    return Config;
  }

  static removeTagReader(tagReader) {
    var tagReaderIx = mediaTagReaders.indexOf(tagReader);

    if (tagReaderIx >= 0) {
      mediaTagReaders.splice(tagReaderIx, 1);
    }

    return Config;
  }

  static EXPERIMENTAL_avoidHeadRequests() {
    XhrFileReader.setConfig({
      avoidHeadRequests: true
    });
  }

  static setDisallowedXhrHeaders(disallowedXhrHeaders) {
    XhrFileReader.setConfig({
      disallowedXhrHeaders: disallowedXhrHeaders
    });
  }

  static setXhrTimeoutInSec(timeoutInSec) {
    XhrFileReader.setConfig({
      timeoutInSec: timeoutInSec
    });
  }
}

Config.addFileReader(XhrFileReader).addFileReader(BlobFileReader).addFileReader(ArrayFileReader).addTagReader(ID3v2TagReader).addTagReader(ID3v1TagReader).addTagReader(MP4TagReader);

if (typeof process !== "undefined" && !process.browser) {
  Config.addFileReader(NodeFileReader);
}

module.exports = {
  "read": read,
  "Reader": Reader,
  "Config": Config
};
}).call(this,require('_process'))
},{"./ArrayFileReader":151,"./BlobFileReader":152,"./ID3v1TagReader":154,"./ID3v2TagReader":156,"./MP4TagReader":157,"./MediaFileReader":158,"./MediaTagReader":159,"./NodeFileReader":160,"./XhrFileReader":162,"_process":205}],164:[function(require,module,exports){
'use strict';

// # All
// /^npm-debug\.log$/,           // npm error log
// /^\..*\.swp$/,                // Vim state

// # macOS
// /^\.DS_Store$/,               // Stores custom folder attributes
// /^\.AppleDouble$/,            // Stores additional file resources
// /^\.LSOverride$/,             // Contains the absolute path to the app to be used
// /^Icon\r$/,                   // Custom Finder icon: http://superuser.com/questions/298785/icon-file-on-os-x-desktop
// /^\._.*/,                     // Thumbnail
// /^\.Spotlight-V100(?:$|\/)/,  // Directory that might appear on external disk
// /\.Trashes/,                  // File that might appear on external disk
// /^__MACOSX$/,                 // Resource fork

// # Linux
// /~$/,                         // Backup file

// # Windows
// /^Thumbs\.db$/,               // Image file cache
// /^ehthumbs\.db$/,             // Folder config file
// /^Desktop\.ini$/              // Stores custom folder attributes
// /^@eaDir$/                    // Synology Diskstation "hidden" folder where the server stores thumbnails

exports.regex = exports.re = /^npm-debug\.log$|^\..*\.swp$|^\.DS_Store$|^\.AppleDouble$|^\.LSOverride$|^Icon\r$|^\._.*|^\.Spotlight-V100(?:$|\/)|\.Trashes|^__MACOSX$|~$|^Thumbs\.db$|^ehthumbs\.db$|^Desktop\.ini$|^@eaDir$/;

exports.is = filename => exports.re.test(filename);

exports.not = filename => !exports.is(filename);

},{}],165:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.localforage=e()}}(function(){return function e(t,r,n){function o(a,u){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var s=r[a]={exports:{}};t[a][0].call(s.exports,function(e){var r=t[a][1][e];return o(r||e)},s,s.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){(function(e){"use strict";function r(){s=!0;for(var e,t,r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}s=!1}function n(e){1!==l.push(e)||s||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,u=new i(r),c=e.document.createTextNode("");u.observe(c,{characterData:!0}),o=function(){c.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){r(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(r,0)};else{var f=new e.MessageChannel;f.port1.onmessage=r,o=function(){f.port2.postMessage(0)}}var s,l=[];t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";function n(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,e!==n&&c(this,e)}function i(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function a(e,t,r){h(function(){var n;try{n=t(r)}catch(t){return y.reject(e,t)}n===e?y.reject(e,new TypeError("Cannot resolve promise with itself")):y.resolve(e,n)})}function u(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function c(e,t){function r(t){i||(i=!0,y.reject(e,t))}function n(t){i||(i=!0,y.resolve(e,t))}function o(){t(n,r)}var i=!1,a=f(o);"error"===a.status&&r(a.value)}function f(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function s(e){return e instanceof this?e:y.resolve(new this(n),e)}function l(e){var t=new this(n);return y.reject(t,e)}function d(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,o=!1;if(!r)return this.resolve([]);for(var i=new Array(r),a=0,u=-1,c=new this(n);++u<r;)!function(e,n){function u(e){i[n]=e,++a!==r||o||(o=!0,y.resolve(c,i))}t.resolve(e).then(u,function(e){o||(o=!0,y.reject(c,e))})}(e[u],u);return c}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,o=!1;if(!r)return this.resolve([]);for(var i=-1,a=new this(n);++i<r;)!function(e){t.resolve(e).then(function(e){o||(o=!0,y.resolve(a,e))},function(e){o||(o=!0,y.reject(a,e))})}(e[i]);return a}var h=e(1),y={},p=["REJECTED"],b=["FULFILLED"],g=["PENDING"];t.exports=r=o,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===b||"function"!=typeof t&&this.state===p)return this;var r=new this.constructor(n);if(this.state!==g){a(r,this.state===b?e:t,this.outcome)}else this.queue.push(new i(r,e,t));return r},i.prototype.callFulfilled=function(e){y.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){y.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},y.resolve=function(e,t){var r=f(u,t);if("error"===r.status)return y.reject(e,r.value);var n=r.value;if(n)c(e,n);else{e.state=b,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},y.reject=function(e,t){e.state=p,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},r.resolve=s,r.reject=l,r.all=d,r.race=v},{1:1}],3:[function(e,t,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var r="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,n=new r,o=0;o<e.length;o+=1)n.append(e[o]);return n.getBlob(t.type)}}function i(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function u(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}function c(e){return new ie(function(t){var r=e.transaction(ae,"readwrite"),n=o([""]);r.objectStore(ae).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function f(e){return"boolean"==typeof ne?ie.resolve(ne):c(e).then(function(e){return ne=e})}function s(e){var t=oe[e.name],r={};r.promise=new ie(function(e){r.resolve=e}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function l(e){var t=oe[e.name],r=t.deferredOperations.pop();r&&r.resolve()}function d(e,t){return new ie(function(r,n){if(e.db){if(!t)return r(e.db);s(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=re.open.apply(re,o);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(ae)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){r(i.result),l(e)}})}function v(e){return d(e,!1)}function h(e){return d(e,!0)}function y(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function p(e){return new ie(function(t,r){var n=new FileReader;n.onerror=r,n.onloadend=function(r){var n=btoa(r.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)})}function b(e){return o([u(atob(e.data))],{type:e.type})}function g(e){return e&&e.__local_forage_encoded_blob}function m(e){var t=this,r=t._initReady().then(function(){var e=oe[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(r,e,e),r}function w(e){function t(){return ie.resolve()}var r=this,n={db:null};if(e)for(var o in e)n[o]=e[o];oe||(oe={});var i=oe[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},oe[n.name]=i),i.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=m);for(var a=[],u=0;u<i.forages.length;u++){var c=i.forages[u];c!==r&&a.push(c._initReady().catch(t))}var f=i.forages.slice(0);return ie.all(a).then(function(){return n.db=i.db,v(n)}).then(function(e){return n.db=e,y(n,r._defaultConfig.version)?h(n):e}).then(function(e){n.db=i.db=e,r._dbInfo=n;for(var t=0;t<f.length;t++){var o=f[t];o!==r&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})}function _(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),g(e)&&(e=b(e)),t(e)},a.onerror=function(){n(a.error)}}).catch(n)});return i(n,t),n}function S(e,t){var r=this,n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor(),u=1;a.onsuccess=function(){var r=a.result;if(r){var n=r.value;g(n)&&(n=b(n));var o=e(n,r.key,u++);void 0!==o?t(o):r.continue()}else t()},a.onerror=function(){n(a.error)}}).catch(n)});return i(n,t),n}function E(e,t,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new ie(function(r,o){var i;n.ready().then(function(){return i=n._dbInfo,"[object Blob]"===ue.call(t)?f(i.db).then(function(e){return e?t:p(t)}):t}).then(function(t){var n=i.db.transaction(i.storeName,"readwrite"),a=n.objectStore(i.storeName),u=a.put(t,e);null===t&&(t=void 0),n.oncomplete=function(){void 0===t&&(t=null),r(t)},n.onabort=n.onerror=function(){var e=u.error?u.error:u.transaction.error;o(e)}}).catch(o)});return i(o,r),o}function I(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),u=a.delete(e);i.oncomplete=function(){t()},i.onerror=function(){n(u.error)},i.onabort=function(){var e=u.error?u.error:u.transaction.error;n(e)}}).catch(n)});return i(n,t),n}function A(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo,o=n.db.transaction(n.storeName,"readwrite"),i=o.objectStore(n.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;r(e)}}).catch(r)});return i(r,e),r}function D(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo,o=n.db.transaction(n.storeName,"readonly").objectStore(n.storeName),i=o.count();i.onsuccess=function(){e(i.result)},i.onerror=function(){r(i.error)}}).catch(r)});return i(r,e),r}function j(e,t){var r=this,n=new ie(function(t,n){if(e<0)return void t(null);r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,u=i.openCursor();u.onsuccess=function(){var r=u.result;if(!r)return void t(null);0===e?t(r.key):a?t(r.key):(a=!0,r.advance(e))},u.onerror=function(){n(u.error)}}).catch(n)});return i(n,t),n}function N(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo,o=n.db.transaction(n.storeName,"readonly").objectStore(n.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var t=i.result;if(!t)return void e(a);a.push(t.key),t.continue()},i.onerror=function(){r(i.error)}}).catch(r)});return i(r,e),r}function O(e){var t,r,n,o,i,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var f=new ArrayBuffer(a),s=new Uint8Array(f);for(t=0;t<u;t+=4)r=fe.indexOf(e[t]),n=fe.indexOf(e[t+1]),o=fe.indexOf(e[t+2]),i=fe.indexOf(e[t+3]),s[c++]=r<<2|n>>4,s[c++]=(15&n)<<4|o>>2,s[c++]=(3&o)<<6|63&i;return f}function B(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=fe[r[t]>>2],n+=fe[(3&r[t])<<4|r[t+1]>>4],n+=fe[(15&r[t+1])<<2|r[t+2]>>6],n+=fe[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function R(e,t){var r="";if(e&&(r=De.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===De.call(e.buffer))){var n,o=de;e instanceof ArrayBuffer?(n=e,o+=he):(n=e.buffer,"[object Int8Array]"===r?o+=pe:"[object Uint8Array]"===r?o+=be:"[object Uint8ClampedArray]"===r?o+=ge:"[object Int16Array]"===r?o+=me:"[object Uint16Array]"===r?o+=_e:"[object Int32Array]"===r?o+=we:"[object Uint32Array]"===r?o+=Se:"[object Float32Array]"===r?o+=Ee:"[object Float64Array]"===r?o+=Ie:t(new Error("Failed to get type for BinaryArray"))),t(o+B(n))}else if("[object Blob]"===r){var i=new FileReader;i.onload=function(){var r=se+e.type+"~"+B(this.result);t(de+ye+r)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}}function k(e){if(e.substring(0,ve)!==de)return JSON.parse(e);var t,r=e.substring(Ae),n=e.substring(ve,Ae);if(n===ye&&le.test(r)){var i=r.match(le);t=i[1],r=r.substring(i[0].length)}var a=O(r);switch(n){case he:return a;case ye:return o([a],{type:t});case pe:return new Int8Array(a);case be:return new Uint8Array(a);case ge:return new Uint8ClampedArray(a);case me:return new Int16Array(a);case _e:return new Uint16Array(a);case we:return new Int32Array(a);case Se:return new Uint32Array(a);case Ee:return new Float32Array(a);case Ie:return new Float64Array(a);default:throw new Error("Unkown type: "+n)}}function x(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var o=new ie(function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=r,e()},function(e,t){n(t)})})});return r.serializer=je,o}function C(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)},function(e,t){n(t)})})}).catch(n)});return i(n,t),n}function L(e,t){var r=this,n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("SELECT * FROM "+o.storeName,[],function(r,n){for(var i=n.rows,a=i.length,u=0;u<a;u++){var c=i.item(u),f=c.value;if(f&&(f=o.serializer.deserialize(f)),void 0!==(f=e(f,c.key,u+1)))return void t(f)}t()},function(e,t){n(t)})})}).catch(n)});return i(n,t),n}function T(e,t,r,n){var o=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=new ie(function(i,a){o.ready().then(function(){void 0===t&&(t=null);var u=t,c=o._dbInfo;c.serializer.serialize(t,function(t,f){f?a(f):c.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(u)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void i(T.apply(o,[e,u,r,n-1]));a(t)}})})}).catch(a)});return i(a,r),a}function F(e,t,r){return T.apply(this,[e,t,r,1])}function z(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){n(t)})})}).catch(n)});return i(n,t),n}function M(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){t.executeSql("DELETE FROM "+n.storeName,[],function(){e()},function(e,t){r(t)})})}).catch(r)});return i(r,e),r}function P(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+n.storeName,[],function(t,r){var n=r.rows.item(0).c;e(n)},function(e,t){r(t)})})}).catch(r)});return i(r,e),r}function q(e,t){var r=this,n=new ie(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)},function(e,t){n(t)})})}).catch(n)});return i(n,t),n}function U(e){var t=this,r=new ie(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){t.executeSql("SELECT key FROM "+n.storeName,[],function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).key);e(n)},function(e,t){r(t)})})}).catch(r)});return i(r,e),r}function W(e){var t=this,r={};if(e)for(var n in e)r[n]=e[n];return r.keyPrefix=r.name+"/",r.storeName!==t._defaultConfig.storeName&&(r.keyPrefix+=r.storeName+"/"),t._dbInfo=r,r.serializer=je,ie.resolve()}function Q(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}});return i(r,e),r}function G(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=r.ready().then(function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n});return i(n,t),n}function X(e,t){var r=this,n=r.ready().then(function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,i=localStorage.length,a=1,u=0;u<i;u++){var c=localStorage.key(u);if(0===c.indexOf(n)){var f=localStorage.getItem(c);if(f&&(f=t.serializer.deserialize(f)),void 0!==(f=e(f,c.substring(o),a++)))return f}}});return i(n,t),n}function H(e,t){var r=this,n=r.ready().then(function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t});return i(n,t),n}function J(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;o<r;o++)0===localStorage.key(o).indexOf(e.keyPrefix)&&n.push(localStorage.key(o).substring(e.keyPrefix.length));return n});return i(r,e),r}function K(e){var t=this,r=t.keys().then(function(e){return e.length});return i(r,e),r}function V(e,t){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=r.ready().then(function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return i(n,t),n}function Y(e,t,r){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=n.ready().then(function(){void 0===t&&(t=null);var r=t;return new ie(function(o,i){var a=n._dbInfo;a.serializer.serialize(t,function(t,n){if(n)i(n);else try{localStorage.setItem(a.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}})})});return i(o,r),o}function Z(e,t){e[t]=function(){var r=arguments;return e.ready().then(function(){return e[t].apply(e,r)})}}function $(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(Te(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}function ee(e){for(var t in Re)if(Re.hasOwnProperty(t)&&Re[t]===e)return!0;return!1}var te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();"undefined"==typeof Promise&&e(3);var ne,oe,ie=Promise,ae="local-forage-detect-blob-support",ue=Object.prototype.toString,ce={_driver:"asyncStorage",_initStorage:w,iterate:S,getItem:_,setItem:E,removeItem:I,clear:A,length:D,key:j,keys:N},fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se="~~local_forage_type~",le=/^~~local_forage_type~([^~]+)~/,de="__lfsc__:",ve=de.length,he="arbf",ye="blob",pe="si08",be="ui08",ge="uic8",me="si16",we="si32",_e="ur16",Se="ui32",Ee="fl32",Ie="fl64",Ae=ve+he.length,De=Object.prototype.toString,je={serialize:R,deserialize:k,stringToBuffer:O,bufferToString:B},Ne={_driver:"webSQLStorage",_initStorage:x,iterate:L,getItem:C,setItem:F,removeItem:z,clear:M,length:P,key:q,keys:U},Oe={_driver:"localStorageWrapper",_initStorage:W,iterate:X,getItem:G,setItem:Y,removeItem:V,clear:Q,length:K,key:H,keys:J},Be={},Re={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},ke=[Re.INDEXEDDB,Re.WEBSQL,Re.LOCALSTORAGE],xe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],Ce={description:"",driver:ke.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Le={};Le[Re.INDEXEDDB]=function(){try{if(!re)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),Le[Re.WEBSQL]=function(){return"function"==typeof openDatabase}(),Le[Re.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var Te=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Fe=function(){function e(t){n(this,e),this.INDEXEDDB=Re.INDEXEDDB,this.LOCALSTORAGE=Re.LOCALSTORAGE,this.WEBSQL=Re.WEBSQL,this._defaultConfig=$({},Ce),this._config=$({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":te(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new ie(function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),i=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void r(o);if(ee(e._driver))return void r(i);for(var a=xe.concat("_initStorage"),u=0;u<a.length;u++){var c=a[u];if(!c||!e[c]||"function"!=typeof e[c])return void r(o)}var f=ie.resolve(!0);"_support"in e&&(f=e._support&&"function"==typeof e._support?e._support():ie.resolve(!!e._support)),f.then(function(r){Le[n]=r,Be[n]=e,t()},r)}catch(e){r(e)}});return a(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=this,o=ie.resolve().then(function(){if(!ee(e)){if(Be[e])return Be[e];throw new Error("Driver not found.")}switch(e){case n.INDEXEDDB:return ce;case n.LOCALSTORAGE:return Oe;case n.WEBSQL:return Ne}});return a(o,t,r),o},e.prototype.getSerializer=function(e){var t=ie.resolve(je);return a(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(r,e,e),r},e.prototype.setDriver=function(e,t,r){function n(){u._config.driver=u.driver()}function o(e){return u._extend(e),n(),u._ready=u._initStorage(u._config),u._ready}function i(e){return function(){function t(){for(;r<e.length;){var i=e[r];return r++,u._dbInfo=null,u._ready=null,u.getDriver(i).then(o).catch(t)}n();var a=new Error("No available storage method found.");return u._driverSet=ie.reject(a),u._driverSet}var r=0;return t()}}var u=this;Te(e)||(e=[e]);var c=this._getSupportedDrivers(e),f=null!==this._driverSet?this._driverSet.catch(function(){return ie.resolve()}):ie.resolve();return this._driverSet=f.then(function(){var e=c[0];return u._dbInfo=null,u._ready=null,u.getDriver(e).then(function(e){u._driver=e._driver,n(),u._wrapLibraryMethodsWithReady(),u._initDriver=i(c)})}).catch(function(){n();var e=new Error("No available storage method found.");return u._driverSet=ie.reject(e),u._driverSet}),a(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!Le[e]},e.prototype._extend=function(e){$(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<xe.length;e++)Z(this,xe[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),ze=new Fe;t.exports=ze},{3:3}]},{},[4])(4)});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],166:[function(require,module,exports){
function magnetURIDecode(e){var n={},r=e.split("magnet:?")[1];(r&&r.length>=0?r.split("&"):[]).forEach(function(e){var r=e.split("=");if(2===r.length){var t=r[0],o=r[1];if("dn"===t&&(o=decodeURIComponent(o).replace(/\+/g," ")),"tr"!==t&&"xs"!==t&&"as"!==t&&"ws"!==t||(o=decodeURIComponent(o)),"kt"===t&&(o=decodeURIComponent(o).split("+")),"ix"===t&&(o=Number(o)),n[t])if(Array.isArray(n[t]))n[t].push(o);else{var a=n[t];n[t]=[a,o]}else n[t]=o}});var t;if(n.xt){(Array.isArray(n.xt)?n.xt:[n.xt]).forEach(function(e){if(t=e.match(/^urn:btih:(.{40})/))n.infoHash=t[1].toLowerCase();else if(t=e.match(/^urn:btih:(.{32})/)){var r=base32.decode(t[1]);n.infoHash=Buffer.from(r,"binary").toString("hex")}})}return n.infoHash&&(n.infoHashBuffer=Buffer.from(n.infoHash,"hex")),n.dn&&(n.name=n.dn),n.kt&&(n.keywords=n.kt),"string"==typeof n.tr?n.announce=[n.tr]:Array.isArray(n.tr)?n.announce=n.tr:n.announce=[],n.urlList=[],("string"==typeof n.as||Array.isArray(n.as))&&(n.urlList=n.urlList.concat(n.as)),("string"==typeof n.ws||Array.isArray(n.ws))&&(n.urlList=n.urlList.concat(n.ws)),uniq(n.announce),uniq(n.urlList),n}function magnetURIEncode(e){e=extend(e),e.infoHashBuffer&&(e.xt="urn:btih:"+e.infoHashBuffer.toString("hex")),e.infoHash&&(e.xt="urn:btih:"+e.infoHash),e.name&&(e.dn=e.name),e.keywords&&(e.kt=e.keywords),e.announce&&(e.tr=e.announce),e.urlList&&(e.ws=e.urlList,delete e.as);var n="magnet:?";return Object.keys(e).filter(function(e){return 2===e.length}).forEach(function(r,t){(Array.isArray(e[r])?e[r]:[e[r]]).forEach(function(e,o){!(t>0||o>0)||"kt"===r&&0!==o||(n+="&"),"dn"===r&&(e=encodeURIComponent(e).replace(/%20/g,"+")),"tr"!==r&&"xs"!==r&&"as"!==r&&"ws"!==r||(e=encodeURIComponent(e)),"kt"===r&&(e=encodeURIComponent(e)),n+="kt"===r&&o>0?"+"+e:r+"="+e})}),n}module.exports=magnetURIDecode,module.exports.decode=magnetURIDecode,module.exports.encode=magnetURIEncode;var base32=require("thirty-two"),Buffer=require("safe-buffer").Buffer,extend=require("xtend"),uniq=require("uniq");

},{"safe-buffer":244,"thirty-two":281,"uniq":293,"xtend":324}],167:[function(require,module,exports){
function MediaElementWrapper(e,r){var t=this;if(!(t instanceof MediaElementWrapper))return new MediaElementWrapper(e,r);if(!MediaSource)throw new Error("web browser lacks MediaSource support");r||(r={}),t._bufferDuration=r.bufferDuration||DEFAULT_BUFFER_DURATION,t._elem=e,t._mediaSource=new MediaSource,t._streams=[],t.detailedError=null,t._errorHandler=function(){t._elem.removeEventListener("error",t._errorHandler),t._streams.slice().forEach(function(e){e.destroy(t._elem.error)})},t._elem.addEventListener("error",t._errorHandler),t._elem.src=window.URL.createObjectURL(t._mediaSource)}function MediaSourceStream(e,r){var t=this;if(stream.Writable.call(t),t._wrapper=e,t._elem=e._elem,t._mediaSource=e._mediaSource,t._allStreams=e._streams,t._allStreams.push(t),t._bufferDuration=e._bufferDuration,t._sourceBuffer=null,t._openHandler=function(){t._onSourceOpen()},t._flowHandler=function(){t._flow()},"string"==typeof r)t._type=r,"open"===t._mediaSource.readyState?t._createSourceBuffer():t._mediaSource.addEventListener("sourceopen",t._openHandler);else if(null===r._sourceBuffer)r.destroy(),t._type=r._type,t._mediaSource.addEventListener("sourceopen",t._openHandler);else{if(!r._sourceBuffer)throw new Error("The argument to MediaElementWrapper.createWriteStream must be a string or a previous stream returned from that function");r.destroy(),t._type=r._type,t._sourceBuffer=r._sourceBuffer,t._sourceBuffer.addEventListener("updateend",t._flowHandler)}t._elem.addEventListener("timeupdate",t._flowHandler),t.on("error",function(e){t._wrapper.error(e)}),t.on("finish",function(){if(!t.destroyed&&(t._finished=!0,t._allStreams.every(function(e){return e._finished})))try{t._mediaSource.endOfStream()}catch(e){}})}module.exports=MediaElementWrapper;var inherits=require("inherits"),stream=require("readable-stream"),toArrayBuffer=require("to-arraybuffer"),MediaSource="undefined"!=typeof window&&window.MediaSource,DEFAULT_BUFFER_DURATION=60;MediaElementWrapper.prototype.createWriteStream=function(e){return new MediaSourceStream(this,e)},MediaElementWrapper.prototype.error=function(e){var r=this;r.detailedError||(r.detailedError=e);try{r._mediaSource.endOfStream("decode")}catch(e){}},inherits(MediaSourceStream,stream.Writable),MediaSourceStream.prototype._onSourceOpen=function(){var e=this;e.destroyed||(e._mediaSource.removeEventListener("sourceopen",e._openHandler),e._createSourceBuffer())},MediaSourceStream.prototype.destroy=function(e){var r=this;r.destroyed||(r.destroyed=!0,r._allStreams.splice(r._allStreams.indexOf(r),1),r._mediaSource.removeEventListener("sourceopen",r._openHandler),r._elem.removeEventListener("timeupdate",r._flowHandler),r._sourceBuffer&&(r._sourceBuffer.removeEventListener("updateend",r._flowHandler),"open"===r._mediaSource.readyState&&r._sourceBuffer.abort()),e&&r.emit("error",e),r.emit("close"))},MediaSourceStream.prototype._createSourceBuffer=function(){var e=this;if(!e.destroyed)if(MediaSource.isTypeSupported(e._type)){if(e._sourceBuffer=e._mediaSource.addSourceBuffer(e._type),e._sourceBuffer.addEventListener("updateend",e._flowHandler),e._cb){var r=e._cb;e._cb=null,r()}}else e.destroy(new Error("The provided type is not supported"))},MediaSourceStream.prototype._write=function(e,r,t){var o=this;if(!o.destroyed){if(!o._sourceBuffer)return void(o._cb=function(a){if(a)return t(a);o._write(e,r,t)});if(o._sourceBuffer.updating)return t(new Error("Cannot append buffer while source buffer updating"));try{o._sourceBuffer.appendBuffer(toArrayBuffer(e))}catch(e){return void o.destroy(e)}o._cb=t}},MediaSourceStream.prototype._flow=function(){var e=this;if(!e.destroyed&&e._sourceBuffer&&!e._sourceBuffer.updating&&!("open"===e._mediaSource.readyState&&e._getBufferDuration()>e._bufferDuration)&&e._cb){var r=e._cb;e._cb=null,r()}};var EPSILON=0;MediaSourceStream.prototype._getBufferDuration=function(){for(var e=this,r=e._sourceBuffer.buffered,t=e._elem.currentTime,o=-1,a=0;a<r.length;a++){var n=r.start(a),u=r.end(a)+EPSILON;if(n>t)break;(o>=0||t<=u)&&(o=u)}var i=o-t;return i<0&&(i=0),i};

},{"inherits":144,"readable-stream":235,"to-arraybuffer":283}],168:[function(require,module,exports){
(function (process){
function Storage(t,n){if(!(this instanceof Storage))return new Storage(t,n);if(n||(n={}),this.chunkLength=Number(t),!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[],this.closed=!1,this.length=Number(n.length)||1/0,this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1)}function nextTick(t,n,e){process.nextTick(function(){t&&t(n,e)})}module.exports=Storage,Storage.prototype.put=function(t,n,e){if(this.closed)return nextTick(e,new Error("Storage is closed"));var h=t===this.lastChunkIndex;return h&&n.length!==this.lastChunkLength?nextTick(e,new Error("Last chunk length must be "+this.lastChunkLength)):h||n.length===this.chunkLength?(this.chunks[t]=n,void nextTick(e,null)):nextTick(e,new Error("Chunk length must be "+this.chunkLength))},Storage.prototype.get=function(t,n,e){if("function"==typeof n)return this.get(t,null,n);if(this.closed)return nextTick(e,new Error("Storage is closed"));var h=this.chunks[t];if(!h){var r=new Error("Chunk not found");return r.notFound=!0,nextTick(e,r)}if(!n)return nextTick(e,null,h);var i=n.offset||0,s=n.length||h.length-i;nextTick(e,null,h.slice(i,s+i))},Storage.prototype.close=Storage.prototype.destroy=function(t){if(this.closed)return nextTick(t,new Error("Storage is closed"));this.closed=!0,this.chunks=null,nextTick(t,null)};

}).call(this,require('_process'))
},{"_process":205}],169:[function(require,module,exports){
function MillerRabin(r){this.rand=r||new brorand.Rand}var bn=require("bn.js"),brorand=require("brorand");module.exports=MillerRabin,MillerRabin.create=function(r){return new MillerRabin(r)},MillerRabin.prototype._rand=function(r){var n=r.bitLength(),e=this.rand.generate(Math.ceil(n/8));e[0]|=3;var t=7&n;return 0!==t&&(e[e.length-1]>>=7-t),new bn(e)},MillerRabin.prototype.test=function(r,n,e){var t=r.bitLength(),a=bn.mont(r),i=new bn(1).toRed(a);n||(n=Math.max(1,t/48|0));for(var o=r.subn(1),b=o.subn(1),d=0;!o.testn(d);d++);for(var u=r.shrn(d),f=o.toRed(a);n>0;n--){var c=this._rand(b);e&&e(c);var s=c.toRed(a).redPow(u);if(0!==s.cmp(i)&&0!==s.cmp(f)){for(var l=1;l<d;l++){if(s=s.redSqr(),0===s.cmp(i))return!1;if(0===s.cmp(f))break}if(l===d)return!1}}return!0},MillerRabin.prototype.getDivisor=function(r,n){var e=r.bitLength(),t=bn.mont(r),a=new bn(1).toRed(t);n||(n=Math.max(1,e/48|0));for(var i=r.subn(1),o=i.subn(1),b=0;!i.testn(b);b++);for(var d=r.shrn(b),u=i.toRed(t);n>0;n--){var f=this._rand(o),c=r.gcd(f);if(0!==c.cmpn(1))return c;var s=f.toRed(t).redPow(d);if(0!==s.cmp(a)&&0!==s.cmp(u)){for(var l=1;l<b;l++){if(s=s.redSqr(),0===s.cmp(a))return s.fromRed().subn(1).gcd(r);if(0===s.cmp(u))break}if(l===b)return s=s.redSqr(),s.fromRed().subn(1).gcd(r)}}return!1};

},{"bn.js":35,"brorand":36}],170:[function(require,module,exports){
function assert(r,e){if(!r)throw new Error(e||"Assertion failed")}module.exports=assert,assert.equal=function(r,e,s){if(r!=e)throw new Error(s||"Assertion failed: "+r+" != "+e)};

},{}],171:[function(require,module,exports){
"use strict";function toArray(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var e=[];if("string"!=typeof r){for(var n=0;n<r.length;n++)e[n]=0|r[n];return e}if("hex"===t){r=r.replace(/[^a-z0-9]+/gi,""),r.length%2!=0&&(r="0"+r);for(var n=0;n<r.length;n+=2)e.push(parseInt(r[n]+r[n+1],16))}else for(var n=0;n<r.length;n++){var o=r.charCodeAt(n),u=o>>8,i=255&o;u?e.push(u,i):e.push(i)}return e}function zero2(r){return 1===r.length?"0"+r:r}function toHex(r){for(var t="",e=0;e<r.length;e++)t+=zero2(r[e].toString(16));return t}var utils=exports;utils.toArray=toArray,utils.zero2=zero2,utils.toHex=toHex,utils.encode=function(r,t){return"hex"===t?toHex(r):r};

},{}],172:[function(require,module,exports){
var _last=0,_count=1,adjusted=0,_adjusted=0;module.exports=function(){var d=Date.now();if(_last===d){do{adjusted=d+_count++/(_count+999)}while(adjusted===_adjusted);_adjusted=adjusted}else _count=1,adjusted=d;return _adjusted=adjusted,_last=d,adjusted};

},{}],173:[function(require,module,exports){
(function (Buffer){
function writeReserved(e,t,r){for(var n=t;n<r;n++)e[n]=0}function writeDate(e,t,r){t.writeUInt32BE(Math.floor((e.getTime()+TIME_OFFSET)/1e3),r)}function writeFixed32(e,t,r){t.writeUInt16BE(Math.floor(e)%65536,r),t.writeUInt16BE(Math.floor(256*e*256)%65536,r+2)}function writeFixed16(e,t,r){t[r]=Math.floor(e)%256,t[r+1]=Math.floor(256*e)%256}function writeMatrix(e,t,r){e||(e=[0,0,0,0,0,0,0,0,0]);for(var n=0;n<e.length;n++)writeFixed32(e[n],t,r+4*n)}function writeString(e,t,r){var n=new Buffer(e,"utf8");n.copy(t,r),t[r+n.length]=0}function readMatrix(e){for(var t=new Array(e.length/4),r=0;r<t.length;r++)t[r]=readFixed32(e,4*r);return t}function readDate(e,t){return new Date(1e3*e.readUInt32BE(t)-TIME_OFFSET)}function readFixed32(e,t){return e.readUInt16BE(t)+e.readUInt16BE(t+2)/65536}function readFixed16(e,t){return e[t]+e[t+1]/256}function readString(e,t,r){var n;for(n=0;n<r&&0!==e[t+n];n++);return e.toString("utf8",t,t+n)}var Box=require("./index"),Descriptor=require("./descriptor"),TIME_OFFSET=20828448e5;exports.fullBoxes={};var fullBoxes=["mvhd","tkhd","mdhd","vmhd","smhd","stsd","esds","stsz","stco","stss","stts","ctts","stsc","dref","elst","hdlr","mehd","trex","mfhd","tfhd","tfdt","trun"];fullBoxes.forEach(function(e){exports.fullBoxes[e]=!0}),exports.ftyp={},exports.ftyp.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.ftyp.encodingLength(e));var n=e.compatibleBrands||[];t.write(e.brand,0,4,"ascii"),t.writeUInt32BE(e.brandVersion,4);for(var o=0;o<n.length;o++)t.write(n[o],8+4*o,4,"ascii");return exports.ftyp.encode.bytes=8+4*n.length,t},exports.ftyp.decode=function(e,t){e=e.slice(t);for(var r=e.toString("ascii",0,4),n=e.readUInt32BE(4),o=[],i=8;i<e.length;i+=4)o.push(e.toString("ascii",i,i+4));return{brand:r,brandVersion:n,compatibleBrands:o}},exports.ftyp.encodingLength=function(e){return 8+4*(e.compatibleBrands||[]).length},exports.mvhd={},exports.mvhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(96),writeDate(e.ctime||new Date,t,0),writeDate(e.mtime||new Date,t,4),t.writeUInt32BE(e.timeScale||0,8),t.writeUInt32BE(e.duration||0,12),writeFixed32(e.preferredRate||0,t,16),writeFixed16(e.preferredVolume||0,t,20),writeReserved(t,22,32),writeMatrix(e.matrix,t,32),t.writeUInt32BE(e.previewTime||0,68),t.writeUInt32BE(e.previewDuration||0,72),t.writeUInt32BE(e.posterTime||0,76),t.writeUInt32BE(e.selectionTime||0,80),t.writeUInt32BE(e.selectionDuration||0,84),t.writeUInt32BE(e.currentTime||0,88),t.writeUInt32BE(e.nextTrackId||0,92),exports.mvhd.encode.bytes=96,t},exports.mvhd.decode=function(e,t){return e=e.slice(t),{ctime:readDate(e,0),mtime:readDate(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),preferredRate:readFixed32(e,16),preferredVolume:readFixed16(e,20),matrix:readMatrix(e.slice(32,68)),previewTime:e.readUInt32BE(68),previewDuration:e.readUInt32BE(72),posterTime:e.readUInt32BE(76),selectionTime:e.readUInt32BE(80),selectionDuration:e.readUInt32BE(84),currentTime:e.readUInt32BE(88),nextTrackId:e.readUInt32BE(92)}},exports.mvhd.encodingLength=function(e){return 96},exports.tkhd={},exports.tkhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(80),writeDate(e.ctime||new Date,t,0),writeDate(e.mtime||new Date,t,4),t.writeUInt32BE(e.trackId||0,8),writeReserved(t,12,16),t.writeUInt32BE(e.duration||0,16),writeReserved(t,20,28),t.writeUInt16BE(e.layer||0,28),t.writeUInt16BE(e.alternateGroup||0,30),t.writeUInt16BE(e.volume||0,32),writeMatrix(e.matrix,t,36),t.writeUInt32BE(e.trackWidth||0,72),t.writeUInt32BE(e.trackHeight||0,76),exports.tkhd.encode.bytes=80,t},exports.tkhd.decode=function(e,t){return e=e.slice(t),{ctime:readDate(e,0),mtime:readDate(e,4),trackId:e.readUInt32BE(8),duration:e.readUInt32BE(16),layer:e.readUInt16BE(28),alternateGroup:e.readUInt16BE(30),volume:e.readUInt16BE(32),matrix:readMatrix(e.slice(36,72)),trackWidth:e.readUInt32BE(72),trackHeight:e.readUInt32BE(76)}},exports.tkhd.encodingLength=function(e){return 80},exports.mdhd={},exports.mdhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(20),writeDate(e.ctime||new Date,t,0),writeDate(e.mtime||new Date,t,4),t.writeUInt32BE(e.timeScale||0,8),t.writeUInt32BE(e.duration||0,12),t.writeUInt16BE(e.language||0,16),t.writeUInt16BE(e.quality||0,18),exports.mdhd.encode.bytes=20,t},exports.mdhd.decode=function(e,t){return e=e.slice(t),{ctime:readDate(e,0),mtime:readDate(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),language:e.readUInt16BE(16),quality:e.readUInt16BE(18)}},exports.mdhd.encodingLength=function(e){return 20},exports.vmhd={},exports.vmhd.encode=function(e,t,r){t=t?t.slice(r):new Buffer(8),t.writeUInt16BE(e.graphicsMode||0,0);var n=e.opcolor||[0,0,0];return t.writeUInt16BE(n[0],2),t.writeUInt16BE(n[1],4),t.writeUInt16BE(n[2],6),exports.vmhd.encode.bytes=8,t},exports.vmhd.decode=function(e,t){return e=e.slice(t),{graphicsMode:e.readUInt16BE(0),opcolor:[e.readUInt16BE(2),e.readUInt16BE(4),e.readUInt16BE(6)]}},exports.vmhd.encodingLength=function(e){return 8},exports.smhd={},exports.smhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(4),t.writeUInt16BE(e.balance||0,0),writeReserved(t,2,4),exports.smhd.encode.bytes=4,t},exports.smhd.decode=function(e,t){return e=e.slice(t),{balance:e.readUInt16BE(0)}},exports.smhd.encodingLength=function(e){return 4},exports.stsd={},exports.stsd.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.stsd.encodingLength(e));var n=e.entries||[];t.writeUInt32BE(n.length,0);for(var o=4,i=0;i<n.length;i++){var s=n[i];Box.encode(s,t,o),o+=Box.encode.bytes}return exports.stsd.encode.bytes=o,t},exports.stsd.decode=function(e,t,r){e=e.slice(t);for(var n=e.readUInt32BE(0),o=new Array(n),i=4,s=0;s<n;s++){var d=Box.decode(e,i,r);o[s]=d,i+=d.length}return{entries:o}},exports.stsd.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var r=0;r<e.entries.length;r++)t+=Box.encodingLength(e.entries[r]);return t},exports.avc1=exports.VisualSampleEntry={},exports.VisualSampleEntry.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.VisualSampleEntry.encodingLength(e)),writeReserved(t,0,6),t.writeUInt16BE(e.dataReferenceIndex||0,6),writeReserved(t,8,24),t.writeUInt16BE(e.width||0,24),t.writeUInt16BE(e.height||0,26),t.writeUInt32BE(e.hResolution||4718592,28),t.writeUInt32BE(e.vResolution||4718592,32),writeReserved(t,36,40),t.writeUInt16BE(e.frameCount||1,40);var n=e.compressorName||"",o=Math.min(n.length,31);t.writeUInt8(o,42),t.write(n,43,o,"utf8"),t.writeUInt16BE(e.depth||24,74),t.writeInt16BE(-1,76);var i=78;(e.children||[]).forEach(function(e){Box.encode(e,t,i),i+=Box.encode.bytes}),exports.VisualSampleEntry.encode.bytes=i},exports.VisualSampleEntry.decode=function(e,t,r){e=e.slice(t);for(var n=r-t,o=Math.min(e.readUInt8(42),31),i={dataReferenceIndex:e.readUInt16BE(6),width:e.readUInt16BE(24),height:e.readUInt16BE(26),hResolution:e.readUInt32BE(28),vResolution:e.readUInt32BE(32),frameCount:e.readUInt16BE(40),compressorName:e.toString("utf8",43,43+o),depth:e.readUInt16BE(74),children:[]},s=78;n-s>=8;){var d=Box.decode(e,s,n);i.children.push(d),i[d.type]=d,s+=d.length}return i},exports.VisualSampleEntry.encodingLength=function(e){var t=78;return(e.children||[]).forEach(function(e){t+=Box.encodingLength(e)}),t},exports.avcC={},exports.avcC.encode=function(e,t,r){t=t?t.slice(r):Buffer(e.buffer.length),e.buffer.copy(t),exports.avcC.encode.bytes=e.buffer.length},exports.avcC.decode=function(e,t,r){return e=e.slice(t,r),{mimeCodec:e.toString("hex",1,4),buffer:new Buffer(e)}},exports.avcC.encodingLength=function(e){return e.buffer.length},exports.mp4a=exports.AudioSampleEntry={},exports.AudioSampleEntry.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.AudioSampleEntry.encodingLength(e)),writeReserved(t,0,6),t.writeUInt16BE(e.dataReferenceIndex||0,6),writeReserved(t,8,16),t.writeUInt16BE(e.channelCount||2,16),t.writeUInt16BE(e.sampleSize||16,18),writeReserved(t,20,24),t.writeUInt32BE(e.sampleRate||0,24);var n=28;(e.children||[]).forEach(function(e){Box.encode(e,t,n),n+=Box.encode.bytes}),exports.AudioSampleEntry.encode.bytes=n},exports.AudioSampleEntry.decode=function(e,t,r){e=e.slice(t,r);for(var n=r-t,o={dataReferenceIndex:e.readUInt16BE(6),channelCount:e.readUInt16BE(16),sampleSize:e.readUInt16BE(18),sampleRate:e.readUInt32BE(24),children:[]},i=28;n-i>=8;){var s=Box.decode(e,i,n);o.children.push(s),o[s.type]=s,i+=s.length}return o},exports.AudioSampleEntry.encodingLength=function(e){var t=28;return(e.children||[]).forEach(function(e){t+=Box.encodingLength(e)}),t},exports.esds={},exports.esds.encode=function(e,t,r){t=t?t.slice(r):Buffer(e.buffer.length),e.buffer.copy(t,0),exports.esds.encode.bytes=e.buffer.length},exports.esds.decode=function(e,t,r){e=e.slice(t,r);var n=Descriptor.Descriptor.decode(e,0,e.length),o="ESDescriptor"===n.tagName?n:{},i=o.DecoderConfigDescriptor||{},s=i.oti||0,d=i.DecoderSpecificInfo,c=d?(248&d.buffer.readUInt8(0))>>3:0,a=null;return s&&(a=s.toString(16),c&&(a+="."+c)),{mimeCodec:a,buffer:new Buffer(e.slice(0))}},exports.esds.encodingLength=function(e){return e.buffer.length},exports.stsz={},exports.stsz.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):Buffer(exports.stsz.encodingLength(e)),t.writeUInt32BE(0,0),t.writeUInt32BE(n.length,4);for(var o=0;o<n.length;o++)t.writeUInt32BE(n[o],4*o+8);return exports.stsz.encode.bytes=8+4*n.length,t},exports.stsz.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=e.readUInt32BE(4),o=new Array(n),i=0;i<n;i++)o[i]=0===r?e.readUInt32BE(4*i+8):r;return{entries:o}},exports.stsz.encodingLength=function(e){return 8+4*e.entries.length},exports.stss=exports.stco={},exports.stco.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):new Buffer(exports.stco.encodingLength(e)),t.writeUInt32BE(n.length,0);for(var o=0;o<n.length;o++)t.writeUInt32BE(n[o],4*o+4);return exports.stco.encode.bytes=4+4*n.length,t},exports.stco.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=0;o<r;o++)n[o]=e.readUInt32BE(4*o+4);return{entries:n}},exports.stco.encodingLength=function(e){return 4+4*e.entries.length},exports.stts={},exports.stts.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):new Buffer(exports.stts.encodingLength(e)),t.writeUInt32BE(n.length,0);for(var o=0;o<n.length;o++){var i=8*o+4;t.writeUInt32BE(n[o].count||0,i),t.writeUInt32BE(n[o].duration||0,i+4)}return exports.stts.encode.bytes=4+8*e.entries.length,t},exports.stts.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=0;o<r;o++){var i=8*o+4;n[o]={count:e.readUInt32BE(i),duration:e.readUInt32BE(i+4)}}return{entries:n}},exports.stts.encodingLength=function(e){return 4+8*e.entries.length},exports.ctts={},exports.ctts.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):new Buffer(exports.ctts.encodingLength(e)),t.writeUInt32BE(n.length,0);for(var o=0;o<n.length;o++){var i=8*o+4;t.writeUInt32BE(n[o].count||0,i),t.writeUInt32BE(n[o].compositionOffset||0,i+4)}return exports.ctts.encode.bytes=4+8*n.length,t},exports.ctts.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=0;o<r;o++){var i=8*o+4;n[o]={count:e.readUInt32BE(i),compositionOffset:e.readInt32BE(i+4)}}return{entries:n}},exports.ctts.encodingLength=function(e){return 4+8*e.entries.length},exports.stsc={},exports.stsc.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):new Buffer(exports.stsc.encodingLength(e)),t.writeUInt32BE(n.length,0);for(var o=0;o<n.length;o++){var i=12*o+4;t.writeUInt32BE(n[o].firstChunk||0,i),t.writeUInt32BE(n[o].samplesPerChunk||0,i+4),t.writeUInt32BE(n[o].sampleDescriptionId||0,i+8)}return exports.stsc.encode.bytes=4+12*n.length,t},exports.stsc.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=0;o<r;o++){var i=12*o+4;n[o]={firstChunk:e.readUInt32BE(i),samplesPerChunk:e.readUInt32BE(i+4),sampleDescriptionId:e.readUInt32BE(i+8)}}return{entries:n}},exports.stsc.encodingLength=function(e){return 4+12*e.entries.length},exports.dref={},exports.dref.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.dref.encodingLength(e));var n=e.entries||[];t.writeUInt32BE(n.length,0);for(var o=4,i=0;i<n.length;i++){var s=n[i],d=(s.buf?s.buf.length:0)+4+4;t.writeUInt32BE(d,o),o+=4,t.write(s.type,o,4,"ascii"),o+=4,s.buf&&(s.buf.copy(t,o),o+=s.buf.length)}return exports.dref.encode.bytes=o,t},exports.dref.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=4,i=0;i<r;i++){var s=e.readUInt32BE(o),d=e.toString("ascii",o+4,o+8),c=e.slice(o+8,o+s);o+=s,n[i]={type:d,buf:c}}return{entries:n}},exports.dref.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var r=0;r<e.entries.length;r++){var n=e.entries[r].buf;t+=(n?n.length:0)+4+4}return t},exports.elst={},exports.elst.encode=function(e,t,r){var n=e.entries||[];t=t?t.slice(r):new Buffer(exports.elst.encodingLength(e)),t.writeUInt32BE(n.length,0);for(var o=0;o<n.length;o++){var i=12*o+4;t.writeUInt32BE(n[o].trackDuration||0,i),t.writeUInt32BE(n[o].mediaTime||0,i+4),writeFixed32(n[o].mediaRate||0,t,i+8)}return exports.elst.encode.bytes=4+12*n.length,t},exports.elst.decode=function(e,t){e=e.slice(t);for(var r=e.readUInt32BE(0),n=new Array(r),o=0;o<r;o++){var i=12*o+4;n[o]={trackDuration:e.readUInt32BE(i),mediaTime:e.readInt32BE(i+4),mediaRate:readFixed32(e,i+8)}}return{entries:n}},exports.elst.encodingLength=function(e){return 4+12*e.entries.length},exports.hdlr={},exports.hdlr.encode=function(e,t,r){t=t?t.slice(r):new Buffer(exports.hdlr.encodingLength(e));var n=21+(e.name||"").length;return t.fill(0,0,n),t.write(e.handlerType||"",4,4,"ascii"),writeString(e.name||"",t,20),exports.hdlr.encode.bytes=n,t},exports.hdlr.decode=function(e,t,r){return e=e.slice(t),{handlerType:e.toString("ascii",4,8),name:readString(e,20,r)}},exports.hdlr.encodingLength=function(e){return 21+(e.name||"").length},exports.mehd={},exports.mehd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(4),t.writeUInt32BE(e.fragmentDuration||0,0),exports.mehd.encode.bytes=4,t},exports.mehd.decode=function(e,t){return e=e.slice(t),{fragmentDuration:e.readUInt32BE(0)}},exports.mehd.encodingLength=function(e){return 4},exports.trex={},exports.trex.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(20),t.writeUInt32BE(e.trackId||0,0),t.writeUInt32BE(e.defaultSampleDescriptionIndex||0,4),t.writeUInt32BE(e.defaultSampleDuration||0,8),t.writeUInt32BE(e.defaultSampleSize||0,12),t.writeUInt32BE(e.defaultSampleFlags||0,16),exports.trex.encode.bytes=20,t},exports.trex.decode=function(e,t){return e=e.slice(t),{trackId:e.readUInt32BE(0),defaultSampleDescriptionIndex:e.readUInt32BE(4),defaultSampleDuration:e.readUInt32BE(8),defaultSampleSize:e.readUInt32BE(12),defaultSampleFlags:e.readUInt32BE(16)}},exports.trex.encodingLength=function(e){return 20},exports.mfhd={},exports.mfhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(4),t.writeUInt32BE(e.sequenceNumber||0,0),exports.mfhd.encode.bytes=4,t},exports.mfhd.decode=function(e,t){return{sequenceNumber:e.readUint32BE(0)}},exports.mfhd.encodingLength=function(e){return 4},exports.tfhd={},exports.tfhd.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(4),t.writeUInt32BE(e.trackId,0),exports.tfhd.encode.bytes=4,t},exports.tfhd.decode=function(e,t){},exports.tfhd.encodingLength=function(e){return 4},exports.tfdt={},exports.tfdt.encode=function(e,t,r){return t=t?t.slice(r):new Buffer(4),t.writeUInt32BE(e.baseMediaDecodeTime||0,0),exports.tfdt.encode.bytes=4,t},exports.tfdt.decode=function(e,t){},exports.tfdt.encodingLength=function(e){return 4},exports.trun={},exports.trun.encode=function(e,t,r){t=t?t.slice(r):new Buffer(8+16*e.entries.length),t.writeUInt32BE(e.entries.length,0),t.writeInt32BE(e.dataOffset,4);for(var n=8,o=0;o<e.entries.length;o++){var i=e.entries[o];t.writeUInt32BE(i.sampleDuration,n),n+=4,t.writeUInt32BE(i.sampleSize,n),n+=4,t.writeUInt32BE(i.sampleFlags,n),n+=4,t.writeUInt32BE(i.sampleCompositionTimeOffset,n),n+=4}exports.trun.encode.bytes=n},exports.trun.decode=function(e,t){},exports.trun.encodingLength=function(e){return 8+16*e.entries.length},exports.mdat={},exports.mdat.encode=function(e,t,r){e.buffer?(e.buffer.copy(t,r),exports.mdat.encode.bytes=e.buffer.length):exports.mdat.encode.bytes=exports.mdat.encodingLength(e)},exports.mdat.decode=function(e,t,r){return{buffer:new Buffer(e.slice(t,r))}},exports.mdat.encodingLength=function(e){return e.buffer?e.buffer.length:e.contentLength};

}).call(this,require("buffer").Buffer)
},{"./descriptor":174,"./index":175,"buffer":66}],174:[function(require,module,exports){
(function (Buffer){
var tagToName={3:"ESDescriptor",4:"DecoderConfigDescriptor",5:"DecoderSpecificInfo",6:"SLConfigDescriptor"};exports.Descriptor={},exports.Descriptor.decode=function(r,e,o){var t,c=r.readUInt8(e),s=e+1,i=0;do{t=r.readUInt8(s++),i=i<<7|127&t}while(128&t);var p,n=tagToName[c];return p=exports[n]?exports[n].decode(r,s,o):{buffer:new Buffer(r.slice(s,s+i))},p.tag=c,p.tagName=n,p.length=s-e+i,p.contentsLen=i,p},exports.DescriptorArray={},exports.DescriptorArray.decode=function(r,e,o){for(var t=e,c={};t+2<=o;){var s=exports.Descriptor.decode(r,t,o);t+=s.length;c[tagToName[s.tag]||"Descriptor"+s.tag]=s}return c},exports.ESDescriptor={},exports.ESDescriptor.decode=function(r,e,o){var t=r.readUInt8(e+2),c=e+3;if(128&t&&(c+=2),64&t){c+=r.readUInt8(c)+1}return 32&t&&(c+=2),exports.DescriptorArray.decode(r,c,o)},exports.DecoderConfigDescriptor={},exports.DecoderConfigDescriptor.decode=function(r,e,o){var t=r.readUInt8(e),c=exports.DescriptorArray.decode(r,e+13,o);return c.oti=t,c};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],175:[function(require,module,exports){
(function (Buffer){
var uint64be=require("uint64be"),boxes=require("./boxes"),UINT32_MAX=4294967295,Box=exports,containers=exports.containers={moov:["mvhd","meta","traks","mvex"],trak:["tkhd","tref","trgr","edts","meta","mdia","udta"],edts:["elst"],mdia:["mdhd","hdlr","elng","minf"],minf:["vmhd","smhd","hmhd","sthd","nmhd","dinf","stbl"],dinf:["dref"],stbl:["stsd","stts","ctts","cslg","stsc","stsz","stz2","stco","co64","stss","stsh","padb","stdp","sdtp","sbgps","sgpds","subss","saizs","saios"],mvex:["mehd","trexs","leva"],moof:["mfhd","meta","trafs"],traf:["tfhd","trun","sbgps","sgpds","subss","saizs","saios","tfdt","meta"]};Box.encode=function(e,t,n){return Box.encodingLength(e),n=n||0,t=t||new Buffer(e.length),Box._encode(e,t,n)},Box._encode=function(e,t,n){var o=e.type,s=e.length;s>UINT32_MAX&&(s=1),t.writeUInt32BE(s,n),t.write(e.type,n+4,4,"ascii");var r=n+8;if(1===s&&(uint64be.encode(e.length,t,r),r+=8),boxes.fullBoxes[o]&&(t.writeUInt32BE(e.flags||0,r),t.writeUInt8(e.version||0,r),r+=4),containers[o]){containers[o].forEach(function(n){if(5===n.length){var o=e[n]||[];n=n.substr(0,4),o.forEach(function(e){Box._encode(e,t,r),r+=Box.encode.bytes})}else e[n]&&(Box._encode(e[n],t,r),r+=Box.encode.bytes)}),e.otherBoxes&&e.otherBoxes.forEach(function(e){Box._encode(e,t,r),r+=Box.encode.bytes})}else if(boxes[o]){var i=boxes[o].encode;i(e,t,r),r+=i.bytes}else{if(!e.buffer)throw new Error("Either `type` must be set to a known type (not'"+o+"') or `buffer` must be set");var f=e.buffer;f.copy(t,r),r+=e.buffer.length}return Box.encode.bytes=r-n,t},Box.readHeaders=function(e,t,n){if(t=t||0,(n=n||e.length)-t<8)return 8;var o=e.readUInt32BE(t),s=e.toString("ascii",t+4,t+8),r=t+8;if(1===o){if(n-t<16)return 16;o=uint64be.decode(e,r),r+=8}var i,f;return boxes.fullBoxes[s]&&(i=e.readUInt8(r),f=16777215&e.readUInt32BE(r),r+=4),{length:o,headersLen:r-t,contentLen:o-(r-t),type:s,version:i,flags:f}},Box.decode=function(e,t,n){t=t||0,n=n||e.length;var o=Box.readHeaders(e,t,n);if(!o||o.length>n-t)throw new Error("Data too short");return Box.decodeWithoutHeaders(o,e,t+o.headersLen,t+o.length)},Box.decodeWithoutHeaders=function(e,t,n,o){n=n||0,o=o||t.length;var s=e.type,r={};if(containers[s]){r.otherBoxes=[];for(var i=containers[s],f=n;o-f>=8;){var d=Box.decode(t,f,o);if(f+=d.length,i.indexOf(d.type)>=0)r[d.type]=d;else if(i.indexOf(d.type+"s")>=0){var a=d.type+"s",c=r[a]=r[a]||[];c.push(d)}else r.otherBoxes.push(d)}}else if(boxes[s]){var h=boxes[s].decode;r=h(t,n,o)}else r.buffer=new Buffer(t.slice(n,o));return r.length=e.length,r.contentLen=e.contentLen,r.type=e.type,r.version=e.version,r.flags=e.flags,r},Box.encodingLength=function(e){var t=e.type,n=8;if(boxes.fullBoxes[t]&&(n+=4),containers[t]){containers[t].forEach(function(t){if(5===t.length){var o=e[t]||[];t=t.substr(0,4),o.forEach(function(e){e.type=t,n+=Box.encodingLength(e)})}else if(e[t]){var s=e[t];s.type=t,n+=Box.encodingLength(s)}}),e.otherBoxes&&e.otherBoxes.forEach(function(e){n+=Box.encodingLength(e)})}else if(boxes[t])n+=boxes[t].encodingLength(e);else{if(!e.buffer)throw new Error("Either `type` must be set to a known type (not'"+t+"') or `buffer` must be set");n+=e.buffer.length}return n>UINT32_MAX&&(n+=8),e.length=n,n};

}).call(this,require("buffer").Buffer)
},{"./boxes":173,"buffer":66,"uint64be":292}],176:[function(require,module,exports){
(function (Buffer){
function Decoder(){if(!(this instanceof Decoder))return new Decoder;stream.Writable.call(this),this.destroyed=!1,this._pending=0,this._missing=0,this._buf=null,this._str=null,this._cb=null,this._ondrain=null,this._writeBuffer=null,this._writeCb=null,this._ondrain=null,this._kick()}function MediaData(t){this._parent=t,this.destroyed=!1,stream.PassThrough.call(this)}var stream=require("readable-stream"),inherits=require("inherits"),nextEvent=require("next-event"),Box=require("mp4-box-encoding"),EMPTY=new Buffer(0);module.exports=Decoder,inherits(Decoder,stream.Writable),Decoder.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,t&&this.emit("error",t),this.emit("close"))},Decoder.prototype._write=function(t,e,i){if(!this.destroyed){for(var r=!this._str||!this._str._writableState.needDrain;t.length&&!this.destroyed;){if(!this._missing)return this._writeBuffer=t,void(this._writeCb=i);var s=t.length<this._missing?t.length:this._missing;if(this._buf?t.copy(this._buf,this._buf.length-this._missing):this._str&&(r=this._str.write(s===t.length?t:t.slice(0,s))),this._missing-=s,!this._missing){var n=this._buf,o=this._cb,h=this._str;this._buf=this._cb=this._str=this._ondrain=null,r=!0,h&&h.end(),o&&o(n)}t=s===t.length?EMPTY:t.slice(s)}if(this._pending&&!this._missing)return this._writeBuffer=t,void(this._writeCb=i);r?i():this._ondrain(i)}},Decoder.prototype._buffer=function(t,e){this._missing=t,this._buf=new Buffer(t),this._cb=e},Decoder.prototype._stream=function(t,e){var i=this;return this._missing=t,this._str=new MediaData(this),this._ondrain=nextEvent(this._str,"drain"),this._pending++,this._str.on("end",function(){i._pending--,i._kick()}),this._cb=e,this._str},Decoder.prototype._readBox=function(){function t(i,r){e._buffer(i,function(i){r=r?Buffer.concat([r,i]):i;var s=Box.readHeaders(r);"number"==typeof s?t(s-r.length,r):(e._pending++,e._headers=s,e.emit("box",s))})}var e=this;t(8)},Decoder.prototype.stream=function(){var t=this;if(!t._headers)throw new Error("this function can only be called once after 'box' is emitted");var e=t._headers;return t._headers=null,t._stream(e.contentLen,null)},Decoder.prototype.decode=function(t){var e=this;if(!e._headers)throw new Error("this function can only be called once after 'box' is emitted");var i=e._headers;e._headers=null,e._buffer(i.contentLen,function(r){var s=Box.decodeWithoutHeaders(i,r);t(s),e._pending--,e._kick()})},Decoder.prototype.ignore=function(){var t=this;if(!t._headers)throw new Error("this function can only be called once after 'box' is emitted");var e=t._headers;t._headers=null,this._missing=e.contentLen,this._cb=function(){t._pending--,t._kick()}},Decoder.prototype._kick=function(){if(!this._pending&&(this._buf||this._str||this._readBox(),this._writeBuffer)){var t=this._writeCb,e=this._writeBuffer;this._writeBuffer=null,this._writeCb=null,this._write(e,null,t)}},inherits(MediaData,stream.PassThrough),MediaData.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._parent.destroy(t),t&&this.emit("error",t),this.emit("close"))};
}).call(this,require("buffer").Buffer)
},{"buffer":66,"inherits":144,"mp4-box-encoding":175,"next-event":184,"readable-stream":235}],177:[function(require,module,exports){
(function (process,Buffer){
function noop(){}function Encoder(){function t(){r._want&&(r._want=!1,r._read())}function e(){r._stream=null}if(!(this instanceof Encoder))return new Encoder;stream.Readable.call(this),this.destroyed=!1,this._reading=!1,this._stream=null,this._drain=null,this._want=!1,this._onreadable=t,this._onend=e;var r=this}function MediaData(t){this._parent=t,this.destroyed=!1,stream.PassThrough.call(this)}var stream=require("readable-stream"),inherits=require("inherits"),Box=require("mp4-box-encoding");module.exports=Encoder,inherits(Encoder,stream.Readable),Encoder.prototype.mediaData=Encoder.prototype.mdat=function(t,e){var r=new MediaData(this);return this.box({type:"mdat",contentLength:t,encodeBufferLen:8,stream:r},e),r},Encoder.prototype.box=function(t,e){if(e||(e=noop),this.destroyed)return e(new Error("Encoder is destroyed"));var r;if(t.encodeBufferLen&&(r=new Buffer(t.encodeBufferLen)),t.stream)t.buffer=null,r=Box.encode(t,r),this.push(r),this._stream=t.stream,this._stream.on("readable",this._onreadable),this._stream.on("end",this._onend),this._stream.on("end",e),this._forward();else{r=Box.encode(t,r);if(this.push(r))return process.nextTick(e);this._drain=e}},Encoder.prototype.destroy=function(t){if(!this.destroyed){if(this.destroyed=!0,this._stream&&this._stream.destroy&&this._stream.destroy(),this._stream=null,this._drain){var e=this._drain;this._drain=null,e(t)}t&&this.emit("error",t),this.emit("close")}},Encoder.prototype.finalize=function(){this.push(null)},Encoder.prototype._forward=function(){if(this._stream)for(;!this.destroyed;){var t=this._stream.read();if(!t)return void(this._want=!!this._stream);if(!this.push(t))return}},Encoder.prototype._read=function(){if(!this._reading&&!this.destroyed){if(this._reading=!0,this._stream&&this._forward(),this._drain){var t=this._drain;this._drain=null,t()}this._reading=!1}},inherits(MediaData,stream.PassThrough),MediaData.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._parent.destroy(t),t&&this.emit("error",t),this.emit("close"))};

}).call(this,require('_process'),require("buffer").Buffer)
},{"_process":205,"buffer":66,"inherits":144,"mp4-box-encoding":175,"readable-stream":235}],178:[function(require,module,exports){
exports.decode=require("./decode"),exports.encode=require("./encode");
},{"./decode":176,"./encode":177}],179:[function(require,module,exports){
function parse(e){if(e=String(e),!(e.length>100)){var r=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*y;case"days":case"day":case"d":return a*d;case"hours":case"hour":case"hrs":case"hr":case"h":return a*h;case"minutes":case"minute":case"mins":case"min":case"m":return a*m;case"seconds":case"second":case"secs":case"sec":case"s":return a*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function fmtShort(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,r){if(!(s<e))return s<1.5*e?Math.floor(s/e)+" "+r:Math.ceil(s/e)+" "+r+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(s,e){e=e||{};var r=typeof s;if("string"===r&&s.length>0)return parse(s);if("number"===r&&!1===isNaN(s))return e.long?fmtLong(s):fmtShort(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};

},{}],180:[function(require,module,exports){
(function (Buffer){
var stream=require("readable-stream"),varint=require("varint"),EventEmitter=require("events").EventEmitter,xtend=require("xtend"),inherits=require("inherits"),duplexify=require("duplexify"),SIGNAL_FLUSH=new Buffer([0]),empty=new Buffer(0),pool=new Buffer(10240),used=0,Channel=function(t,i,e){e||(e={}),stream.Duplex.call(this),this.name=t,this.channel=0,this.initiator=!1,this.chunked=!!e.chunked,this.halfOpen=!!e.halfOpen,this.destroyed=!1,this.finalized=!1,this._multiplex=i,this._dataHeader=0,this._opened=!1,this._awaitDrain=0,this._lazy=!!e.lazy;var n=!1,s=!1;this.once("end",function(){this._read(),this.destroyed||(s=!0,n?this._finalize():this.halfOpen||this.end())}),this.once("finish",function t(){this.destroyed||(this._opened?(this._lazy&&this.initiator&&this._open(),this._multiplex._send(this.channel<<3|(this.initiator?4:3),null),n=!0,s&&this._finalize()):this.once("open",t))})};inherits(Channel,stream.Duplex),Channel.prototype.destroy=function(t){this._destroy(t,!0)},Channel.prototype._destroy=function(t,i){if(!this.destroyed){if(this.destroyed=!0,!t||i&&!EventEmitter.listenerCount(this,"error")||this.emit("error",t),this.emit("close"),i&&this._opened){this._lazy&&this.initiator&&this._open();try{this._multiplex._send(this.channel<<3|(this.initiator?6:5),t?new Buffer(t.message):null)}catch(t){}}this._finalize()}},Channel.prototype._finalize=function(){this.finalized||(this.finalized=!0,this.emit("finalize"))},Channel.prototype._write=function(t,i,e){return this._opened?this.destroyed?e():(this._lazy&&this.initiator&&this._open(),void(this._multiplex._send(this._dataHeader,t)?e():this._multiplex._ondrain.push(e))):void this.once("open",this._write.bind(this,t,i,e))},Channel.prototype._read=function(){if(this._awaitDrain){var t=this._awaitDrain;this._awaitDrain=0,this._multiplex._onchanneldrain(t)}},Channel.prototype._open=function(){var t=null;Buffer.isBuffer(this.name)?t=this.name:this.name!==this.channel.toString()&&(t=new Buffer(this.name)),this._lazy=!1,this._multiplex._send(this.channel<<3|0,t)},Channel.prototype.open=function(t,i){this.channel=t,this.initiator=i,this._dataHeader=t<<3|(i?2:1),this._opened=!0,!this._lazy&&this.initiator&&this._open(),this.emit("open")};var Multiplex=function(t,i){if(!(this instanceof Multiplex))return new Multiplex(t,i);stream.Duplex.call(this),"function"==typeof t&&(i=t,t=null),t||(t={}),i&&this.on("stream",i),this.destroyed=!1,this.limit=t.limit||0,this._corked=0,this._options=t,this._binaryName=!!t.binaryName,this._local=[],this._remote=[],this._list=this._local,this._receiving=null,this._chunked=!1,this._state=0,this._type=0,this._channel=0,this._missing=0,this._message=null,this._buf=new Buffer(this.limit?varint.encodingLength(this.limit):100),this._ptr=0,this._awaitChannelDrains=0,this._onwritedrain=null,this._ondrain=[],this._finished=!1,this.on("finish",this._clear)};inherits(Multiplex,stream.Duplex),Multiplex.prototype.createStream=function(t,i){if(this.destroyed)throw new Error("Multiplexer is destroyed");var e=this._local.indexOf(null);-1===e&&(e=this._local.push(null)-1);var n=new Channel(this._name(t||e.toString()),this,xtend(this._options,i));return this._addChannel(n,e,this._local)},Multiplex.prototype.receiveStream=function(t,i){if(this.destroyed)throw new Error("Multiplexer is destroyed");if(void 0===t||null===t)throw new Error("Name is needed when receiving a stream");var e=new Channel(this._name(t),this,xtend(this._options,i));if(this._receiving||(this._receiving={}),this._receiving[e.name])throw new Error("You are already receiving this stream");return this._receiving[e.name]=e,e},Multiplex.prototype.createSharedStream=function(t,i){return duplexify(this.createStream(t,xtend(i,{lazy:!0})),this.receiveStream(t,i))},Multiplex.prototype._name=function(t){return this._binaryName?Buffer.isBuffer(t)?t:new Buffer(t):t.toString()},Multiplex.prototype._send=function(t,i){var e=i?i.length:0,n=used,s=!0;return varint.encode(t,pool,used),used+=varint.encode.bytes,varint.encode(e,pool,used),used+=varint.encode.bytes,s=this.push(pool.slice(n,used)),pool.length-used<100&&(pool=new Buffer(10240),used=0),i&&(s=this.push(i)),s},Multiplex.prototype._addChannel=function(t,i,e){for(;e.length<=i;)e.push(null);return e[i]=t,t.on("finalize",function(){e[i]=null}),t.open(i,e===this._local),t},Multiplex.prototype._writeVarint=function(t,i){for(i;i<t.length;i++){if(this._ptr===this._buf.length)return this._lengthError(t);if(this._buf[this._ptr++]=t[i],!(128&t[i])){if(0===this._state){var e=varint.decode(this._buf);this._type=7&e,this._channel=e>>3,this._list=1&this._type?this._local:this._remote;var n=this._list.length>this._channel&&this._list[this._channel]&&this._list[this._channel].chunked;this._chunked=!(1!==this._type&&2!==this._type)&&n}else if(this._missing=varint.decode(this._buf),this.limit&&this._missing>this.limit)return this._lengthError(t);return this._state++,this._ptr=0,i+1}}return t.length},Multiplex.prototype._lengthError=function(t){return this.destroy(new Error("Incoming message is too big")),t.length},Multiplex.prototype._writeMessage=function(t,i){var e=t.length-i,n=this._missing;if(!this._message){if(n<=e)return this._missing=0,this._push(t.slice(i,i+n)),i+n;if(this._chunked)return this._missing-=e,this._push(t.slice(i,t.length)),t.length;this._message=new Buffer(n)}return t.copy(this._message,this._ptr,i,i+n),n<=e?(this._missing=0,this._push(this._message),i+n):(this._missing-=e,this._ptr+=e,t.length)},Multiplex.prototype._push=function(t){if(this._missing||(this._ptr=0,this._state=0,this._message=null),0===this._type){if(this.destroyed||this._finished)return;var i,e=this._binaryName?t:t.toString()||this._channel.toString();return void(this._receiving&&this._receiving[e]?(i=this._receiving[e],delete this._receiving[e],this._addChannel(i,this._channel,this._list)):(i=new Channel(e,this,this._options),this.emit("stream",this._addChannel(i,this._channel,this._list),i.name)))}var n=this._list[this._channel];if(n)switch(this._type){case 5:case 6:return void n._destroy(new Error(t.toString()||"Channel destroyed"),!1);case 3:case 4:return void n.push(null);case 1:case 2:return void(n.push(t)||(this._awaitChannelDrains++,n._awaitDrain++))}},Multiplex.prototype._onchanneldrain=function(t){if(this._awaitChannelDrains-=t,!this._awaitChannelDrains){var i=this._onwritedrain;this._onwritedrain=null,i&&i()}},Multiplex.prototype._write=function(t,i,e){if(this._finished)return e();if(this._corked)return this._onuncork(this._write.bind(this,t,i,e));if(t===SIGNAL_FLUSH)return this._finish(e);for(var n=0;n<t.length;)n=2===this._state?this._writeMessage(t,n):this._writeVarint(t,n);2!==this._state||this._missing||this._push(empty),this._awaitChannelDrains?this._onwritedrain=e:e()},Multiplex.prototype._finish=function(t){var i=this;this._onuncork(function(){!1===i._writableState.prefinished&&(i._writableState.prefinished=!0),i.emit("prefinish"),i._onuncork(t)})},Multiplex.prototype.cork=function(){1==++this._corked&&this.emit("cork")},Multiplex.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},Multiplex.prototype.end=function(t,i,e){return"function"==typeof t?this.end(null,null,t):"function"==typeof i?this.end(t,null,i):(t&&this.write(t),this._writableState.ending||this.write(SIGNAL_FLUSH),stream.Writable.prototype.end.call(this,e))},Multiplex.prototype._onuncork=function(t){this._corked?this.once("uncork",t):t()},Multiplex.prototype._read=function(){for(;this._ondrain.length;)this._ondrain.shift()()},Multiplex.prototype._clear=function(){if(!this._finished){this._finished=!0;var t=this._local.concat(this._remote);this._local=[],this._remote=[],t.forEach(function(t){t&&t._destroy(null,!1)}),this.push(null)}},Multiplex.prototype.finalize=function(){this._clear()},Multiplex.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._clear(),t&&this.emit("error",t),this.emit("close"))},module.exports=Multiplex;

}).call(this,require("buffer").Buffer)
},{"buffer":66,"duplexify":103,"events":121,"inherits":144,"readable-stream":235,"varint":307,"xtend":324}],181:[function(require,module,exports){
function MultiStream(t,e){var r=this;if(!(r instanceof MultiStream))return new MultiStream(t,e);stream.Readable.call(r,e),r.destroyed=!1,r._drained=!1,r._forwarding=!1,r._current=null,"function"==typeof t?r._queue=t:(r._queue=t.map(toStreams2),r._queue.forEach(function(t){"function"!=typeof t&&r._attachErrorListener(t)})),r._next()}function toStreams2(t){if(!t||"function"==typeof t||t._readableState)return t;var e=(new stream.Readable).wrap(t);return t.destroy&&(e.destroy=t.destroy.bind(t)),e}module.exports=MultiStream;var inherits=require("inherits"),stream=require("readable-stream");inherits(MultiStream,stream.Readable),MultiStream.obj=function(t){return new MultiStream(t,{objectMode:!0,highWaterMark:16})},MultiStream.prototype._read=function(){this._drained=!0,this._forward()},MultiStream.prototype._forward=function(){if(!this._forwarding&&this._drained&&this._current){this._forwarding=!0;for(var t;null!==(t=this._current.read());)this._drained=this.push(t);this._forwarding=!1}},MultiStream.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(function(t){t.destroy&&t.destroy()}),t&&this.emit("error",t),this.emit("close"))},MultiStream.prototype._next=function(){var t=this;if(t._current=null,"function"==typeof t._queue)t._queue(function(e,r){if(e)return t.destroy(e);r=toStreams2(r),t._attachErrorListener(r),t._gotNextStream(r)});else{var e=t._queue.shift();"function"==typeof e&&(e=toStreams2(e()),t._attachErrorListener(e)),t._gotNextStream(e)}},MultiStream.prototype._gotNextStream=function(t){function e(){o._forward()}function r(){t._readableState.ended||o.destroy()}function n(){o._current=null,t.removeListener("readable",e),t.removeListener("end",n),t.removeListener("close",r),o._next()}var o=this;if(!t)return o.push(null),void o.destroy();o._current=t,o._forward(),t.on("readable",e),t.once("end",n),t.once("close",r)},MultiStream.prototype._attachErrorListener=function(t){function e(n){t.removeListener("error",e),r.destroy(n)}var r=this;t&&t.once("error",e)};

},{"inherits":144,"readable-stream":235}],182:[function(require,module,exports){
!function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return g(e)?"array":typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}function o(e,t){return v.call(e,t)}function s(e){return!o(w,e)}function a(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return y[e]})}function u(t,n){function i(e){if("string"==typeof e&&(e=e.split(k,2)),!g(e)||2!==e.length)throw new Error("Invalid tags: "+e);o=new RegExp(r(e[0])+"\\s*"),a=new RegExp("\\s*"+r(e[1])),u=new RegExp("\\s*"+r("}"+e[1]))}if(!t)return[];var o,a,u,h=[],f=[],d=[],v=!1,w=!1;i(n||e.tags);for(var y,U,T,j,S,V,C=new l(t);!C.eos();){if(y=C.pos,T=C.scanUntil(o))for(var A=0,I=T.length;A<I;++A)j=T.charAt(A),s(j)?d.push(f.length):w=!0,f.push(["text",j,y,y+1]),y+=1,"\n"===j&&function(){if(v&&!w)for(;d.length;)delete f[d.pop()];else d=[];v=!1,w=!1}();if(!C.scan(o))break;if(v=!0,U=C.scan(E)||"name",C.scan(x),"="===U?(T=C.scanUntil(b),C.scan(b),C.scanUntil(a)):"{"===U?(T=C.scanUntil(u),C.scan(m),C.scanUntil(a),U="&"):T=C.scanUntil(a),!C.scan(a))throw new Error("Unclosed tag at "+C.pos);if(S=[U,T,y,C.pos],f.push(S),"#"===U||"^"===U)h.push(S);else if("/"===U){if(!(V=h.pop()))throw new Error('Unopened section "'+T+'" at '+y);if(V[1]!==T)throw new Error('Unclosed section "'+V[1]+'" at '+y)}else"name"===U||"{"===U||"&"===U?w=!0:"="===U&&i(T)}if(V=h.pop())throw new Error('Unclosed section "'+V[1]+'" at '+C.pos);return p(c(f))}function c(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function p(e){for(var t,n,r=[],i=r,o=[],s=0,a=e.length;s<a;++s)switch(t=e[s],t[0]){case"#":case"^":i.push(t),o.push(t),i=t[4]=[];break;case"/":n=o.pop(),n[5]=t[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(t)}return r}function l(e){this.string=e,this.tail=e,this.pos=0}function h(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}var d=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===d.call(e)},v=RegExp.prototype.test,w=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},x=/\s*/,k=/\s+/,b=/\s*=/,m=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},l.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},h.prototype.push=function(e){return new h(e,this)},h.prototype.lookup=function(e){var n,r=this.cache;if(r.hasOwnProperty(e))n=r[e];else{for(var o,s,a=this,u=!1;a;){if(e.indexOf(".")>0)for(n=a.view,o=e.split("."),s=0;null!=n&&s<o.length;)s===o.length-1&&(u=i(n,o[s])),n=n[o[s++]];else n=a.view[e],u=i(a.view,e);if(u)break;a=a.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=u(e,t)),r},f.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof h?t:new h(t);return this.renderTokens(r,i,n,e)},f.prototype.renderTokens=function(e,t,n,r){for(var i,o,s,a="",u=0,c=e.length;u<c;++u)s=void 0,i=e[u],o=i[0],"#"===o?s=this.renderSection(i,t,n,r):"^"===o?s=this.renderInverted(i,t,n,r):">"===o?s=this.renderPartial(i,t,n,r):"&"===o?s=this.unescapedValue(i,t):"name"===o?s=this.escapedValue(i,t):"text"===o&&(s=this.rawValue(i)),void 0!==s&&(a+=s);return a},f.prototype.renderSection=function(e,n,r,i){function o(e){return s.render(e,n,r)}var s=this,a="",u=n.lookup(e[1]);if(u){if(g(u))for(var c=0,p=u.length;c<p;++c)a+=this.renderTokens(e[4],n.push(u[c]),r,i);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)a+=this.renderTokens(e[4],n.push(u),r,i);else if(t(u)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,i.slice(e[3],e[5]),o),null!=u&&(a+=u)}else a+=this.renderTokens(e[4],n,r,i);return a}},f.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1]);if(!i||g(i)&&0===i.length)return this.renderTokens(e[4],t,n,r)},f.prototype.renderPartial=function(e,n,r){if(r){var i=t(r)?r(e[1]):r[e[1]];return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},f.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},f.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);if(null!=r)return e.escape(r)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.0",e.tags=["{{","}}"];var U=new f;return e.clearCache=function(){return U.clearCache()},e.parse=function(e,t){return U.parse(e,t)},e.render=function(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return U.render(e,t,r)},e.to_html=function(n,r,i,o){var s=e.render(n,r,i);if(!t(o))return s;o(s)},e.escape=a,e.Scanner=l,e.Context=h,e.Writer=f,e});

},{}],183:[function(require,module,exports){
function equal(s,t,r){assert(s==t,r)}function notEqual(s,t,r){assert(s!=t,r)}function notOk(s,t){assert(!s,t)}function assert(s,t){if(!s)throw new Error(t||"AssertionError")}assert.notEqual=notEqual,assert.notOk=notOk,assert.equal=equal,assert.ok=assert,module.exports=assert;

},{}],184:[function(require,module,exports){
function nextEvent(n,t){var e=null;return n.on(t,function(n){if(e){var t=e;e=null,t(n)}}),function(n){e=n}}module.exports=nextEvent;
},{}],185:[function(require,module,exports){
"use strict";function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(e){return r[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=shouldUseNative()?Object.assign:function(e,r){for(var t,n,o=toObject(e),a=1;a<arguments.length;a++){t=Object(arguments[a]);for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);if(getOwnPropertySymbols){n=getOwnPropertySymbols(t);for(var c=0;c<n.length;c++)propIsEnumerable.call(t,n[c])&&(o[n[c]]=t[n[c]])}}return o};

},{}],186:[function(require,module,exports){
function once(e){var r=function(){return r.called?r.value:(r.called=!0,r.value=e.apply(this,arguments))};return r.called=!1,r}function onceStrict(e){var r=function(){if(r.called)throw new Error(r.onceError);return r.called=!0,r.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return r.onceError=n+" shouldn't be called more than once",r.called=!1,r}var wrappy=require("wrappy");module.exports=wrappy(once),module.exports.strict=wrappy(onceStrict),once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})});

},{"wrappy":320}],187:[function(require,module,exports){
module.exports={"2.16.840.1.101.3.4.1.1": "aes-128-ecb",
"2.16.840.1.101.3.4.1.2": "aes-128-cbc",
"2.16.840.1.101.3.4.1.3": "aes-128-ofb",
"2.16.840.1.101.3.4.1.4": "aes-128-cfb",
"2.16.840.1.101.3.4.1.21": "aes-192-ecb",
"2.16.840.1.101.3.4.1.22": "aes-192-cbc",
"2.16.840.1.101.3.4.1.23": "aes-192-ofb",
"2.16.840.1.101.3.4.1.24": "aes-192-cfb",
"2.16.840.1.101.3.4.1.41": "aes-256-ecb",
"2.16.840.1.101.3.4.1.42": "aes-256-cbc",
"2.16.840.1.101.3.4.1.43": "aes-256-ofb",
"2.16.840.1.101.3.4.1.44": "aes-256-cfb"
}
},{}],188:[function(require,module,exports){
"use strict";var asn1=require("asn1.js");exports.certificate=require("./certificate");var RSAPrivateKey=asn1.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});exports.RSAPrivateKey=RSAPrivateKey;var RSAPublicKey=asn1.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});exports.RSAPublicKey=RSAPublicKey;var PublicKey=asn1.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())});exports.PublicKey=PublicKey;var AlgorithmIdentifier=asn1.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),PrivateKeyInfo=asn1.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())});exports.PrivateKey=PrivateKeyInfo;var EncryptedPrivateKeyInfo=asn1.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});exports.EncryptedPrivateKey=EncryptedPrivateKeyInfo;var DSAPrivateKey=asn1.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});exports.DSAPrivateKey=DSAPrivateKey,exports.DSAparam=asn1.define("DSAparam",function(){this.int()});var ECPrivateKey=asn1.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())});exports.ECPrivateKey=ECPrivateKey;var ECParameters=asn1.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});exports.signature=asn1.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())});

},{"./certificate":189,"asn1.js":2}],189:[function(require,module,exports){
"use strict";var asn=require("asn1.js"),Time=asn.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),AttributeTypeValue=asn.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),AlgorithmIdentifier=asn.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional())}),SubjectPublicKeyInfo=asn.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}),RelativeDistinguishedName=asn.define("RelativeDistinguishedName",function(){this.setof(AttributeTypeValue)}),RDNSequence=asn.define("RDNSequence",function(){this.seqof(RelativeDistinguishedName)}),Name=asn.define("Name",function(){this.choice({rdnSequence:this.use(RDNSequence)})}),Validity=asn.define("Validity",function(){this.seq().obj(this.key("notBefore").use(Time),this.key("notAfter").use(Time))}),Extension=asn.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),TBSCertificate=asn.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int(),this.key("serialNumber").int(),this.key("signature").use(AlgorithmIdentifier),this.key("issuer").use(Name),this.key("validity").use(Validity),this.key("subject").use(Name),this.key("subjectPublicKeyInfo").use(SubjectPublicKeyInfo),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(Extension).optional())}),X509Certificate=asn.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(TBSCertificate),this.key("signatureAlgorithm").use(AlgorithmIdentifier),this.key("signatureValue").bitstr())});module.exports=X509Certificate;

},{"asn1.js":2}],190:[function(require,module,exports){
(function (Buffer){
var findProc=/Proc-Type: 4,ENCRYPTED\n\r?DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\n\r?\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?/m,startRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n/m,fullRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?-----END \1-----$/m,evp=require("evp_bytestokey"),ciphers=require("browserify-aes");module.exports=function(e,r){var n,a=e.toString(),t=a.match(findProc);if(t){var f="aes"+t[1],c=new Buffer(t[2],"hex"),s=new Buffer(t[3].replace(/\r?\n/g,""),"base64"),i=evp(r,c.slice(0,8),parseInt(t[1],10)).key,p=[],u=ciphers.createDecipheriv(f,i,c);p.push(u.update(s)),p.push(u.final()),n=Buffer.concat(p)}else{var E=a.match(fullRegex);n=new Buffer(E[2].replace(/\r?\n/g,""),"base64")}return{tag:a.match(startRegex)[1],data:n}};

}).call(this,require("buffer").Buffer)
},{"browserify-aes":40,"buffer":66,"evp_bytestokey":122}],191:[function(require,module,exports){
(function (Buffer){
function parseKeys(e){var r;"object"!=typeof e||Buffer.isBuffer(e)||(r=e.passphrase,e=e.key),"string"==typeof e&&(e=new Buffer(e));var a,t,s=fixProc(e,r),i=s.tag,c=s.data;switch(i){case"CERTIFICATE":t=asn1.certificate.decode(c,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(t||(t=asn1.PublicKey.decode(c,"der")),a=t.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(t.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return t.subjectPrivateKey=t.subjectPublicKey,{type:"ec",data:t};case"1.2.840.10040.4.1":return t.algorithm.params.pub_key=asn1.DSAparam.decode(t.subjectPublicKey.data,"der"),{type:"dsa",data:t.algorithm.params};default:throw new Error("unknown key id "+a)}throw new Error("unknown key type "+i);case"ENCRYPTED PRIVATE KEY":c=asn1.EncryptedPrivateKey.decode(c,"der"),c=decrypt(c,r);case"PRIVATE KEY":switch(t=asn1.PrivateKey.decode(c,"der"),a=t.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(t.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:t.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(t.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return t.algorithm.params.priv_key=asn1.DSAparam.decode(t.subjectPrivateKey,"der"),{type:"dsa",params:t.algorithm.params};default:throw new Error("unknown key id "+a)}throw new Error("unknown key type "+i);case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(c,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(c,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(c,"der")};case"EC PRIVATE KEY":return c=asn1.ECPrivateKey.decode(c,"der"),{curve:c.parameters.value,privateKey:c.privateKey};default:throw new Error("unknown key type "+i)}}function decrypt(e,r){var a=e.algorithm.decrypt.kde.kdeparams.salt,t=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),s=aesid[e.algorithm.decrypt.cipher.algo.join(".")],i=e.algorithm.decrypt.cipher.iv,c=e.subjectPrivateKey,d=parseInt(s.split("-")[1],10)/8,n=compat.pbkdf2Sync(r,a,t,d),o=ciphers.createDecipheriv(s,n,i),u=[];return u.push(o.update(c)),u.push(o.final()),Buffer.concat(u)}var asn1=require("./asn1"),aesid=require("./aesid.json"),fixProc=require("./fixProc"),ciphers=require("browserify-aes"),compat=require("pbkdf2");module.exports=parseKeys,parseKeys.signature=asn1.signature;

}).call(this,require("buffer").Buffer)
},{"./aesid.json":187,"./asn1":188,"./fixProc":190,"browserify-aes":40,"buffer":66,"pbkdf2":198}],192:[function(require,module,exports){
(function (Buffer){
function decodeTorrentFile(e){Buffer.isBuffer(e)&&(e=bencode.decode(e)),ensure(e.info,"info"),ensure(e.info["name.utf-8"]||e.info.name,"info.name"),ensure(e.info["piece length"],"info['piece length']"),ensure(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(function(e){ensure("number"==typeof e.length,"info.files[0].length"),ensure(e["path.utf-8"]||e.path,"info.files[0].path")}):ensure("number"==typeof e.info.length,"info.length");var n={};n.info=e.info,n.infoBuffer=bencode.encode(e.info),n.infoHash=sha1.sync(n.infoBuffer),n.infoHashBuffer=Buffer.from(n.infoHash,"hex"),n.name=(e.info["name.utf-8"]||e.info.name).toString(),void 0!==e.info.private&&(n.private=!!e.info.private),e["creation date"]&&(n.created=new Date(1e3*e["creation date"])),e["created by"]&&(n.createdBy=e["created by"].toString()),Buffer.isBuffer(e.comment)&&(n.comment=e.comment.toString()),n.announce=[],e["announce-list"]&&e["announce-list"].length?e["announce-list"].forEach(function(e){e.forEach(function(e){n.announce.push(e.toString())})}):e.announce&&n.announce.push(e.announce.toString()),Buffer.isBuffer(e["url-list"])&&(e["url-list"]=e["url-list"].length>0?[e["url-list"]]:[]),n.urlList=(e["url-list"]||[]).map(function(e){return e.toString()}),uniq(n.announce),uniq(n.urlList);var t=e.info.files||[e.info];n.files=t.map(function(e,i){var o=[].concat(n.name,e["path.utf-8"]||e.path||[]).map(function(e){return e.toString()});return{path:path.join.apply(null,[path.sep].concat(o)).slice(1),name:o[o.length-1],length:e.length,offset:t.slice(0,i).reduce(sumLength,0)}}),n.length=t.reduce(sumLength,0);var i=n.files[n.files.length-1];return n.pieceLength=e.info["piece length"],n.lastPieceLength=(i.offset+i.length)%n.pieceLength||n.pieceLength,n.pieces=splitPieces(e.info.pieces),n}function encodeTorrentFile(e){var n={info:e.info};return n["announce-list"]=(e.announce||[]).map(function(e){return n.announce||(n.announce=e),e=Buffer.from(e,"utf8"),[e]}),n["url-list"]=e.urlList||[],e.created&&(n["creation date"]=e.created.getTime()/1e3|0),e.createdBy&&(n["created by"]=e.createdBy),e.comment&&(n.comment=e.comment),bencode.encode(n)}function sumLength(e,n){return e+n.length}function splitPieces(e){for(var n=[],t=0;t<e.length;t+=20)n.push(e.slice(t,t+20).toString("hex"));return n}function ensure(e,n){if(!e)throw new Error("Torrent is missing required field: "+n)}module.exports=decodeTorrentFile,module.exports.decode=decodeTorrentFile,module.exports.encode=encodeTorrentFile;var bencode=require("bencode"),path=require("path"),sha1=require("simple-sha1"),uniq=require("uniq");

}).call(this,require("buffer").Buffer)
},{"bencode":195,"buffer":66,"path":197,"simple-sha1":258,"uniq":293}],193:[function(require,module,exports){
arguments[4][22][0].apply(exports,arguments)
},{"buffer":66,"dup":22}],194:[function(require,module,exports){
arguments[4][23][0].apply(exports,arguments)
},{"dup":23,"safe-buffer":244}],195:[function(require,module,exports){
var bencode=module.exports;bencode.encode=require("./encode"),bencode.decode=require("./decode"),bencode.byteLength=bencode.encodingLength=function(e){return bencode.encode(e).length};
},{"./decode":193,"./encode":194}],196:[function(require,module,exports){
(function (process,Buffer){
function parseTorrent(e){if("string"==typeof e&&/^(stream-)?magnet:/.test(e))return magnet(e);if("string"==typeof e&&(/^[a-f0-9]{40}$/i.test(e)||/^[a-z2-7]{32}$/i.test(e)))return magnet("magnet:?xt=urn:btih:"+e);if(Buffer.isBuffer(e)&&20===e.length)return magnet("magnet:?xt=urn:btih:"+e.toString("hex"));if(Buffer.isBuffer(e))return parseTorrentFile(e);if(e&&e.infoHash)return e.announce||(e.announce=[]),"string"==typeof e.announce&&(e.announce=[e.announce]),e.urlList||(e.urlList=[]),e;throw new Error("Invalid torrent identifier")}function parseTorrentRemote(e,r){function t(e){try{n=parseTorrent(e)}catch(e){return r(e)}n&&n.infoHash?r(null,n):r(new Error("Invalid torrent identifier"))}var n;if("function"!=typeof r)throw new Error("second argument must be a Function");try{n=parseTorrent(e)}catch(e){}n&&n.infoHash?process.nextTick(function(){r(null,n)}):isBlob(e)?blobToBuffer(e,function(e,n){if(e)return r(new Error("Error converting Blob: "+e.message));t(n)}):"function"==typeof get&&/^https?:/.test(e)?get.concat({url:e,timeout:3e4,headers:{"user-agent":"WebTorrent (http://webtorrent.io)"}},function(e,n,o){if(e)return r(new Error("Error downloading torrent: "+e.message));t(o)}):"function"==typeof fs.readFile&&"string"==typeof e?fs.readFile(e,function(e,n){if(e)return r(new Error("Invalid torrent identifier"));t(n)}):process.nextTick(function(){r(new Error("Invalid torrent identifier"))})}function isBlob(e){return"undefined"!=typeof Blob&&e instanceof Blob}module.exports=parseTorrent,module.exports.remote=parseTorrentRemote;var blobToBuffer=require("blob-to-buffer"),fs=require("fs"),get=require("simple-get"),magnet=require("magnet-uri"),parseTorrentFile=require("parse-torrent-file");module.exports.toMagnetURI=magnet.encode,module.exports.toTorrentFile=parseTorrentFile.encode,function(){Buffer.alloc(0)}();

}).call(this,require('_process'),require("buffer").Buffer)
},{"_process":205,"blob-to-buffer":33,"buffer":66,"fs":63,"magnet-uri":166,"parse-torrent-file":192,"simple-get":256}],197:[function(require,module,exports){
(function (process){
function normalizeArray(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function filter(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(r){return splitPathRe.exec(r).slice(1)};exports.resolve=function(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var n=e>=0?arguments[e]:process.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(r=n+"/"+r,t="/"===n.charAt(0))}return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+r||"."},exports.normalize=function(r){var t=exports.isAbsolute(r),e="/"===substr(r,-1);return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),r||t||(r="."),r&&e&&(r+="/"),(t?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),i=Math.min(n.length,s.length),o=i,u=0;u<i;u++)if(n[u]!==s[u]){o=u;break}for(var l=[],u=o;u<n.length;u++)l.push("..");return l=l.concat(s.slice(o)),l.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=splitPath(r),e=t[0],n=t[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},exports.basename=function(r,t){var e=splitPath(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return splitPath(r)[3]};var substr="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};

}).call(this,require('_process'))
},{"_process":205}],198:[function(require,module,exports){
exports.pbkdf2=require("./lib/async"),exports.pbkdf2Sync=require("./lib/sync");

},{"./lib/async":199,"./lib/sync":202}],199:[function(require,module,exports){
(function (process,global){
function checkNative(e){if(global.process&&!global.process.browser)return Promise.resolve(!1);if(!subtle||!subtle.importKey||!subtle.deriveBits)return Promise.resolve(!1);if(void 0!==checks[e])return checks[e];ZERO_BUF=ZERO_BUF||Buffer.alloc(8);var r=browserPbkdf2(ZERO_BUF,ZERO_BUF,10,128,e).then(function(){return!0}).catch(function(){return!1});return checks[e]=r,r}function browserPbkdf2(e,r,n,t,o){return subtle.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(e){return subtle.deriveBits({name:"PBKDF2",salt:r,iterations:n,hash:{name:o}},e,t<<3)}).then(function(e){return Buffer.from(e)})}function resolvePromise(e,r){e.then(function(e){process.nextTick(function(){r(null,e)})},function(e){process.nextTick(function(){r(e)})})}var checkParameters=require("./precondition"),defaultEncoding=require("./default-encoding"),sync=require("./sync"),Buffer=require("safe-buffer").Buffer,ZERO_BUF,subtle=global.crypto&&global.crypto.subtle,toBrowser={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},checks=[];module.exports=function(e,r,n,t,o,s){if(Buffer.isBuffer(e)||(e=Buffer.from(e,defaultEncoding)),Buffer.isBuffer(r)||(r=Buffer.from(r,defaultEncoding)),checkParameters(n,t),"function"==typeof o&&(s=o,o=void 0),"function"!=typeof s)throw new Error("No callback provided to pbkdf2");o=o||"sha1";var c=toBrowser[o.toLowerCase()];if(!c||"function"!=typeof global.Promise)return process.nextTick(function(){var c;try{c=sync(e,r,n,t,o)}catch(e){return s(e)}s(null,c)});resolvePromise(checkNative(c).then(function(s){return s?browserPbkdf2(e,r,n,t,c):sync(e,r,n,t,o)}),s)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./default-encoding":200,"./precondition":201,"./sync":202,"_process":205,"safe-buffer":244}],200:[function(require,module,exports){
(function (process){
var defaultEncoding;if(process.browser)defaultEncoding="utf-8";else{var pVersionMajor=parseInt(process.version.split(".")[0].slice(1),10);defaultEncoding=pVersionMajor>=6?"utf-8":"binary"}module.exports=defaultEncoding;

}).call(this,require('_process'))
},{"_process":205}],201:[function(require,module,exports){
var MAX_ALLOC=Math.pow(2,30)-1;module.exports=function(r,e){if("number"!=typeof r)throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if("number"!=typeof e)throw new TypeError("Key length not a number");if(e<0||e>MAX_ALLOC||e!==e)throw new TypeError("Bad key length")};

},{}],202:[function(require,module,exports){
function Hmac(e,r,a){var s=getDigest(e),f="sha512"===e||"sha384"===e?128:64;r.length>f?r=s(r):r.length<f&&(r=Buffer.concat([r,ZEROS],f));for(var i=Buffer.allocUnsafe(f+sizes[e]),t=Buffer.allocUnsafe(f+sizes[e]),h=0;h<f;h++)i[h]=54^r[h],t[h]=92^r[h];var n=Buffer.allocUnsafe(f+a+4);i.copy(n,0,0,f),this.ipad1=n,this.ipad2=i,this.opad=t,this.alg=e,this.blocksize=f,this.hash=s,this.size=sizes[e]}function getDigest(e){function r(r){return sha(e).update(r).digest()}return"rmd160"===e||"ripemd160"===e?rmd160:"md5"===e?md5:r}function pbkdf2(e,r,a,s,f){Buffer.isBuffer(e)||(e=Buffer.from(e,defaultEncoding)),Buffer.isBuffer(r)||(r=Buffer.from(r,defaultEncoding)),checkParameters(a,s),f=f||"sha1";var i=new Hmac(f,e,r.length),t=Buffer.allocUnsafe(s),h=Buffer.allocUnsafe(r.length+4);r.copy(h,0,0,r.length);for(var n=0,u=sizes[f],o=Math.ceil(s/u),c=1;c<=o;c++){h.writeUInt32BE(c,r.length);for(var d=i.run(h,i.ipad1),l=d,p=1;p<a;p++){l=i.run(l,i.ipad2);for(var m=0;m<u;m++)d[m]^=l[m]}d.copy(t,n),n+=u}return t}var md5=require("create-hash/md5"),rmd160=require("ripemd160"),sha=require("sha.js"),checkParameters=require("./precondition"),defaultEncoding=require("./default-encoding"),Buffer=require("safe-buffer").Buffer,ZEROS=Buffer.alloc(128),sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};Hmac.prototype.run=function(e,r){return e.copy(r,this.blocksize),this.hash(r).copy(this.opad,this.blocksize),this.hash(this.opad)},module.exports=pbkdf2;

},{"./default-encoding":200,"./precondition":201,"create-hash/md5":80,"ripemd160":240,"safe-buffer":244,"sha.js":248}],203:[function(require,module,exports){
for(var closest=require("closest-to"),kB=Math.pow(2,10),p=13,range=[];p++<22;)range.push(Math.pow(2,p));module.exports=function(e){return closest(e/kB,range)};

},{"closest-to":70}],204:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick;

}).call(this,require('_process'))
},{"_process":205}],205:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],206:[function(require,module,exports){
exports.publicEncrypt=require("./publicEncrypt"),exports.privateDecrypt=require("./privateDecrypt"),exports.privateEncrypt=function(r,p){return exports.publicEncrypt(r,p,!0)},exports.publicDecrypt=function(r,p){return exports.privateDecrypt(r,p,!0)};

},{"./privateDecrypt":208,"./publicEncrypt":209}],207:[function(require,module,exports){
(function (Buffer){
function i2ops(e){var r=new Buffer(4);return r.writeUInt32BE(e,0),r}var createHash=require("create-hash");module.exports=function(e,r){for(var t,a=new Buffer(""),n=0;a.length<r;)t=i2ops(n++),a=Buffer.concat([a,createHash("sha1").update(e).update(t).digest()]);return a.slice(0,r)};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"create-hash":78}],208:[function(require,module,exports){
(function (Buffer){
function oaep(r,e){var n=(r.modulus,r.modulus.byteLength()),t=(e.length,createHash("sha1").update(new Buffer("")).digest()),i=t.length;if(0!==e[0])throw new Error("decryption error");var o=e.slice(1,i+1),u=e.slice(i+1),a=xor(o,mgf(u,i)),c=xor(u,mgf(a,n-i-1));if(compare(t,c.slice(0,i)))throw new Error("decryption error");for(var f=i;0===c[f];)f++;if(1!==c[f++])throw new Error("decryption error");return c.slice(f)}function pkcs1(r,e,n){for(var t=e.slice(0,2),i=2,o=0;0!==e[i++];)if(i>=e.length){o++;break}var u=e.slice(2,i-1);e.slice(i-1,i);if(("0002"!==t.toString("hex")&&!n||"0001"!==t.toString("hex")&&n)&&o++,u.length<8&&o++,o)throw new Error("decryption error");return e.slice(i)}function compare(r,e){r=new Buffer(r),e=new Buffer(e);var n=0,t=r.length;r.length!==e.length&&(n++,t=Math.min(r.length,e.length));for(var i=-1;++i<t;)n+=r[i]^e[i];return n}var parseKeys=require("parse-asn1"),mgf=require("./mgf"),xor=require("./xor"),bn=require("bn.js"),crt=require("browserify-rsa"),createHash=require("create-hash"),withPublic=require("./withPublic");module.exports=function(r,e,n){var t;t=r.padding?r.padding:n?1:4;var i=parseKeys(r),o=i.modulus.byteLength();if(e.length>o||new bn(e).cmp(i.modulus)>=0)throw new Error("decryption error");var u;u=n?withPublic(new bn(e),i):crt(e,i);var a=new Buffer(o-u.length);if(a.fill(0),u=Buffer.concat([a,u],o),4===t)return oaep(i,u);if(1===t)return pkcs1(i,u,n);if(3===t)return u;throw new Error("unknown padding")};

}).call(this,require("buffer").Buffer)
},{"./mgf":207,"./withPublic":210,"./xor":211,"bn.js":35,"browserify-rsa":56,"buffer":66,"create-hash":78,"parse-asn1":191}],209:[function(require,module,exports){
(function (Buffer){
function oaep(e,r){var n=e.modulus.byteLength(),o=r.length,t=createHash("sha1").update(new Buffer("")).digest(),f=t.length,u=2*f;if(o>n-u-2)throw new Error("message too long");var a=new Buffer(n-o-u-2);a.fill(0);var s=n-f-1,i=randomBytes(f),w=xor(Buffer.concat([t,a,new Buffer([1]),r],s),mgf(i,s)),c=xor(i,mgf(w,f));return new bn(Buffer.concat([new Buffer([0]),c,w],n))}function pkcs1(e,r,n){var o=r.length,t=e.modulus.byteLength();if(o>t-11)throw new Error("message too long");var f;return n?(f=new Buffer(t-o-3),f.fill(255)):f=nonZero(t-o-3),new bn(Buffer.concat([new Buffer([0,n?1:2]),f,new Buffer([0]),r],t))}function nonZero(e,r){for(var n,o=new Buffer(e),t=0,f=randomBytes(2*e),u=0;t<e;)u===f.length&&(f=randomBytes(2*e),u=0),(n=f[u++])&&(o[t++]=n);return o}var parseKeys=require("parse-asn1"),randomBytes=require("randombytes"),createHash=require("create-hash"),mgf=require("./mgf"),xor=require("./xor"),bn=require("bn.js"),withPublic=require("./withPublic"),crt=require("browserify-rsa"),constants={RSA_PKCS1_OAEP_PADDING:4,RSA_PKCS1_PADDIN:1,RSA_NO_PADDING:3};module.exports=function(e,r,n){var o;o=e.padding?e.padding:n?1:4;var t,f=parseKeys(e);if(4===o)t=oaep(f,r);else if(1===o)t=pkcs1(f,r,n);else{if(3!==o)throw new Error("unknown padding");if(t=new bn(r),t.cmp(f.modulus)>=0)throw new Error("data too long for modulus")}return n?crt(t,f):withPublic(t,f)};

}).call(this,require("buffer").Buffer)
},{"./mgf":207,"./withPublic":210,"./xor":211,"bn.js":35,"browserify-rsa":56,"buffer":66,"create-hash":78,"parse-asn1":191,"randombytes":223}],210:[function(require,module,exports){
(function (Buffer){
function withPublic(e,n){return new Buffer(e.toRed(bn.mont(n.modulus)).redPow(new bn(n.publicExponent)).fromRed().toArray())}var bn=require("bn.js");module.exports=withPublic;

}).call(this,require("buffer").Buffer)
},{"bn.js":35,"buffer":66}],211:[function(require,module,exports){
module.exports=function(r,e){for(var n=r.length,o=-1;++o<n;)r[o]^=e[o];return r};

},{}],212:[function(require,module,exports){
var once=require("once"),eos=require("end-of-stream"),fs=require("fs"),noop=function(){},isFn=function(e){return"function"==typeof e},isFS=function(e){return!!fs&&((e instanceof(fs.ReadStream||noop)||e instanceof(fs.WriteStream||noop))&&isFn(e.close))},isRequest=function(e){return e.setHeader&&isFn(e.abort)},destroyer=function(e,r,n,o){o=once(o);var t=!1;e.on("close",function(){t=!0}),eos(e,{readable:r,writable:n},function(e){if(e)return o(e);t=!0,o()});var i=!1;return function(r){if(!t&&!i)return i=!0,isFS(e)?e.close():isRequest(e)?e.abort():isFn(e.destroy)?e.destroy():void o(r||new Error("stream was destroyed"))}},call=function(e){e()},pipe=function(e,r){return e.pipe(r)},pump=function(){var e=Array.prototype.slice.call(arguments),r=isFn(e[e.length-1]||noop)&&e.pop()||noop;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var n,o=e.map(function(t,i){var s=i<e.length-1;return destroyer(t,s,i>0,function(e){n||(n=e),e&&o.forEach(call),s||(o.forEach(call),r(n))})});return e.reduce(pipe)};module.exports=pump;

},{"end-of-stream":120,"fs":37,"once":186}],213:[function(require,module,exports){
(function (global){
!function(e){function o(e){throw new RangeError(T[e])}function n(e,o){for(var n=e.length,t=[];n--;)t[n]=o(e[n]);return t}function t(e,o){var t=e.split("@"),r="";return t.length>1&&(r=t[0]+"@",e=t[1]),e=e.replace(S,"."),r+n(e.split("."),o).join(".")}function r(e){for(var o,n,t=[],r=0,u=e.length;r<u;)o=e.charCodeAt(r++),o>=55296&&o<=56319&&r<u?(n=e.charCodeAt(r++),56320==(64512&n)?t.push(((1023&o)<<10)+(1023&n)+65536):(t.push(o),r--)):t.push(o);return t}function u(e){return n(e,function(e){var o="";return e>65535&&(e-=65536,o+=P(e>>>10&1023|55296),e=56320|1023&e),o+=P(e)}).join("")}function i(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:b}function f(e,o){return e+22+75*(e<26)-((0!=o)<<5)}function c(e,o,n){var t=0;for(e=n?M(e/j):e>>1,e+=M(e/o);e>L*C>>1;t+=b)e=M(e/L);return M(t+(L+1)*e/(e+m))}function l(e){var n,t,r,f,l,s,d,p,a,h,v=[],g=e.length,w=0,m=I,j=A;for(t=e.lastIndexOf(E),t<0&&(t=0),r=0;r<t;++r)e.charCodeAt(r)>=128&&o("not-basic"),v.push(e.charCodeAt(r));for(f=t>0?t+1:0;f<g;){for(l=w,s=1,d=b;f>=g&&o("invalid-input"),p=i(e.charCodeAt(f++)),(p>=b||p>M((x-w)/s))&&o("overflow"),w+=p*s,a=d<=j?y:d>=j+C?C:d-j,!(p<a);d+=b)h=b-a,s>M(x/h)&&o("overflow"),s*=h;n=v.length+1,j=c(w-l,n,0==l),M(w/n)>x-m&&o("overflow"),m+=M(w/n),w%=n,v.splice(w++,0,m)}return u(v)}function s(e){var n,t,u,i,l,s,d,p,a,h,v,g,w,m,j,F=[];for(e=r(e),g=e.length,n=I,t=0,l=A,s=0;s<g;++s)(v=e[s])<128&&F.push(P(v));for(u=i=F.length,i&&F.push(E);u<g;){for(d=x,s=0;s<g;++s)(v=e[s])>=n&&v<d&&(d=v);for(w=u+1,d-n>M((x-t)/w)&&o("overflow"),t+=(d-n)*w,n=d,s=0;s<g;++s)if(v=e[s],v<n&&++t>x&&o("overflow"),v==n){for(p=t,a=b;h=a<=l?y:a>=l+C?C:a-l,!(p<h);a+=b)j=p-h,m=b-h,F.push(P(f(h+j%m,0))),p=M(j/m);F.push(P(f(p,0))),l=c(t,w,u==i),t=0,++u}++t,++n}return F.join("")}function d(e){return t(e,function(e){return F.test(e)?l(e.slice(4).toLowerCase()):e})}function p(e){return t(e,function(e){return O.test(e)?"xn--"+s(e):e})}var a="object"==typeof exports&&exports&&!exports.nodeType&&exports,h="object"==typeof module&&module&&!module.nodeType&&module,v="object"==typeof global&&global;v.global!==v&&v.window!==v&&v.self!==v||(e=v);var g,w,x=2147483647,b=36,y=1,C=26,m=38,j=700,A=72,I=128,E="-",F=/^xn--/,O=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=b-y,M=Math.floor,P=String.fromCharCode;if(g={version:"1.4.1",ucs2:{decode:r,encode:u},decode:l,encode:s,toASCII:p,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return g});else if(a&&h)if(module.exports==a)h.exports=g;else for(w in g)g.hasOwnProperty(w)&&(a[w]=g[w]);else e.punycode=g}(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],214:[function(require,module,exports){
"use strict";function encoderForArrayFormat(r){switch(r.arrayFormat){case"index":return function(e,n,t){return null===n?[encode(e,r),"[",t,"]"].join(""):[encode(e,r),"[",encode(t,r),"]=",encode(n,r)].join("")};case"bracket":return function(e,n){return null===n?encode(e,r):[encode(e,r),"[]=",encode(n,r)].join("")};default:return function(e,n){return null===n?encode(e,r):[encode(e,r),"=",encode(n,r)].join("")}}}function parserForArrayFormat(r){var e;switch(r.arrayFormat){case"index":return function(r,n,t){if(e=/\[(\d*)\]$/.exec(r),r=r.replace(/\[\d*\]$/,""),!e)return void(t[r]=n);void 0===t[r]&&(t[r]={}),t[r][e[1]]=n};case"bracket":return function(r,n,t){return e=/(\[\])$/.exec(r),r=r.replace(/\[\]$/,""),e?void 0===t[r]?void(t[r]=[n]):void(t[r]=[].concat(t[r],n)):void(t[r]=n)};default:return function(r,e,n){if(void 0===n[r])return void(n[r]=e);n[r]=[].concat(n[r],e)}}}function encode(r,e){return e.encode?e.strict?strictUriEncode(r):encodeURIComponent(r):r}function keysSorter(r){return Array.isArray(r)?r.sort():"object"==typeof r?keysSorter(Object.keys(r)).sort(function(r,e){return Number(r)-Number(e)}).map(function(e){return r[e]}):r}var strictUriEncode=require("strict-uri-encode"),objectAssign=require("object-assign");exports.extract=function(r){return r.split("?")[1]||""},exports.parse=function(r,e){e=objectAssign({arrayFormat:"none"},e);var n=parserForArrayFormat(e),t=Object.create(null);return"string"!=typeof r?t:(r=r.trim().replace(/^(\?|#|&)/,""))?(r.split("&").forEach(function(r){var e=r.replace(/\+/g," ").split("="),o=e.shift(),c=e.length>0?e.join("="):void 0;c=void 0===c?null:decodeURIComponent(c),n(decodeURIComponent(o),c,t)}),Object.keys(t).sort().reduce(function(r,e){var n=t[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?r[e]=keysSorter(n):r[e]=n,r},Object.create(null))):t},exports.stringify=function(r,e){e=objectAssign({encode:!0,strict:!0,arrayFormat:"none"},e);var n=encoderForArrayFormat(e);return r?Object.keys(r).sort().map(function(t){var o=r[t];if(void 0===o)return"";if(null===o)return encode(t,e);if(Array.isArray(o)){var c=[];return o.slice().forEach(function(r){void 0!==r&&c.push(n(t,r,c.length))}),c.join("&")}return encode(t,e)+"="+encode(o,e)}).filter(function(r){return r.length>0}).join("&"):""};

},{"object-assign":185,"strict-uri-encode":279}],215:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;y<p;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],216:[function(require,module,exports){
"use strict";function map(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}var stringifyPrimitive=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};module.exports=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?map(objectKeys(r),function(n){var i=encodeURIComponent(stringifyPrimitive(n))+t;return isArray(r[n])?map(r[n],function(r){return i+encodeURIComponent(stringifyPrimitive(r))}).join(e):i+encodeURIComponent(stringifyPrimitive(r[n]))}).join(e):n?encodeURIComponent(stringifyPrimitive(n))+t+encodeURIComponent(stringifyPrimitive(r)):""};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},objectKeys=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e};

},{}],217:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");

},{"./decode":215,"./encode":216}],218:[function(require,module,exports){
function Value(t,i){if(!(this instanceof Value))return new Value(t,i);Scuttlebutt.call(this,t),this._history=[],this.histLength=i||1}var Scuttlebutt=require("scuttlebutt"),inherits=require("util").inherits,u=require("scuttlebutt/util");inherits(Value,Scuttlebutt);var V=Value.prototype;V.set=function(t){return this.localUpdate(t),this},V.get=function(){this._history=this._history||[];var t=this._history.length;return t?this._history[t-1]&&this._history[t-1][0]:null},V.applyUpdate=function(t){for(this._history=this._history||[],this._history.push(t),u.sort(this._history);this._history.length>this.histLength;)this.emit("_remove",this._history.shift());return this.emit("update",t[0]),!0},V.history=function(t){this._history=this._history||[];var i=[];return this._history.forEach(function(s){u.filter(s,t)&&i.push(s)}),i},V.toJSON=function(){return this.get()},module.exports=Value;

},{"scuttlebutt":219,"scuttlebutt/util":220,"util":304}],219:[function(require,module,exports){
(function (process){
function dutyOfSubclass(){throw new Error("method must be implemented by subclass")}function validate(e){return!(!Array.isArray(e)||"string"!=typeof e[2]||"__proto__"===e[2]||"number"!=typeof e[1])}function Scuttlebutt(e){if(!(this instanceof Scuttlebutt))return new Scuttlebutt(e);var t="string"==typeof e?e:e&&e.id;this.sources={},this.setMaxListeners(Number.MAX_VALUE),this._streams=0,e&&e.sign&&e.verify?(this.setId(e.id||e.createId()),this._sign=e.sign,this._verify=e.verify):this.setId(t||u.createId())}function streamDone(e,t){function r(){e.removeListener("end",i),e.removeListener("error",i),e.removeListener("close",i)}function i(e){r(),t.call(this,e)}i.listener=t,e.on("end",i),e.on("error",i),e.on("close",i)}var EventEmitter=require("events").EventEmitter,i=require("iterate"),duplex=require("duplex"),inherits=require("util").inherits,serializer=require("stream-serializer"),u=require("./util"),timestamp=require("monotonic-timestamp");exports=module.exports=Scuttlebutt,exports.createID=u.createID,exports.updateIsRecent=u.filter,exports.filter=u.filter,exports.timestamp=timestamp;var emit=EventEmitter.prototype.emit;inherits(Scuttlebutt,EventEmitter);var sb=Scuttlebutt.prototype,emit=EventEmitter.prototype.emit;sb.applyUpdate=dutyOfSubclass,sb.history=dutyOfSubclass,sb.localUpdate=function(e){return this._update([e,timestamp(),this.id]),this},sb._update=function(e){function t(t,r){return t?emit.call(s,"error",t):r?void(s.applyUpdate(e)&&emit.call(s,"_update",e)):emit.call(s,"unverified_data",e)}var r=e[1],i=e[2],n=this.sources[i];if(n&&n>=r)return emit.call(this,"old_data",e),!1;this.sources[i]=r;var s=this;return i!==this.id?this._verify?this._verify(e,t):t(null,!0):(this._sign&&(e[3]=this._sign(e)),t(null,!0)),!0},sb.createStream=function(e){function t(e){s=e.clock,i.each(n.history(s),function(e){c._data(e)}),l.emit("header",e),c._data("SYNC"),l.emit("syncSent"),a=!0,o&&(l.emit("sync"),l.emit("synced")),d||c._end()}function r(e){if(validate(e)&&u.filter(e,s)){c._data(e);var t=e[1],r=e[2];s[r]=t}}var n=this,s={},a=!1,o=!1;this._streams++,e=e||{};var c=duplex();c.name=e.name;var l=serializer(e&&e.wrapper)(c);l.inner=c,c.writable=!1!==e.writable,c.readable=!1!==e.readable,o=!c.writable,a=!c.readable;var d=!1!==e.tail;c.on("_data",function(e){if(Array.isArray(e)){if(validate(e))return n._update(e)}else"object"==typeof e&&e?t(e):"string"==typeof e&&"SYNC"==e&&(o=!0,l.emit("syncRecieved"),a&&(l.emit("sync"),l.emit("synced")))}).on("_end",function(){c._end()}).on("close",function(){n.removeListener("_update",r),n._streams--,emit.call(n,"unstream",n._streams)}),e&&!1===e.tail&&l.on("sync",function(){process.nextTick(function(){c._end()})});var m={id:n.id,clock:n.sources};return e&&e.meta&&(m.meta=e.meta),c.readable&&(c._data(m),c.writable||t({clock:{}}),d&&n.on("_update",r)),n.once("dispose",function(){c.end()}),l},sb.createWriteStream=function(e){return e=e||{},e.writable=!0,e.readable=!1,this.createStream(e)},sb.createReadStream=function(e){return e=e||{},e.writable=!1,e.readable=!0,this.createStream(e)},sb.dispose=function(){emit.call(this,"dispose")},sb.setId=function(e){if("__proto__"===e)throw new Error("__proto__ is invalid id");if(null==e)throw new Error("null is not invalid id");return this.id=e,this},sb.clone=function(){var e=this,t=new e.constructor;t.setId(e.id),e._clones=(e._clones||0)+1;var r=e.createStream({wrapper:"raw"}),i=t.createStream({wrapper:"raw"});return r.pause=i.pause=function(){},streamDone(i,function(){e._clones--,emit.call(e,"unclone",e._clones)}),r.pipe(i).pipe(r),r.resume(),i.resume(),t};
}).call(this,require('_process'))
},{"./util":220,"_process":205,"duplex":102,"events":121,"iterate":150,"monotonic-timestamp":172,"stream-serializer":221,"util":304}],220:[function(require,module,exports){
function invalidUpdate(r){r.emit("invalid",new Error("invalid update"))}exports.createId=function(){return[1,1,1].map(function(){return Math.random().toString(16).substring(2).toUpperCase()}).join("")},exports.filter=function(r,t){var n=r[1],e=r[2];return!t||!t[e]||t[e]<n},exports.protoIsIllegal=function(r){return r.emit("invalid",new Error('"__proto__" is illegal property name')),null},exports.validUpdate=function(r,t){return Array.isArray(t)?"string"!=typeof t[1]||"number"!=typeof t[2]?invalidUpdate(r):void 0:invalidUpdate(r)},exports.sort=function(r){return r.sort(function(r,t){return r[1]-t[1]||(r[2]>t[2]?1:-1)})};
},{}],221:[function(require,module,exports){
var EventEmitter=require("events").EventEmitter;exports=module.exports=function(t){return"function"==typeof t?t:exports[t]||exports.json},exports.json=function(t){function r(r){var e;try{e=JSON.parse(r)}catch(r){return t.emit("error",r)}void 0!==e&&n.call(t,e)}function e(t){var e=(o+t).split("\n");for(o=e.pop();e.length;)r(e.shift())}var n=t.write,o="";t.write=e;var i=t.end;return t.end=function(e){return e&&t.write(e),o&&r(o),i.call(t)},t.emit=function(r,e){"data"==r&&(e=JSON.stringify(e)+"\n"),EventEmitter.prototype.emit.call(t,r,e)},t},exports.raw=function(t){return t};
},{"events":121}],222:[function(require,module,exports){
var iterate=function(r){var t=0;return function(){if(t===r.length)return null;var e=r.length-t,n=Math.random()*e|0,a=r[t+n],u=r[t];return r[t]=a,r[t+n]=u,t++,a}};module.exports=iterate;

},{}],223:[function(require,module,exports){
(function (process,global){
"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function randomBytes(r,e){if(r>65536)throw new Error("requested too many random bytes");var o=new global.Uint8Array(r);r>0&&crypto.getRandomValues(o);var t=Buffer.from(o.buffer);return"function"==typeof e?process.nextTick(function(){e(null,t)}):t}var Buffer=require("safe-buffer").Buffer,crypto=global.crypto||global.msCrypto;crypto&&crypto.getRandomValues?module.exports=randomBytes:module.exports=oldBrowser;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":205,"safe-buffer":244}],224:[function(require,module,exports){
function RangeSliceStream(e,t){var r=this;if(!(r instanceof RangeSliceStream))return new RangeSliceStream(e);stream.Writable.call(r,t),r.destroyed=!1,r._queue=[],r._position=e||0,r._cb=null,r._buffer=null,r._out=null}var inherits=require("inherits"),stream=require("readable-stream");module.exports=RangeSliceStream,inherits(RangeSliceStream,stream.Writable),RangeSliceStream.prototype._write=function(e,t,r){for(var n=this,i=!0;;){if(n.destroyed)return;if(0===n._queue.length)return n._buffer=e,void(n._cb=r);n._buffer=null;var a=n._queue[0],l=Math.max(a.start-n._position,0),s=a.end-n._position;if(l>=e.length)return n._position+=e.length,r(null);var u;if(s>e.length){n._position+=e.length,u=0===l?e:e.slice(l),i=a.stream.write(u)&&i;break}n._position+=s,u=0===l&&s===e.length?e:e.slice(l,s),i=a.stream.write(u)&&i,a.last&&a.stream.end(),e=e.slice(s),n._queue.shift()}i?r(null):a.stream.once("drain",r.bind(null,null))},RangeSliceStream.prototype.slice=function(e){var t=this;if(t.destroyed)return null;e instanceof Array||(e=[e]);var r=new stream.PassThrough;return e.forEach(function(n,i){t._queue.push({start:n.start,end:n.end,stream:r,last:i===e.length-1})}),t._buffer&&t._write(t._buffer,null,t._cb),r},RangeSliceStream.prototype.destroy=function(e){var t=this;t.destroyed||(t.destroyed=!0,e&&t.emit("error",e))};

},{"inherits":144,"readable-stream":235}],225:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");
},{"./lib/_stream_duplex.js":226}],226:[function(require,module,exports){
"use strict";function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(e){e.end()}function forEach(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)}var processNextTick=require("process-nextick-args"),objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),Duplex.prototype._destroy=function(e,t){this.push(null),this.end(),processNextTick(t,e)};

},{"./_stream_readable":228,"./_stream_writable":230,"core-util-is":71,"inherits":144,"process-nextick-args":204}],227:[function(require,module,exports){
"use strict";function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":229,"core-util-is":71,"inherits":144}],228:[function(require,module,exports){
(function (process,global){
"use strict";function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,n,a){var i=e._readableState;if(null===t)i.reading=!1,onEofChunk(e,i);else{var d;a||(d=chunkInvalid(i,t)),d?e.emit("error",d):i.objectMode||t&&t.length>0?("string"==typeof t||i.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=_uint8ArrayToBuffer(t)),n?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):addChunk(e,i,t,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!r?(t=i.decoder.write(t),i.objectMode||0!==t.length?addChunk(e,i,t,!1):maybeReadMore(e,i)):addChunk(e,i,t,!1))):n||(i.reading=!1)}return needMoreData(i)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?processNextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,processNextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,processNextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){if(0===t.length)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,a=r.data;for(e-=a.length;r=r.next;){var i=r.data,d=e>i.length?i.length:e;if(d===i.length?a+=i:a+=i.slice(0,e),0===(e-=d)){d===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(d));break}++n}return t.length-=n,a}function copyFromBuffer(e,t){var r=Buffer.allocUnsafe(e),n=t.head,a=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var i=n.data,d=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,d),0===(e-=d)){d===i.length?(++a,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(d));break}++a}return t.length-=a,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,processNextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}var processNextTick=require("process-nextick-args");module.exports=Readable;var isArray=require("isarray"),Duplex;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy"),StringDecoder;util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){this.push(null),t(e)},Readable.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n=t.needReadable;debug("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&(n=!0,debug("length less than watermark",n)),t.ended||t.reading?(n=!1,debug("reading or ended",n)):n&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t)));var a;return a=e>0?fromList(e,t):null,null===a?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==a&&this.emit("data",a),a},Readable.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(e,t){function r(e,t){debug("onunpipe"),e===l&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,a())}function n(){debug("onend"),e.end()}function a(){debug("cleanup"),e.removeListener("close",o),e.removeListener("finish",u),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",r),l.removeListener("end",n),l.removeListener("end",s),l.removeListener("data",i),b=!0,!h.awaitDrain||e._writableState&&!e._writableState.needDrain||c()}function i(t){debug("ondata"),g=!1,!1!==e.write(t)||g||((1===h.pipesCount&&h.pipes===e||h.pipesCount>1&&-1!==indexOf(h.pipes,e))&&!b&&(debug("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,g=!0),l.pause())}function d(t){debug("onerror",t),s(),e.removeListener("error",d),0===EElistenerCount(e,"error")&&e.emit("error",t)}function o(){e.removeListener("finish",u),s()}function u(){debug("onfinish"),e.removeListener("close",o),s()}function s(){debug("unpipe"),l.unpipe(e)}var l=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,debug("pipe count=%d opts=%j",h.pipesCount,t);var f=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr,p=f?n:s;h.endEmitted?processNextTick(p):l.once("end",p),e.on("unpipe",r);var c=pipeOnDrain(l);e.on("drain",c);var b=!1,g=!1;return l.on("data",i),prependListener(e,"error",d),e.once("close",o),e.once("finish",u),e.emit("pipe",l),h.flowing||(debug("pipe resume"),l.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<a;i++)n[i].emit("unpipe",this,r);return this}var d=indexOf(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this):processNextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(a){if(debug("wrapped data"),t.decoder&&(a=t.decoder.write(a)),(!t.objectMode||null!==a&&void 0!==a)&&(t.objectMode||a&&a.length)){n.push(a)||(r=!0,e.pause())}});for(var a in e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var i=0;i<kProxyEvents.length;i++)e.on(kProxyEvents[i],n.emit.bind(n,kProxyEvents[i]));return n._read=function(t){debug("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable._fromList=fromList;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./_stream_duplex":226,"./internal/streams/BufferList":231,"./internal/streams/destroy":232,"./internal/streams/stream":233,"_process":205,"core-util-is":71,"events":121,"inherits":144,"isarray":149,"process-nextick-args":204,"safe-buffer":244,"string_decoder/":280,"util":37}],229:[function(require,module,exports){
"use strict";function TransformState(r){this.afterTransform=function(t,n){return afterTransform(r,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,null!==n&&void 0!==n&&r.push(n),i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(r,n){done(t,r,n)}):done(t)})}function done(r,t,n){if(t)return r.emit("error",t);null!==n&&void 0!==n&&r.push(n);var e=r._writableState,i=r._transformState;if(e.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Transform.prototype._destroy=function(r,t){var n=this;Duplex.prototype._destroy.call(this,r,function(r){t(r),n.emit("close")})};

},{"./_stream_duplex":226,"core-util-is":71,"inherits":144}],230:[function(require,module,exports){
(function (process,global){
"use strict";function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}function nop(){}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=!1===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),processNextTick(t,r)}function validChunk(e,t,r,i){var n=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),processNextTick(i,o),n=!1),n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var s=decodeChunk(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var a=t.objectMode?1:i.length;t.length+=a;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,a,i,n,o);return f}function doWrite(e,t,r,i,n,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(processNextTick(n,i),processNextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)n[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;n.allBuffers=a,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t)}else{for(;r;){var f=r.chunk,u=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:f.length,f,u,l),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,processNextTick(callFinal,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function finishMaybe(e,t){var r=needFinish(t);return r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?processNextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var processNextTick=require("process-nextick-args");module.exports=Writable;var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick,Duplex;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},destroyImpl=require("./internal/streams/destroy");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||e&&e._writableState instanceof WritableState}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=_isUint8Array(e)&&!i.objectMode;return o&&!Buffer.isBuffer(e)&&(e=_uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Writable.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){this.end(),t(e)};
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./_stream_duplex":226,"./internal/streams/destroy":232,"./internal/streams/stream":233,"_process":205,"core-util-is":71,"inherits":144,"process-nextick-args":204,"safe-buffer":244,"util-deprecate":301}],231:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function copyBuffer(t,e,h){t.copy(e,h)}var Buffer=require("safe-buffer").Buffer;module.exports=function(){function t(){_classCallCheck(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,h=""+e.data;e=e.next;)h+=t+e.data;return h},t.prototype.concat=function(t){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var e=Buffer.allocUnsafe(t>>>0),h=this.head,n=0;h;)copyBuffer(h.data,e,n),n+=h.data.length,h=h.next;return e},t}();

},{"safe-buffer":244}],232:[function(require,module,exports){
"use strict";function destroy(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;if(i||a)return void(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||processNextTick(emitErrorNT,this,t));this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(processNextTick(emitErrorNT,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)})}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}var processNextTick=require("process-nextick-args");module.exports={destroy:destroy,undestroy:undestroy};

},{"process-nextick-args":204}],233:[function(require,module,exports){
module.exports=require("events").EventEmitter;

},{"events":121}],234:[function(require,module,exports){
module.exports=require("./readable").PassThrough;

},{"./readable":235}],235:[function(require,module,exports){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":226,"./lib/_stream_passthrough.js":227,"./lib/_stream_readable.js":228,"./lib/_stream_transform.js":229,"./lib/_stream_writable.js":230}],236:[function(require,module,exports){
module.exports=require("./readable").Transform;

},{"./readable":235}],237:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");

},{"./lib/_stream_writable.js":230}],238:[function(require,module,exports){
function render(e,n,r,t){"function"==typeof r&&(t=r,r={}),r||(r={}),t||(t=function(){}),validateFile(e),parseOpts(r),"string"==typeof n&&(n=document.querySelector(n)),renderMedia(e,function(r){if(n.nodeName!==r.toUpperCase()){var t=path.extname(e.name).toLowerCase();throw new Error('Cannot render "'+t+'" inside a "'+n.nodeName.toLowerCase()+'" element, expected "'+r+'"')}return n},r,t)}function append(e,n,r,t){function o(e){return"video"===e||"audio"===e?a(e):i(e)}function a(e){var t=i(e);return r.controls&&(t.controls=!0),r.autoplay&&(t.autoplay=!0),n.appendChild(t),t}function i(e){var r=document.createElement(e);return n.appendChild(r),r}function d(e,n){e&&n&&n.remove(),t(e,n)}if("function"==typeof r&&(t=r,r={}),r||(r={}),t||(t=function(){}),validateFile(e),parseOpts(r),"string"==typeof n&&(n=document.querySelector(n)),n&&("VIDEO"===n.nodeName||"AUDIO"===n.nodeName))throw new Error("Invalid video/audio node argument. Argument must be root element that video/audio tag will be appended to.");renderMedia(e,o,r,d)}function renderMedia(e,n,r,t){function o(){s.removeEventListener("loadstart",o),r.autoplay&&s.play()}function a(){s.removeEventListener("canplay",a),t(null,s)}function i(){s=n("iframe"),getBlobURL(e,function(e,n){if(e)return d(e);s.src=n,".pdf"!==l&&(s.sandbox="allow-forms allow-scripts"),t(null,s)})}function d(n){n.message='Error rendering file "'+e.name+'": '+n.message,debug(n.message),t(n)}var s,l=path.extname(e.name).toLowerCase(),u=0;MEDIASOURCE_EXTS.indexOf(l)>=0?function(){function t(){debug("Use MediaSource API for "+e.name),p(),s.addEventListener("error",c),s.addEventListener("loadstart",o),s.addEventListener("canplay",a);var n=new MediaElementWrapper(s),r=n.createWriteStream(getCodec(e.name));e.createReadStream().pipe(r),u&&(s.currentTime=u)}function i(){debug("Use Blob URL for "+e.name),p(),s.addEventListener("error",d),s.addEventListener("loadstart",o),s.addEventListener("canplay",a),getBlobURL(e,function(e,n){if(e)return d(e);s.src=n,u&&(s.currentTime=u)})}function m(e){debug("videostream error: fallback to MediaSource API: %o",e.message||e),s.removeEventListener("error",m),s.removeEventListener("canplay",a),t()}function c(n){if(debug("MediaSource API error: fallback to Blob URL: %o",n.message||n),"number"==typeof e.length&&e.length>r.maxBlobLength)return debug("File length too large for Blob URL approach: %d (max: %d)",e.length,r.maxBlobLength),d(new Error("File length too large for Blob URL approach: "+e.length+" (max: "+r.maxBlobLength+")"));s.removeEventListener("error",c),s.removeEventListener("canplay",a),i()}function p(){s||(s=n(f),s.addEventListener("progress",function(){u=s.currentTime}))}var f=MEDIASOURCE_VIDEO_EXTS.indexOf(l)>=0?"video":"audio";MediaSource?VIDEOSTREAM_EXTS.indexOf(l)>=0?function(){debug("Use `videostream` package for "+e.name),p(),s.addEventListener("error",m),s.addEventListener("loadstart",o),s.addEventListener("canplay",a),videostream(e,s)}():t():i()}():AUDIO_EXTS.indexOf(l)>=0?function(){s=n("audio"),getBlobURL(e,function(e,n){if(e)return d(e);s.addEventListener("error",d),s.addEventListener("loadstart",o),s.addEventListener("canplay",a),s.src=n})}():IMAGE_EXTS.indexOf(l)>=0?function(){s=n("img"),getBlobURL(e,function(n,r){if(n)return d(n);s.src=r,s.alt=e.name,t(null,s)})}():IFRAME_EXTS.indexOf(l)>=0?i():function(){function n(){isAscii(r)?(debug('File extension "%s" appears ascii, so will render.',l),i()):(debug('File extension "%s" appears non-ascii, will not render.',l),t(new Error('Unsupported file type "'+l+'": Cannot append to DOM')))}debug('Unknown file extension "%s" - will attempt to render into iframe',l);var r="";e.createReadStream({start:0,end:1e3}).setEncoding("utf8").on("data",function(e){r+=e}).on("end",n).on("error",t)}()}function getBlobURL(e,n){var r=path.extname(e.name).toLowerCase();streamToBlobURL(e.createReadStream(),exports.mime[r],n)}function validateFile(e){if(null==e)throw new Error("file cannot be null or undefined");if("string"!=typeof e.name)throw new Error("missing or invalid file.name property");if("function"!=typeof e.createReadStream)throw new Error("missing or invalid file.createReadStream property")}function getCodec(e){return{".m4a":'audio/mp4; codecs="mp4a.40.5"',".m4v":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".mkv":'video/webm; codecs="avc1.640029, mp4a.40.5"',".mp3":"audio/mpeg",".mp4":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".webm":'video/webm; codecs="vorbis, vp8"'}[path.extname(e).toLowerCase()]}function parseOpts(e){null==e.autoplay&&(e.autoplay=!0),null==e.controls&&(e.controls=!0),null==e.maxBlobLength&&(e.maxBlobLength=MAX_BLOB_LENGTH)}exports.render=render,exports.append=append,exports.mime=require("./lib/mime.json");var debug=require("debug")("render-media"),isAscii=require("is-ascii"),MediaElementWrapper=require("mediasource"),path=require("path"),streamToBlobURL=require("stream-to-blob-url"),videostream=require("videostream"),VIDEOSTREAM_EXTS=[".m4a",".m4v",".mp4"],MEDIASOURCE_VIDEO_EXTS=[".m4v",".mkv",".mp4",".webm"],MEDIASOURCE_AUDIO_EXTS=[".m4a",".mp3"],MEDIASOURCE_EXTS=[].concat(MEDIASOURCE_VIDEO_EXTS,MEDIASOURCE_AUDIO_EXTS),AUDIO_EXTS=[".aac",".oga",".ogg",".wav"],IMAGE_EXTS=[".bmp",".gif",".jpeg",".jpg",".png",".svg"],IFRAME_EXTS=[".css",".html",".js",".md",".pdf",".txt"],MAX_BLOB_LENGTH=2e8,MediaSource="undefined"!=typeof window&&window.MediaSource;
},{"./lib/mime.json":239,"debug":88,"is-ascii":145,"mediasource":167,"path":197,"stream-to-blob-url":276,"videostream":310}],239:[function(require,module,exports){
module.exports={
  ".3gp": "video/3gpp",
  ".aac": "audio/aac",
  ".aif": "audio/x-aiff",
  ".aiff": "audio/x-aiff",
  ".atom": "application/atom+xml",
  ".avi": "video/x-msvideo",
  ".bmp": "image/bmp",
  ".bz2": "application/x-bzip2",
  ".conf": "text/plain",
  ".css": "text/css",
  ".csv": "text/plain",
  ".diff": "text/x-diff",
  ".doc": "application/msword",
  ".flv": "video/x-flv",
  ".gif": "image/gif",
  ".gz": "application/x-gzip",
  ".htm": "text/html",
  ".html": "text/html",
  ".ico": "image/vnd.microsoft.icon",
  ".ics": "text/calendar",
  ".iso": "application/octet-stream",
  ".jar": "application/java-archive",
  ".jpeg": "image/jpeg",
  ".jpg": "image/jpeg",
  ".js": "application/javascript",
  ".json": "application/json",
  ".less": "text/css",
  ".log": "text/plain",
  ".m3u": "audio/x-mpegurl",
  ".m4a": "audio/mp4",
  ".m4v": "video/mp4",
  ".manifest": "text/cache-manifest",
  ".markdown": "text/x-markdown",
  ".mathml": "application/mathml+xml",
  ".md": "text/x-markdown",
  ".mid": "audio/midi",
  ".midi": "audio/midi",
  ".mov": "video/quicktime",
  ".mp3": "audio/mpeg",
  ".mp4": "video/mp4",
  ".mp4v": "video/mp4",
  ".mpeg": "video/mpeg",
  ".mpg": "video/mpeg",
  ".odp": "application/vnd.oasis.opendocument.presentation",
  ".ods": "application/vnd.oasis.opendocument.spreadsheet",
  ".odt": "application/vnd.oasis.opendocument.text",
  ".oga": "audio/ogg",
  ".ogg": "application/ogg",
  ".pdf": "application/pdf",
  ".png": "image/png",
  ".pps": "application/vnd.ms-powerpoint",
  ".ppt": "application/vnd.ms-powerpoint",
  ".ps": "application/postscript",
  ".psd": "image/vnd.adobe.photoshop",
  ".qt": "video/quicktime",
  ".rar": "application/x-rar-compressed",
  ".rdf": "application/rdf+xml",
  ".rss": "application/rss+xml",
  ".rtf": "application/rtf",
  ".svg": "image/svg+xml",
  ".svgz": "image/svg+xml",
  ".swf": "application/x-shockwave-flash",
  ".tar": "application/x-tar",
  ".tbz": "application/x-bzip-compressed-tar",
  ".text": "text/plain",
  ".tif": "image/tiff",
  ".tiff": "image/tiff",
  ".torrent": "application/x-bittorrent",
  ".ttf": "application/x-font-ttf",
  ".txt": "text/plain",
  ".wav": "audio/wav",
  ".webm": "video/webm",
  ".wma": "audio/x-ms-wma",
  ".wmv": "video/x-ms-wmv",
  ".xls": "application/vnd.ms-excel",
  ".xml": "application/xml",
  ".yaml": "text/yaml",
  ".yml": "text/yaml",
  ".zip": "application/zip"
}

},{}],240:[function(require,module,exports){
(function (Buffer){
"use strict";function RIPEMD160(){HashBase.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function rotl(t,r){return t<<r|t>>>32-r}function fn1(t,r,n,o,f,l,i,s){return rotl(t+(r^n^o)+l+i|0,s)+f|0}function fn2(t,r,n,o,f,l,i,s){return rotl(t+(r&n|~r&o)+l+i|0,s)+f|0}function fn3(t,r,n,o,f,l,i,s){return rotl(t+((r|~n)^o)+l+i|0,s)+f|0}function fn4(t,r,n,o,f,l,i,s){return rotl(t+(r&o|n&~o)+l+i|0,s)+f|0}function fn5(t,r,n,o,f,l,i,s){return rotl(t+(r^(n|~o))+l+i|0,s)+f|0}var inherits=require("inherits"),HashBase=require("hash-base");inherits(RIPEMD160,HashBase),RIPEMD160.prototype._update=function(){for(var t=new Array(16),r=0;r<16;++r)t[r]=this._block.readInt32LE(4*r);var n=this._a,o=this._b,f=this._c,l=this._d,i=this._e;n=fn1(n,o,f,l,i,t[0],0,11),f=rotl(f,10),i=fn1(i,n,o,f,l,t[1],0,14),o=rotl(o,10),l=fn1(l,i,n,o,f,t[2],0,15),n=rotl(n,10),f=fn1(f,l,i,n,o,t[3],0,12),i=rotl(i,10),o=fn1(o,f,l,i,n,t[4],0,5),l=rotl(l,10),n=fn1(n,o,f,l,i,t[5],0,8),f=rotl(f,10),i=fn1(i,n,o,f,l,t[6],0,7),o=rotl(o,10),l=fn1(l,i,n,o,f,t[7],0,9),n=rotl(n,10),f=fn1(f,l,i,n,o,t[8],0,11),i=rotl(i,10),o=fn1(o,f,l,i,n,t[9],0,13),l=rotl(l,10),n=fn1(n,o,f,l,i,t[10],0,14),f=rotl(f,10),i=fn1(i,n,o,f,l,t[11],0,15),o=rotl(o,10),l=fn1(l,i,n,o,f,t[12],0,6),n=rotl(n,10),f=fn1(f,l,i,n,o,t[13],0,7),i=rotl(i,10),o=fn1(o,f,l,i,n,t[14],0,9),l=rotl(l,10),n=fn1(n,o,f,l,i,t[15],0,8),f=rotl(f,10),i=fn2(i,n,o,f,l,t[7],1518500249,7),o=rotl(o,10),l=fn2(l,i,n,o,f,t[4],1518500249,6),n=rotl(n,10),f=fn2(f,l,i,n,o,t[13],1518500249,8),i=rotl(i,10),o=fn2(o,f,l,i,n,t[1],1518500249,13),l=rotl(l,10),n=fn2(n,o,f,l,i,t[10],1518500249,11),f=rotl(f,10),i=fn2(i,n,o,f,l,t[6],1518500249,9),o=rotl(o,10),l=fn2(l,i,n,o,f,t[15],1518500249,7),n=rotl(n,10),f=fn2(f,l,i,n,o,t[3],1518500249,15),i=rotl(i,10),o=fn2(o,f,l,i,n,t[12],1518500249,7),l=rotl(l,10),n=fn2(n,o,f,l,i,t[0],1518500249,12),f=rotl(f,10),i=fn2(i,n,o,f,l,t[9],1518500249,15),o=rotl(o,10),l=fn2(l,i,n,o,f,t[5],1518500249,9),n=rotl(n,10),f=fn2(f,l,i,n,o,t[2],1518500249,11),i=rotl(i,10),o=fn2(o,f,l,i,n,t[14],1518500249,7),l=rotl(l,10),n=fn2(n,o,f,l,i,t[11],1518500249,13),f=rotl(f,10),i=fn2(i,n,o,f,l,t[8],1518500249,12),o=rotl(o,10),l=fn3(l,i,n,o,f,t[3],1859775393,11),n=rotl(n,10),f=fn3(f,l,i,n,o,t[10],1859775393,13),i=rotl(i,10),o=fn3(o,f,l,i,n,t[14],1859775393,6),l=rotl(l,10),n=fn3(n,o,f,l,i,t[4],1859775393,7),f=rotl(f,10),i=fn3(i,n,o,f,l,t[9],1859775393,14),o=rotl(o,10),l=fn3(l,i,n,o,f,t[15],1859775393,9),n=rotl(n,10),f=fn3(f,l,i,n,o,t[8],1859775393,13),i=rotl(i,10),o=fn3(o,f,l,i,n,t[1],1859775393,15),l=rotl(l,10),n=fn3(n,o,f,l,i,t[2],1859775393,14),f=rotl(f,10),i=fn3(i,n,o,f,l,t[7],1859775393,8),o=rotl(o,10),l=fn3(l,i,n,o,f,t[0],1859775393,13),n=rotl(n,10),f=fn3(f,l,i,n,o,t[6],1859775393,6),i=rotl(i,10),o=fn3(o,f,l,i,n,t[13],1859775393,5),l=rotl(l,10),n=fn3(n,o,f,l,i,t[11],1859775393,12),f=rotl(f,10),i=fn3(i,n,o,f,l,t[5],1859775393,7),o=rotl(o,10),l=fn3(l,i,n,o,f,t[12],1859775393,5),n=rotl(n,10),f=fn4(f,l,i,n,o,t[1],2400959708,11),i=rotl(i,10),o=fn4(o,f,l,i,n,t[9],2400959708,12),l=rotl(l,10),n=fn4(n,o,f,l,i,t[11],2400959708,14),f=rotl(f,10),i=fn4(i,n,o,f,l,t[10],2400959708,15),o=rotl(o,10),l=fn4(l,i,n,o,f,t[0],2400959708,14),n=rotl(n,10),f=fn4(f,l,i,n,o,t[8],2400959708,15),i=rotl(i,10),o=fn4(o,f,l,i,n,t[12],2400959708,9),l=rotl(l,10),n=fn4(n,o,f,l,i,t[4],2400959708,8),f=rotl(f,10),i=fn4(i,n,o,f,l,t[13],2400959708,9),o=rotl(o,10),l=fn4(l,i,n,o,f,t[3],2400959708,14),n=rotl(n,10),f=fn4(f,l,i,n,o,t[7],2400959708,5),i=rotl(i,10),o=fn4(o,f,l,i,n,t[15],2400959708,6),l=rotl(l,10),n=fn4(n,o,f,l,i,t[14],2400959708,8),f=rotl(f,10),i=fn4(i,n,o,f,l,t[5],2400959708,6),o=rotl(o,10),l=fn4(l,i,n,o,f,t[6],2400959708,5),n=rotl(n,10),f=fn4(f,l,i,n,o,t[2],2400959708,12),i=rotl(i,10),o=fn5(o,f,l,i,n,t[4],2840853838,9),l=rotl(l,10),n=fn5(n,o,f,l,i,t[0],2840853838,15),f=rotl(f,10),i=fn5(i,n,o,f,l,t[5],2840853838,5),o=rotl(o,10),l=fn5(l,i,n,o,f,t[9],2840853838,11),n=rotl(n,10),f=fn5(f,l,i,n,o,t[7],2840853838,6),i=rotl(i,10),o=fn5(o,f,l,i,n,t[12],2840853838,8),l=rotl(l,10),n=fn5(n,o,f,l,i,t[2],2840853838,13),f=rotl(f,10),i=fn5(i,n,o,f,l,t[10],2840853838,12),o=rotl(o,10),l=fn5(l,i,n,o,f,t[14],2840853838,5),n=rotl(n,10),f=fn5(f,l,i,n,o,t[1],2840853838,12),i=rotl(i,10),o=fn5(o,f,l,i,n,t[3],2840853838,13),l=rotl(l,10),n=fn5(n,o,f,l,i,t[8],2840853838,14),f=rotl(f,10),i=fn5(i,n,o,f,l,t[11],2840853838,11),o=rotl(o,10),l=fn5(l,i,n,o,f,t[6],2840853838,8),n=rotl(n,10),f=fn5(f,l,i,n,o,t[15],2840853838,5),i=rotl(i,10),o=fn5(o,f,l,i,n,t[13],2840853838,6),l=rotl(l,10);var s=this._a,h=this._b,e=this._c,_=this._d,c=this._e;s=fn5(s,h,e,_,c,t[5],1352829926,8),e=rotl(e,10),c=fn5(c,s,h,e,_,t[14],1352829926,9),h=rotl(h,10),_=fn5(_,c,s,h,e,t[7],1352829926,9),s=rotl(s,10),e=fn5(e,_,c,s,h,t[0],1352829926,11),c=rotl(c,10),h=fn5(h,e,_,c,s,t[9],1352829926,13),_=rotl(_,10),s=fn5(s,h,e,_,c,t[2],1352829926,15),e=rotl(e,10),c=fn5(c,s,h,e,_,t[11],1352829926,15),h=rotl(h,10),_=fn5(_,c,s,h,e,t[4],1352829926,5),s=rotl(s,10),e=fn5(e,_,c,s,h,t[13],1352829926,7),c=rotl(c,10),h=fn5(h,e,_,c,s,t[6],1352829926,7),_=rotl(_,10),s=fn5(s,h,e,_,c,t[15],1352829926,8),e=rotl(e,10),c=fn5(c,s,h,e,_,t[8],1352829926,11),h=rotl(h,10),_=fn5(_,c,s,h,e,t[1],1352829926,14),s=rotl(s,10),e=fn5(e,_,c,s,h,t[10],1352829926,14),c=rotl(c,10),h=fn5(h,e,_,c,s,t[3],1352829926,12),_=rotl(_,10),s=fn5(s,h,e,_,c,t[12],1352829926,6),e=rotl(e,10),c=fn4(c,s,h,e,_,t[6],1548603684,9),h=rotl(h,10),_=fn4(_,c,s,h,e,t[11],1548603684,13),s=rotl(s,10),e=fn4(e,_,c,s,h,t[3],1548603684,15),c=rotl(c,10),h=fn4(h,e,_,c,s,t[7],1548603684,7),_=rotl(_,10),s=fn4(s,h,e,_,c,t[0],1548603684,12),e=rotl(e,10),c=fn4(c,s,h,e,_,t[13],1548603684,8),h=rotl(h,10),_=fn4(_,c,s,h,e,t[5],1548603684,9),s=rotl(s,10),e=fn4(e,_,c,s,h,t[10],1548603684,11),c=rotl(c,10),h=fn4(h,e,_,c,s,t[14],1548603684,7),_=rotl(_,10),s=fn4(s,h,e,_,c,t[15],1548603684,7),e=rotl(e,10),c=fn4(c,s,h,e,_,t[8],1548603684,12),h=rotl(h,10),_=fn4(_,c,s,h,e,t[12],1548603684,7),s=rotl(s,10),e=fn4(e,_,c,s,h,t[4],1548603684,6),c=rotl(c,10),h=fn4(h,e,_,c,s,t[9],1548603684,15),_=rotl(_,10),s=fn4(s,h,e,_,c,t[1],1548603684,13),e=rotl(e,10),c=fn4(c,s,h,e,_,t[2],1548603684,11),h=rotl(h,10),_=fn3(_,c,s,h,e,t[15],1836072691,9),s=rotl(s,10),e=fn3(e,_,c,s,h,t[5],1836072691,7),c=rotl(c,10),h=fn3(h,e,_,c,s,t[1],1836072691,15),_=rotl(_,10),s=fn3(s,h,e,_,c,t[3],1836072691,11),e=rotl(e,10),c=fn3(c,s,h,e,_,t[7],1836072691,8),h=rotl(h,10),_=fn3(_,c,s,h,e,t[14],1836072691,6),s=rotl(s,10),e=fn3(e,_,c,s,h,t[6],1836072691,6),c=rotl(c,10),h=fn3(h,e,_,c,s,t[9],1836072691,14),_=rotl(_,10),s=fn3(s,h,e,_,c,t[11],1836072691,12),e=rotl(e,10),c=fn3(c,s,h,e,_,t[8],1836072691,13),h=rotl(h,10),_=fn3(_,c,s,h,e,t[12],1836072691,5),s=rotl(s,10),e=fn3(e,_,c,s,h,t[2],1836072691,14),c=rotl(c,10),h=fn3(h,e,_,c,s,t[10],1836072691,13),_=rotl(_,10),s=fn3(s,h,e,_,c,t[0],1836072691,13),e=rotl(e,10),c=fn3(c,s,h,e,_,t[4],1836072691,7),h=rotl(h,10),_=fn3(_,c,s,h,e,t[13],1836072691,5),s=rotl(s,10),e=fn2(e,_,c,s,h,t[8],2053994217,15),c=rotl(c,10),h=fn2(h,e,_,c,s,t[6],2053994217,5),_=rotl(_,10),s=fn2(s,h,e,_,c,t[4],2053994217,8),e=rotl(e,10),c=fn2(c,s,h,e,_,t[1],2053994217,11),h=rotl(h,10),_=fn2(_,c,s,h,e,t[3],2053994217,14),s=rotl(s,10),e=fn2(e,_,c,s,h,t[11],2053994217,14),c=rotl(c,10),h=fn2(h,e,_,c,s,t[15],2053994217,6),_=rotl(_,10),s=fn2(s,h,e,_,c,t[0],2053994217,14),e=rotl(e,10),c=fn2(c,s,h,e,_,t[5],2053994217,6),h=rotl(h,10),_=fn2(_,c,s,h,e,t[12],2053994217,9),s=rotl(s,10),e=fn2(e,_,c,s,h,t[2],2053994217,12),c=rotl(c,10),h=fn2(h,e,_,c,s,t[13],2053994217,9),_=rotl(_,10),s=fn2(s,h,e,_,c,t[9],2053994217,12),e=rotl(e,10),c=fn2(c,s,h,e,_,t[7],2053994217,5),h=rotl(h,10),_=fn2(_,c,s,h,e,t[10],2053994217,15),s=rotl(s,10),e=fn2(e,_,c,s,h,t[14],2053994217,8),c=rotl(c,10),h=fn1(h,e,_,c,s,t[12],0,8),_=rotl(_,10),s=fn1(s,h,e,_,c,t[15],0,5),e=rotl(e,10),c=fn1(c,s,h,e,_,t[10],0,12),h=rotl(h,10),_=fn1(_,c,s,h,e,t[4],0,9),s=rotl(s,10),e=fn1(e,_,c,s,h,t[1],0,12),c=rotl(c,10),h=fn1(h,e,_,c,s,t[5],0,5),_=rotl(_,10),s=fn1(s,h,e,_,c,t[8],0,14),e=rotl(e,10),c=fn1(c,s,h,e,_,t[7],0,6),h=rotl(h,10),_=fn1(_,c,s,h,e,t[6],0,8),s=rotl(s,10),e=fn1(e,_,c,s,h,t[2],0,13),c=rotl(c,10),h=fn1(h,e,_,c,s,t[13],0,6),_=rotl(_,10),s=fn1(s,h,e,_,c,t[14],0,5),e=rotl(e,10),c=fn1(c,s,h,e,_,t[0],0,15),h=rotl(h,10),_=fn1(_,c,s,h,e,t[3],0,13),s=rotl(s,10),e=fn1(e,_,c,s,h,t[9],0,11),c=rotl(c,10),h=fn1(h,e,_,c,s,t[11],0,11),_=rotl(_,10);var a=this._b+f+_|0;this._b=this._c+l+c|0,this._c=this._d+i+s|0,this._d=this._e+n+h|0,this._e=this._a+o+e|0,this._a=a},RIPEMD160.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new Buffer(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},module.exports=RIPEMD160;
}).call(this,require("buffer").Buffer)
},{"buffer":66,"hash-base":126,"inherits":144}],241:[function(require,module,exports){
(function (process){
module.exports=function(n,e,t){function r(n){function e(){t&&t(n,u),t=null}l?process.nextTick(e):e()}function o(e,t,l){if(u[e]=l,t&&(s=!0),0==--f||t)r(t);else if(!s&&a<i){var m;c?(m=c[a],a+=1,n[m](function(n,e){o(m,n,e)})):(m=a,a+=1,n[m](function(n,e){o(m,n,e)}))}}if("number"!=typeof e)throw new Error("second argument must be a Number");var u,i,f,c,s,l=!0;Array.isArray(n)?(u=[],f=i=n.length):(c=Object.keys(n),u={},f=i=c.length);var a=e;f?c?c.some(function(t,r){if(n[t](function(n,e){o(t,n,e)}),r===e-1)return!0}):n.some(function(n,t){if(n(function(n,e){o(t,n,e)}),t===e-1)return!0}):r(null),l=!1};

}).call(this,require('_process'))
},{"_process":205}],242:[function(require,module,exports){
(function (process){
module.exports=function(n,c){function o(n){function o(){c&&c(n,u),c=null}r?process.nextTick(o):o()}function t(n,c,t){u[n]=t,(0==--f||c)&&o(c)}var u,f,i,r=!0;Array.isArray(n)?(u=[],f=n.length):(i=Object.keys(n),u={},f=i.length),f?i?i.forEach(function(c){n[c](function(n,o){t(c,n,o)})}):n.forEach(function(n,c){n(function(n,o){t(c,n,o)})}):o(null),r=!1};

}).call(this,require('_process'))
},{"_process":205}],243:[function(require,module,exports){
(function (global){
!function(){function e(t){"use strict";for(var a={fill:0},f=function(e){for(e+=9;e%64>0;e+=1);return e},i=function(e,r){var n=new Uint8Array(e.buffer),t=r%4,a=r-t;switch(t){case 0:n[a+3]=0;case 1:n[a+2]=0;case 2:n[a+1]=0;case 3:n[a+0]=0}for(var f=1+(r>>2);f<e.length;f++)e[f]=0},s=function(e,r,n){e[r>>2]|=128<<24-(r%4<<3),e[14+(2+(r>>2)&-16)]=n/(1<<29)|0,e[15+(2+(r>>2)&-16)]=n<<3},u=function(e,r,n,t,a){var f,i=this,s=a%4,u=(t+s)%4,o=t-u;switch(s){case 0:e[a]=i.charCodeAt(n+3);case 1:e[a+1-(s<<1)|0]=i.charCodeAt(n+2);case 2:e[a+2-(s<<1)|0]=i.charCodeAt(n+1);case 3:e[a+3-(s<<1)|0]=i.charCodeAt(n)}if(!(t<u+s)){for(f=4-s;f<o;f=f+4|0)r[a+f>>2]=i.charCodeAt(n+f)<<24|i.charCodeAt(n+f+1)<<16|i.charCodeAt(n+f+2)<<8|i.charCodeAt(n+f+3);switch(u){case 3:e[a+o+1|0]=i.charCodeAt(n+o+2);case 2:e[a+o+2|0]=i.charCodeAt(n+o+1);case 1:e[a+o+3|0]=i.charCodeAt(n+o)}}},o=function(e,r,n,t,a){var f,i=this,s=a%4,u=(t+s)%4,o=t-u;switch(s){case 0:e[a]=i[n+3];case 1:e[a+1-(s<<1)|0]=i[n+2];case 2:e[a+2-(s<<1)|0]=i[n+1];case 3:e[a+3-(s<<1)|0]=i[n]}if(!(t<u+s)){for(f=4-s;f<o;f=f+4|0)r[a+f>>2|0]=i[n+f]<<24|i[n+f+1]<<16|i[n+f+2]<<8|i[n+f+3];switch(u){case 3:e[a+o+1|0]=i[n+o+2];case 2:e[a+o+2|0]=i[n+o+1];case 1:e[a+o+3|0]=i[n+o]}}},h=function(e,r,t,a,f){var i,s=this,u=f%4,o=(a+u)%4,h=a-o,c=new Uint8Array(n.readAsArrayBuffer(s.slice(t,t+a)));switch(u){case 0:e[f]=c[3];case 1:e[f+1-(u<<1)|0]=c[2];case 2:e[f+2-(u<<1)|0]=c[1];case 3:e[f+3-(u<<1)|0]=c[0]}if(!(a<o+u)){for(i=4-u;i<h;i=i+4|0)r[f+i>>2|0]=c[i]<<24|c[i+1]<<16|c[i+2]<<8|c[i+3];switch(o){case 3:e[f+h+1|0]=c[h+2];case 2:e[f+h+2|0]=c[h+1];case 1:e[f+h+3|0]=c[h]}}},c=function(e){switch(r.getDataType(e)){case"string":return u.bind(e);case"array":case"buffer":return o.bind(e);case"arraybuffer":return o.bind(new Uint8Array(e));case"view":return o.bind(new Uint8Array(e.buffer,e.byteOffset,e.byteLength));case"blob":return h.bind(e)}},d=new Array(256),y=0;y<256;y++)d[y]=(y<16?"0":"")+y.toString(16);var p=function(e){for(var r=new Uint8Array(e),n=new Array(e.byteLength),t=0;t<n.length;t++)n[t]=d[r[t]];return n.join("")},w=function(e){var r;if(e<=65536)return 65536;if(e<16777216)for(r=1;r<e;r<<=1);else for(r=16777216;r<e;r+=16777216);return r};!function(r){if(r%64>0)throw new Error("Chunk size must be a multiple of 128 bit");a.offset=0,a.maxChunkLen=r,a.padMaxChunkLen=f(r),a.heap=new ArrayBuffer(w(a.padMaxChunkLen+320+20)),a.h32=new Int32Array(a.heap),a.h8=new Int8Array(a.heap),a.core=new e._core({Int32Array:Int32Array,DataView:DataView},{},a.heap),a.buffer=null}(t||65536);var l=function(e,r){a.offset=0;var n=new Int32Array(e,r+320,5);n[0]=1732584193,n[1]=-271733879,n[2]=-1732584194,n[3]=271733878,n[4]=-1009589776},A=function(e,r){var n=f(e),t=new Int32Array(a.heap,0,n>>2);return i(t,e),s(t,e,r),n},b=function(e,r,n,t){c(e)(a.h8,a.h32,r,n,t||0)},v=function(e,r,n,t,f){var i=n;b(e,r,n),f&&(i=A(n,t)),a.core.hash(i,a.padMaxChunkLen)},C=function(e,r){var n=new Int32Array(e,r+320,5),t=new Int32Array(5),a=new DataView(t.buffer);return a.setInt32(0,n[0],!1),a.setInt32(4,n[1],!1),a.setInt32(8,n[2],!1),a.setInt32(12,n[3],!1),a.setInt32(16,n[4],!1),t},g=this.rawDigest=function(e){var r=e.byteLength||e.length||e.size||0;l(a.heap,a.padMaxChunkLen);var n=0,t=a.maxChunkLen;for(n=0;r>n+t;n+=t)v(e,n,t,r,!1);return v(e,n,r-n,r,!0),C(a.heap,a.padMaxChunkLen)};this.digest=this.digestFromString=this.digestFromBuffer=this.digestFromArrayBuffer=function(e){return p(g(e).buffer)},this.resetState=function(){return l(a.heap,a.padMaxChunkLen),this},this.append=function(e){var r,n=0,t=e.byteLength||e.length||e.size||0,f=a.offset%a.maxChunkLen;for(a.offset+=t;n<t;)r=Math.min(t-n,a.maxChunkLen-f),b(e,n,r,f),f+=r,n+=r,f===a.maxChunkLen&&(a.core.hash(a.maxChunkLen,a.padMaxChunkLen),f=0);return this},this.getState=function(){var e,r=a.offset%a.maxChunkLen;if(r)e=a.heap.slice(0);else{var n=new Int32Array(a.heap,a.padMaxChunkLen+320,5);e=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{offset:a.offset,heap:e}},this.setState=function(e){if(a.offset=e.offset,20===e.heap.byteLength){new Int32Array(a.heap,a.padMaxChunkLen+320,5).set(new Int32Array(e.heap))}else a.h32.set(new Int32Array(e.heap));return this};var L=this.rawEnd=function(){var e=a.offset,r=e%a.maxChunkLen,n=A(r,e);a.core.hash(n,a.padMaxChunkLen);var t=C(a.heap,a.padMaxChunkLen);return l(a.heap,a.padMaxChunkLen),t};this.end=function(){return p(L().buffer)}}var r={getDataType:function(e){if("string"==typeof e)return"string";if(e instanceof Array)return"array";if("undefined"!=typeof global&&global.Buffer&&global.Buffer.isBuffer(e))return"buffer";if(e instanceof ArrayBuffer)return"arraybuffer";if(e.buffer instanceof ArrayBuffer)return"view";if(e instanceof Blob)return"blob";throw new Error("Unsupported data type.")}};if(e._core=function(e,r,n){"use asm";var t=new e.Int32Array(n);function a(e,r){e=e|0;r=r|0;var n=0,a=0,f=0,i=0,s=0,u=0,o=0,h=0,c=0,d=0,y=0,p=0,w=0,l=0;f=t[r+320>>2]|0;s=t[r+324>>2]|0;o=t[r+328>>2]|0;c=t[r+332>>2]|0;y=t[r+336>>2]|0;for(n=0;(n|0)<(e|0);n=n+64|0){i=f;u=s;h=o;d=c;p=y;for(a=0;(a|0)<64;a=a+4|0){l=t[n+a>>2]|0;w=((f<<5|f>>>27)+(s&o|~s&c)|0)+((l+y|0)+1518500249|0)|0;y=c;c=o;o=s<<30|s>>>2;s=f;f=w;t[e+a>>2]=l}for(a=e+64|0;(a|0)<(e+80|0);a=a+4|0){l=(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])<<1|(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])>>>31;w=((f<<5|f>>>27)+(s&o|~s&c)|0)+((l+y|0)+1518500249|0)|0;y=c;c=o;o=s<<30|s>>>2;s=f;f=w;t[a>>2]=l}for(a=e+80|0;(a|0)<(e+160|0);a=a+4|0){l=(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])<<1|(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])>>>31;w=((f<<5|f>>>27)+(s^o^c)|0)+((l+y|0)+1859775393|0)|0;y=c;c=o;o=s<<30|s>>>2;s=f;f=w;t[a>>2]=l}for(a=e+160|0;(a|0)<(e+240|0);a=a+4|0){l=(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])<<1|(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])>>>31;w=((f<<5|f>>>27)+(s&o|s&c|o&c)|0)+((l+y|0)-1894007588|0)|0;y=c;c=o;o=s<<30|s>>>2;s=f;f=w;t[a>>2]=l}for(a=e+240|0;(a|0)<(e+320|0);a=a+4|0){l=(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])<<1|(t[a-12>>2]^t[a-32>>2]^t[a-56>>2]^t[a-64>>2])>>>31;w=((f<<5|f>>>27)+(s^o^c)|0)+((l+y|0)-899497514|0)|0;y=c;c=o;o=s<<30|s>>>2;s=f;f=w;t[a>>2]=l}f=f+i|0;s=s+u|0;o=o+h|0;c=c+d|0;y=y+p|0}t[r+320>>2]=f;t[r+324>>2]=s;t[r+328>>2]=o;t[r+332>>2]=c;t[r+336>>2]=y}return{hash:a}},"undefined"!=typeof module?module.exports=e:"undefined"!=typeof window&&(window.Rusha=e),"undefined"!=typeof FileReaderSync){var n=new FileReaderSync,t=function(e,r,n){try{return n(null,e.digest(r))}catch(e){return n(e)}},a=function(e,r,n,t,f){var i=new self.FileReader;i.onloadend=function(){var s=i.result;r+=i.result.byteLength;try{e.append(s)}catch(e){return void f(e)}r<t.size?a(e,r,n,t,f):f(null,e.end())},i.readAsArrayBuffer(t.slice(r,r+n))};self.onmessage=function(r){var n=r.data.data,f=r.data.file,i=r.data.id;if(void 0!==i&&(f||n)){var s=r.data.blockSize||4194304,u=new e(s);u.resetState();var o=function(e,r){e?self.postMessage({id:i,error:e.name}):self.postMessage({id:i,hash:r})};n&&t(u,n,o),f&&a(u,0,s,f,o)}}}}();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],244:[function(require,module,exports){
function copyProps(f,r){for(var e in f)r[e]=f[e]}function SafeBuffer(f,r,e){return Buffer(f,r,e)}var buffer=require("buffer"),Buffer=buffer.Buffer;Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,r,e){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,r,e)},SafeBuffer.alloc=function(f,r,e){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==r?"string"==typeof e?u.fill(r,e):u.fill(r):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":66}],245:[function(require,module,exports){
(function (process){
function dutyOfSubclass(){throw new Error("method must be implemented by subclass")}function validate(e){return!(!Array.isArray(e)||"string"!=typeof e[2]||"__proto__"===e[2]||"number"!=typeof e[1])}function Scuttlebutt(e){if(!(this instanceof Scuttlebutt))return new Scuttlebutt(e);var t="string"==typeof e?e:e&&e.id;this.sources={},this.setMaxListeners(Number.MAX_VALUE),this._streams=0,e&&e.sign&&e.verify?(this.setId(e.id||e.createId()),this._sign=e.sign,this._verify=e.verify):this.setId(t||u.createId())}function streamDone(e,t){function r(){e.removeListener("end",i),e.removeListener("error",i),e.removeListener("close",i)}function i(e){r(),t.call(this,e)}i.listener=t,e.on("end",i),e.on("error",i),e.on("close",i)}var EventEmitter=require("events").EventEmitter,i=require("iterate"),duplex=require("duplex"),inherits=require("util").inherits,serializer=require("stream-serializer"),u=require("./util"),timestamp=require("monotonic-timestamp");exports=module.exports=Scuttlebutt,exports.createID=u.createID,exports.updateIsRecent=u.filter,exports.filter=u.filter,exports.timestamp=timestamp,inherits(Scuttlebutt,EventEmitter);var sb=Scuttlebutt.prototype,emit=EventEmitter.prototype.emit;sb.applyUpdate=dutyOfSubclass,sb.history=dutyOfSubclass,sb.localUpdate=function(e){return this._update([e,timestamp(),this.id]),this},sb._update=function(e){function t(t,r){return t?emit.call(s,"error",t):r?void(s.applyUpdate(e)&&emit.call(s,"_update",e)):emit.call(s,"unverified_data",e)}var r=e[1],i=e[2],n=this.sources[i];if(n&&n>=r)return emit.call(this,"old_data",e),!1;this.sources[i]=r;var s=this;return i!==this.id?this._verify?this._verify(e,t):t(null,!0):(this._sign&&(e[3]=this._sign(e)),t(null,!0)),!0},sb.createStream=function(e){function t(e){if(!e||!e.clock)return l.emit("error"),l._end();a=e.clock,i.each(s.history(a),function(e){l._data(e)}),s.on("_update",r),l._data("SYNC"),o=!0,d.emit("header",e),d.emit("syncSent"),c&&(d.emit("sync"),d.emit("synced")),m||l._end()}function r(e){if(validate(e)&&u.filter(e,a)){l._data(e);var t=e[1],r=e[2];a[r]=t}}function n(){l.end()}var s=this,a={},o=!1,c=!1;this._streams++,e=e||{};var l=duplex();l.name=e.name;var d=serializer(e&&e.wrapper)(l);d.inner=l,l.writable=!1!==e.writable,l.readable=!1!==e.readable,c=!l.writable,o=!l.readable;var m=!1!==e.tail;l.on("_data",function(e){if(Array.isArray(e)){if(!l.writable)return;if(validate(e))return s._update(e)}else"object"==typeof e&&e?t(e):"string"==typeof e&&"SYNC"==e&&(c=!0,d.emit("syncRecieved"),o&&(d.emit("sync"),d.emit("synced")))}).on("_end",function(){l._end()}).on("close",function(){s.removeListener("_update",r),s.removeListener("dispose",n),s._streams--,emit.call(s,"unstream",s._streams)}),e&&!1===e.tail&&d.on("sync",function(){process.nextTick(function(){l._end()})});var p={id:s.id,clock:s.sources};return e&&e.meta&&(p.meta=e.meta),l.readable?(l._data(p),l.writable||e.clock||t({clock:{}})):e.sendClock&&l._data(p),s.once("dispose",n),d},sb.createWriteStream=function(e){return e=e||{},e.writable=!0,e.readable=!1,this.createStream(e)},sb.createReadStream=function(e){return e=e||{},e.writable=!1,e.readable=!0,this.createStream(e)},sb.dispose=function(){emit.call(this,"dispose")},sb.setId=function(e){if("__proto__"===e)throw new Error("__proto__ is invalid id");if(null==e)throw new Error("null is not invalid id");return this.id=e,this},sb.clone=function(){var e=this,t=new e.constructor;t.setId(e.id),e._clones=(e._clones||0)+1;var r=e.createStream({wrapper:"raw"}),i=t.createStream({wrapper:"raw"});return r.pause=i.pause=function(){},streamDone(i,function(){e._clones--,emit.call(e,"unclone",e._clones)}),r.pipe(i).pipe(r),r.resume(),i.resume(),t};

}).call(this,require('_process'))
},{"./util":246,"_process":205,"duplex":102,"events":121,"iterate":150,"monotonic-timestamp":172,"stream-serializer":274,"util":304}],246:[function(require,module,exports){
arguments[4][220][0].apply(exports,arguments)
},{"dup":220}],247:[function(require,module,exports){
(function (Buffer){
function Hash(t,i){this._block=new Buffer(t),this._finalSize=i,this._blockSize=t,this._len=0,this._s=0}Hash.prototype.update=function(t,i){"string"==typeof t&&(i=i||"utf8",t=new Buffer(t,i));for(var s=this._len+=t.length,e=this._s||0,h=0,o=this._block;e<s;){for(var l=Math.min(t.length,h+this._blockSize-e%this._blockSize),_=l-h,n=0;n<_;n++)o[e%this._blockSize+n]=t[n+h];e+=_,h+=_,e%this._blockSize==0&&this._update(o)}return this._s=e,this},Hash.prototype.digest=function(t){var i=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),i%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(i,this._blockSize-4);var s=this._update(this._block)||this._hash();return t?s.toString(t):s},Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")},module.exports=Hash;

}).call(this,require("buffer").Buffer)
},{"buffer":66}],248:[function(require,module,exports){
var exports=module.exports=function(e){e=e.toLowerCase();var r=exports[e];if(!r)throw new Error(e+" is not supported (we accept pull requests)");return new r};exports.sha=require("./sha"),exports.sha1=require("./sha1"),exports.sha224=require("./sha224"),exports.sha256=require("./sha256"),exports.sha384=require("./sha384"),exports.sha512=require("./sha512");

},{"./sha":249,"./sha1":250,"./sha224":251,"./sha256":252,"./sha384":253,"./sha512":254}],249:[function(require,module,exports){
(function (Buffer){
function Sha(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl5(t){return t<<5|t>>>27}function rotl30(t){return t<<30|t>>>2}function ft(t,i,h,r){return 0===t?i&h|~i&r:2===t?i&h|i&r|h&r:i^h^r}var inherits=require("inherits"),Hash=require("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha,Hash),Sha.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha.prototype._update=function(t){for(var i=this._w,h=0|this._a,r=0|this._b,s=0|this._c,e=0|this._d,n=0|this._e,_=0;_<16;++_)i[_]=t.readInt32BE(4*_);for(;_<80;++_)i[_]=i[_-3]^i[_-8]^i[_-14]^i[_-16];for(var a=0;a<80;++a){var o=~~(a/20),u=rotl5(h)+ft(o,r,s,e)+n+i[a]+K[o]|0;n=e,e=s,s=rotl30(r),r=h,h=u}this._a=h+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=e+this._d|0,this._e=n+this._e|0},Sha.prototype._hash=function(){var t=new Buffer(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},module.exports=Sha;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"buffer":66,"inherits":144}],250:[function(require,module,exports){
(function (Buffer){
function Sha1(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl1(t){return t<<1|t>>>31}function rotl5(t){return t<<5|t>>>27}function rotl30(t){return t<<30|t>>>2}function ft(t,i,h,r){return 0===t?i&h|~i&r:2===t?i&h|i&r|h&r:i^h^r}var inherits=require("inherits"),Hash=require("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha1,Hash),Sha1.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha1.prototype._update=function(t){for(var i=this._w,h=0|this._a,r=0|this._b,s=0|this._c,n=0|this._d,e=0|this._e,_=0;_<16;++_)i[_]=t.readInt32BE(4*_);for(;_<80;++_)i[_]=rotl1(i[_-3]^i[_-8]^i[_-14]^i[_-16]);for(var a=0;a<80;++a){var o=~~(a/20),u=rotl5(h)+ft(o,r,s,n)+e+i[a]+K[o]|0;e=n,n=s,s=rotl30(r),r=h,h=u}this._a=h+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=n+this._d|0,this._e=e+this._e|0},Sha1.prototype._hash=function(){var t=new Buffer(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},module.exports=Sha1;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"buffer":66,"inherits":144}],251:[function(require,module,exports){
(function (Buffer){
function Sha224(){this.init(),this._w=W,Hash.call(this,64,56)}var inherits=require("inherits"),Sha256=require("./sha256"),Hash=require("./hash"),W=new Array(64);inherits(Sha224,Sha256),Sha224.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},Sha224.prototype._hash=function(){var t=new Buffer(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},module.exports=Sha224;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"./sha256":252,"buffer":66,"inherits":144}],252:[function(require,module,exports){
(function (Buffer){
function Sha256(){this.init(),this._w=W,Hash.call(this,64,56)}function ch(t,i,h){return h^t&(i^h)}function maj(t,i,h){return t&i|h&(t|i)}function sigma0(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function sigma1(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function gamma0(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function gamma1(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}var inherits=require("inherits"),Hash=require("./hash"),K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W=new Array(64);inherits(Sha256,Hash),Sha256.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},Sha256.prototype._update=function(t){for(var i=this._w,h=0|this._a,s=0|this._b,r=0|this._c,n=0|this._d,_=0|this._e,a=0|this._f,e=0|this._g,u=0|this._h,o=0;o<16;++o)i[o]=t.readInt32BE(4*o);for(;o<64;++o)i[o]=gamma1(i[o-2])+i[o-7]+gamma0(i[o-15])+i[o-16]|0;for(var f=0;f<64;++f){var c=u+sigma1(_)+ch(_,a,e)+K[f]+i[f]|0,m=sigma0(h)+maj(h,s,r)|0;u=e,e=a,a=_,_=n+c|0,n=r,r=s,s=h,h=c+m|0}this._a=h+this._a|0,this._b=s+this._b|0,this._c=r+this._c|0,this._d=n+this._d|0,this._e=_+this._e|0,this._f=a+this._f|0,this._g=e+this._g|0,this._h=u+this._h|0},Sha256.prototype._hash=function(){var t=new Buffer(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},module.exports=Sha256;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"buffer":66,"inherits":144}],253:[function(require,module,exports){
(function (Buffer){
function Sha384(){this.init(),this._w=W,Hash.call(this,128,112)}var inherits=require("inherits"),SHA512=require("./sha512"),Hash=require("./hash"),W=new Array(160);inherits(Sha384,SHA512),Sha384.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},Sha384.prototype._hash=function(){function h(h,i,s){t.writeInt32BE(h,s),t.writeInt32BE(i,s+4)}var t=new Buffer(48);return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),t},module.exports=Sha384;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"./sha512":254,"buffer":66,"inherits":144}],254:[function(require,module,exports){
(function (Buffer){
function Sha512(){this.init(),this._w=W,Hash.call(this,128,112)}function Ch(h,t,i){return i^h&(t^i)}function maj(h,t,i){return h&t|i&(h|t)}function sigma0(h,t){return(h>>>28|t<<4)^(t>>>2|h<<30)^(t>>>7|h<<25)}function sigma1(h,t){return(h>>>14|t<<18)^(h>>>18|t<<14)^(t>>>9|h<<23)}function Gamma0(h,t){return(h>>>1|t<<31)^(h>>>8|t<<24)^h>>>7}function Gamma0l(h,t){return(h>>>1|t<<31)^(h>>>8|t<<24)^(h>>>7|t<<25)}function Gamma1(h,t){return(h>>>19|t<<13)^(t>>>29|h<<3)^h>>>6}function Gamma1l(h,t){return(h>>>19|t<<13)^(t>>>29|h<<3)^(h>>>6|t<<26)}function getCarry(h,t){return h>>>0<t>>>0?1:0}var inherits=require("inherits"),Hash=require("./hash"),K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],W=new Array(160);inherits(Sha512,Hash),Sha512.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},Sha512.prototype._update=function(h){for(var t=this._w,i=0|this._ah,s=0|this._bh,_=0|this._ch,r=0|this._dh,a=0|this._eh,e=0|this._fh,l=0|this._gh,n=0|this._hh,g=0|this._al,f=0|this._bl,u=0|this._cl,c=0|this._dl,m=0|this._el,o=0|this._fl,y=0|this._gl,C=0|this._hl,d=0;d<32;d+=2)t[d]=h.readInt32BE(4*d),t[d+1]=h.readInt32BE(4*d+4);for(;d<160;d+=2){var b=t[d-30],p=t[d-30+1],v=Gamma0(b,p),G=Gamma0l(p,b);b=t[d-4],p=t[d-4+1];var w=Gamma1(b,p),S=Gamma1l(p,b),B=t[d-14],E=t[d-14+1],I=t[d-32],j=t[d-32+1],H=G+E|0,q=v+B+getCarry(H,G)|0;H=H+S|0,q=q+w+getCarry(H,S)|0,H=H+j|0,q=q+I+getCarry(H,j)|0,t[d]=q,t[d+1]=H}for(var W=0;W<160;W+=2){q=t[W],H=t[W+1];var x=maj(i,s,_),A=maj(g,f,u),k=sigma0(i,g),z=sigma0(g,i),D=sigma1(a,m),F=sigma1(m,a),J=K[W],L=K[W+1],M=Ch(a,e,l),N=Ch(m,o,y),O=C+F|0,P=n+D+getCarry(O,C)|0;O=O+N|0,P=P+M+getCarry(O,N)|0,O=O+L|0,P=P+J+getCarry(O,L)|0,O=O+H|0,P=P+q+getCarry(O,H)|0;var Q=z+A|0,R=k+x+getCarry(Q,z)|0;n=l,C=y,l=e,y=o,e=a,o=m,m=c+O|0,a=r+P+getCarry(m,c)|0,r=_,c=u,_=s,u=f,s=i,f=g,g=O+Q|0,i=P+R+getCarry(g,O)|0}this._al=this._al+g|0,this._bl=this._bl+f|0,this._cl=this._cl+u|0,this._dl=this._dl+c|0,this._el=this._el+m|0,this._fl=this._fl+o|0,this._gl=this._gl+y|0,this._hl=this._hl+C|0,this._ah=this._ah+i+getCarry(this._al,g)|0,this._bh=this._bh+s+getCarry(this._bl,f)|0,this._ch=this._ch+_+getCarry(this._cl,u)|0,this._dh=this._dh+r+getCarry(this._dl,c)|0,this._eh=this._eh+a+getCarry(this._el,m)|0,this._fh=this._fh+e+getCarry(this._fl,o)|0,this._gh=this._gh+l+getCarry(this._gl,y)|0,this._hh=this._hh+n+getCarry(this._hl,C)|0},Sha512.prototype._hash=function(){function h(h,i,s){t.writeInt32BE(h,s),t.writeInt32BE(i,s+4)}var t=new Buffer(64);return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),h(this._gh,this._gl,48),h(this._hh,this._hl,56),t},module.exports=Sha512;

}).call(this,require("buffer").Buffer)
},{"./hash":247,"buffer":66,"inherits":144}],255:[function(require,module,exports){
(function (Buffer){
module.exports=function(n,o){var u=[];n.on("data",function(n){u.push(n)}),n.once("end",function(){o&&o(null,Buffer.concat(u)),o=null}),n.once("error",function(n){o&&o(n),o=null})};
}).call(this,require("buffer").Buffer)
},{"buffer":66}],256:[function(require,module,exports){
(function (Buffer){
function simpleGet(e,t){e="string"==typeof e?{url:e}:Object.assign({},e),t=once(t),e.url&&parseOptsUrl(e),null==e.headers&&(e.headers={}),null==e.maxRedirects&&(e.maxRedirects=10);var r;e.form&&(r="string"==typeof e.form?e.form:querystring.stringify(e.form)),e.body&&(r=e.json?JSON.stringify(e.body):e.body),e.json&&(e.headers.accept="application/json"),e.json&&r&&(e.headers["content-type"]="application/json"),e.form&&(e.headers["content-type"]="application/x-www-form-urlencoded"),r&&!isStream(r)&&(e.headers["content-length"]=Buffer.byteLength(r)),delete e.body,delete e.form,r&&!e.method&&(e.method="POST"),e.method&&(e.method=e.method.toUpperCase()),Object.keys(e.headers).some(function(e){return"accept-encoding"===e.toLowerCase()})||(e.headers["accept-encoding"]="gzip, deflate");var o="https:"===e.protocol?https:http,n=o.request(e,function(r){if(r.statusCode>=300&&r.statusCode<400&&"location"in r.headers)return e.url=r.headers.location,r.resume(),void(e.maxRedirects>0?(e.maxRedirects-=1,simpleGet(e,t)):t(new Error("too many redirects")));var o="function"==typeof unzipResponse&&"HEAD"!==e.method;t(null,o?unzipResponse(r):r)});return n.on("timeout",function(){n.abort(),t(new Error("Request timed out"))}),n.on("error",t),r&&isStream(r)?r.on("error",t).pipe(n):n.end(r),n}function parseOptsUrl(e){var t=url.parse(e.url);t.hostname&&(e.hostname=t.hostname),t.port&&(e.port=t.port),t.protocol&&(e.protocol=t.protocol),t.auth&&(e.auth=t.auth),e.path=t.path,delete e.url}function isStream(e){return"function"==typeof e.pipe}module.exports=simpleGet;var concat=require("simple-concat"),http=require("http"),https=require("https"),once=require("once"),querystring=require("querystring"),unzipResponse=require("unzip-response"),url=require("url");simpleGet.concat=function(e,t){return simpleGet(e,function(r,o){if(r)return t(r);concat(o,function(r,n){if(r)return t(r);if(e.json)try{n=JSON.parse(n.toString())}catch(r){return t(r,o,n)}t(null,o,n)})})},["get","post","put","patch","head","delete"].forEach(function(e){simpleGet[e]=function(t,r){return"string"==typeof t&&(t={url:t}),t.method=e.toUpperCase(),simpleGet(t,r)}});

}).call(this,require("buffer").Buffer)
},{"buffer":66,"http":270,"https":140,"once":186,"querystring":217,"simple-concat":255,"unzip-response":37,"url":295}],257:[function(require,module,exports){
(function (Buffer){
function Peer(e){var n=this;if(!(n instanceof Peer))return new Peer(e);if(n._id=randombytes(4).toString("hex").slice(0,7),n._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),stream.Duplex.call(n,e),n.channelName=e.initiator?e.channelName||randombytes(20).toString("hex"):null,n._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,n.initiator=e.initiator||!1,n.channelConfig=e.channelConfig||Peer.channelConfig,n.config=e.config||Peer.config,n.constraints=n._transformConstraints(e.constraints||Peer.constraints),n.offerConstraints=n._transformConstraints(e.offerConstraints||{}),n.answerConstraints=n._transformConstraints(e.answerConstraints||{}),n.reconnectTimer=e.reconnectTimer||!1,n.sdpTransform=e.sdpTransform||function(e){return e},n.stream=e.stream||!1,n.trickle=void 0===e.trickle||e.trickle,n.destroyed=!1,n.connected=!1,n.remoteAddress=void 0,n.remoteFamily=void 0,n.remotePort=void 0,n.localAddress=void 0,n.localPort=void 0,n._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:getBrowserRTC(),!n._wrtc)throw"undefined"==typeof window?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser");if(n._pcReady=!1,n._channelReady=!1,n._iceComplete=!1,n._channel=null,n._pendingCandidates=[],n._previousStreams=[],n._chunk=null,n._cb=null,n._interval=null,n._reconnectTimeout=null,n._pc=new n._wrtc.RTCPeerConnection(n.config,n.constraints),n._isWrtc=Array.isArray(n._pc.RTCIceConnectionStates),n._isReactNativeWebrtc="number"==typeof n._pc._peerConnectionId,n._pc.oniceconnectionstatechange=function(){n._onIceConnectionStateChange()},n._pc.onsignalingstatechange=function(){n._onSignalingStateChange()},n._pc.onicecandidate=function(e){n._onIceCandidate(e)},n.initiator){var t=!1;n._pc.onnegotiationneeded=function(){t||n._createOffer(),t=!0},n._setupData({channel:n._pc.createDataChannel(n.channelName,n.channelConfig)})}else n._pc.ondatachannel=function(e){n._setupData(e)};"addTrack"in n._pc?(n.stream&&n.stream.getTracks().forEach(function(e){n._pc.addTrack(e,n.stream)}),n._pc.ontrack=function(e){n._onTrack(e)}):(n.stream&&n._pc.addStream(n.stream),n._pc.onaddstream=function(e){n._onAddStream(e)}),n.initiator&&n._isWrtc&&n._pc.onnegotiationneeded(),n._onFinishBound=function(){n._onFinish()},n.once("finish",n._onFinishBound)}function noop(){}module.exports=Peer;var debug=require("debug")("simple-peer"),getBrowserRTC=require("get-browser-rtc"),inherits=require("inherits"),randombytes=require("randombytes"),stream=require("readable-stream"),MAX_BUFFERED_AMOUNT=65536;inherits(Peer,stream.Duplex),Peer.WEBRTC_SUPPORT=!!getBrowserRTC(),Peer.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},Peer.constraints={},Peer.channelConfig={},Object.defineProperty(Peer.prototype,"bufferSize",{get:function(){var e=this;return e._channel&&e._channel.bufferedAmount||0}}),Peer.prototype.address=function(){var e=this;return{port:e.localPort,family:"IPv4",address:e.localAddress}},Peer.prototype.signal=function(e){var n=this;if(n.destroyed)throw new Error("cannot signal after peer is destroyed");if("string"==typeof e)try{e=JSON.parse(e)}catch(n){e={}}n._debug("signal()"),e.candidate&&(n._pc.remoteDescription?n._addIceCandidate(e.candidate):n._pendingCandidates.push(e.candidate)),e.sdp&&n._pc.setRemoteDescription(new n._wrtc.RTCSessionDescription(e),function(){n.destroyed||(n._pendingCandidates.forEach(function(e){n._addIceCandidate(e)}),n._pendingCandidates=[],"offer"===n._pc.remoteDescription.type&&n._createAnswer())},function(e){n._onError(e)}),e.sdp||e.candidate||n._destroy(new Error("signal() called with invalid signal data"))},Peer.prototype._addIceCandidate=function(e){var n=this;try{n._pc.addIceCandidate(new n._wrtc.RTCIceCandidate(e),noop,function(e){n._onError(e)})}catch(e){n._destroy(new Error("error adding candidate: "+e.message))}},Peer.prototype.send=function(e){var n=this;n._isWrtc&&Buffer.isBuffer(e)&&(e=new Uint8Array(e)),n._channel.send(e)},Peer.prototype.destroy=function(e){this._destroy(null,e)},Peer.prototype._destroy=function(e,n){var t=this;if(!t.destroyed){if(n&&t.once("close",n),t._debug("destroy (error: %s)",e&&e.message),t.readable=t.writable=!1,t._readableState.ended||t.push(null),t._writableState.finished||t.end(),t.destroyed=!0,t.connected=!1,t._pcReady=!1,t._channelReady=!1,t._previousStreams=null,clearInterval(t._interval),clearTimeout(t._reconnectTimeout),t._interval=null,t._reconnectTimeout=null,t._chunk=null,t._cb=null,t._onFinishBound&&t.removeListener("finish",t._onFinishBound),t._onFinishBound=null,t._pc){try{t._pc.close()}catch(e){}t._pc.oniceconnectionstatechange=null,t._pc.onsignalingstatechange=null,t._pc.onicecandidate=null,"addTrack"in t._pc?t._pc.ontrack=null:t._pc.onaddstream=null,t._pc.onnegotiationneeded=null,t._pc.ondatachannel=null}if(t._channel){try{t._channel.close()}catch(e){}t._channel.onmessage=null,t._channel.onopen=null,t._channel.onclose=null}t._pc=null,t._channel=null,e&&t.emit("error",e),t.emit("close")}},Peer.prototype._setupData=function(e){var n=this;n._channel=e.channel,n._channel.binaryType="arraybuffer","number"==typeof n._channel.bufferedAmountLowThreshold&&(n._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),n.channelName=n._channel.label,n._channel.onmessage=function(e){n._onChannelMessage(e)},n._channel.onbufferedamountlow=function(){n._onChannelBufferedAmountLow()},n._channel.onopen=function(){n._onChannelOpen()},n._channel.onclose=function(){n._onChannelClose()}},Peer.prototype._read=function(){},Peer.prototype._write=function(e,n,t){var o=this;if(o.destroyed)return t(new Error("cannot write after peer is destroyed"));if(o.connected){try{o.send(e)}catch(e){return o._onError(e)}o._channel.bufferedAmount>MAX_BUFFERED_AMOUNT?(o._debug("start backpressure: bufferedAmount %d",o._channel.bufferedAmount),o._cb=t):t(null)}else o._debug("write before connect"),o._chunk=e,o._cb=t},Peer.prototype._onFinish=function(){function e(){setTimeout(function(){n._destroy()},100)}var n=this;n.destroyed||(n.connected?e():n.once("connect",e))},Peer.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(n){if(!e.destroyed){n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,noop,function(n){e._onError(n)});var t=function(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})};e.trickle||e._iceComplete?t():e.once("_iceComplete",t)}},function(n){e._onError(n)},e.offerConstraints)},Peer.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(n){function t(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})}e.destroyed||(n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,noop,function(n){e._onError(n)}),e.trickle||e._iceComplete?t():e.once("_iceComplete",t))},function(n){e._onError(n)},e.answerConstraints)},Peer.prototype._onIceConnectionStateChange=function(){var e=this;if(!e.destroyed){var n=e._pc.iceGatheringState,t=e._pc.iceConnectionState;e._debug("iceConnectionStateChange %s %s",n,t),e.emit("iceConnectionStateChange",n,t),"connected"!==t&&"completed"!==t||(clearTimeout(e._reconnectTimeout),e._pcReady=!0,e._maybeReady()),"disconnected"===t&&(e.reconnectTimer?(clearTimeout(e._reconnectTimeout),e._reconnectTimeout=setTimeout(function(){e._destroy()},e.reconnectTimer)):e._destroy()),"failed"===t&&e._destroy(new Error("Ice connection failed.")),"closed"===t&&e._destroy()}},Peer.prototype.getStats=function(e){var n=this;0===n._pc.getStats.length?n._pc.getStats().then(function(n){var t=[];n.forEach(function(e){t.push(e)}),e(t)},function(e){n._onError(e)}):n._isReactNativeWebrtc?n._pc.getStats(null,function(n){var t=[];n.forEach(function(e){t.push(e)}),e(t)},function(e){n._onError(e)}):n._pc.getStats.length>0?n._pc.getStats(function(n){var t=[];n.result().forEach(function(e){var n={};e.names().forEach(function(t){n[t]=e.stat(t)}),n.id=e.id,n.type=e.type,n.timestamp=e.timestamp,t.push(n)}),e(t)},function(e){n._onError(e)}):e([])},Peer.prototype._maybeReady=function(){var e=this;e._debug("maybeReady pc %s channel %s",e._pcReady,e._channelReady),!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,e.getStats(function(n){function t(n){var t=r[n.localCandidateId];t&&t.ip?(e.localAddress=t.ip,e.localPort=Number(t.port)):t&&t.ipAddress?(e.localAddress=t.ipAddress,e.localPort=Number(t.portNumber)):"string"==typeof n.googLocalAddress&&(t=n.googLocalAddress.split(":"),e.localAddress=t[0],e.localPort=Number(t[1]));var i=o[n.remoteCandidateId];i&&i.ip?(e.remoteAddress=i.ip,e.remotePort=Number(i.port)):i&&i.ipAddress?(e.remoteAddress=i.ipAddress,e.remotePort=Number(i.portNumber)):"string"==typeof n.googRemoteAddress&&(i=n.googRemoteAddress.split(":"),e.remoteAddress=i[0],e.remotePort=Number(i[1])),e.remoteFamily="IPv4",e._debug("connect local: %s:%s remote: %s:%s",e.localAddress,e.localPort,e.remoteAddress,e.remotePort)}e._connecting=!1,e.connected=!0;var o={},r={},i={};if(n.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(o[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(r[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(i[e.id]=e)}),n.forEach(function(e){"transport"===e.type&&t(i[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&t(e)}),e._chunk){try{e.send(e._chunk)}catch(n){return e._onError(n)}e._chunk=null,e._debug('sent chunk from "write before connect"');var a=e._cb;e._cb=null,a(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}))},Peer.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT||this._onChannelBufferedAmountLow()},Peer.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||(e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},Peer.prototype._onIceCandidate=function(e){var n=this;n.destroyed||(e.candidate&&n.trickle?n.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||(n._iceComplete=!0,n.emit("_iceComplete")))},Peer.prototype._onChannelMessage=function(e){var n=this;if(!n.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Buffer(t)),n.push(t)}},Peer.prototype._onChannelBufferedAmountLow=function(){var e=this;if(!e.destroyed&&e._cb){e._debug("ending backpressure: bufferedAmount %d",e._channel.bufferedAmount);var n=e._cb;e._cb=null,n(null)}},Peer.prototype._onChannelOpen=function(){var e=this;e.connected||e.destroyed||(e._debug("on channel open"),e._channelReady=!0,e._maybeReady())},Peer.prototype._onChannelClose=function(){var e=this;e.destroyed||(e._debug("on channel close"),e._destroy())},Peer.prototype._onAddStream=function(e){var n=this;n.destroyed||(n._debug("on add stream"),n.emit("stream",e.stream))},Peer.prototype._onTrack=function(e){var n=this;if(!n.destroyed){n._debug("on track");var t=e.streams[0].id;-1===n._previousStreams.indexOf(t)&&(n._previousStreams.push(t),n.emit("stream",e.streams[0]))}},Peer.prototype._onError=function(e){var n=this;n.destroyed||(n._debug("error %s",e.message||e),n._destroy(e))},Peer.prototype._debug=function(){var e=this,n=[].slice.call(arguments);n[0]="["+e._id+"] "+n[0],debug.apply(null,n)},Peer.prototype._transformConstraints=function(e){var n=this;if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!n._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!n._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"debug":88,"get-browser-rtc":125,"inherits":144,"randombytes":223,"readable-stream":235}],258:[function(require,module,exports){
function sha1sync(t){return rusha.digest(t)}function sha1(t,n){if(!subtle)return void setTimeout(n,0,sha1sync(t));"string"==typeof t&&(t=uint8array(t)),subtle.digest({name:"sha-1"},t).then(function(t){n(hex(new Uint8Array(t)))},function(e){n(sha1sync(t))})}function uint8array(t){for(var n=t.length,e=new Uint8Array(n),r=0;r<n;r++)e[r]=t.charCodeAt(r);return e}function hex(t){for(var n=t.length,e=[],r=0;r<n;r++){var s=t[r];e.push((s>>>4).toString(16)),e.push((15&s).toString(16))}return e.join("")}var Rusha=require("rusha"),rusha=new Rusha,scope="undefined"!=typeof window?window:self,crypto=scope.crypto||scope.msCrypto||{},subtle=crypto.subtle||crypto.webkitSubtle;try{subtle.digest({name:"sha-1"},new Uint8Array).catch(function(){subtle=!1})}catch(t){subtle=!1}module.exports=sha1,module.exports.sync=sha1sync;

},{"rusha":243}],259:[function(require,module,exports){
(function (process){
function Socket(e){var t=this;if(!(t instanceof Socket))return new Socket(e);if(e||(e={}),"string"==typeof e&&(e={url:e}),null==e.url&&null==e.socket)throw new Error("Missing required `url` or `socket` option");if(null!=e.url&&null!=e.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(t._id=randombytes(4).toString("hex").slice(0,7),t._debug("new websocket: %o",e),e=Object.assign({allowHalfOpen:!1},e),stream.Duplex.call(t,e),t.connected=!1,t.destroyed=!1,t._chunk=null,t._cb=null,t._interval=null,e.socket)t.url=e.socket.url,t._ws=e.socket;else{t.url=e.url;try{t._ws="function"==typeof ws?new _WebSocket(e.url,e):new _WebSocket(e.url)}catch(e){return void process.nextTick(function(){t._destroy(e)})}}t._ws.binaryType="arraybuffer",t._ws.onopen=function(){t._onOpen()},t._ws.onmessage=function(e){t._onMessage(e)},t._ws.onclose=function(){t._onClose()},t._ws.onerror=function(){t._destroy(new Error("connection error to "+t.url))},t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}module.exports=Socket;var Buffer=require("safe-buffer").Buffer,debug=require("debug")("simple-websocket"),inherits=require("inherits"),randombytes=require("randombytes"),stream=require("readable-stream"),ws=require("ws"),_WebSocket="function"!=typeof ws?WebSocket:ws,MAX_BUFFERED_AMOUNT=65536;inherits(Socket,stream.Duplex),Socket.WEBSOCKET_SUPPORT=!!_WebSocket,Socket.prototype.send=function(e){this._ws.send(e)},Socket.prototype.destroy=function(e){this._destroy(null,e)},Socket.prototype._destroy=function(e,t){var n=this;if(!n.destroyed){if(t&&n.once("close",t),n._debug("destroy (error: %s)",e&&(e.message||e)),n.readable=n.writable=!1,n._readableState.ended||n.push(null),n._writableState.finished||n.end(),n.connected=!1,n.destroyed=!0,clearInterval(n._interval),n._interval=null,n._chunk=null,n._cb=null,n._onFinishBound&&n.removeListener("finish",n._onFinishBound),n._onFinishBound=null,n._ws){var o=n._ws,r=function(){o.onclose=null};if(o.readyState===_WebSocket.CLOSED)r();else try{o.onclose=r,o.close()}catch(e){r()}o.onopen=null,o.onmessage=null,o.onerror=null}n._ws=null,e&&n.emit("error",e),n.emit("close")}},Socket.prototype._read=function(){},Socket.prototype._write=function(e,t,n){if(this.destroyed)return n(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(e){return this._destroy(e)}"function"!=typeof ws&&this._ws.bufferedAmount>MAX_BUFFERED_AMOUNT?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},Socket.prototype._onFinish=function(){function e(){setTimeout(function(){t._destroy()},1e3)}var t=this;t.destroyed||(t.connected?e():t.once("connect",e))},Socket.prototype._onMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=Buffer.from(t)),this.push(t)}},Socket.prototype._onOpen=function(){var e=this;if(!e.connected&&!e.destroyed){if(e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(t){return e._destroy(t)}e._chunk=null,e._debug('sent chunk from "write before connect"');var t=e._cb;e._cb=null,t(null)}"function"!=typeof ws&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}},Socket.prototype._onInterval=function(){if(this._cb&&this._ws&&!(this._ws.bufferedAmount>MAX_BUFFERED_AMOUNT)){this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);var e=this._cb;this._cb=null,e(null)}},Socket.prototype._onClose=function(){this.destroyed||(this._debug("on close"),this._destroy())},Socket.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],debug.apply(null,e)};
}).call(this,require('_process'))
},{"_process":205,"debug":88,"inherits":144,"randombytes":223,"readable-stream":235,"safe-buffer":244,"ws":37}],260:[function(require,module,exports){
function ready(A){return A||(A=noop),siphash24.WASM_SUPPORTED?(rdy||(rdy=WebAssembly.instantiate(WASM).then(setup)),rdy.then(A).catch(A)):A()}function siphash24(A,I,h,E){return h||(h=new Uint8Array(8)),!0!==E&&(assert(h.length>=BYTES,"output must be at least "+BYTES),assert(I.length>=KEYBYTES,"key must be at least "+KEYBYTES)),mod?(mem.set(I,8),mem.set(A,24),mod.siphash(24,A.length),h.set(mem.subarray(0,8))):fallback(h,A,I),h}function noop(){}function setup(A){mod=A.instance.exports,mem=new Uint8Array(A.instance.exports.memory.buffer)}function _add(A,I){var h=A.l+I.l,E={h:A.h+I.h+(h/2>>>31)>>>0,l:h>>>0};A.h=E.h,A.l=E.l}function _xor(A,I){A.h^=I.h,A.h>>>=0,A.l^=I.l,A.l>>>=0}function _rotl(A,I){var h={h:A.h<<I|A.l>>>32-I,l:A.l<<I|A.h>>>32-I};A.h=h.h,A.l=h.l}function _rotl32(A){var I=A.l;A.l=A.h,A.h=I}function _compress(A,I,h,E){_add(A,I),_add(h,E),_rotl(I,13),_rotl(E,16),_xor(I,A),_xor(E,h),_rotl32(A),_add(h,I),_add(A,E),_rotl(I,17),_rotl(E,21),_xor(I,h),_xor(E,A),_rotl32(h)}function _get_int(A,I){return A[I+3]<<24|A[I+2]<<16|A[I+1]<<8|A[I]}function fallback(A,I,h){var E,g={h:_get_int(h,4),l:_get_int(h,0)},C={h:_get_int(h,12),l:_get_int(h,8)},Q={h:g.h,l:g.l},r=g,B={h:C.h,l:C.l},i=C,o=0,t=I.length,e=t-7,s=new Uint8Array(new ArrayBuffer(8));for(_xor(Q,{h:1936682341,l:1886610805}),_xor(B,{h:1685025377,l:1852075885}),_xor(r,{h:1819895653,l:1852142177}),_xor(i,{h:1952801890,l:2037671283});o<e;)E={h:_get_int(I,o+4),l:_get_int(I,o)},_xor(i,E),_compress(Q,B,r,i),_compress(Q,B,r,i),_xor(Q,E),o+=8;s[7]=t;for(var S=0;o<t;)s[S++]=I[o++];for(;S<7;)s[S++]=0;E={h:s[7]<<24|s[6]<<16|s[5]<<8|s[4],l:s[3]<<24|s[2]<<16|s[1]<<8|s[0]},_xor(i,E),_compress(Q,B,r,i),_compress(Q,B,r,i),_xor(Q,E),_xor(r,{h:0,l:255}),_compress(Q,B,r,i),_compress(Q,B,r,i),_compress(Q,B,r,i),_compress(Q,B,r,i);var a=Q;_xor(a,B),_xor(a,r),_xor(a,i),A[0]=255&a.l,A[1]=a.l>>8&255,A[2]=a.l>>16&255,A[3]=a.l>>24&255,A[4]=255&a.h,A[5]=a.h>>8&255,A[6]=a.h>>16&255,A[7]=a.h>>24&255}var toUint8Array=require("base64-to-uint8array"),assert=require("nanoassert"),WASM=toUint8Array("AGFzbQEAAAABBgFgAn9/AAMCAQAFBAEBCgoHFAIGbWVtb3J5AgAHc2lwaGFzaAAACu8IAewIAgh+An9C9crNg9es27fzACECQu3ekfOWzNy35AAhA0Lh5JXz1uzZvOwAIQRC88rRy6eM2bL0ACEFQQgpAwAhB0EQKQMAIQggAa1COIYhBiABQQdxIQsgACABaiALayEKIAUgCIUhBSAEIAeFIQQgAyAIhSEDIAIgB4UhAgJAA0AgACAKRg0BIAApAwAhCSAFIAmFIQUgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgCYUhAiAAQQhqIQAMAAsLAkACQAJAAkACQAJAAkACQCALDgcHBgUEAwIBAAsgBiAAQQZqMQAAQjCGhCEGCyAGIABBBWoxAABCKIaEIQYLIAYgAEEEajEAAEIghoQhBgsgBiAAQQNqMQAAQhiGhCEGCyAGIABBAmoxAABCEIaEIQYLIAYgAEEBajEAAEIIhoQhBgsgBiAAMQAAhCEGCyAFIAaFIQUgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgBoUhAiAEQv8BhSEEIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQRBACACIAMgBCAFhYWFNwMACw=="),mod,mem,rdy;module.exports=siphash24;var BYTES=siphash24.BYTES=8,KEYBYTES=siphash24.KEYBYTES=16;siphash24.WASM_SUPPORTED="undefined"!=typeof WebAssembly,siphash24.WASM_LOADED=!1,siphash24.ready=ready,ready(function(){siphash24.WASM_LOADED=!!mod});

},{"base64-to-uint8array":17,"nanoassert":183}],261:[function(require,module,exports){
var blake2b=require("blake2b");module.exports.crypto_generichash_PRIMITIVE="blake2b",module.exports.crypto_generichash_BYTES_MIN=blake2b.BYTES_MIN,module.exports.crypto_generichash_BYTES_MAX=blake2b.BYTES_MAX,module.exports.crypto_generichash_BYTES=blake2b.BYTES,module.exports.crypto_generichash_KEYBYTES_MIN=blake2b.KEYBYTES_MIN,module.exports.crypto_generichash_KEYBYTES_MAX=blake2b.KEYBYTES_MAX,module.exports.crypto_generichash_KEYBYTES=blake2b.KEYBYTES,module.exports.crypto_generichash_WASM_SUPPORTED=blake2b.WASM_SUPPORTED,module.exports.crypto_generichash_WASM_LOADED=!1,module.exports.crypto_generichash=function(e,r,o){blake2b(e.length,o).update(r).final(e)},module.exports.crypto_generichash_ready=blake2b.ready,module.exports.crypto_generichash_batch=function(e,r,o){for(var a=blake2b(e.length,o),t=0;t<r.length;t++)a.update(r[t]);a.final(e)},module.exports.crypto_generichash_instance=function(e,r){return null==r&&(r=module.exports.crypto_generichash_BYTES),blake2b(r,e)},blake2b.ready(function(e){module.exports.crypto_generichash_WASM_LOADED=blake2b.WASM_LOADED});

},{"blake2b":32}],262:[function(require,module,exports){
function STORE64_LE(e,t){var r=1,o=0;for(e[0]=255&t;++o<8&&(r*=256);)e[o]=t/r&255}var assert=require("nanoassert"),randombytes_buf=require("./randombytes").randombytes_buf,blake2b=require("blake2b");module.exports.crypto_kdf_PRIMITIVE="blake2b",module.exports.crypto_kdf_BYTES_MIN=16,module.exports.crypto_kdf_BYTES_MAX=64,module.exports.crypto_kdf_CONTEXTBYTES=8,module.exports.crypto_kdf_KEYBYTES=64,module.exports.crypto_kdf_derive_from_key=function(e,t,r,o){assert(e.length>=module.exports.crypto_kdf_BYTES_MIN,"subkey must be at least crypto_kdf_BYTES_MIN"),assert(t>=0&&t<=9007199254740991,"subkey_id must be safe integer"),assert(r.length>=module.exports.crypto_kdf_CONTEXTBYTES,"context must be at least crypto_kdf_CONTEXTBYTES");var _=new Uint8Array(blake2b.PERSONALBYTES),s=new Uint8Array(blake2b.SALTBYTES);_.set(r,0,module.exports.crypto_kdf_CONTEXTBYTES),STORE64_LE(s,t);var d=Math.min(e.length,module.exports.crypto_kdf_BYTES_MAX);blake2b(d,o,s,_,!0).final(e)},module.exports.crypto_kdf_keygen=function(e){assert(e.length>=module.exports.crypto_kdf_KEYBYTES,"out.length must be crypto_kdf_KEYBYTES"),randombytes_buf(e.subarray(0,module.exports.crypto_kdf_KEYBYTES))};

},{"./randombytes":266,"blake2b":32,"nanoassert":183}],263:[function(require,module,exports){
function shorthash(h,s,r,o){siphash(s,r,h,o)}var siphash=require("siphash24");exports.crypto_shorthash_PRIMITIVE="siphash24",exports.crypto_shorthash_BYTES=siphash.BYTES,exports.crypto_shorthash_KEYBYTES=siphash.KEYBYTES,exports.crypto_shorthash_WASM_SUPPORTED=siphash.WASM_SUPPORTED,exports.crypto_shorthash_WASM_LOADED=siphash.WASM_LOADED,exports.crypto_shorthash_ready=siphash.ready,exports.crypto_shorthash=shorthash,siphash.ready(function(){exports.crypto_shorthash_WASM_LOADED=siphash.WASM_LOADED});

},{"siphash24":260}],264:[function(require,module,exports){
function XOR(t,s){this._instance=xsalsa20(t,s)}var xsalsa20=require("xsalsa20");exports.crypto_stream_KEYBYTES=32,exports.crypto_stream_NONCEBYTES=24,exports.crypto_stream_PRIMITIVE="xsalsa20",exports.crypto_stream=function(t,s,r){t.fill(0),exports.crypto_stream_xor(t,t,s,r)},exports.crypto_stream_xor=function(t,s,r,a){var e=xsalsa20(r,a);e.update(s,t),e.final()},exports.crypto_stream_xor_instance=function(t,s){return new XOR(t,s)},XOR.prototype.update=function(t,s){this._instance.update(s,t)},XOR.prototype.final=function(){this._instance.finalize(),this._instance=null};
},{"xsalsa20":322}],265:[function(require,module,exports){
"use strict";function ts64(r,t,o,e){r[t]=o>>24&255,r[t+1]=o>>16&255,r[t+2]=o>>8&255,r[t+3]=255&o,r[t+4]=e>>24&255,r[t+5]=e>>16&255,r[t+6]=e>>8&255,r[t+7]=255&e}function vn(r,t,o,e,s){var c,h=0;for(c=0;c<s;c++)h|=r[t+c]^o[e+c];return(1&h-1>>>8)-1}function crypto_verify_16(r,t,o,e){return vn(r,t,o,e,16)}function crypto_verify_32(r,t,o,e){return vn(r,t,o,e,32)}function crypto_stream_xor(r,t,o,e,s,c,h){cs.crypto_stream_xor(r,o,c,h)}function crypto_stream(r,t,o,e,s){cs.crypto_stream(r,e,s)}function crypto_onetimeauth(r,t,o,e,s,c){var h=new poly1305(c);return h.update(o,e,s),h.finish(r,t),0}function crypto_onetimeauth_verify(r,t,o,e,s,c){var h=new Uint8Array(16);return crypto_onetimeauth(h,0,o,e,s,c),crypto_verify_16(r,t,h,0)}function crypto_secretbox(r,t,o,e,s){var c;if(o<32)return-1;for(crypto_stream_xor(r,0,t,0,o,e,s),crypto_onetimeauth(r,16,r,32,o-32,r),c=0;c<16;c++)r[c]=0;return 0}function crypto_secretbox_open(r,t,o,e,s){var c,h=new Uint8Array(32);if(o<32)return-1;if(crypto_stream(h,0,32,e,s),0!==crypto_onetimeauth_verify(t,16,t,32,o-32,h))return-1;for(crypto_stream_xor(r,0,t,0,o,e,s),c=0;c<32;c++)r[c]=0;return 0}function set25519(r,t){var o;for(o=0;o<16;o++)r[o]=0|t[o]}function car25519(r){var t,o,e=1;for(t=0;t<16;t++)o=r[t]+e+65535,e=Math.floor(o/65536),r[t]=o-65536*e;r[0]+=e-1+37*(e-1)}function sel25519(r,t,o){for(var e,s=~(o-1),c=0;c<16;c++)e=s&(r[c]^t[c]),r[c]^=e,t[c]^=e}function pack25519(r,t){var o,e,s,c=gf(),h=gf();for(o=0;o<16;o++)h[o]=t[o];for(car25519(h),car25519(h),car25519(h),e=0;e<2;e++){for(c[0]=h[0]-65517,o=1;o<15;o++)c[o]=h[o]-65535-(c[o-1]>>16&1),c[o-1]&=65535;c[15]=h[15]-32767-(c[14]>>16&1),s=c[15]>>16&1,c[14]&=65535,sel25519(h,c,1-s)}for(o=0;o<16;o++)r[2*o]=255&h[o],r[2*o+1]=h[o]>>8}function neq25519(r,t){var o=new Uint8Array(32),e=new Uint8Array(32);return pack25519(o,r),pack25519(e,t),crypto_verify_32(o,0,e,0)}function par25519(r){var t=new Uint8Array(32);return pack25519(t,r),1&t[0]}function unpack25519(r,t){var o;for(o=0;o<16;o++)r[o]=t[2*o]+(t[2*o+1]<<8);r[15]&=32767}function A(r,t,o){for(var e=0;e<16;e++)r[e]=t[e]+o[e]}function Z(r,t,o){for(var e=0;e<16;e++)r[e]=t[e]-o[e]}function M(r,t,o){var e,s,c=0,h=0,i=0,n=0,a=0,f=0,_=0,y=0,p=0,u=0,g=0,l=0,E=0,d=0,S=0,Y=0,b=0,B=0,m=0,T=0,v=0,M=0,A=0,x=0,k=0,w=0,U=0,O=0,C=0,R=0,Z=0,K=o[0],L=o[1],N=o[2],I=o[3],q=o[4],X=o[5],D=o[6],F=o[7],P=o[8],j=o[9],z=o[10],G=o[11],H=o[12],J=o[13],Q=o[14],V=o[15];e=t[0],c+=e*K,h+=e*L,i+=e*N,n+=e*I,a+=e*q,f+=e*X,_+=e*D,y+=e*F,p+=e*P,u+=e*j,g+=e*z,l+=e*G,E+=e*H,d+=e*J,S+=e*Q,Y+=e*V,e=t[1],h+=e*K,i+=e*L,n+=e*N,a+=e*I,f+=e*q,_+=e*X,y+=e*D,p+=e*F,u+=e*P,g+=e*j,l+=e*z,E+=e*G,d+=e*H,S+=e*J,Y+=e*Q,b+=e*V,e=t[2],i+=e*K,n+=e*L,a+=e*N,f+=e*I,_+=e*q,y+=e*X,p+=e*D,u+=e*F,g+=e*P,l+=e*j,E+=e*z,d+=e*G,S+=e*H,Y+=e*J,b+=e*Q,B+=e*V,e=t[3],n+=e*K,a+=e*L,f+=e*N,_+=e*I,y+=e*q,p+=e*X,u+=e*D,g+=e*F,l+=e*P,E+=e*j,d+=e*z,S+=e*G,Y+=e*H,b+=e*J,B+=e*Q,m+=e*V,e=t[4],a+=e*K,f+=e*L,_+=e*N,y+=e*I,p+=e*q,u+=e*X,g+=e*D,l+=e*F,E+=e*P,d+=e*j,S+=e*z,Y+=e*G,b+=e*H,B+=e*J,m+=e*Q,T+=e*V,e=t[5],f+=e*K,_+=e*L,y+=e*N,p+=e*I,u+=e*q,g+=e*X,l+=e*D,E+=e*F,d+=e*P,S+=e*j,Y+=e*z,b+=e*G,B+=e*H,m+=e*J,T+=e*Q,v+=e*V,e=t[6],_+=e*K,y+=e*L,p+=e*N,u+=e*I,g+=e*q,l+=e*X,E+=e*D,d+=e*F,S+=e*P,Y+=e*j,b+=e*z,B+=e*G,m+=e*H,T+=e*J,v+=e*Q,M+=e*V,e=t[7],y+=e*K,p+=e*L,u+=e*N,g+=e*I,l+=e*q,E+=e*X,d+=e*D,S+=e*F,Y+=e*P,b+=e*j,B+=e*z,m+=e*G,T+=e*H,v+=e*J,M+=e*Q,A+=e*V,e=t[8],p+=e*K,u+=e*L,g+=e*N,l+=e*I,E+=e*q,d+=e*X,S+=e*D,Y+=e*F,b+=e*P,B+=e*j,m+=e*z,T+=e*G,v+=e*H,M+=e*J,A+=e*Q,x+=e*V,e=t[9],u+=e*K,g+=e*L,l+=e*N,E+=e*I,d+=e*q,S+=e*X,Y+=e*D,b+=e*F,B+=e*P,m+=e*j,T+=e*z,v+=e*G,M+=e*H,A+=e*J,x+=e*Q,k+=e*V,e=t[10],g+=e*K,l+=e*L,E+=e*N,d+=e*I,S+=e*q,Y+=e*X,b+=e*D,B+=e*F,m+=e*P,T+=e*j,v+=e*z,M+=e*G,A+=e*H,x+=e*J,k+=e*Q,w+=e*V,e=t[11],l+=e*K,E+=e*L,d+=e*N,S+=e*I,Y+=e*q,b+=e*X,B+=e*D,m+=e*F,T+=e*P,v+=e*j,M+=e*z,A+=e*G;x+=e*H,k+=e*J,w+=e*Q,U+=e*V,e=t[12],E+=e*K,d+=e*L,S+=e*N,Y+=e*I,b+=e*q,B+=e*X,m+=e*D,T+=e*F,v+=e*P,M+=e*j,A+=e*z,x+=e*G,k+=e*H,w+=e*J,U+=e*Q,O+=e*V,e=t[13],d+=e*K,S+=e*L,Y+=e*N,b+=e*I,B+=e*q,m+=e*X,T+=e*D,v+=e*F,M+=e*P,A+=e*j,x+=e*z,k+=e*G,w+=e*H,U+=e*J,O+=e*Q,C+=e*V,e=t[14],S+=e*K,Y+=e*L,b+=e*N,B+=e*I,m+=e*q,T+=e*X,v+=e*D,M+=e*F,A+=e*P,x+=e*j,k+=e*z,w+=e*G,U+=e*H,O+=e*J,C+=e*Q,R+=e*V,e=t[15],Y+=e*K,b+=e*L,B+=e*N,m+=e*I,T+=e*q,v+=e*X,M+=e*D,A+=e*F,x+=e*P,k+=e*j,w+=e*z,U+=e*G,O+=e*H,C+=e*J,R+=e*Q,Z+=e*V,c+=38*b,h+=38*B,i+=38*m,n+=38*T,a+=38*v,f+=38*M,_+=38*A,y+=38*x,p+=38*k,u+=38*w,g+=38*U,l+=38*O,E+=38*C,d+=38*R,S+=38*Z,s=1,e=c+s+65535,s=Math.floor(e/65536),c=e-65536*s,e=h+s+65535,s=Math.floor(e/65536),h=e-65536*s,e=i+s+65535,s=Math.floor(e/65536),i=e-65536*s,e=n+s+65535,s=Math.floor(e/65536),n=e-65536*s,e=a+s+65535,s=Math.floor(e/65536),a=e-65536*s,e=f+s+65535,s=Math.floor(e/65536),f=e-65536*s,e=_+s+65535,s=Math.floor(e/65536),_=e-65536*s,e=y+s+65535,s=Math.floor(e/65536),y=e-65536*s,e=p+s+65535,s=Math.floor(e/65536),p=e-65536*s,e=u+s+65535,s=Math.floor(e/65536),u=e-65536*s,e=g+s+65535,s=Math.floor(e/65536),g=e-65536*s,e=l+s+65535,s=Math.floor(e/65536),l=e-65536*s,e=E+s+65535,s=Math.floor(e/65536),E=e-65536*s,e=d+s+65535,s=Math.floor(e/65536),d=e-65536*s,e=S+s+65535,s=Math.floor(e/65536),S=e-65536*s,e=Y+s+65535,s=Math.floor(e/65536),Y=e-65536*s,c+=s-1+37*(s-1),s=1,e=c+s+65535,s=Math.floor(e/65536),c=e-65536*s,e=h+s+65535,s=Math.floor(e/65536),h=e-65536*s,e=i+s+65535,s=Math.floor(e/65536),i=e-65536*s,e=n+s+65535,s=Math.floor(e/65536),n=e-65536*s,e=a+s+65535,s=Math.floor(e/65536),a=e-65536*s,e=f+s+65535,s=Math.floor(e/65536),f=e-65536*s,e=_+s+65535,s=Math.floor(e/65536),_=e-65536*s,e=y+s+65535,s=Math.floor(e/65536),y=e-65536*s,e=p+s+65535,s=Math.floor(e/65536),p=e-65536*s,e=u+s+65535,s=Math.floor(e/65536),u=e-65536*s,e=g+s+65535,s=Math.floor(e/65536),g=e-65536*s,e=l+s+65535,s=Math.floor(e/65536),l=e-65536*s,e=E+s+65535,s=Math.floor(e/65536),E=e-65536*s,e=d+s+65535,s=Math.floor(e/65536),d=e-65536*s,e=S+s+65535,s=Math.floor(e/65536),S=e-65536*s,e=Y+s+65535,s=Math.floor(e/65536),Y=e-65536*s,c+=s-1+37*(s-1),r[0]=c,r[1]=h,r[2]=i,r[3]=n,r[4]=a,r[5]=f,r[6]=_,r[7]=y,r[8]=p,r[9]=u,r[10]=g,r[11]=l,r[12]=E;r[13]=d,r[14]=S,r[15]=Y}function S(r,t){M(r,t,t)}function inv25519(r,t){var o,e=gf();for(o=0;o<16;o++)e[o]=t[o];for(o=253;o>=0;o--)S(e,e),2!==o&&4!==o&&M(e,e,t);for(o=0;o<16;o++)r[o]=e[o]}function pow2523(r,t){var o,e=gf();for(o=0;o<16;o++)e[o]=t[o];for(o=250;o>=0;o--)S(e,e),1!==o&&M(e,e,t);for(o=0;o<16;o++)r[o]=e[o]}function crypto_scalarmult(r,t,o){check(r,crypto_scalarmult_BYTES),check(t,crypto_scalarmult_SCALARBYTES),check(o,crypto_scalarmult_BYTES);var e,s,c=new Uint8Array(32),h=new Float64Array(80),i=gf(),n=gf(),a=gf(),f=gf(),_=gf(),y=gf();for(s=0;s<31;s++)c[s]=t[s];for(c[31]=127&t[31]|64,c[0]&=248,unpack25519(h,o),s=0;s<16;s++)n[s]=h[s],f[s]=i[s]=a[s]=0;for(i[0]=f[0]=1,s=254;s>=0;--s)e=c[s>>>3]>>>(7&s)&1,sel25519(i,n,e),sel25519(a,f,e),A(_,i,a),Z(i,i,a),A(a,n,f),Z(n,n,f),S(f,_),S(y,i),M(i,a,i),M(a,n,_),A(_,i,a),Z(i,i,a),S(n,i),Z(a,f,y),M(i,a,_121665),A(i,i,f),M(a,a,i),M(i,f,y),M(f,n,h),S(n,_),sel25519(i,n,e),sel25519(a,f,e);for(s=0;s<16;s++)h[s+16]=i[s],h[s+32]=a[s],h[s+48]=n[s],h[s+64]=f[s];var p=h.subarray(32),u=h.subarray(16);return inv25519(p,p),M(u,u,p),pack25519(r,u),0}function crypto_scalarmult_base(r,t){return crypto_scalarmult(r,t,_9)}function crypto_hashblocks_hl(r,t,o,e){for(var s,c,h,i,n,a,f,_,y,p,u,g,l,E,d,S,Y,b,B,m,T,v,M,A,x,k,w=new Int32Array(16),U=new Int32Array(16),O=r[0],C=r[1],R=r[2],Z=r[3],L=r[4],N=r[5],I=r[6],q=r[7],X=t[0],D=t[1],F=t[2],P=t[3],j=t[4],z=t[5],G=t[6],H=t[7],J=0;e>=128;){for(B=0;B<16;B++)m=8*B+J,w[B]=o[m+0]<<24|o[m+1]<<16|o[m+2]<<8|o[m+3],U[B]=o[m+4]<<24|o[m+5]<<16|o[m+6]<<8|o[m+7];for(B=0;B<80;B++)if(s=O,c=C,h=R,i=Z,n=L,a=N,f=I,_=q,y=X,p=D,u=F,g=P,l=j,E=z,d=G,S=H,T=q,v=H,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=(L>>>14|j<<18)^(L>>>18|j<<14)^(j>>>9|L<<23),v=(j>>>14|L<<18)^(j>>>18|L<<14)^(L>>>9|j<<23),M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,T=L&N^~L&I,v=j&z^~j&G,M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,T=K[2*B],v=K[2*B+1],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,T=w[B%16],v=U[B%16],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,Y=65535&x|k<<16,b=65535&M|A<<16,T=Y,v=b,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=(O>>>28|X<<4)^(X>>>2|O<<30)^(X>>>7|O<<25),v=(X>>>28|O<<4)^(O>>>2|X<<30)^(O>>>7|X<<25),M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,T=O&C^O&R^C&R,v=X&D^X&F^D&F,M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,_=65535&x|k<<16,S=65535&M|A<<16,T=i,v=g,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=Y,v=b,M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,i=65535&x|k<<16,g=65535&M|A<<16,C=s,R=c,Z=h,L=i,N=n,I=a,q=f,O=_,D=y,F=p,P=u,j=g,z=l,G=E,H=d,X=S,B%16==15)for(m=0;m<16;m++)T=w[m],v=U[m],M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=w[(m+9)%16],v=U[(m+9)%16],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,Y=w[(m+1)%16],b=U[(m+1)%16],T=(Y>>>1|b<<31)^(Y>>>8|b<<24)^Y>>>7,v=(b>>>1|Y<<31)^(b>>>8|Y<<24)^(b>>>7|Y<<25),M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,Y=w[(m+14)%16],b=U[(m+14)%16],T=(Y>>>19|b<<13)^(b>>>29|Y<<3)^Y>>>6,v=(b>>>19|Y<<13)^(Y>>>29|b<<3)^(b>>>6|Y<<26),M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,w[m]=65535&x|k<<16,U[m]=65535&M|A<<16;T=O,v=X,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[0],v=t[0],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[0]=O=65535&x|k<<16,t[0]=X=65535&M|A<<16,T=C,v=D,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[1],v=t[1],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[1]=C=65535&x|k<<16,t[1]=D=65535&M|A<<16,T=R,v=F,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[2],v=t[2],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[2]=R=65535&x|k<<16,t[2]=F=65535&M|A<<16,T=Z,v=P,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[3],v=t[3],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[3]=Z=65535&x|k<<16,t[3]=P=65535&M|A<<16,T=L,v=j,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[4],v=t[4],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[4]=L=65535&x|k<<16,t[4]=j=65535&M|A<<16,T=N,v=z,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[5],v=t[5],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[5]=N=65535&x|k<<16,t[5]=z=65535&M|A<<16,T=I,v=G,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[6],v=t[6],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[6]=I=65535&x|k<<16,t[6]=G=65535&M|A<<16,T=q,v=H,M=65535&v,A=v>>>16,x=65535&T,k=T>>>16,T=r[7],v=t[7],M+=65535&v,A+=v>>>16,x+=65535&T,k+=T>>>16,A+=M>>>16,x+=A>>>16,k+=x>>>16,r[7]=q=65535&x|k<<16,t[7]=H=65535&M|A<<16,J+=128,e-=128}return e}function crypto_hash(r,t,o){var e,s=new Int32Array(8),c=new Int32Array(8),h=new Uint8Array(256),i=o;for(s[0]=1779033703,s[1]=3144134277,s[2]=1013904242,s[3]=2773480762,s[4]=1359893119,s[5]=2600822924,s[6]=528734635,s[7]=1541459225,c[0]=4089235720,c[1]=2227873595,c[2]=4271175723,c[3]=1595750129,c[4]=2917565137,c[5]=725511199,c[6]=4215389547,c[7]=327033209,crypto_hashblocks_hl(s,c,t,o),o%=128,e=0;e<o;e++)h[e]=t[i-o+e];for(h[o]=128,o=256-128*(o<112?1:0),h[o-9]=0,ts64(h,o-8,i/536870912|0,i<<3),crypto_hashblocks_hl(s,c,h,o),e=0;e<8;e++)ts64(r,8*e,s[e],c[e]);return 0}function add(r,t){var o=gf(),e=gf(),s=gf(),c=gf(),h=gf(),i=gf(),n=gf(),a=gf(),f=gf();Z(o,r[1],r[0]),Z(f,t[1],t[0]),M(o,o,f),A(e,r[0],r[1]),A(f,t[0],t[1]),M(e,e,f),M(s,r[3],t[3]),M(s,s,D2),M(c,r[2],t[2]),A(c,c,c),Z(h,e,o),Z(i,c,s),A(n,c,s),A(a,e,o),M(r[0],h,i),M(r[1],a,n),M(r[2],n,i),M(r[3],h,a)}function cswap(r,t,o){var e;for(e=0;e<4;e++)sel25519(r[e],t[e],o)}function pack(r,t){var o=gf(),e=gf(),s=gf();inv25519(s,t[2]),M(o,t[0],s),M(e,t[1],s),pack25519(r,e),r[31]^=par25519(o)<<7}function scalarmult(r,t,o){var e,s;for(set25519(r[0],gf0),set25519(r[1],gf1),set25519(r[2],gf1),set25519(r[3],gf0),s=255;s>=0;--s)e=o[s/8|0]>>(7&s)&1,cswap(r,t,e),add(t,r),add(r,r),cswap(r,t,e)}function scalarbase(r,t){var o=[gf(),gf(),gf(),gf()];set25519(o[0],X),set25519(o[1],Y),set25519(o[2],gf1),M(o[3],X,Y),scalarmult(r,o,t)}function crypto_sign_keypair(r,t,o){check(r,sodium.crypto_sign_PUBLICKEYBYTES),check(t,sodium.crypto_sign_SECRETKEYBYTES);var e,s=new Uint8Array(64),c=[gf(),gf(),gf(),gf()];for(o||randombytes(t,32),crypto_hash(s,t,32),s[0]&=248,s[31]&=127,s[31]|=64,scalarbase(c,s),pack(r,c),e=0;e<32;e++)t[e+32]=r[e];return 0}function crypto_sign_seed_keypair(r,t,o){check(o,sodium.crypto_sign_SEEDBYTES),o.copy(t),crypto_sign_keypair(r,t,!0)}function modL(r,t){var o,e,s,c;for(e=63;e>=32;--e){for(o=0,s=e-32,c=e-12;s<c;++s)t[s]+=o-16*t[e]*L[s-(e-32)],o=t[s]+128>>8,t[s]-=256*o;t[s]+=o,t[e]=0}for(o=0,s=0;s<32;s++)t[s]+=o-(t[31]>>4)*L[s],o=t[s]>>8,t[s]&=255;for(s=0;s<32;s++)t[s]-=o*L[s];for(e=0;e<32;e++)t[e+1]+=t[e]>>8,r[e]=255&t[e]}function reduce(r){var t,o=new Float64Array(64);for(t=0;t<64;t++)o[t]=r[t];for(t=0;t<64;t++)r[t]=0;modL(r,o)}function crypto_sign(r,t,o){check(r,crypto_sign_BYTES+t.length),check(t,0),check(o,crypto_sign_SECRETKEYBYTES);var e,s,c=t.length,h=new Uint8Array(64),i=new Uint8Array(64),n=new Uint8Array(64),a=new Float64Array(64),f=[gf(),gf(),gf(),gf()];crypto_hash(h,o,32),h[0]&=248,h[31]&=127,h[31]|=64;for(e=0;e<c;e++)r[64+e]=t[e];for(e=0;e<32;e++)r[32+e]=h[32+e];for(crypto_hash(n,r.subarray(32),c+32),reduce(n),scalarbase(f,n),pack(r,f),e=32;e<64;e++)r[e]=o[e];for(crypto_hash(i,r,c+64),reduce(i),e=0;e<64;e++)a[e]=0;for(e=0;e<32;e++)a[e]=n[e];for(e=0;e<32;e++)for(s=0;s<32;s++)a[e+s]+=i[e]*h[s];modL(r.subarray(32),a)}function crypto_sign_detached(r,t,o){var e=new Uint8Array(t.length+crypto_sign_BYTES);crypto_sign(e,t,o);for(var s=0;s<crypto_sign_BYTES;s++)r[s]=e[s]}function unpackneg(r,t){var o=gf(),e=gf(),s=gf(),c=gf(),h=gf(),i=gf(),n=gf();return set25519(r[2],gf1),unpack25519(r[1],t),S(s,r[1]),M(c,s,D),Z(s,s,r[2]),A(c,r[2],c),S(h,c),S(i,h),M(n,i,h),M(o,n,s),M(o,o,c),pow2523(o,o),M(o,o,s),M(o,o,c),M(o,o,c),M(r[0],o,c),S(e,r[0]),M(e,e,c),neq25519(e,s)&&M(r[0],r[0],I),S(e,r[0]),M(e,e,c),neq25519(e,s)?-1:(par25519(r[0])===t[31]>>7&&Z(r[0],gf0,r[0]),M(r[3],r[0],r[1]),0)}function crypto_sign_open(r,t,o){check(r,t.length-crypto_sign_BYTES),check(t,crypto_sign_BYTES),check(o,crypto_sign_PUBLICKEYBYTES);var e,s=t.length,c=new Uint8Array(t.length),h=new Uint8Array(32),i=new Uint8Array(64),n=[gf(),gf(),gf(),gf()],a=[gf(),gf(),gf(),gf()];if(-1,s<64)return!1;if(unpackneg(a,o))return!1;for(e=0;e<s;e++)c[e]=t[e];for(e=0;e<32;e++)c[e+32]=o[e];if(crypto_hash(i,c,s),reduce(i),scalarmult(n,a,i),scalarbase(a,t.subarray(32)),add(n,a),pack(h,n),s-=64,crypto_verify_32(t,0,h,0)){for(e=0;e<s;e++)c[e]=0;return!1}for(e=0;e<s;e++)r[e]=t[e+64];return s,!0}function crypto_sign_verify_detached(r,t,o){check(r,crypto_sign_BYTES);var e=new Uint8Array(t.length+crypto_sign_BYTES),s=0;for(s=0;s<crypto_sign_BYTES;s++)e[s]=r[s];for(s=0;s<t.length;s++)e[s+crypto_sign_BYTES]=t[s];return crypto_sign_open(t,e,o)}function crypto_secretbox_detached(r,t,o,e,s){check(t,sodium.crypto_secretbox_MACBYTES);var c=new Uint8Array(o.length+t.length);crypto_secretbox_easy(c,o,e,s),r.set(c.subarray(0,o.length)),t.set(c.subarray(o.length))}function crypto_secretbox_open_detached(r,t,o,e,s){check(o,sodium.crypto_secretbox_MACBYTES);var c=new Uint8Array(t.length+o.length);return c.set(t),c.set(o,r.length),crypto_secretbox_open_easy(r,c,e,s)}function crypto_secretbox_easy(r,t,o,e){check(t,0),check(r,t.length+sodium.crypto_secretbox_MACBYTES),check(o,crypto_secretbox_NONCEBYTES),check(e,crypto_secretbox_KEYBYTES);var s,c=new Uint8Array(crypto_secretbox_ZEROBYTES+t.length),h=new Uint8Array(c.length);for(s=0;s<t.length;s++)c[s+crypto_secretbox_ZEROBYTES]=t[s];for(crypto_secretbox(h,c,c.length,o,e),s=crypto_secretbox_BOXZEROBYTES;s<h.length;s++)r[s-crypto_secretbox_BOXZEROBYTES]=h[s]}function crypto_secretbox_open_easy(r,t,o,e){check(t,sodium.crypto_secretbox_MACBYTES),check(r,t.length-sodium.crypto_secretbox_MACBYTES),check(o,crypto_secretbox_NONCEBYTES),check(e,crypto_secretbox_KEYBYTES);var s,c=new Uint8Array(crypto_secretbox_BOXZEROBYTES+t.length),h=new Uint8Array(c.length);for(s=0;s<t.length;s++)c[s+crypto_secretbox_BOXZEROBYTES]=t[s];if(c.length<32)return!1;if(0!==crypto_secretbox_open(h,c,c.length,o,e))return!1;for(s=crypto_secretbox_ZEROBYTES;s<h.length;s++)r[s-crypto_secretbox_ZEROBYTES]=h[s];return!0}function cleanup(r){for(var t=0;t<r.length;t++)r[t]=0}function check(r,t){if(!r||t&&r.length<t)throw new Error("Argument must be a buffer"+(t?" of length "+t:""))}function forward(r){Object.keys(r).forEach(function(t){module.exports[t]=r[t]})}var sodium=module.exports,cs=require("./crypto_stream"),gf=function(r){var t,o=new Float64Array(16);if(r)for(t=0;t<r.length;t++)o[t]=r[t];return o},randombytes=require("./randombytes").randombytes,_0=new Uint8Array(16),_9=new Uint8Array(32);_9[0]=9;var gf0=gf(),gf1=gf([1]),_121665=gf([56129,1]),D=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),D2=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Y=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),poly1305=function(r){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var t,o,e,s,c,h,i,n;t=255&r[0]|(255&r[1])<<8,this.r[0]=8191&t,o=255&r[2]|(255&r[3])<<8,this.r[1]=8191&(t>>>13|o<<3),e=255&r[4]|(255&r[5])<<8,this.r[2]=7939&(o>>>10|e<<6),s=255&r[6]|(255&r[7])<<8,this.r[3]=8191&(e>>>7|s<<9),c=255&r[8]|(255&r[9])<<8,this.r[4]=255&(s>>>4|c<<12),this.r[5]=c>>>1&8190,h=255&r[10]|(255&r[11])<<8,this.r[6]=8191&(c>>>14|h<<2),i=255&r[12]|(255&r[13])<<8,this.r[7]=8065&(h>>>11|i<<5),n=255&r[14]|(255&r[15])<<8,this.r[8]=8191&(i>>>8|n<<8),this.r[9]=n>>>5&127,this.pad[0]=255&r[16]|(255&r[17])<<8,this.pad[1]=255&r[18]|(255&r[19])<<8,this.pad[2]=255&r[20]|(255&r[21])<<8,this.pad[3]=255&r[22]|(255&r[23])<<8,this.pad[4]=255&r[24]|(255&r[25])<<8,this.pad[5]=255&r[26]|(255&r[27])<<8,this.pad[6]=255&r[28]|(255&r[29])<<8,this.pad[7]=255&r[30]|(255&r[31])<<8};poly1305.prototype.blocks=function(r,t,o){for(var e,s,c,h,i,n,a,f,_,y,p,u,g,l,E,d,S,Y,b,B=this.fin?0:2048,m=this.h[0],T=this.h[1],v=this.h[2],M=this.h[3],A=this.h[4],x=this.h[5],k=this.h[6],w=this.h[7],U=this.h[8],O=this.h[9],C=this.r[0],R=this.r[1],Z=this.r[2],K=this.r[3],L=this.r[4],N=this.r[5],I=this.r[6],q=this.r[7],X=this.r[8],D=this.r[9];o>=16;)e=255&r[t+0]|(255&r[t+1])<<8,m+=8191&e,s=255&r[t+2]|(255&r[t+3])<<8,T+=8191&(e>>>13|s<<3),c=255&r[t+4]|(255&r[t+5])<<8,v+=8191&(s>>>10|c<<6),h=255&r[t+6]|(255&r[t+7])<<8,M+=8191&(c>>>7|h<<9),i=255&r[t+8]|(255&r[t+9])<<8,A+=8191&(h>>>4|i<<12),x+=i>>>1&8191,n=255&r[t+10]|(255&r[t+11])<<8,k+=8191&(i>>>14|n<<2),a=255&r[t+12]|(255&r[t+13])<<8,w+=8191&(n>>>11|a<<5),f=255&r[t+14]|(255&r[t+15])<<8,U+=8191&(a>>>8|f<<8),O+=f>>>5|B,_=0,y=_,y+=m*C,y+=T*(5*D),y+=v*(5*X),y+=M*(5*q),y+=A*(5*I),_=y>>>13,y&=8191,y+=x*(5*N),y+=k*(5*L),y+=w*(5*K),y+=U*(5*Z),y+=O*(5*R),_+=y>>>13,y&=8191,p=_,p+=m*R,p+=T*C,p+=v*(5*D),p+=M*(5*X),p+=A*(5*q),_=p>>>13,p&=8191,p+=x*(5*I),p+=k*(5*N),p+=w*(5*L),p+=U*(5*K),p+=O*(5*Z),_+=p>>>13,p&=8191,u=_,u+=m*Z,u+=T*R,u+=v*C,u+=M*(5*D),u+=A*(5*X),_=u>>>13,u&=8191,u+=x*(5*q),u+=k*(5*I),u+=w*(5*N),u+=U*(5*L),u+=O*(5*K),_+=u>>>13,u&=8191,g=_,g+=m*K,g+=T*Z,g+=v*R,g+=M*C,g+=A*(5*D),_=g>>>13,g&=8191,g+=x*(5*X),g+=k*(5*q),g+=w*(5*I),g+=U*(5*N),g+=O*(5*L),_+=g>>>13,g&=8191,l=_,l+=m*L,l+=T*K,l+=v*Z,l+=M*R,l+=A*C,_=l>>>13,l&=8191,l+=x*(5*D),l+=k*(5*X),l+=w*(5*q),l+=U*(5*I),l+=O*(5*N),_+=l>>>13,l&=8191,E=_,E+=m*N,E+=T*L,E+=v*K,E+=M*Z,E+=A*R,_=E>>>13,E&=8191,E+=x*C,E+=k*(5*D),E+=w*(5*X),E+=U*(5*q),E+=O*(5*I),_+=E>>>13,E&=8191,d=_,d+=m*I,d+=T*N,d+=v*L,d+=M*K,d+=A*Z,_=d>>>13,d&=8191,d+=x*R,d+=k*C,d+=w*(5*D),d+=U*(5*X),d+=O*(5*q),_+=d>>>13,d&=8191,S=_,S+=m*q,S+=T*I,S+=v*N,S+=M*L,S+=A*K,_=S>>>13,S&=8191,S+=x*Z,S+=k*R,S+=w*C,S+=U*(5*D),S+=O*(5*X),_+=S>>>13,S&=8191,Y=_,Y+=m*X,Y+=T*q,Y+=v*I,Y+=M*N,Y+=A*L,_=Y>>>13,Y&=8191,Y+=x*K,Y+=k*Z,Y+=w*R,Y+=U*C,Y+=O*(5*D),_+=Y>>>13,Y&=8191,b=_,b+=m*D,b+=T*X,b+=v*q,b+=M*I,b+=A*N,_=b>>>13,b&=8191,b+=x*L,b+=k*K,b+=w*Z,b+=U*R,b+=O*C,_+=b>>>13,b&=8191,_=(_<<2)+_|0,_=_+y|0,y=8191&_,_>>>=13,p+=_,m=y,T=p,v=u,M=g,A=l,x=E,k=d,w=S,U=Y,O=b,t+=16,o-=16;this.h[0]=m,this.h[1]=T,this.h[2]=v,this.h[3]=M,this.h[4]=A,this.h[5]=x,this.h[6]=k,this.h[7]=w,this.h[8]=U,this.h[9]=O},poly1305.prototype.finish=function(r,t){var o,e,s,c,h=new Uint16Array(10);if(this.leftover){for(c=this.leftover,this.buffer[c++]=1;c<16;c++)this.buffer[c]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(o=this.h[1]>>>13,this.h[1]&=8191,c=2;c<10;c++)this.h[c]+=o,o=this.h[c]>>>13,this.h[c]&=8191;for(this.h[0]+=5*o,o=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=o,o=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=o,h[0]=this.h[0]+5,o=h[0]>>>13,h[0]&=8191,c=1;c<10;c++)h[c]=this.h[c]+o,o=h[c]>>>13,h[c]&=8191;for(h[9]-=8192,e=(1^o)-1,c=0;c<10;c++)h[c]&=e;for(e=~e,c=0;c<10;c++)this.h[c]=this.h[c]&e|h[c];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),s=this.h[0]+this.pad[0],this.h[0]=65535&s,c=1;c<8;c++)s=(this.h[c]+this.pad[c]|0)+(s>>>16)|0,this.h[c]=65535&s;r[t+0]=this.h[0]>>>0&255,r[t+1]=this.h[0]>>>8&255,r[t+2]=this.h[1]>>>0&255,r[t+3]=this.h[1]>>>8&255,r[t+4]=this.h[2]>>>0&255,r[t+5]=this.h[2]>>>8&255,r[t+6]=this.h[3]>>>0&255,r[t+7]=this.h[3]>>>8&255,r[t+8]=this.h[4]>>>0&255,r[t+9]=this.h[4]>>>8&255,r[t+10]=this.h[5]>>>0&255,r[t+11]=this.h[5]>>>8&255,r[t+12]=this.h[6]>>>0&255,r[t+13]=this.h[6]>>>8&255,r[t+14]=this.h[7]>>>0&255,r[t+15]=this.h[7]>>>8&255},poly1305.prototype.update=function(r,t,o){var e,s;if(this.leftover){for(s=16-this.leftover,s>o&&(s=o),e=0;e<s;e++)this.buffer[this.leftover+e]=r[t+e];if(o-=s,t+=s,this.leftover+=s,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(o>=16&&(s=o-o%16,this.blocks(r,t,s),t+=s,o-=s),o){for(e=0;e<o;e++)this.buffer[this.leftover+e]=r[t+e];this.leftover+=o}};var K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],L=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),crypto_secretbox_KEYBYTES=32,crypto_secretbox_NONCEBYTES=24,crypto_secretbox_ZEROBYTES=32,crypto_secretbox_BOXZEROBYTES=16,crypto_scalarmult_BYTES=32,crypto_scalarmult_SCALARBYTES=32,crypto_box_PUBLICKEYBYTES=32,crypto_box_SECRETKEYBYTES=32,crypto_box_BEFORENMBYTES=32,crypto_box_NONCEBYTES=crypto_secretbox_NONCEBYTES,crypto_box_ZEROBYTES=crypto_secretbox_ZEROBYTES,crypto_box_BOXZEROBYTES=crypto_secretbox_BOXZEROBYTES,crypto_sign_BYTES=64,crypto_sign_PUBLICKEYBYTES=32,crypto_sign_SECRETKEYBYTES=64,crypto_sign_SEEDBYTES=32,crypto_hash_BYTES=64;sodium.memzero=function(r,t){for(var o=t;o<r;o++)arr[o]=0},sodium.crypto_sign_BYTES=crypto_sign_BYTES,sodium.crypto_sign_PUBLICKEYBYTES=crypto_sign_PUBLICKEYBYTES,sodium.crypto_sign_SECRETKEYBYTES=crypto_sign_SECRETKEYBYTES,sodium.crypto_sign_SEEDBYTES=crypto_sign_SEEDBYTES,sodium.crypto_sign_keypair=crypto_sign_keypair,sodium.crypto_sign_seed_keypair=crypto_sign_seed_keypair,sodium.crypto_sign=crypto_sign,sodium.crypto_sign_open=crypto_sign_open,sodium.crypto_sign_detached=crypto_sign_detached,sodium.crypto_sign_verify_detached=crypto_sign_verify_detached,forward(require("./crypto_generichash")),forward(require("./crypto_kdf")),forward(require("./crypto_shorthash")),forward(require("./randombytes")),forward(require("./crypto_stream")),sodium.crypto_scalarmult_BYTES=crypto_scalarmult_BYTES,sodium.crypto_scalarmult_SCALARBYTES=crypto_scalarmult_SCALARBYTES,sodium.crypto_scalarmult_base=crypto_scalarmult_base,sodium.crypto_scalarmult=crypto_scalarmult,sodium.crypto_secretbox_KEYBYTES=crypto_secretbox_KEYBYTES,sodium.crypto_secretbox_NONCEBYTES=crypto_secretbox_NONCEBYTES,sodium.crypto_secretbox_MACBYTES=16,sodium.crypto_secretbox_easy=crypto_secretbox_easy,sodium.crypto_secretbox_open_easy=crypto_secretbox_open_easy,sodium.crypto_secretbox_detached=crypto_secretbox_detached,sodium.crypto_secretbox_open_detached=crypto_secretbox_open_detached;
},{"./crypto_generichash":261,"./crypto_kdf":262,"./crypto_shorthash":263,"./crypto_stream":264,"./randombytes":266}],266:[function(require,module,exports){
var assert=require("nanoassert"),randombytes=function(){function e(e,r){for(var n=0;n<r;n+=o)t.getRandomValues(e.subarray(n,n+Math.min(r-n,o)))}function r(e,r){e.set(t.randomBytes(r))}function n(){throw new Error("No secure random number generator available")}var o=65536,t="undefined"!=typeof window?window.crypto||window.msCrypto:null;return t&&t.getRandomValues?e:"undefined"!=typeof require&&(t=require("crypto"))&&t.randomBytes?r:n}();Object.defineProperty(module.exports,"randombytes",{value:randombytes}),module.exports.randombytes_buf=function(e){assert(e,"out must be given"),randombytes(e,e.length)};

},{"crypto":87,"nanoassert":183}],267:[function(require,module,exports){
module.exports=require("sodium-javascript");

},{"sodium-javascript":265}],268:[function(require,module,exports){
var tick=1,maxTick=65535,resolution=4,inc=function(){tick=tick+1&maxTick},timer=setInterval(inc,1e3/resolution|0);timer.unref&&timer.unref(),module.exports=function(t){var i=resolution*(t||5),n=[0],r=1,e=tick-1&maxTick;return function(t){var o=tick-e&maxTick;for(o>i&&(o=i),e=tick;o--;)r===i&&(r=0),n[r]=n[0===r?i-1:r-1],r++;t&&(n[r-1]+=t);var c=n[r-1],u=n.length<i?0:n[r===i?0:r];return n.length<resolution?c:(c-u)*resolution/n.length}};

},{}],269:[function(require,module,exports){
function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){function t(r){e.writable&&!1===e.write(r)&&m.pause&&m.pause()}function n(){m.readable&&m.resume&&m.resume()}function a(){u||(u=!0,e.end())}function o(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function i(e){if(s(),0===EE.listenerCount(this,"error"))throw e}function s(){m.removeListener("data",t),e.removeListener("drain",n),m.removeListener("end",a),m.removeListener("close",o),m.removeListener("error",i),e.removeListener("error",i),m.removeListener("end",s),m.removeListener("close",s),e.removeListener("close",s)}var m=this;m.on("data",t),e.on("drain",n),e._isStdio||r&&!1===r.end||(m.on("end",a),m.on("close",o));var u=!1;return m.on("error",i),e.on("error",i),m.on("end",s),m.on("close",s),e.on("close",s),e.emit("pipe",m),e};

},{"events":121,"inherits":144,"readable-stream/duplex.js":225,"readable-stream/passthrough.js":234,"readable-stream/readable.js":235,"readable-stream/transform.js":236,"readable-stream/writable.js":237}],270:[function(require,module,exports){
(function (global){
var ClientRequest=require("./lib/request"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(t,e){t="string"==typeof t?url.parse(t):extend(t);var r=-1===global.location.protocol.search(/^https?:$/)?"http:":"",s=t.protocol||r,o=t.hostname||t.host,n=t.port,u=t.path||"/";o&&-1!==o.indexOf(":")&&(o="["+o+"]"),t.url=(o?s+"//"+o:"")+(n?":"+n:"")+u,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var C=new ClientRequest(t);return e&&C.on("response",e),C},http.get=function(t,e){var r=http.request(t,e);return r.end(),r},http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./lib/request":272,"builtin-status-codes":67,"url":295,"xtend":324}],271:[function(require,module,exports){
(function (global){
function getXHR(){if(void 0!==xhr)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else xhr=null;return xhr}function checkTypeSupport(e){var r=getXHR();if(!r)return!1;try{return r.responseType=e,r.responseType===e}catch(e){}return!1}function isFunction(e){return"function"==typeof e}exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream),exports.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),exports.blobConstructor=!0}catch(e){}var xhr,haveArrayBuffer=void 0!==global.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);exports.arraybuffer=exports.fetch||haveArrayBuffer&&checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=exports.fetch||!!getXHR()&&isFunction(getXHR().overrideMimeType),exports.vbArray=isFunction(global.VBArray),xhr=null;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],272:[function(require,module,exports){
(function (process,global,Buffer){
function decideMode(e,t){return capability.fetch&&t?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&e?"arraybuffer":capability.vbArray&&e?"text:vbarray":"text"}function statusValid(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}var capability=require("./capability"),inherits=require("inherits"),response=require("./response"),stream=require("readable-stream"),toArrayBuffer=require("to-arraybuffer"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates,ClientRequest=module.exports=function(e){var t=this;stream.Writable.call(t),t._opts=e,t._body=[],t._headers={},e.auth&&t.setHeader("Authorization","Basic "+new Buffer(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(r){t.setHeader(r,e.headers[r])});var r,o=!0;if("disable-fetch"===e.mode||"timeout"in e)o=!1,r=!0;else if("prefer-streaming"===e.mode)r=!1;else if("allow-wrong-content-type"===e.mode)r=!capability.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");r=!0}t._mode=decideMode(r,o),t.on("finish",function(){t._onFinish()})};inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(e,t){var r=this,o=e.toLowerCase();-1===unsafeHeaders.indexOf(o)&&(r._headers[o]={name:e,value:t})},ClientRequest.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},ClientRequest.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,r=e._headers,o=null;"GET"!==t.method&&"HEAD"!==t.method&&(o=capability.blobConstructor?new global.Blob(e._body.map(function(e){return toArrayBuffer(e)}),{type:(r["content-type"]||{}).value||""}):Buffer.concat(e._body).toString());var n=[];if(Object.keys(r).forEach(function(e){var t=r[e].name,o=r[e].value;Array.isArray(o)?o.forEach(function(e){n.push([t,e])}):n.push([t,o])}),"fetch"===e._mode)global.fetch(e._opts.url,{method:e._opts.method,headers:n,body:o||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin"}).then(function(t){e._fetchResponse=t,e._connect()},function(t){e.emit("error",t)});else{var s=e._xhr=new global.XMLHttpRequest;try{s.open(e._opts.method,e._opts.url,!0)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}"responseType"in s&&(s.responseType=e._mode.split(":")[0]),"withCredentials"in s&&(s.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),"timeout"in t&&(s.timeout=t.timeout,s.ontimeout=function(){e.emit("timeout")}),n.forEach(function(e){s.setRequestHeader(e[0],e[1])}),e._response=null,s.onreadystatechange=function(){switch(s.readyState){case rStates.LOADING:case rStates.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(s.onprogress=function(){e._onXHRProgress()}),s.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{s.send(o)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}}}},ClientRequest.prototype._onXHRProgress=function(){var e=this;statusValid(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var e=this;e._destroyed||(e._response=new IncomingMessage(e._xhr,e._fetchResponse,e._mode),e._response.on("error",function(t){e.emit("error",t)}),e.emit("response",e._response))},ClientRequest.prototype._write=function(e,t,r){this._body.push(e),r()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var e=this;e._destroyed=!0,e._response&&(e._response._destroyed=!0),e._xhr&&e._xhr.abort()},ClientRequest.prototype.end=function(e,t,r){var o=this;"function"==typeof e&&(r=e,e=void 0),stream.Writable.prototype.end.call(o,e,t,r)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"./capability":271,"./response":273,"_process":205,"buffer":66,"inherits":144,"readable-stream":235,"to-arraybuffer":283}],273:[function(require,module,exports){
(function (process,global,Buffer){
var capability=require("./capability"),inherits=require("inherits"),stream=require("readable-stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(e,r,s){function a(){n.read().then(function(e){if(!t._destroyed){if(e.done)return void t.push(null);t.push(new Buffer(e.value)),a()}}).catch(function(e){t.emit("error",e)})}var t=this;if(stream.Readable.call(t),t._mode=s,t.headers={},t.rawHeaders=[],t.trailers={},t.rawTrailers=[],t.on("end",function(){process.nextTick(function(){t.emit("close")})}),"fetch"===s){t._fetchResponse=r,t.url=r.url,t.statusCode=r.status,t.statusMessage=r.statusText,r.headers.forEach(function(e,r){t.headers[r.toLowerCase()]=e,t.rawHeaders.push(r,e)});var n=r.body.getReader();a()}else{t._xhr=e,t._pos=0,t.url=e.responseURL,t.statusCode=e.status,t.statusMessage=e.statusText;if(e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var r=e.match(/^([^:]+):\s*(.*)/);if(r){var s=r[1].toLowerCase();"set-cookie"===s?(void 0===t.headers[s]&&(t.headers[s]=[]),t.headers[s].push(r[2])):void 0!==t.headers[s]?t.headers[s]+=", "+r[2]:t.headers[s]=r[2],t.rawHeaders.push(r[1],r[2])}}),t._charset="x-user-defined",!capability.overrideMimeType){var o=t.rawHeaders["mime-type"];if(o){var i=o.match(/;\s*charset=([^;])(;|$)/);i&&(t._charset=i[1].toLowerCase())}t._charset||(t._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){},IncomingMessage.prototype._onXHRProgress=function(){var e=this,r=e._xhr,s=null;switch(e._mode){case"text:vbarray":if(r.readyState!==rStates.DONE)break;try{s=new global.VBArray(r.responseBody).toArray()}catch(e){}if(null!==s){e.push(new Buffer(s));break}case"text":try{s=r.responseText}catch(r){e._mode="text:vbarray";break}if(s.length>e._pos){var a=s.substr(e._pos);if("x-user-defined"===e._charset){for(var t=new Buffer(a.length),n=0;n<a.length;n++)t[n]=255&a.charCodeAt(n);e.push(t)}else e.push(a,e._charset);e._pos=s.length}break;case"arraybuffer":if(r.readyState!==rStates.DONE||!r.response)break;s=r.response,e.push(new Buffer(new Uint8Array(s)));break;case"moz-chunked-arraybuffer":if(s=r.response,r.readyState!==rStates.LOADING||!s)break;e.push(new Buffer(new Uint8Array(s)));break;case"ms-stream":if(s=r.response,r.readyState!==rStates.LOADING)break;var o=new global.MSStreamReader;o.onprogress=function(){o.result.byteLength>e._pos&&(e.push(new Buffer(new Uint8Array(o.result.slice(e._pos)))),e._pos=o.result.byteLength)},o.onload=function(){e.push(null)},o.readAsArrayBuffer(s)}e._xhr.readyState===rStates.DONE&&"ms-stream"!==e._mode&&e.push(null)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"./capability":271,"_process":205,"buffer":66,"inherits":144,"readable-stream":235}],274:[function(require,module,exports){
var EventEmitter=require("events").EventEmitter;exports=module.exports=function(t){return"function"==typeof t?t:exports[t]||exports.json},exports.json=function(t,r){function e(e){var n;try{n=r.parse(e)}catch(r){return r.line=e,t.emit("error",r)}void 0!==n&&i.call(t,n)}function n(t){var r=(o+t).split("\n");for(o=r.pop();r.length;)e(r.shift())}r=r||JSON;var i=t.write,o="";t.write=n;var u=t.end;return t.end=function(r){return r&&t.write(r),o&&e(o),u.call(t)},t.emit=function(e,n){"data"==e&&(n=r.stringify(n)+"\n"),EventEmitter.prototype.emit.call(t,e,n)},t},exports.raw=function(t){return t};
},{"events":121}],275:[function(require,module,exports){
function shift(e){var t=e._readableState;return t?t.objectMode?e.read():e.read(getStateLength(t)):null}function getStateLength(e){return e.buffer.length?e.buffer.head?e.buffer.head.data.length:e.buffer[0].length:e.length}module.exports=shift;

},{}],276:[function(require,module,exports){
var getBlob=require("stream-to-blob");module.exports=function e(t,r,n){if("function"==typeof r)return e(t,null,r);getBlob(t,r,function(e,t){if(e)return n(e);var r=URL.createObjectURL(t);n(null,r)})};

},{"stream-to-blob":277}],277:[function(require,module,exports){
var once=require("once");module.exports=function n(o,e,r){if("function"==typeof e)return n(o,null,e);r=once(r);var u=[];o.on("data",function(n){u.push(n)}).on("end",function(){var n=e?new Blob(u,{type:e}):new Blob(u);r(null,n)}).on("error",r)};

},{"once":186}],278:[function(require,module,exports){
(function (Buffer){
var once=require("once");module.exports=function(n,o,e){e=once(e);var r=new Buffer(o),c=0;n.on("data",function(n){n.copy(r,c),c+=n.length}).on("end",function(){e(null,r)}).on("error",e)};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"once":186}],279:[function(require,module,exports){
"use strict";module.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})};

},{}],280:[function(require,module,exports){
"use strict";function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){this.encoding=normalizeEncoding(t);var e;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:-1}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var a=utf8CheckByte(e[i]);return a>=0?(a>0&&(t.lastNeed=a-1),a):--i<s?0:(a=utf8CheckByte(e[i]))>=0?(a>0&&(t.lastNeed=a-2),a):--i<s?0:(a=utf8CheckByte(e[i]),a>=0?(a>0&&(2===a?a=0:t.lastNeed=a-3),a):0)}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"".repeat(s);if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"".repeat(s+1);if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"".repeat(s+2)}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"".repeat(this.lastTotal-this.lastNeed):e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":244}],281:[function(require,module,exports){
var base32=require("./thirty-two");exports.encode=base32.encode,exports.decode=base32.decode;
},{"./thirty-two":282}],282:[function(require,module,exports){
(function (Buffer){
"use strict";function quintetCount(e){var r=Math.floor(e.length/5);return e.length%5==0?r:r+1}var charTable="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",byteTable=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];exports.encode=function(e){Buffer.isBuffer(e)||(e=new Buffer(e));for(var r=0,t=0,n=0,f=0,u=new Buffer(8*quintetCount(e));r<e.length;){var a=e[r];n>3?(f=a&255>>n,n=(n+5)%8,f=f<<n|(r+1<e.length?e[r+1]:0)>>8-n,r++):(f=a>>8-(n+5)&31,0===(n=(n+5)%8)&&r++),u[t]=charTable.charCodeAt(f),t++}for(r=t;r<u.length;r++)u[r]=61;return u},exports.decode=function(e){var r,t=0,n=0,f=0;Buffer.isBuffer(e)||(e=new Buffer(e));for(var u=new Buffer(Math.ceil(5*e.length/8)),a=0;a<e.length&&61!==e[a];a++){var o=e[a]-48;if(!(o<byteTable.length))throw new Error("Invalid input - it is not base32 encoded string");n=byteTable[o],t<=3?(t=(t+5)%8,0===t?(r|=n,u[f]=r,f++,r=0):r|=255&n<<8-t):(t=(t+5)%8,r|=255&n>>>t,u[f]=r,f++,r=255&n<<8-t)}return u.slice(0,f)};
}).call(this,require("buffer").Buffer)
},{"buffer":66}],283:[function(require,module,exports){
var Buffer=require("buffer").Buffer;module.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(Buffer.isBuffer(e)){for(var f=new Uint8Array(e.length),r=e.length,t=0;t<r;t++)f[t]=e[t];return f.buffer}throw new Error("Argument must be a Buffer")};
},{"buffer":66}],284:[function(require,module,exports){
(function (process){
function Discovery(e){function r(e,r){var n=new DHT(r);return n.on("warning",t._onWarning),n.on("error",t._onError),n.listen(e),t._internalDHT=!0,n}var t=this;if(!(t instanceof Discovery))return new Discovery(e);if(EventEmitter.call(t),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!process.browser&&!e.port)throw new Error("Option `port` is required");t.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),t.infoHash="string"==typeof e.infoHash?e.infoHash:e.infoHash.toString("hex"),t._port=e.port,t._userAgent=e.userAgent,t.destroyed=!1,t._announce=e.announce||[],t._intervalMs=e.intervalMs||9e5,t._trackerOpts=null,t._dhtAnnouncing=!1,t._dhtTimeout=!1,t._internalDHT=!1,t._onWarning=function(e){t.emit("warning",e)},t._onError=function(e){t.emit("error",e)},t._onDHTPeer=function(e,r){r.toString("hex")===t.infoHash&&t.emit("peer",e.host+":"+e.port,"dht")},t._onTrackerPeer=function(e){t.emit("peer",e,"tracker")},t._onTrackerAnnounce=function(){t.emit("trackerAnnounce")},!1===e.tracker?t.tracker=null:e.tracker&&"object"==typeof e.tracker?(t._trackerOpts=extend(e.tracker),t.tracker=t._createTracker()):t.tracker=t._createTracker(),!1===e.dht||"function"!=typeof DHT?t.dht=null:e.dht&&"function"==typeof e.dht.addNode?t.dht=e.dht:e.dht&&"object"==typeof e.dht?t.dht=r(e.dhtPort,e.dht):t.dht=r(e.dhtPort),t.dht&&(t.dht.on("peer",t._onDHTPeer),t._dhtAnnounce())}module.exports=Discovery;var debug=require("debug")("torrent-discovery"),DHT=require("bittorrent-dht/client"),EventEmitter=require("events").EventEmitter,extend=require("xtend"),inherits=require("inherits"),parallel=require("run-parallel"),Tracker=require("bittorrent-tracker/client");inherits(Discovery,EventEmitter),Discovery.prototype.updatePort=function(e){var r=this;e!==r._port&&(r._port=e,r.dht&&r._dhtAnnounce(),r.tracker&&(r.tracker.stop(),r.tracker.destroy(function(){r.tracker=r._createTracker()})))},Discovery.prototype.complete=function(e){this.tracker&&this.tracker.complete(e)},Discovery.prototype.destroy=function(e){var r=this;if(!r.destroyed){r.destroyed=!0,clearTimeout(r._dhtTimeout);var t=[];r.tracker&&(r.tracker.stop(),r.tracker.removeListener("warning",r._onWarning),r.tracker.removeListener("error",r._onError),r.tracker.removeListener("peer",r._onTrackerPeer),r.tracker.removeListener("update",r._onTrackerAnnounce),t.push(function(e){r.tracker.destroy(e)})),r.dht&&r.dht.removeListener("peer",r._onDHTPeer),r._internalDHT&&(r.dht.removeListener("warning",r._onWarning),r.dht.removeListener("error",r._onError),t.push(function(e){r.dht.destroy(e)})),parallel(t,e),r.dht=null,r.tracker=null,r._announce=null}},Discovery.prototype._createTracker=function(){var e=extend(this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent}),r=new Tracker(e);return r.on("warning",this._onWarning),r.on("error",this._onError),r.on("peer",this._onTrackerPeer),r.on("update",this._onTrackerAnnounce),r.setInterval(this._intervalMs),r.start(),r},Discovery.prototype._dhtAnnounce=function(){function e(){return r._intervalMs+Math.floor(Math.random()*r._intervalMs/5)}var r=this;r._dhtAnnouncing||(debug("dht announce"),r._dhtAnnouncing=!0,clearTimeout(r._dhtTimeout),r.dht.announce(r.infoHash,r._port,function(t){r._dhtAnnouncing=!1,debug("dht announce complete"),t&&r.emit("warning",t),r.emit("dhtAnnounce"),r.destroyed||(r._dhtTimeout=setTimeout(function(){r._dhtAnnounce()},e()),r._dhtTimeout.unref&&r._dhtTimeout.unref())}))};

}).call(this,require('_process'))
},{"_process":205,"bittorrent-dht/client":37,"bittorrent-tracker/client":285,"debug":88,"events":121,"inherits":144,"run-parallel":242,"xtend":324}],285:[function(require,module,exports){
arguments[4][25][0].apply(exports,arguments)
},{"./lib/client/http-tracker":37,"./lib/client/udp-tracker":37,"./lib/client/websocket-tracker":287,"./lib/common":288,"_process":205,"debug":88,"dup":25,"events":121,"inherits":144,"once":186,"run-parallel":242,"safe-buffer":244,"simple-peer":289,"uniq":293,"url":295,"xtend":324}],286:[function(require,module,exports){
arguments[4][27][0].apply(exports,arguments)
},{"dup":27,"events":121,"inherits":144}],287:[function(require,module,exports){
function WebSocketTracker(e,n,o){var r=this;Tracker.call(r,e,n),debug("new websocket tracker %s",n),r.peers={},r.socket=null,r.reconnecting=!1,r.retries=0,r.reconnectTimer=null,r.expectingResponse=!1,r._openSocket()}function noop(){}module.exports=WebSocketTracker;var debug=require("debug")("bittorrent-tracker:websocket-tracker"),extend=require("xtend"),inherits=require("inherits"),Peer=require("simple-peer"),randombytes=require("randombytes"),Socket=require("simple-websocket"),common=require("../common"),Tracker=require("./tracker"),socketPool={},RECONNECT_MINIMUM=15e3,RECONNECT_MAXIMUM=18e5,RECONNECT_VARIANCE=3e4,OFFER_TIMEOUT=5e4;inherits(WebSocketTracker,Tracker),WebSocketTracker.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,WebSocketTracker.prototype.announce=function(e){var n=this;if(!n.destroyed&&!n.reconnecting){if(!n.socket.connected)return void n.socket.once("connect",function(){n.announce(e)});var o=extend(e,{action:"announce",info_hash:n.client._infoHashBinary,peer_id:n.client._peerIdBinary});if(n._trackerId&&(o.trackerid=n._trackerId),"stopped"===e.event||"completed"===e.event)n._send(o);else{var r=Math.min(e.numwant,10);n._generateOffers(r,function(e){o.numwant=r,o.offers=e,n._send(o)})}}},WebSocketTracker.prototype.scrape=function(e){var n=this;if(!n.destroyed&&!n.reconnecting){if(!n.socket.connected)return void n.socket.once("connect",function(){n.scrape(e)});var o=Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(function(e){return e.toString("binary")}):e.infoHash&&e.infoHash.toString("binary")||n.client._infoHashBinary,r={action:"scrape",info_hash:o};n._send(r)}},WebSocketTracker.prototype.destroy=function(e){function n(){i&&(clearTimeout(i),i=null),c.removeListener("data",n),c.destroy(),c=null}var o=this;if(e||(e=noop),o.destroyed)return e(null);o.destroyed=!0,clearInterval(o.interval),clearTimeout(o.reconnectTimer);for(var r in o.peers){var t=o.peers[r];clearTimeout(t.trackerTimeout),t.destroy()}if(o.peers=null,o.socket&&(o.socket.removeListener("connect",o._onSocketConnectBound),o.socket.removeListener("data",o._onSocketDataBound),o.socket.removeListener("close",o._onSocketCloseBound),o.socket.removeListener("error",o._onSocketErrorBound),o.socket=null),o._onSocketConnectBound=null,o._onSocketErrorBound=null,o._onSocketDataBound=null,o._onSocketCloseBound=null,socketPool[o.announceUrl]&&(socketPool[o.announceUrl].consumers-=1),socketPool[o.announceUrl].consumers>0)return e();var c=socketPool[o.announceUrl];if(delete socketPool[o.announceUrl],c.on("error",noop),c.once("close",e),!o.expectingResponse)return n();var i=setTimeout(n,common.DESTROY_TIMEOUT);c.once("data",n)},WebSocketTracker.prototype._openSocket=function(){var e=this;e.destroyed=!1,e.peers||(e.peers={}),e._onSocketConnectBound=function(){e._onSocketConnect()},e._onSocketErrorBound=function(n){e._onSocketError(n)},e._onSocketDataBound=function(n){e._onSocketData(n)},e._onSocketCloseBound=function(){e._onSocketClose()},e.socket=socketPool[e.announceUrl],e.socket?socketPool[e.announceUrl].consumers+=1:(e.socket=socketPool[e.announceUrl]=new Socket(e.announceUrl),e.socket.consumers=1,e.socket.once("connect",e._onSocketConnectBound)),e.socket.on("data",e._onSocketDataBound),e.socket.once("close",e._onSocketCloseBound),e.socket.once("error",e._onSocketErrorBound)},WebSocketTracker.prototype._onSocketConnect=function(){var e=this;e.destroyed||e.reconnecting&&(e.reconnecting=!1,e.retries=0,e.announce(e.client._defaultAnnounceOpts()))},WebSocketTracker.prototype._onSocketData=function(e){var n=this;if(!n.destroyed){n.expectingResponse=!1;try{e=JSON.parse(e)}catch(e){return void n.client.emit("warning",new Error("Invalid tracker response"))}"announce"===e.action?n._onAnnounceResponse(e):"scrape"===e.action?n._onScrapeResponse(e):n._onSocketError(new Error("invalid action in WS response: "+e.action))}},WebSocketTracker.prototype._onAnnounceResponse=function(e){var n=this;if(e.info_hash!==n.client._infoHashBinary)return void debug("ignoring websocket data from %s for %s (looking for %s: reused socket)",n.announceUrl,common.binaryToHex(e.info_hash),n.client.infoHash);if(!e.peer_id||e.peer_id!==n.client._peerIdBinary){debug("received %s from %s for %s",JSON.stringify(e),n.announceUrl,n.client.infoHash);var o=e["failure reason"];if(o)return n.client.emit("warning",new Error(o));var r=e["warning message"];r&&n.client.emit("warning",new Error(r));var t=e.interval||e["min interval"];t&&n.setInterval(1e3*t);var c=e["tracker id"];if(c&&(n._trackerId=c),null!=e.complete){var i=Object.assign({},e,{announce:n.announceUrl,infoHash:common.binaryToHex(e.info_hash)});n.client.emit("update",i)}var a;if(e.offer&&e.peer_id&&(debug("creating peer (from remote offer)"),a=n._createPeer(),a.id=common.binaryToHex(e.peer_id),a.once("signal",function(o){var r={action:"announce",info_hash:n.client._infoHashBinary,peer_id:n.client._peerIdBinary,to_peer_id:e.peer_id,answer:o,offer_id:e.offer_id};n._trackerId&&(r.trackerid=n._trackerId),n._send(r)}),a.signal(e.offer),n.client.emit("peer",a)),e.answer&&e.peer_id){var s=common.binaryToHex(e.offer_id);a=n.peers[s],a?(a.id=common.binaryToHex(e.peer_id),a.signal(e.answer),n.client.emit("peer",a),clearTimeout(a.trackerTimeout),a.trackerTimeout=null,delete n.peers[s]):debug("got unexpected answer: "+JSON.stringify(e.answer))}}},WebSocketTracker.prototype._onScrapeResponse=function(e){var n=this;e=e.files||{};var o=Object.keys(e);if(0===o.length)return void n.client.emit("warning",new Error("invalid scrape response"));o.forEach(function(o){var r=Object.assign(e[o],{announce:n.announceUrl,infoHash:common.binaryToHex(o)});n.client.emit("scrape",r)})},WebSocketTracker.prototype._onSocketClose=function(){var e=this;e.destroyed||(e.destroy(),e._startReconnectTimer())},WebSocketTracker.prototype._onSocketError=function(e){var n=this;n.destroyed||(n.destroy(),n.client.emit("warning",e),n._startReconnectTimer())},WebSocketTracker.prototype._startReconnectTimer=function(){var e=this,n=Math.floor(Math.random()*RECONNECT_VARIANCE)+Math.min(Math.pow(2,e.retries)*RECONNECT_MINIMUM,RECONNECT_MAXIMUM);e.reconnecting=!0,clearTimeout(e.reconnectTimer),e.reconnectTimer=setTimeout(function(){e.retries++,e._openSocket()},n),e.reconnectTimer.unref&&e.reconnectTimer.unref(),debug("reconnecting socket in %s ms",n)},WebSocketTracker.prototype._send=function(e){var n=this;if(!n.destroyed){n.expectingResponse=!0;var o=JSON.stringify(e);debug("send %s",o),n.socket.send(o)}},WebSocketTracker.prototype._generateOffers=function(e,n){function o(){t.length===e&&(debug("generated %s offers",e),n(t))}var r=this,t=[];debug("generating %s offers",e);for(var c=0;c<e;++c)!function(){var e=randombytes(20).toString("hex");debug("creating peer (from _generateOffers)");var n=r.peers[e]=r._createPeer({initiator:!0});n.once("signal",function(n){t.push({offer:n,offer_id:common.hexToBinary(e)}),o()}),n.trackerTimeout=setTimeout(function(){debug("tracker timeout: destroying peer"),n.trackerTimeout=null,delete r.peers[e],n.destroy()},OFFER_TIMEOUT),n.trackerTimeout.unref&&n.trackerTimeout.unref()}();o()},WebSocketTracker.prototype._createPeer=function(e){function n(e){r.client.emit("warning",new Error("Connection error: "+e.message)),t.destroy()}function o(){t.removeListener("error",n),t.removeListener("connect",o)}var r=this;e=Object.assign({trickle:!1,config:r.client._rtcConfig,wrtc:r.client._wrtc},e);var t=new Peer(e);return t.once("error",n),t.once("connect",o),t};

},{"../common":288,"./tracker":286,"debug":88,"inherits":144,"randombytes":223,"simple-peer":289,"simple-websocket":259,"xtend":324}],288:[function(require,module,exports){
var Buffer=require("safe-buffer").Buffer,extend=require("xtend/mutable");exports.DEFAULT_ANNOUNCE_PEERS=50,exports.MAX_ANNOUNCE_PEERS=82,exports.binaryToHex=function(r){return"string"!=typeof r&&(r=String(r)),Buffer.from(r,"binary").toString("hex")},exports.hexToBinary=function(r){return"string"!=typeof r&&(r=String(r)),Buffer.from(r,"hex").toString("binary")};var config=require("./common-node");extend(exports,config);

},{"./common-node":37,"safe-buffer":244,"xtend/mutable":325}],289:[function(require,module,exports){
(function (Buffer){
function Peer(e){var n=this;if(!(n instanceof Peer))return new Peer(e);if(n._id=randombytes(4).toString("hex").slice(0,7),n._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),stream.Duplex.call(n,e),n.channelName=e.initiator?e.channelName||randombytes(20).toString("hex"):null,n._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,n.initiator=e.initiator||!1,n.channelConfig=e.channelConfig||Peer.channelConfig,n.config=e.config||Peer.config,n.constraints=n._transformConstraints(e.constraints||Peer.constraints),n.offerConstraints=n._transformConstraints(e.offerConstraints||{}),n.answerConstraints=n._transformConstraints(e.answerConstraints||{}),n.reconnectTimer=e.reconnectTimer||!1,n.sdpTransform=e.sdpTransform||function(e){return e},n.stream=e.stream||!1,n.trickle=void 0===e.trickle||e.trickle,n._earlyMessage=null,n.destroyed=!1,n.connected=!1,n.remoteAddress=void 0,n.remoteFamily=void 0,n.remotePort=void 0,n.localAddress=void 0,n.localPort=void 0,n._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:getBrowserRTC(),!n._wrtc)throw"undefined"==typeof window?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser");if(n._pcReady=!1,n._channelReady=!1,n._iceComplete=!1,n._channel=null,n._pendingCandidates=[],n._previousStreams=[],n._chunk=null,n._cb=null,n._interval=null,n._reconnectTimeout=null,n._pc=new n._wrtc.RTCPeerConnection(n.config,n.constraints),n._isWrtc=Array.isArray(n._pc.RTCIceConnectionStates),n._isReactNativeWebrtc="number"==typeof n._pc._peerConnectionId,n._pc.oniceconnectionstatechange=function(){n._onIceStateChange()},n._pc.onicegatheringstatechange=function(){n._onIceStateChange()},n._pc.onsignalingstatechange=function(){n._onSignalingStateChange()},n._pc.onicecandidate=function(e){n._onIceCandidate(e)},n.initiator){var t=!1;n._pc.onnegotiationneeded=function(){t||n._createOffer(),t=!0},n._setupData({channel:n._pc.createDataChannel(n.channelName,n.channelConfig)})}else n._pc.ondatachannel=function(e){n._setupData(e)};"addTrack"in n._pc?(n.stream&&n.stream.getTracks().forEach(function(e){n._pc.addTrack(e,n.stream)}),n._pc.ontrack=function(e){n._onTrack(e)}):(n.stream&&n._pc.addStream(n.stream),n._pc.onaddstream=function(e){n._onAddStream(e)}),n.initiator&&n._isWrtc&&n._pc.onnegotiationneeded(),n._onFinishBound=function(){n._onFinish()},n.once("finish",n._onFinishBound)}function noop(){}module.exports=Peer;var debug=require("debug")("simple-peer"),getBrowserRTC=require("get-browser-rtc"),inherits=require("inherits"),randombytes=require("randombytes"),stream=require("readable-stream"),MAX_BUFFERED_AMOUNT=65536;inherits(Peer,stream.Duplex),Peer.WEBRTC_SUPPORT=!!getBrowserRTC(),Peer.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},Peer.constraints={},Peer.channelConfig={},Object.defineProperty(Peer.prototype,"bufferSize",{get:function(){var e=this;return e._channel&&e._channel.bufferedAmount||0}}),Peer.prototype.address=function(){var e=this;return{port:e.localPort,family:"IPv4",address:e.localAddress}},Peer.prototype.signal=function(e){var n=this;if(n.destroyed)throw new Error("cannot signal after peer is destroyed");if("string"==typeof e)try{e=JSON.parse(e)}catch(n){e={}}n._debug("signal()"),e.candidate&&(n._pc.remoteDescription?n._addIceCandidate(e.candidate):n._pendingCandidates.push(e.candidate)),e.sdp&&n._pc.setRemoteDescription(new n._wrtc.RTCSessionDescription(e),function(){n.destroyed||(n._pendingCandidates.forEach(function(e){n._addIceCandidate(e)}),n._pendingCandidates=[],"offer"===n._pc.remoteDescription.type&&n._createAnswer())},function(e){n._destroy(e)}),e.sdp||e.candidate||n._destroy(new Error("signal() called with invalid signal data"))},Peer.prototype._addIceCandidate=function(e){var n=this;try{n._pc.addIceCandidate(new n._wrtc.RTCIceCandidate(e),noop,function(e){n._destroy(e)})}catch(e){n._destroy(new Error("error adding candidate: "+e.message))}},Peer.prototype.send=function(e){var n=this;n._isWrtc&&Buffer.isBuffer(e)&&(e=new Uint8Array(e)),n._channel.send(e)},Peer.prototype.destroy=function(e){this._destroy(null,e)},Peer.prototype._destroy=function(e,n){var t=this;if(!t.destroyed){if(n&&t.once("close",n),t._debug("destroy (error: %s)",e&&(e.message||e)),t.readable=t.writable=!1,t._readableState.ended||t.push(null),t._writableState.finished||t.end(),t.destroyed=!0,t.connected=!1,t._pcReady=!1,t._channelReady=!1,t._previousStreams=null,t._earlyMessage=null,clearInterval(t._interval),clearTimeout(t._reconnectTimeout),t._interval=null,t._reconnectTimeout=null,t._chunk=null,t._cb=null,t._onFinishBound&&t.removeListener("finish",t._onFinishBound),t._onFinishBound=null,t._pc){try{t._pc.close()}catch(e){}t._pc.oniceconnectionstatechange=null,t._pc.onicegatheringstatechange=null,t._pc.onsignalingstatechange=null,t._pc.onicecandidate=null,"addTrack"in t._pc?t._pc.ontrack=null:t._pc.onaddstream=null,t._pc.onnegotiationneeded=null,t._pc.ondatachannel=null}if(t._channel){try{t._channel.close()}catch(e){}t._channel.onmessage=null,t._channel.onopen=null,t._channel.onclose=null,t._channel.onerror=null}t._pc=null,t._channel=null,e&&t.emit("error",e),t.emit("close")}},Peer.prototype._setupData=function(e){var n=this;if(!e.channel)return n._destroy(new Error("Data channel event is missing `channel` property"));n._channel=e.channel,n._channel.binaryType="arraybuffer","number"==typeof n._channel.bufferedAmountLowThreshold&&(n._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),n.channelName=n._channel.label,n._channel.onmessage=function(e){n._channelReady?n._onChannelMessage(e):(n._earlyMessage=e,n._onChannelOpen())},n._channel.onbufferedamountlow=function(){n._onChannelBufferedAmountLow()},n._channel.onopen=function(){n._channelReady||n._onChannelOpen()},n._channel.onclose=function(){n._onChannelClose()},n._channel.onerror=function(e){n._destroy(e)}},Peer.prototype._read=function(){},Peer.prototype._write=function(e,n,t){var o=this;if(o.destroyed)return t(new Error("cannot write after peer is destroyed"));if(o.connected){try{o.send(e)}catch(e){return o._destroy(e)}o._channel.bufferedAmount>MAX_BUFFERED_AMOUNT?(o._debug("start backpressure: bufferedAmount %d",o._channel.bufferedAmount),o._cb=t):t(null)}else o._debug("write before connect"),o._chunk=e,o._cb=t},Peer.prototype._onFinish=function(){function e(){setTimeout(function(){n._destroy()},1e3)}var n=this;n.destroyed||(n.connected?e():n.once("connect",e))},Peer.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(n){function t(){e.destroyed||(e.trickle||e._iceComplete?r():e.once("_iceComplete",r))}function o(n){e._destroy(n)}function r(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})}e.destroyed||(n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,t,o))},function(n){e._destroy(n)},e.offerConstraints)},Peer.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(n){function t(){e.destroyed||(e.trickle||e._iceComplete?r():e.once("_iceComplete",r))}function o(n){e._destroy(n)}function r(){var t=e._pc.localDescription||n;e._debug("signal"),e.emit("signal",{type:t.type,sdp:t.sdp})}e.destroyed||(n.sdp=e.sdpTransform(n.sdp),e._pc.setLocalDescription(n,t,o))},function(n){e._destroy(n)},e.answerConstraints)},Peer.prototype._onIceStateChange=function(){var e=this;if(!e.destroyed){var n=e._pc.iceConnectionState,t=e._pc.iceGatheringState;e._debug("iceStateChange (connection: %s) (gathering: %s)",n,t),e.emit("iceStateChange",n,t),"connected"!==n&&"completed"!==n||(clearTimeout(e._reconnectTimeout),e._pcReady=!0,e._maybeReady()),"disconnected"===n&&(e.reconnectTimer?(clearTimeout(e._reconnectTimeout),e._reconnectTimeout=setTimeout(function(){e._destroy()},e.reconnectTimer)):e._destroy()),"failed"===n&&e._destroy(new Error("Ice connection failed.")),"closed"===n&&e._destroy()}},Peer.prototype.getStats=function(e){var n=this;0===n._pc.getStats.length?n._pc.getStats().then(function(n){var t=[];n.forEach(function(e){t.push(e)}),e(null,t)},function(n){e(n)}):n._isReactNativeWebrtc?n._pc.getStats(null,function(n){var t=[];n.forEach(function(e){t.push(e)}),e(null,t)},function(n){e(n)}):n._pc.getStats.length>0?n._pc.getStats(function(n){var t=[];n.result().forEach(function(e){var n={};e.names().forEach(function(t){n[t]=e.stat(t)}),n.id=e.id,n.type=e.type,n.timestamp=e.timestamp,t.push(n)}),e(null,t)},function(n){e(n)}):e(null,[])},Peer.prototype._maybeReady=function(){var e=this;e._debug("maybeReady pc %s channel %s",e._pcReady,e._channelReady),!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,e.getStats(function(n,t){function o(n){var t=a[n.localCandidateId];t&&t.ip?(e.localAddress=t.ip,e.localPort=Number(t.port)):t&&t.ipAddress?(e.localAddress=t.ipAddress,e.localPort=Number(t.portNumber)):"string"==typeof n.googLocalAddress&&(t=n.googLocalAddress.split(":"),e.localAddress=t[0],e.localPort=Number(t[1]));var o=r[n.remoteCandidateId];o&&o.ip?(e.remoteAddress=o.ip,e.remotePort=Number(o.port)):o&&o.ipAddress?(e.remoteAddress=o.ipAddress,e.remotePort=Number(o.portNumber)):"string"==typeof n.googRemoteAddress&&(o=n.googRemoteAddress.split(":"),e.remoteAddress=o[0],e.remotePort=Number(o[1])),e.remoteFamily="IPv4",e._debug("connect local: %s:%s remote: %s:%s",e.localAddress,e.localPort,e.remoteAddress,e.remotePort)}if(!e.destroyed){n&&(t=[]),e._connecting=!1,e.connected=!0;var r={},a={},i={};if(t.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(r[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(a[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(i[e.id]=e)}),t.forEach(function(e){"transport"===e.type&&o(i[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),e._chunk){try{e.send(e._chunk)}catch(n){return e._destroy(n)}e._chunk=null,e._debug('sent chunk from "write before connect"');var c=e._cb;e._cb=null,c(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect"),e._earlyMessage&&(e._onChannelMessage(e._earlyMessage),e._earlyMessage=null)}}))},Peer.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT||this._onChannelBufferedAmountLow()},Peer.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||(e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},Peer.prototype._onIceCandidate=function(e){var n=this;n.destroyed||(e.candidate&&n.trickle?n.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||(n._iceComplete=!0,n.emit("_iceComplete")))},Peer.prototype._onChannelMessage=function(e){var n=this;if(!n.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=Buffer.from(t)),n.push(t)}},Peer.prototype._onChannelBufferedAmountLow=function(){var e=this;if(!e.destroyed&&e._cb){e._debug("ending backpressure: bufferedAmount %d",e._channel.bufferedAmount);var n=e._cb;e._cb=null,n(null)}},Peer.prototype._onChannelOpen=function(){var e=this;e.connected||e.destroyed||(e._debug("on channel open"),e._channelReady=!0,e._maybeReady())},Peer.prototype._onChannelClose=function(){var e=this;e.destroyed||(e._debug("on channel close"),e._destroy())},Peer.prototype._onAddStream=function(e){var n=this;n.destroyed||(n._debug("on add stream"),n.emit("stream",e.stream))},Peer.prototype._onTrack=function(e){var n=this;if(!n.destroyed){n._debug("on track");var t=e.streams[0].id;-1===n._previousStreams.indexOf(t)&&(n._previousStreams.push(t),n.emit("stream",e.streams[0]))}},Peer.prototype._debug=function(){var e=this,n=[].slice.call(arguments);n[0]="["+e._id+"] "+n[0],debug.apply(null,n)},Peer.prototype._transformConstraints=function(e){var n=this;if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!n._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!n._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})};

}).call(this,require("buffer").Buffer)
},{"buffer":66,"debug":88,"get-browser-rtc":125,"inherits":144,"randombytes":223,"readable-stream":235}],290:[function(require,module,exports){
(function (Buffer){
function Piece(t){if(!(this instanceof Piece))return new Piece(t);this.length=t,this.missing=t,this.sources=null,this._chunks=Math.ceil(t/BLOCK_LENGTH),this._remainder=t%BLOCK_LENGTH||BLOCK_LENGTH,this._buffered=0,this._buffer=null,this._cancellations=null,this._reservations=0,this._flushed=!1}module.exports=Piece;var BLOCK_LENGTH=16384;Piece.BLOCK_LENGTH=BLOCK_LENGTH,Piece.prototype.chunkLength=function(t){return t===this._chunks-1?this._remainder:BLOCK_LENGTH},Piece.prototype.chunkLengthRemaining=function(t){return this.length-t*BLOCK_LENGTH},Piece.prototype.chunkOffset=function(t){return t*BLOCK_LENGTH},Piece.prototype.reserve=function(){return this.init()?this._cancellations.length?this._cancellations.pop():this._reservations<this._chunks?this._reservations++:-1:-1},Piece.prototype.reserveRemaining=function(){if(!this.init())return-1;if(this._reservations<this._chunks){var t=this._reservations;return this._reservations=this._chunks,t}return-1},Piece.prototype.cancel=function(t){this.init()&&this._cancellations.push(t)},Piece.prototype.cancelRemaining=function(t){this.init()&&(this._reservations=t)},Piece.prototype.get=function(t){return this.init()?this._buffer[t]:null},Piece.prototype.set=function(t,e,i){if(!this.init())return!1;for(var s=e.length,n=Math.ceil(s/BLOCK_LENGTH),r=0;r<n;r++)if(!this._buffer[t+r]){var h=r*BLOCK_LENGTH,u=e.slice(h,h+BLOCK_LENGTH);this._buffered++,this._buffer[t+r]=u,this.missing-=u.length,-1===this.sources.indexOf(i)&&this.sources.push(i)}return this._buffered===this._chunks},Piece.prototype.flush=function(){if(!this._buffer||this._chunks!==this._buffered)return null;var t=Buffer.concat(this._buffer,this.length);return this._buffer=null,this._cancellations=null,this.sources=null,this._flushed=!0,t},Piece.prototype.init=function(){return!this._flushed&&(!!this._buffer||(this._buffer=new Array(this._chunks),this._cancellations=[],this.sources=[],!0))};

}).call(this,require("buffer").Buffer)
},{"buffer":66}],291:[function(require,module,exports){
(function (Buffer){
var isTypedArray=require("is-typedarray").strict;module.exports=function(e){if(isTypedArray(e)){var r=new Buffer(e.buffer);return e.byteLength!==e.buffer.byteLength&&(r=r.slice(e.byteOffset,e.byteOffset+e.byteLength)),r}return new Buffer(e)};
}).call(this,require("buffer").Buffer)
},{"buffer":66,"is-typedarray":148}],292:[function(require,module,exports){
(function (Buffer){
var UINT_32_MAX=4294967295;exports.encodingLength=function(){return 8},exports.encode=function(e,r,t){r||(r=new Buffer(8)),t||(t=0);var n=Math.floor(e/UINT_32_MAX),o=e-n*UINT_32_MAX;return r.writeUInt32BE(n,t),r.writeUInt32BE(o,t+4),r},exports.decode=function(e,r){r||(r=0),e||(e=new Buffer(4)),r||(r=0);var t=e.readUInt32BE(r),n=e.readUInt32BE(r+4);return t*UINT_32_MAX+n},exports.encode.bytes=8,exports.decode.bytes=8;
}).call(this,require("buffer").Buffer)
},{"buffer":66}],293:[function(require,module,exports){
"use strict";function unique_pred(n,e){for(var u=1,t=n.length,i=n[0],r=n[0],o=1;o<t;++o)if(r=i,i=n[o],e(i,r)){if(o===u){u++;continue}n[u++]=i}return n.length=u,n}function unique_eq(n){for(var e=1,u=n.length,t=n[0],i=n[0],r=1;r<u;++r,i=t)if(i=t,(t=n[r])!==i){if(r===e){e++;continue}n[e++]=t}return n.length=e,n}function unique(n,e,u){return 0===n.length?n:e?(u||n.sort(e),unique_pred(n,e)):(u||n.sort(),unique_eq(n))}module.exports=unique;

},{}],294:[function(require,module,exports){
function remove(e,r){if(!(r>=e.length||r<0)){var n=e.pop();if(r<e.length){var o=e[r];return e[r]=n,o}return n}}module.exports=remove;

},{}],295:[function(require,module,exports){
"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(t,s,e){if(t&&util.isObject(t)&&t instanceof Url)return t;var h=new Url;return h.parse(t,s,e),h}function urlFormat(t){return util.isString(t)&&(t=urlParse(t)),t instanceof Url?t.format():Url.prototype.format.call(t)}function urlResolve(t,s){return urlParse(t,!1,!0).resolve(s)}function urlResolveObject(t,s){return t?urlParse(t,!1,!0).resolveObject(s):s}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(t,s,e){if(!util.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var h=t.indexOf("?"),r=-1!==h&&h<t.indexOf("#")?"?":"#",a=t.split(r),o=/\\/g;a[0]=a[0].replace(o,"/"),t=a.join(r);var n=t;if(n=n.trim(),!e&&1===t.split("#").length){var i=simplePathPattern.exec(n);if(i)return this.path=n,this.href=n,this.pathname=i[1],i[2]?(this.search=i[2],this.query=s?querystring.parse(this.search.substr(1)):this.search.substr(1)):s&&(this.search="",this.query={}),this}var l=protocolPattern.exec(n);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,n=n.substr(l.length)}if(e||l||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===n.substr(0,2);!p||l&&hostlessProtocol[l]||(n=n.substr(2),this.slashes=!0)}if(!hostlessProtocol[l]&&(p||l&&!slashedProtocol[l])){for(var c=-1,f=0;f<hostEndingChars.length;f++){var m=n.indexOf(hostEndingChars[f]);-1!==m&&(-1===c||m<c)&&(c=m)}var v,g;g=-1===c?n.lastIndexOf("@"):n.lastIndexOf("@",c),-1!==g&&(v=n.slice(0,g),n=n.slice(g+1),this.auth=decodeURIComponent(v)),c=-1;for(var f=0;f<nonHostChars.length;f++){var m=n.indexOf(nonHostChars[f]);-1!==m&&(-1===c||m<c)&&(c=m)}-1===c&&(c=n.length),this.host=n.slice(0,c),n=n.slice(c),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var P=this.hostname.split(/\./),f=0,d=P.length;f<d;f++){var b=P[f];if(b&&!b.match(hostnamePartPattern)){for(var q="",O=0,j=b.length;O<j;O++)b.charCodeAt(O)>127?q+="x":q+=b[O];if(!q.match(hostnamePartPattern)){var x=P.slice(0,f),U=P.slice(f+1),C=b.match(hostnamePartStart);C&&(x.push(C[1]),U.unshift(C[2])),U.length&&(n="/"+U.join(".")+n),this.hostname=x.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=punycode.toASCII(this.hostname));var A=this.port?":"+this.port:"",w=this.hostname||"";this.host=w+A,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!unsafeProtocol[u])for(var f=0,d=autoEscape.length;f<d;f++){var E=autoEscape[f];if(-1!==n.indexOf(E)){var I=encodeURIComponent(E);I===E&&(I=escape(E)),n=n.split(E).join(I)}}var R=n.indexOf("#");-1!==R&&(this.hash=n.substr(R),n=n.slice(0,R));var S=n.indexOf("?");if(-1!==S?(this.search=n.substr(S),this.query=n.substr(S+1),s&&(this.query=querystring.parse(this.query)),n=n.slice(0,S)):s&&(this.search="",this.query={}),n&&(this.pathname=n),slashedProtocol[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var A=this.pathname||"",k=this.search||"";this.path=A+k}return this.href=this.format(),this},Url.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var s=this.protocol||"",e=this.pathname||"",h=this.hash||"",r=!1,a="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(a=querystring.stringify(this.query));var o=this.search||a&&"?"+a||"";return s&&":"!==s.substr(-1)&&(s+=":"),this.slashes||(!s||slashedProtocol[s])&&!1!==r?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),h&&"#"!==h.charAt(0)&&(h="#"+h),o&&"?"!==o.charAt(0)&&(o="?"+o),e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),o=o.replace("#","%23"),s+r+e+o+h},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if(util.isString(t)){var s=new Url;s.parse(t,!1,!0),t=s}for(var e=new Url,h=Object.keys(this),r=0;r<h.length;r++){var a=h[r];e[a]=this[a]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),n=0;n<o.length;n++){var i=o[n];"protocol"!==i&&(e[i]=t[i])}return slashedProtocol[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol[t.protocol]){for(var l=Object.keys(t),u=0;u<l.length;u++){var p=l[u];e[p]=t[p]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||hostlessProtocol[t.protocol])e.pathname=t.pathname;else{for(var c=(t.pathname||"").split("/");c.length&&!(t.host=c.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==c[0]&&c.unshift(""),c.length<2&&c.unshift(""),e.pathname=c.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){var f=e.pathname||"",m=e.search||"";e.path=f+m}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var v=e.pathname&&"/"===e.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=g||v||e.host&&t.pathname,P=y,d=e.pathname&&e.pathname.split("/")||[],c=t.pathname&&t.pathname.split("/")||[],b=e.protocol&&!slashedProtocol[e.protocol];if(b&&(e.hostname="",e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===c[0]?c[0]=t.host:c.unshift(t.host)),t.host=null),y=y&&(""===c[0]||""===d[0])),g)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,d=c;else if(c.length)d||(d=[]),d.pop(),d=d.concat(c),e.search=t.search,e.query=t.query;else if(!util.isNullOrUndefined(t.search)){if(b){e.hostname=e.host=d.shift();var q=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");q&&(e.auth=q.shift(),e.host=e.hostname=q.shift())}return e.search=t.search,e.query=t.query,util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!d.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var O=d.slice(-1)[0],j=(e.host||t.host||d.length>1)&&("."===O||".."===O)||""===O,x=0,U=d.length;U>=0;U--)O=d[U],"."===O?d.splice(U,1):".."===O?(d.splice(U,1),x++):x&&(d.splice(U,1),x--);if(!y&&!P)for(;x--;x)d.unshift("..");!y||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),j&&"/"!==d.join("/").substr(-1)&&d.push("");var C=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(b){e.hostname=e.host=C?"":d.length?d.shift():"";var q=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");q&&(e.auth=q.shift(),e.host=e.hostname=q.shift())}return y=y||e.host&&d.length,y&&!C&&d.unshift(""),d.length?e.pathname=d.join("/"):(e.pathname=null,e.path=null),util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url.prototype.parseHost=function(){var t=this.host,s=portPattern.exec(t);s&&(s=s[0],":"!==s&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};
},{"./util":296,"punycode":213,"querystring":217}],296:[function(require,module,exports){
"use strict";module.exports={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};
},{}],297:[function(require,module,exports){
var bencode=require("bencode"),BitField=require("bitfield"),Buffer=require("safe-buffer").Buffer,debug=require("debug")("ut_metadata"),EventEmitter=require("events").EventEmitter,inherits=require("inherits"),sha1=require("simple-sha1"),MAX_METADATA_SIZE=1e7,BITFIELD_GROW=1e3,PIECE_LENGTH=16384;module.exports=function(e){function t(t){EventEmitter.call(this),this._wire=t,this._metadataComplete=!1,this._metadataSize=null,this._remainingRejects=null,this._fetching=!1,this._bitfield=new BitField(0,{grow:BITFIELD_GROW}),Buffer.isBuffer(e)&&this.setMetadata(e)}return inherits(t,EventEmitter),t.prototype.name="ut_metadata",t.prototype.onHandshake=function(e,t,i){this._infoHash=e},t.prototype.onExtendedHandshake=function(e){return e.m&&e.m.ut_metadata?e.metadata_size?"number"!=typeof e.metadata_size||MAX_METADATA_SIZE<e.metadata_size||e.metadata_size<=0?this.emit("warning",new Error("Peer gave invalid metadata size")):(this._metadataSize=e.metadata_size,this._numPieces=Math.ceil(this._metadataSize/PIECE_LENGTH),this._remainingRejects=2*this._numPieces,void(this._fetching&&this._requestPieces())):this.emit("warning",new Error("Peer does not have metadata")):this.emit("warning",new Error("Peer does not support ut_metadata"))},t.prototype.onMessage=function(e){var t,i;try{var a=e.toString(),s=a.indexOf("ee")+2;t=bencode.decode(a.substring(0,s)),i=e.slice(s)}catch(e){return}switch(t.msg_type){case 0:this._onRequest(t.piece);break;case 1:this._onData(t.piece,i,t.total_size);break;case 2:this._onReject(t.piece)}},t.prototype.fetch=function(){this._metadataComplete||(this._fetching=!0,this._metadataSize&&this._requestPieces())},t.prototype.cancel=function(){this._fetching=!1},t.prototype.setMetadata=function(e){if(this._metadataComplete)return!0;debug("set metadata");try{var t=bencode.decode(e).info;t&&(e=bencode.encode(t))}catch(e){}return(!this._infoHash||this._infoHash===sha1.sync(e))&&(this.cancel(),this.metadata=e,this._metadataComplete=!0,this._metadataSize=this.metadata.length,this._wire.extendedHandshake.metadata_size=this._metadataSize,this.emit("metadata",bencode.encode({info:bencode.decode(this.metadata)})),!0)},t.prototype._send=function(e,t){var i=bencode.encode(e);Buffer.isBuffer(t)&&(i=Buffer.concat([i,t])),this._wire.extended("ut_metadata",i)},t.prototype._request=function(e){this._send({msg_type:0,piece:e})},t.prototype._data=function(e,t,i){var a={msg_type:1,piece:e};"number"==typeof i&&(a.total_size=i),this._send(a,t)},t.prototype._reject=function(e){this._send({msg_type:2,piece:e})},t.prototype._onRequest=function(e){if(!this._metadataComplete)return void this._reject(e);var t=e*PIECE_LENGTH,i=t+PIECE_LENGTH;i>this._metadataSize&&(i=this._metadataSize);var a=this.metadata.slice(t,i);this._data(e,a,this._metadataSize)},t.prototype._onData=function(e,t,i){t.length>PIECE_LENGTH||(t.copy(this.metadata,e*PIECE_LENGTH),this._bitfield.set(e),this._checkDone())},t.prototype._onReject=function(e){this._remainingRejects>0&&this._fetching?(this._request(e),this._remainingRejects-=1):this.emit("warning",new Error('Peer sent "reject" too much'))},t.prototype._requestPieces=function(){this.metadata=Buffer.alloc(this._metadataSize);for(var e=0;e<this._numPieces;e++)this._request(e)},t.prototype._checkDone=function(){for(var e=!0,t=0;t<this._numPieces;t++)if(!this._bitfield.get(t)){e=!1;break}if(e){this.setMetadata(this.metadata)||this._failedMetadata()}},t.prototype._failedMetadata=function(){this._bitfield=new BitField(0,{grow:BITFIELD_GROW}),this._remainingRejects-=this._numPieces,this._remainingRejects>0?this._requestPieces():this.emit("warning",new Error("Peer sent invalid metadata"))},t};

},{"bencode":300,"bitfield":20,"debug":88,"events":121,"inherits":144,"safe-buffer":244,"simple-sha1":258}],298:[function(require,module,exports){
arguments[4][22][0].apply(exports,arguments)
},{"buffer":66,"dup":22}],299:[function(require,module,exports){
function encode(e,f,o){var n=[],r=null;return encode._encode(n,e),r=Buffer.concat(n),encode.bytes=r.length,Buffer.isBuffer(f)?(r.copy(f,o),f):r}var Buffer=require("safe-buffer").Buffer;encode.bytes=-1,encode._floatConversionDetected=!1,encode._encode=function(e,f){if(Buffer.isBuffer(f))return e.push(Buffer.from(f.length+":")),void e.push(f);if(null!=f)switch(typeof f){case"string":encode.buffer(e,f);break;case"number":encode.number(e,f);break;case"object":f.constructor===Array?encode.list(e,f):encode.dict(e,f);break;case"boolean":encode.number(e,f?1:0)}};var buffE=Buffer.from("e"),buffD=Buffer.from("d"),buffL=Buffer.from("l");encode.buffer=function(e,f){e.push(Buffer.from(Buffer.byteLength(f)+":"+f))},encode.number=function(e,f){var o=f/2147483648<<0,n=f%2147483648<<0,r=2147483648*o+n;e.push(Buffer.from("i"+r+"e")),r===f||encode._floatConversionDetected||(encode._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+f+'":','Bencoding only defines support for integers, value was converted to "'+r+'"'),console.trace())},encode.dict=function(e,f){e.push(buffD);for(var o,n=0,r=Object.keys(f).sort(),u=r.length;n<u;n++)o=r[n],null!=f[o]&&(encode.buffer(e,o),encode._encode(e,f[o]));e.push(buffE)},encode.list=function(e,f){var o=0,n=f.length;for(e.push(buffL);o<n;o++)null!=f[o]&&encode._encode(e,f[o]);e.push(buffE)},module.exports=encode;
},{"safe-buffer":244}],300:[function(require,module,exports){
arguments[4][24][0].apply(exports,arguments)
},{"./decode":298,"./encode":299,"dup":24}],301:[function(require,module,exports){
(function (global){
function deprecate(r,e){function o(){if(!t){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}if(config("noDeprecation"))return r;var t=!1;return o}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],302:[function(require,module,exports){
arguments[4][144][0].apply(exports,arguments)
},{"dup":144}],303:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],304:[function(require,module,exports){
(function (process,global){
function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c="",a=!1,l=["{","}"];if(isArray(r)&&(a=!0,l=["[","]"]),isFunction(r)){c=" [Function"+(r.name?": "+r.name:"")+"]"}if(isRegExp(r)&&(c=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(c=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(c=" "+formatError(r)),0===o.length&&(!a||0==r.length))return l[0]+c+l[1];if(t<0)return isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var p;return p=a?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,a)}),e.seen.pop(),reduceToSingleString(p,c,l)}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;s<u;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if(c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]},c.get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){var n=0;return e.reduce(function(e,r){return n++,r.indexOf("\n")>=0&&n++,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}for(var t=1,n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(e){return"[Circular]"}default:return e}}),s=n[t];t<i;s=n[++t])isNull(s)||!isObject(s)?o+=" "+s:o+=" "+inspect(s);return o},exports.deprecate=function(e,r){function t(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var n=!1;return t};var debugs={},debugEnviron;exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./support/isBuffer":303,"_process":205,"inherits":302}],305:[function(require,module,exports){
function read(e,r){var a,d=0,r=r||0,t=0,o=r,n=e.length;do{if(o>=n)return read.bytes=0,void(read.bytesRead=0);a=e[o++],d+=t<28?(a&REST)<<t:(a&REST)*Math.pow(2,t),t+=7}while(a>=MSB);return read.bytes=o-r,d}module.exports=read;var MSB=128,REST=127;

},{}],306:[function(require,module,exports){
function encode(e,o,r){o=o||[],r=r||0;for(var S=r;e>=INT;)o[r++]=255&e|MSB,e/=128;for(;e&MSBALL;)o[r++]=255&e|MSB,e>>>=7;return o[r]=0|e,encode.bytes=r-S+1,o}module.exports=encode;var MSB=128,REST=127,MSBALL=~REST,INT=Math.pow(2,31);

},{}],307:[function(require,module,exports){
module.exports={encode:require("./encode.js"),decode:require("./decode.js"),encodingLength:require("./length.js")};

},{"./decode.js":305,"./encode.js":306,"./length.js":308}],308:[function(require,module,exports){
var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63);module.exports=function(N){return N<N1?1:N<N2?2:N<N3?3:N<N4?4:N<N5?5:N<N6?6:N<N7?7:N<N8?8:N<N9?9:10};

},{}],309:[function(require,module,exports){
(function (Buffer){
function MP4Remuxer(e){var t=this;EventEmitter.call(t),t._tracks=[],t._fragmentSequence=1,t._file=e,t._decoder=null,t._findMoov(0)}function RunLengthIndex(e,t){var r=this;r._entries=e,r._countName=t||"count",r._index=0,r._offset=0,r.value=r._entries[0]}function empty(){return{version:0,flags:0,entries:[]}}var bs=require("binary-search"),EventEmitter=require("events").EventEmitter,inherits=require("inherits"),mp4=require("mp4-stream"),Box=require("mp4-box-encoding"),RangeSliceStream=require("range-slice-stream");module.exports=MP4Remuxer,inherits(MP4Remuxer,EventEmitter),MP4Remuxer.prototype._findMoov=function(e){var t=this;t._decoder&&t._decoder.destroy(),t._decoder=mp4.decode();var r=t._file.createReadStream({start:e});r.pipe(t._decoder),t._decoder.once("box",function(n){"moov"===n.type?t._decoder.decode(function(e){r.destroy();try{t._processMoov(e)}catch(e){e.message="Cannot parse mp4 file: "+e.message,t.emit("error",e)}}):(r.destroy(),t._findMoov(e+n.length))})},RunLengthIndex.prototype.inc=function(){var e=this;e._offset++,e._offset>=e._entries[e._index][e._countName]&&(e._index++,e._offset=0),e.value=e._entries[e._index]},MP4Remuxer.prototype._processMoov=function(e){var t=this,r=e.traks;t._tracks=[],t._hasVideo=!1,t._hasAudio=!1;for(var n=0;n<r.length;n++){var a,s,i=r[n],o=i.mdia.minf.stbl,m=o.stsd.entries[0],d=i.mdia.hdlr.handlerType;if("vide"===d&&"avc1"===m.type){if(t._hasVideo)continue;t._hasVideo=!0,a="avc1",m.avcC&&(a+="."+m.avcC.mimeCodec),s='video/mp4; codecs="'+a+'"'}else{if("soun"!==d||"mp4a"!==m.type)continue;if(t._hasAudio)continue;t._hasAudio=!0,a="mp4a",m.esds&&m.esds.mimeCodec&&(a+="."+m.esds.mimeCodec),s='audio/mp4; codecs="'+a+'"'}var f=[],c=0,u=0,l=0,p=0,h=0,_=0,v=new RunLengthIndex(o.stts.entries),g=null;o.ctts&&(g=new RunLengthIndex(o.ctts.entries));for(var y=0;;){var S=o.stsc.entries[h],k=o.stsz.entries[c],x=v.value.duration,M=g?g.value.compositionOffset:0,R=!0;if(o.stss&&(R=o.stss.entries[y]===c+1),f.push({size:k,duration:x,dts:_,presentationOffset:M,sync:R,offset:p+o.stco.entries[l]}),++c>=o.stsz.entries.length)break;if(u++,p+=k,u>=S.samplesPerChunk){u=0,p=0,l++;var b=o.stsc.entries[h+1];b&&l+1>=b.firstChunk&&h++}_+=x,v.inc(),g&&g.inc(),R&&y++}i.mdia.mdhd.duration=0,i.tkhd.duration=0;var I=S.sampleDescriptionId,E={type:"moov",mvhd:e.mvhd,traks:[{tkhd:i.tkhd,mdia:{mdhd:i.mdia.mdhd,hdlr:i.mdia.hdlr,elng:i.mdia.elng,minf:{vmhd:i.mdia.minf.vmhd,smhd:i.mdia.minf.smhd,dinf:i.mdia.minf.dinf,stbl:{stsd:o.stsd,stts:empty(),ctts:empty(),stsc:empty(),stsz:empty(),stco:empty(),stss:empty()}}}}],mvex:{mehd:{fragmentDuration:e.mvhd.duration},trexs:[{trackId:i.tkhd.trackId,defaultSampleDescriptionIndex:I,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0}]}};t._tracks.push({trackId:i.tkhd.trackId,timeScale:i.mdia.mdhd.timeScale,samples:f,currSample:null,currTime:null,moov:E,mime:s})}if(0===t._tracks.length)return void t.emit("error",new Error("no playable tracks"));e.mvhd.duration=0,t._ftyp={type:"ftyp",brand:"iso5",brandVersion:0,compatibleBrands:["iso5"]};var z=Box.encode(t._ftyp),N=t._tracks.map(function(e){var t=Box.encode(e.moov);return{mime:e.mime,init:Buffer.concat([z,t])}});t.emit("ready",N)},MP4Remuxer.prototype.seek=function(e){var t=this;if(!t._tracks)throw new Error("Not ready yet; wait for 'ready' event");t._fileStream&&(t._fileStream.destroy(),t._fileStream=null);var r=-1;if(t._tracks.map(function(n,a){function s(e){i.destroyed||i.box(e.moof,function(r){if(r)return t.emit("error",r);if(!i.destroyed){n.inStream.slice(e.ranges).pipe(i.mediaData(e.length,function(e){if(e)return t.emit("error",e);if(!i.destroyed){var r=t._generateFragment(a);if(!r)return i.finalize();s(r)}}))}})}n.outStream&&n.outStream.destroy(),n.inStream&&(n.inStream.destroy(),n.inStream=null);var i=n.outStream=mp4.encode(),o=t._generateFragment(a,e);if(!o)return i.finalize();(-1===r||o.ranges[0].start<r)&&(r=o.ranges[0].start),s(o)}),r>=0){var n=t._fileStream=t._file.createReadStream({start:r});t._tracks.forEach(function(e){e.inStream=new RangeSliceStream(r,{highWaterMark:1e7}),n.pipe(e.inStream)})}return t._tracks.map(function(e){return e.outStream})},MP4Remuxer.prototype._findSampleBefore=function(e,t){var r=this,n=r._tracks[e],a=Math.floor(n.timeScale*t),s=bs(n.samples,a,function(e,t){return e.dts+e.presentationOffset-t});for(-1===s?s=0:s<0&&(s=-s-2);!n.samples[s].sync;)s--;return s};var MIN_FRAGMENT_DURATION=1;MP4Remuxer.prototype._generateFragment=function(e,t){var r,n=this,a=n._tracks[e];if((r=void 0!==t?n._findSampleBefore(e,t):a.currSample)>=a.samples.length)return null;for(var s=a.samples[r].dts,i=0,o=[],m=r;m<a.samples.length;m++){var d=a.samples[m];if(d.sync&&d.dts-s>=a.timeScale*MIN_FRAGMENT_DURATION)break;i+=d.size;var f=o.length-1;f<0||o[f].end!==d.offset?o.push({start:d.offset,end:d.offset+d.size}):o[f].end+=d.size}return a.currSample=m,{moof:n._generateMoof(e,r,m),ranges:o,length:i}},MP4Remuxer.prototype._generateMoof=function(e,t,r){for(var n=this,a=n._tracks[e],s=[],i=t;i<r;i++){var o=a.samples[i];s.push({sampleDuration:o.duration,sampleSize:o.size,sampleFlags:o.sync?33554432:16842752,sampleCompositionTimeOffset:o.presentationOffset})}var m={type:"moof",mfhd:{sequenceNumber:n._fragmentSequence++},trafs:[{tfhd:{flags:131072,trackId:a.trackId},tfdt:{baseMediaDecodeTime:a.samples[t].dts},trun:{flags:3841,dataOffset:8,entries:s}}]};return m.trafs[0].trun.dataOffset+=Box.encodingLength(m),m};

}).call(this,require("buffer").Buffer)
},{"binary-search":19,"buffer":66,"events":121,"inherits":144,"mp4-box-encoding":175,"mp4-stream":178,"range-slice-stream":224}],310:[function(require,module,exports){
function VideoStream(e,r,t){var i=this;if(!(this instanceof VideoStream))return new VideoStream(e,r,t);t=t||{},i.detailedError=null,i._elem=r,i._elemWrapper=new MediaElementWrapper(r),i._waitingFired=!1,i._trackMeta=null,i._file=e,i._tracks=null,"none"!==i._elem.preload&&i._createMuxer(),i._onError=function(e){i.detailedError=i._elemWrapper.detailedError,i.destroy()},i._onWaiting=function(){i._waitingFired=!0,i._muxer?i._tracks&&i._pump():i._createMuxer()},i._elem.addEventListener("waiting",i._onWaiting),i._elem.addEventListener("error",i._onError)}var MediaElementWrapper=require("mediasource"),pump=require("pump"),MP4Remuxer=require("./mp4-remuxer");module.exports=VideoStream,VideoStream.prototype._createMuxer=function(){var e=this;e._muxer=new MP4Remuxer(e._file),e._muxer.on("ready",function(r){e._tracks=r.map(function(r){var t=e._elemWrapper.createWriteStream(r.mime);t.on("error",function(r){e._elemWrapper.error(r)});var i={muxed:null,mediaSource:t,initFlushed:!1,onInitFlushed:null};return t.write(r.init,function(e){i.initFlushed=!0,i.onInitFlushed&&i.onInitFlushed(e)}),i}),(e._waitingFired||"auto"===e._elem.preload)&&e._pump()}),e._muxer.on("error",function(r){e._elemWrapper.error(r)})},VideoStream.prototype._pump=function(){var e=this,r=e._muxer.seek(e._elem.currentTime,!e._tracks);e._tracks.forEach(function(t,i){var n=function(){t.muxed&&(t.muxed.destroy(),t.mediaSource=e._elemWrapper.createWriteStream(t.mediaSource),t.mediaSource.on("error",function(r){e._elemWrapper.error(r)})),t.muxed=r[i],pump(t.muxed,t.mediaSource)};t.initFlushed?n():t.onInitFlushed=function(r){if(r)return void e._elemWrapper.error(r);n()}})},VideoStream.prototype.destroy=function(){var e=this;e.destroyed||(e.destroyed=!0,e._elem.removeEventListener("waiting",e._onWaiting),e._elem.removeEventListener("error",e._onError),e._tracks&&e._tracks.forEach(function(e){e.muxed.destroy()}),e._elem.src="")};

},{"./mp4-remuxer":309,"mediasource":167,"pump":212}],311:[function(require,module,exports){
function Context(){}var indexOf=require("indexof"),Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)t.push(r);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,r){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:r})}}catch(e){return function(e,t,r){e[t]=r}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var r=t.contentWindow,n=r.eval,o=r.execScript;!n&&o&&(o.call(r,"null"),n=r.eval),forEach(Object_keys(e),function(t){r[t]=e[t]}),forEach(globals,function(t){e[t]&&(r[t]=e[t])});var c=Object_keys(r),i=n.call(r,this.code);return forEach(Object_keys(r),function(t){(t in e||-1===indexOf(c,t))&&(e[t]=r[t])}),forEach(globals,function(t){t in e||defineProp(e,t,r[t])}),document.body.removeChild(t),i},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),r=this.runInContext(t);return forEach(Object_keys(t),function(r){e[r]=t[r]}),r},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var r=Script(t);return r[e].apply(r,[].slice.call(arguments,1))}}),exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(r){t[r]=e[r]}),t};
},{"indexof":143}],312:[function(require,module,exports){
(function (process,global){
function WebTorrent(e){function r(){t.destroyed||(t.ready=!0,t.emit("ready"))}var t=this;if(!(t instanceof WebTorrent))return new WebTorrent(e);EventEmitter.call(t),e||(e={}),"string"==typeof e.peerId?t.peerId=e.peerId:Buffer.isBuffer(e.peerId)?t.peerId=e.peerId.toString("hex"):t.peerId=Buffer.from(VERSION_PREFIX+randombytes(6).toString("hex")).toString("hex"),t.peerIdBuffer=Buffer.from(t.peerId,"hex"),"string"==typeof e.nodeId?t.nodeId=e.nodeId:Buffer.isBuffer(e.nodeId)?t.nodeId=e.nodeId.toString("hex"):t.nodeId=randombytes(20).toString("hex"),t.nodeIdBuffer=Buffer.from(t.nodeId,"hex"),t.destroyed=!1,t.listening=!1,t.torrentPort=e.torrentPort||0,t.dhtPort=e.dhtPort||0,t.tracker=void 0!==e.tracker?e.tracker:{},t.torrents=[],t.maxConns=Number(e.maxConns)||55,debug("new webtorrent (peerId %s, nodeId %s, port %s)",t.peerId,t.nodeId,t.torrentPort),t.tracker&&("object"!=typeof t.tracker&&(t.tracker={}),e.rtcConfig&&(console.warn("WebTorrent: opts.rtcConfig is deprecated. Use opts.tracker.rtcConfig instead"),t.tracker.rtcConfig=e.rtcConfig),e.wrtc&&(console.warn("WebTorrent: opts.wrtc is deprecated. Use opts.tracker.wrtc instead"),t.tracker.wrtc=e.wrtc),global.WRTC&&!t.tracker.wrtc&&(t.tracker.wrtc=global.WRTC)),"function"==typeof TCPPool?t._tcpPool=new TCPPool(t):process.nextTick(function(){t._onListening()}),t._downloadSpeed=speedometer(),t._uploadSpeed=speedometer(),!1!==e.dht&&"function"==typeof DHT?(t.dht=new DHT(extend({nodeId:t.nodeId},e.dht)),t.dht.once("error",function(e){t._destroy(e)}),t.dht.once("listening",function(){var e=t.dht.address();e&&(t.dhtPort=e.port)}),t.dht.setMaxListeners(0),t.dht.listen(t.dhtPort)):t.dht=!1,"function"==typeof loadIPSet&&null!=e.blocklist?loadIPSet(e.blocklist,{headers:{"user-agent":"WebTorrent/"+VERSION+" (https://webtorrent.io)"}},function(e,o){if(e)return t.error("Failed to load blocklist: "+e.message);t.blocked=o,r()}):process.nextTick(r)}function isReadable(e){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}function isFileList(e){return"undefined"!=typeof FileList&&e instanceof FileList}module.exports=WebTorrent;var Buffer=require("safe-buffer").Buffer,concat=require("simple-concat"),createTorrent=require("create-torrent"),debug=require("debug")("webtorrent"),DHT=require("bittorrent-dht/client"),EventEmitter=require("events").EventEmitter,extend=require("xtend"),inherits=require("inherits"),loadIPSet=require("load-ip-set"),parallel=require("run-parallel"),parseTorrent=require("parse-torrent"),path=require("path"),Peer=require("simple-peer"),randombytes=require("randombytes"),speedometer=require("speedometer"),zeroFill=require("zero-fill"),TCPPool=require("./lib/tcp-pool"),Torrent=require("./lib/torrent"),VERSION=require("./package.json").version,VERSION_STR=VERSION.match(/([0-9]+)/g).slice(0,2).map(function(e){return zeroFill(2,e)}).join(""),VERSION_PREFIX="-WW"+VERSION_STR+"-";inherits(WebTorrent,EventEmitter),WebTorrent.WEBRTC_SUPPORT=Peer.WEBRTC_SUPPORT,Object.defineProperty(WebTorrent.prototype,"downloadSpeed",{get:function(){return this._downloadSpeed()}}),Object.defineProperty(WebTorrent.prototype,"uploadSpeed",{get:function(){return this._uploadSpeed()}}),Object.defineProperty(WebTorrent.prototype,"progress",{get:function(){var e=this.torrents.filter(function(e){return 1!==e.progress});return e.reduce(function(e,r){return e+r.downloaded},0)/(e.reduce(function(e,r){return e+(r.length||0)},0)||1)}}),Object.defineProperty(WebTorrent.prototype,"ratio",{get:function(){return this.torrents.reduce(function(e,r){return e+r.uploaded},0)/(this.torrents.reduce(function(e,r){return e+r.received},0)||1)}}),WebTorrent.prototype.get=function(e){var r,t,o=this,n=o.torrents.length;if(e instanceof Torrent){for(r=0;r<n;r++)if((t=o.torrents[r])===e)return t}else{var i;try{i=parseTorrent(e)}catch(e){}if(!i)return null;if(!i.infoHash)throw new Error("Invalid torrent identifier");for(r=0;r<n;r++)if(t=o.torrents[r],t.infoHash===i.infoHash)return t}return null},WebTorrent.prototype.download=function(e,r,t){return console.warn("WebTorrent: client.download() is deprecated. Use client.add() instead"),this.add(e,r,t)},WebTorrent.prototype.add=function(e,r,t){function o(){if(!d.destroyed)for(var e=0,r=d.torrents.length;e<r;e++){var t=d.torrents[e];if(t.infoHash===s.infoHash&&t!==s)return void s._destroy(new Error("Cannot add duplicate torrent "+s.infoHash))}}function n(){d.destroyed||("function"==typeof t&&t(s),d.emit("torrent",s))}function i(){s.removeListener("_infoHash",o),s.removeListener("ready",n),s.removeListener("close",i)}var d=this;if(d.destroyed)throw new Error("client is destroyed");if("function"==typeof r)return d.add(e,null,r);debug("add"),r=r?extend(r):{};var s=new Torrent(e,d,r);return d.torrents.push(s),s.once("_infoHash",o),s.once("ready",n),s.once("close",i),s},WebTorrent.prototype.seed=function(e,r,t){function o(e){var r=[function(r){e.load(d,r)}];i.dht&&r.push(function(r){e.once("dhtAnnounce",r)}),parallel(r,function(r){if(!i.destroyed)return r?e._destroy(r):void n(e)})}function n(e){debug("on seed"),"function"==typeof t&&t(e),e.emit("seed"),i.emit("seed",e)}var i=this;if(i.destroyed)throw new Error("client is destroyed");if("function"==typeof r)return i.seed(e,null,r);debug("seed"),r=r?extend(r):{},"string"==typeof e&&(r.path=path.dirname(e)),r.createdBy||(r.createdBy="WebTorrent/"+VERSION_STR),i.tracker||(r.announce=[]);var d,s=i.add(null,r,o);return isFileList(e)&&(e=Array.prototype.slice.call(e)),Array.isArray(e)||(e=[e]),parallel(e.map(function(e){return function(r){isReadable(e)?concat(e,r):r(null,e)}}),function(e,t){if(!i.destroyed)return e?s._destroy(e):void createTorrent.parseInput(t,r,function(e,o){if(!i.destroyed){if(e)return s._destroy(e);d=o.map(function(e){return e.getStream}),createTorrent(t,r,function(e,r){if(!i.destroyed){if(e)return s._destroy(e);var t=i.get(r);t?s._destroy(new Error("Cannot add duplicate torrent "+t.infoHash)):s._onTorrentId(r)}})}})}),s},WebTorrent.prototype.remove=function(e,r){if(debug("remove"),!this.get(e))throw new Error("No torrent with id "+e);this._remove(e,r)},WebTorrent.prototype._remove=function(e,r){var t=this.get(e);t&&(this.torrents.splice(this.torrents.indexOf(t),1),t.destroy(r))},WebTorrent.prototype.address=function(){return this.listening?this._tcpPool?this._tcpPool.server.address():{address:"0.0.0.0",family:"IPv4",port:0}:null},WebTorrent.prototype.destroy=function(e){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,e)},WebTorrent.prototype._destroy=function(e,r){var t=this;debug("client destroy"),t.destroyed=!0;var o=t.torrents.map(function(e){return function(r){e.destroy(r)}});t._tcpPool&&o.push(function(e){t._tcpPool.destroy(e)}),t.dht&&o.push(function(e){t.dht.destroy(e)}),parallel(o,r),e&&t.emit("error",e),t.torrents=[],t._tcpPool=null,t.dht=null},WebTorrent.prototype._onListening=function(){if(this.listening=!0,this._tcpPool){var e=this._tcpPool.server.address();e&&(this.torrentPort=e.port)}this.emit("listening")};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./lib/tcp-pool":37,"./lib/torrent":317,"./package.json":319,"_process":205,"bittorrent-dht/client":37,"create-torrent":83,"debug":88,"events":121,"inherits":144,"load-ip-set":37,"parse-torrent":196,"path":197,"randombytes":223,"run-parallel":242,"safe-buffer":244,"simple-concat":255,"simple-peer":257,"speedometer":268,"xtend":324,"zero-fill":326}],313:[function(require,module,exports){
function FileStream(e,t){stream.Readable.call(this,t),this.destroyed=!1,this._torrent=e._torrent;var i=t&&t.start||0,r=t&&t.end&&t.end<e.length?t.end:e.length-1,s=e._torrent.pieceLength;this._startPiece=(i+e.offset)/s|0,this._endPiece=(r+e.offset)/s|0,this._piece=this._startPiece,this._offset=i+e.offset-this._startPiece*s,this._missing=r-i+1,this._reading=!1,this._notifying=!1,this._criticalLength=Math.min(1048576/s|0,2)}module.exports=FileStream;var debug=require("debug")("webtorrent:file-stream"),inherits=require("inherits"),stream=require("readable-stream");inherits(FileStream,stream.Readable),FileStream.prototype._read=function(){this._reading||(this._reading=!0,this._notify())},FileStream.prototype._notify=function(){var e=this;if(e._reading&&0!==e._missing){if(!e._torrent.bitfield.get(e._piece))return e._torrent.critical(e._piece,e._piece+e._criticalLength);if(!e._notifying){e._notifying=!0;var t=e._piece;e._torrent.store.get(t,function(i,r){if(e._notifying=!1,!e.destroyed){if(i)return e._destroy(i);debug("read %s (length %s) (err %s)",t,r.length,i&&i.message),e._offset&&(r=r.slice(e._offset),e._offset=0),e._missing<r.length&&(r=r.slice(0,e._missing)),e._missing-=r.length,debug("pushing buffer of length %s",r.length),e._reading=!1,e.push(r),0===e._missing&&e.push(null)}}),e._piece+=1}}},FileStream.prototype.destroy=function(e){this._destroy(null,e)},FileStream.prototype._destroy=function(e,t){this.destroyed||(this.destroyed=!0,this._torrent.destroyed||this._torrent.deselect(this._startPiece,this._endPiece,!0),e&&this.emit("error",e),this.emit("close"),t&&t())};

},{"debug":88,"inherits":144,"readable-stream":235}],314:[function(require,module,exports){
(function (process){
function File(e,t){EventEmitter.call(this),this._torrent=e,this._destroyed=!1,this.name=t.name,this.path=t.path,this.length=t.length,this.offset=t.offset,this.done=!1;var r=t.offset,i=r+t.length-1;this._startPiece=r/this._torrent.pieceLength|0,this._endPiece=i/this._torrent.pieceLength|0,0===this.length&&(this.done=!0,this.emit("done"))}module.exports=File;var eos=require("end-of-stream"),EventEmitter=require("events").EventEmitter,FileStream=require("./file-stream"),inherits=require("inherits"),path=require("path"),render=require("render-media"),stream=require("readable-stream"),streamToBlob=require("stream-to-blob"),streamToBlobURL=require("stream-to-blob-url"),streamToBuffer=require("stream-with-known-length-to-buffer");inherits(File,EventEmitter),File.prototype.select=function(e){0!==this.length&&this._torrent.select(this._startPiece,this._endPiece,e)},File.prototype.deselect=function(){0!==this.length&&this._torrent.deselect(this._startPiece,this._endPiece,!1)},File.prototype.createReadStream=function(e){var t=this;if(0===this.length){var r=new stream.PassThrough;return process.nextTick(function(){r.end()}),r}var i=new FileStream(t,e);return t._torrent.select(i._startPiece,i._endPiece,!0,function(){i._notify()}),eos(i,function(){t._destroyed||t._torrent.destroyed||t._torrent.deselect(i._startPiece,i._endPiece,!0)}),i},File.prototype.getBuffer=function(e){streamToBuffer(this.createReadStream(),this.length,e)},File.prototype.getBlob=function(e){if("undefined"==typeof window)throw new Error("browser-only method");streamToBlob(this.createReadStream(),this._getMimeType(),e)},File.prototype.getBlobURL=function(e){if("undefined"==typeof window)throw new Error("browser-only method");streamToBlobURL(this.createReadStream(),this._getMimeType(),e)},File.prototype.appendTo=function(e,t,r){if("undefined"==typeof window)throw new Error("browser-only method");render.append(this,e,t,r)},File.prototype.renderTo=function(e,t,r){if("undefined"==typeof window)throw new Error("browser-only method");render.render(this,e,t,r)},File.prototype._getMimeType=function(){return render.mime[path.extname(this.name).toLowerCase()]},File.prototype._destroy=function(){this._destroyed=!0,this._torrent=null};

}).call(this,require('_process'))
},{"./file-stream":313,"_process":205,"end-of-stream":120,"events":121,"inherits":144,"path":197,"readable-stream":235,"render-media":238,"stream-to-blob":277,"stream-to-blob-url":276,"stream-with-known-length-to-buffer":278}],315:[function(require,module,exports){
function Peer(e,n){var r=this;r.id=e,r.type=n,debug("new Peer %s",e),r.addr=null,r.conn=null,r.swarm=null,r.wire=null,r.connected=!1,r.destroyed=!1,r.timeout=null,r.retries=0,r.sentHandshake=!1}function noop(){}var arrayRemove=require("unordered-array-remove"),debug=require("debug")("webtorrent:peer"),Wire=require("bittorrent-protocol"),WebConn=require("./webconn"),CONNECT_TIMEOUT_TCP=5e3,CONNECT_TIMEOUT_WEBRTC=25e3,HANDSHAKE_TIMEOUT=25e3;exports.createWebRTCPeer=function(e,n){var r=new Peer(e.id,"webrtc");return r.conn=e,r.swarm=n,r.conn.connected?r.onConnect():(r.conn.once("connect",function(){r.onConnect()}),r.conn.once("error",function(e){r.destroy(e)}),r.startConnectTimeout()),r},exports.createTCPIncomingPeer=function(e){var n=e.remoteAddress+":"+e.remotePort,r=new Peer(n,"tcpIncoming");return r.conn=e,r.addr=n,r.onConnect(),r},exports.createTCPOutgoingPeer=function(e,n){var r=new Peer(e,"tcpOutgoing");return r.addr=e,r.swarm=n,r},exports.createWebSeedPeer=function(e,n){var r=new Peer(e,"webSeed");return r.swarm=n,r.conn=new WebConn(e,n),r.onConnect(),r},Peer.prototype.onConnect=function(){var e=this;if(!e.destroyed){e.connected=!0,debug("Peer %s connected",e.id),clearTimeout(e.connectTimeout);var n=e.conn;n.once("end",function(){e.destroy()}),n.once("close",function(){e.destroy()}),n.once("finish",function(){e.destroy()}),n.once("error",function(n){e.destroy(n)});var r=e.wire=new Wire;r.type=e.type,r.once("end",function(){e.destroy()}),r.once("close",function(){e.destroy()}),r.once("finish",function(){e.destroy()}),r.once("error",function(n){e.destroy(n)}),r.once("handshake",function(n,r){e.onHandshake(n,r)}),e.startHandshakeTimeout(),n.pipe(r).pipe(n),e.swarm&&!e.sentHandshake&&e.handshake()}},Peer.prototype.onHandshake=function(e,n){var r=this;if(r.swarm&&!r.destroyed){if(r.swarm.destroyed)return r.destroy(new Error("swarm already destroyed"));if(e!==r.swarm.infoHash)return r.destroy(new Error("unexpected handshake info hash for this swarm"));if(n===r.swarm.peerId)return r.destroy(new Error("refusing to connect to ourselves"));debug("Peer %s got handshake %s",r.id,e),clearTimeout(r.handshakeTimeout),r.retries=0;var o=r.addr;!o&&r.conn.remoteAddress&&(o=r.conn.remoteAddress+":"+r.conn.remotePort),r.swarm._onWire(r.wire,o),r.swarm&&!r.swarm.destroyed&&(r.sentHandshake||r.handshake())}},Peer.prototype.handshake=function(){var e=this,n={dht:!e.swarm.private&&!!e.swarm.client.dht};e.wire.handshake(e.swarm.infoHash,e.swarm.client.peerId,n),e.sentHandshake=!0},Peer.prototype.startConnectTimeout=function(){var e=this;clearTimeout(e.connectTimeout),e.connectTimeout=setTimeout(function(){e.destroy(new Error("connect timeout"))},"webrtc"===e.type?CONNECT_TIMEOUT_WEBRTC:CONNECT_TIMEOUT_TCP),e.connectTimeout.unref&&e.connectTimeout.unref()},Peer.prototype.startHandshakeTimeout=function(){var e=this;clearTimeout(e.handshakeTimeout),e.handshakeTimeout=setTimeout(function(){e.destroy(new Error("handshake timeout"))},HANDSHAKE_TIMEOUT),e.handshakeTimeout.unref&&e.handshakeTimeout.unref()},Peer.prototype.destroy=function(e){var n=this;if(!n.destroyed){n.destroyed=!0,n.connected=!1,debug("destroy %s (error: %s)",n.id,e&&(e.message||e)),clearTimeout(n.connectTimeout),clearTimeout(n.handshakeTimeout);var r=n.swarm,o=n.conn,t=n.wire;n.swarm=null,n.conn=null,n.wire=null,r&&t&&arrayRemove(r.wires,r.wires.indexOf(t)),o&&(o.on("error",noop),o.destroy()),t&&t.destroy(),r&&r.removePeer(n.id)}};

},{"./webconn":318,"bittorrent-protocol":21,"debug":88,"unordered-array-remove":294}],316:[function(require,module,exports){
function RarityMap(e){var i=this;i._torrent=e,i._numPieces=e.pieces.length,i._pieces=[],i._onWire=function(e){i.recalculate(),i._initWire(e)},i._onWireHave=function(e){i._pieces[e]+=1},i._onWireBitfield=function(){i.recalculate()},i._torrent.wires.forEach(function(e){i._initWire(e)}),i._torrent.on("wire",i._onWire),i.recalculate()}function trueFn(){return!0}module.exports=RarityMap,RarityMap.prototype.getRarestPiece=function(e){e||(e=trueFn);for(var i=[],t=1/0,r=0;r<this._numPieces;++r)if(e(r)){var n=this._pieces[r];n===t?i.push(r):n<t&&(i=[r],t=n)}return i.length>0?i[Math.random()*i.length|0]:-1},RarityMap.prototype.destroy=function(){var e=this;e._torrent.removeListener("wire",e._onWire),e._torrent.wires.forEach(function(i){e._cleanupWireEvents(i)}),e._torrent=null,e._pieces=null,e._onWire=null,e._onWireHave=null,e._onWireBitfield=null},RarityMap.prototype._initWire=function(e){var i=this;e._onClose=function(){i._cleanupWireEvents(e);for(var t=0;t<this._numPieces;++t)i._pieces[t]-=e.peerPieces.get(t)},e.on("have",i._onWireHave),e.on("bitfield",i._onWireBitfield),e.once("close",e._onClose)},RarityMap.prototype.recalculate=function(){var e;for(e=0;e<this._numPieces;++e)this._pieces[e]=0;var i=this._torrent.wires.length;for(e=0;e<i;++e)for(var t=this._torrent.wires[e],r=0;r<this._numPieces;++r)this._pieces[r]+=t.peerPieces.get(r)},RarityMap.prototype._cleanupWireEvents=function(e){e.removeListener("have",this._onWireHave),e.removeListener("bitfield",this._onWireBitfield),e._onClose&&e.removeListener("close",e._onClose),e._onClose=null};

},{}],317:[function(require,module,exports){
(function (process,global){
function Torrent(e,t,r){EventEmitter.call(this),this.client=t,this._debugId=this.client.peerId.toString("hex").substring(0,7),this._debug("new torrent"),this.announce=r.announce,this.urlList=r.urlList,this.path=r.path,this._store=r.store||FSChunkStore,this._getAnnounceOpts=r.getAnnounceOpts,this.strategy=r.strategy||"sequential",this.maxWebConns=r.maxWebConns||4,this._rechokeNumSlots=!1===r.uploads||0===r.uploads?0:+r.uploads||10,this._rechokeOptimisticWire=null,this._rechokeOptimisticTime=0,this._rechokeIntervalId=null,this.ready=!1,this.destroyed=!1,this.paused=!1,this.done=!1,this.metadata=null,this.store=null,this.files=[],this.pieces=[],this._amInterested=!1,this._selections=[],this._critical=[],this.wires=[],this._queue=[],this._peers={},this._peersLength=0,this.received=0,this.uploaded=0,this._downloadSpeed=speedometer(),this._uploadSpeed=speedometer(),this._servers=[],this._xsRequests=[],this._fileModtimes=r.fileModtimes,null!==e&&this._onTorrentId(e)}function getBlockPipelineLength(e,t){return 2+Math.ceil(t*e.downloadSpeed()/Piece.BLOCK_LENGTH)}function getPiecePipelineLength(e,t,r){return 1+Math.ceil(t*e.downloadSpeed()/r)}function randomInt(e){return Math.random()*e|0}function noop(){}module.exports=Torrent;var addrToIPPort=require("addr-to-ip-port"),BitField=require("bitfield"),ChunkStoreWriteStream=require("chunk-store-stream/write"),debug=require("debug")("webtorrent:torrent"),Discovery=require("torrent-discovery"),EventEmitter=require("events").EventEmitter,extend=require("xtend"),extendMutable=require("xtend/mutable"),fs=require("fs"),FSChunkStore=require("fs-chunk-store"),get=require("simple-get"),ImmediateChunkStore=require("immediate-chunk-store"),inherits=require("inherits"),MultiStream=require("multistream"),net=require("net"),os=require("os"),parallel=require("run-parallel"),parallelLimit=require("run-parallel-limit"),parseTorrent=require("parse-torrent"),path=require("path"),Piece=require("torrent-piece"),pump=require("pump"),randomIterate=require("random-iterate"),sha1=require("simple-sha1"),speedometer=require("speedometer"),uniq=require("uniq"),utMetadata=require("ut_metadata"),utPex=require("ut_pex"),File=require("./file"),Peer=require("./peer"),RarityMap=require("./rarity-map"),Server=require("./server"),MAX_BLOCK_LENGTH=131072,PIECE_TIMEOUT=3e4,CHOKE_TIMEOUT=5e3,SPEED_THRESHOLD=3*Piece.BLOCK_LENGTH,PIPELINE_MIN_DURATION=.5,PIPELINE_MAX_DURATION=1,RECHOKE_INTERVAL=1e4,RECHOKE_OPTIMISTIC_DURATION=2,FILESYSTEM_CONCURRENCY=2,RECONNECT_WAIT=[1e3,5e3,15e3],VERSION=require("../package.json").version,TMP;try{TMP=path.join(fs.statSync("/tmp")&&"/tmp","webtorrent")}catch(e){TMP=path.join("function"==typeof os.tmpDir?os.tmpDir():"/","webtorrent")}inherits(Torrent,EventEmitter),Object.defineProperty(Torrent.prototype,"timeRemaining",{get:function(){return this.done?0:0===this.downloadSpeed?1/0:(this.length-this.downloaded)/this.downloadSpeed*1e3}}),Object.defineProperty(Torrent.prototype,"downloaded",{get:function(){if(!this.bitfield)return 0;for(var e=0,t=0,r=this.pieces.length;t<r;++t)if(this.bitfield.get(t))e+=t===r-1?this.lastPieceLength:this.pieceLength;else{var n=this.pieces[t];e+=n.length-n.missing}return e}}),Object.defineProperty(Torrent.prototype,"downloadSpeed",{get:function(){return this._downloadSpeed()}}),Object.defineProperty(Torrent.prototype,"uploadSpeed",{get:function(){return this._uploadSpeed()}}),Object.defineProperty(Torrent.prototype,"progress",{get:function(){return this.length?this.downloaded/this.length:0}}),Object.defineProperty(Torrent.prototype,"ratio",{get:function(){return this.uploaded/(this.received||1)}}),Object.defineProperty(Torrent.prototype,"numPeers",{get:function(){return this.wires.length}}),Object.defineProperty(Torrent.prototype,"torrentFileBlobURL",{get:function(){if("undefined"==typeof window)throw new Error("browser-only property");return this.torrentFile?URL.createObjectURL(new Blob([this.torrentFile],{type:"application/x-bittorrent"})):null}}),Object.defineProperty(Torrent.prototype,"_numQueued",{get:function(){return this._queue.length+(this._peersLength-this._numConns)}}),Object.defineProperty(Torrent.prototype,"_numConns",{get:function(){var e=this,t=0;for(var r in e._peers)e._peers[r].connected&&(t+=1);return t}}),Object.defineProperty(Torrent.prototype,"swarm",{get:function(){return console.warn("WebTorrent: `torrent.swarm` is deprecated. Use `torrent` directly instead."),this}}),Torrent.prototype._onTorrentId=function(e){var t=this;if(!t.destroyed){var r;try{r=parseTorrent(e)}catch(e){}r?(t.infoHash=r.infoHash,process.nextTick(function(){t.destroyed||t._onParsedTorrent(r)})):parseTorrent.remote(e,function(e,r){if(!t.destroyed)return e?t._destroy(e):void t._onParsedTorrent(r)})}},Torrent.prototype._onParsedTorrent=function(e){var t=this;if(!t.destroyed){if(t._processParsedTorrent(e),!t.infoHash)return t._destroy(new Error("Malformed torrent data: No info hash"));t.path||(t.path=path.join(TMP,t.infoHash)),t._rechokeIntervalId=setInterval(function(){t._rechoke()},RECHOKE_INTERVAL),t._rechokeIntervalId.unref&&t._rechokeIntervalId.unref(),t.emit("_infoHash",t.infoHash),t.destroyed||(t.emit("infoHash",t.infoHash),t.destroyed||(t.client.listening?t._onListening():t.client.once("listening",function(){t._onListening()})))}},Torrent.prototype._processParsedTorrent=function(e){this.announce&&(e.announce=e.announce.concat(this.announce)),this.client.tracker&&global.WEBTORRENT_ANNOUNCE&&!this.private&&(e.announce=e.announce.concat(global.WEBTORRENT_ANNOUNCE)),this.urlList&&(e.urlList=e.urlList.concat(this.urlList)),uniq(e.announce),uniq(e.urlList),extendMutable(this,e),this.magnetURI=parseTorrent.toMagnetURI(e),this.torrentFile=parseTorrent.toTorrentFile(e)},Torrent.prototype._onListening=function(){function e(e){o._destroy(e)}function t(e){"string"==typeof e&&o.done||o.addPeer(e)}function r(){o.emit("trackerAnnounce"),0===o.numPeers&&o.emit("noPeers","tracker")}function n(){o.emit("dhtAnnounce"),0===o.numPeers&&o.emit("noPeers","dht")}function i(e){o.emit("warning",e)}var o=this;if(!o.discovery&&!o.destroyed){var s=o.client.tracker;s&&(s=extend(o.client.tracker,{getAnnounceOpts:function(){var e={uploaded:o.uploaded,downloaded:o.downloaded,left:Math.max(o.length-o.downloaded,0)};return o.client.tracker.getAnnounceOpts&&extendMutable(e,o.client.tracker.getAnnounceOpts()),o._getAnnounceOpts&&extendMutable(e,o._getAnnounceOpts()),e}})),o.discovery=new Discovery({infoHash:o.infoHash,announce:o.announce,peerId:o.client.peerId,dht:!o.private&&o.client.dht,tracker:s,port:o.client.torrentPort}),o.discovery.on("error",e),o.discovery.on("peer",t),o.discovery.on("trackerAnnounce",r),o.discovery.on("dhtAnnounce",n),o.discovery.on("warning",i),o.info?o._onMetadata(o):o.xs&&o._getMetadataFromServer()}},Torrent.prototype._getMetadataFromServer=function(){function e(e,r){function n(n,i,o){if(t.destroyed)return r(null);if(t.metadata)return r(null);if(n)return t._debug("http error from xs param: %s",e),r(null);if(200!==i.statusCode)return t._debug("non-200 status code %s from xs param: %s",i.statusCode,e),r(null);var s;try{s=parseTorrent(o)}catch(n){}return s?s.infoHash!==t.infoHash?(t._debug("got torrent file with incorrect info hash from xs param: %s",e),r(null)):(t._onMetadata(s),void r(null)):(t._debug("got invalid torrent file from xs param: %s",e),r(null))}if(0!==e.indexOf("http://")&&0!==e.indexOf("https://"))return t._debug("skipping non-http xs param: %s",e),r(null);var i,o={url:e,method:"GET",headers:{"user-agent":"WebTorrent/"+VERSION+" (https://webtorrent.io)"}};try{i=get.concat(o,n)}catch(n){return t._debug("skipping invalid url xs param: %s",e),r(null)}t._xsRequests.push(i)}var t=this,r=Array.isArray(t.xs)?t.xs:[t.xs],n=r.map(function(t){return function(r){e(t,r)}});parallel(n)},Torrent.prototype._onMetadata=function(e){var t=this;if(!t.metadata&&!t.destroyed){t._debug("got metadata"),t._xsRequests.forEach(function(e){e.abort()}),t._xsRequests=[];var r;if(e&&e.infoHash)r=e;else try{r=parseTorrent(e)}catch(e){return t._destroy(e)}t._processParsedTorrent(r),t.metadata=t.torrentFile,t.urlList.forEach(function(e){t.addWebSeed(e)}),0!==t.pieces.length&&t.select(0,t.pieces.length-1,!1),t._rarityMap=new RarityMap(t),t.store=new ImmediateChunkStore(new t._store(t.pieceLength,{torrent:{infoHash:t.infoHash},files:t.files.map(function(e){return{path:path.join(t.path,e.path),length:e.length,offset:e.offset}}),length:t.length})),t.files=t.files.map(function(e){return new File(t,e)}),t._hashes=t.pieces,t.pieces=t.pieces.map(function(e,r){var n=r===t.pieces.length-1?t.lastPieceLength:t.pieceLength;return new Piece(n)}),t._reservations=t.pieces.map(function(){return[]}),t.bitfield=new BitField(t.pieces.length),t.wires.forEach(function(e){e.ut_metadata&&e.ut_metadata.setMetadata(t.metadata),t._onWireWithMetadata(e)}),t._debug("verifying existing torrent data"),t._fileModtimes&&t._store===FSChunkStore?t.getFileModtimes(function(e,r){if(e)return t._destroy(e);if(t.files.map(function(e,n){return r[n]===t._fileModtimes[n]}).every(function(e){return e})){for(var n=0;n<t.pieces.length;n++)t._markVerified(n);t._onStore()}else t._verifyPieces()}):t._verifyPieces(),t.emit("metadata")}},Torrent.prototype.getFileModtimes=function(e){var t=this,r=[];parallelLimit(t.files.map(function(e,n){return function(i){fs.stat(path.join(t.path,e.path),function(e,t){if(e&&"ENOENT"!==e.code)return i(e);r[n]=t&&t.mtime.getTime(),i(null)})}}),FILESYSTEM_CONCURRENCY,function(n){t._debug("done getting file modtimes"),e(n,r)})},Torrent.prototype._verifyPieces=function(){var e=this;parallelLimit(e.pieces.map(function(t,r){return function(t){if(e.destroyed)return t(new Error("torrent is destroyed"));e.store.get(r,function(n,i){if(n)return process.nextTick(t,null);sha1(i,function(n){if(n===e._hashes[r]){if(!e.pieces[r])return;e._debug("piece verified %s",r),e._markVerified(r)}else e._debug("piece invalid %s",r);t(null)})})}}),FILESYSTEM_CONCURRENCY,function(t){if(t)return e._destroy(t);e._debug("done verifying"),e._onStore()})},Torrent.prototype._markVerified=function(e){this.pieces[e]=null,this._reservations[e]=null,this.bitfield.set(e,!0)},Torrent.prototype._onStore=function(){var e=this;e.destroyed||(e._debug("on store"),e.ready=!0,e.emit("ready"),e._checkDone(),e._updateSelections())},Torrent.prototype.destroy=function(e){this._destroy(null,e)},Torrent.prototype._destroy=function(e,t){var r=this;if(!r.destroyed){r.destroyed=!0,r._debug("destroy"),r.client._remove(r),clearInterval(r._rechokeIntervalId),r._xsRequests.forEach(function(e){e.abort()}),r._rarityMap&&r._rarityMap.destroy();for(var n in r._peers)r.removePeer(n);r.files.forEach(function(e){e instanceof File&&e._destroy()});var i=r._servers.map(function(e){return function(t){e.destroy(t)}});r.discovery&&i.push(function(e){r.discovery.destroy(e)}),r.store&&i.push(function(e){r.store.close(e)}),parallel(i,t),e&&(0===r.listenerCount("error")?r.client.emit("error",e):r.emit("error",e)),r.emit("close"),r.client=null,r.files=[],r.discovery=null,r.store=null,r._rarityMap=null,r._peers=null,r._servers=null,r._xsRequests=null}},Torrent.prototype.addPeer=function(e){var t=this;if(t.destroyed)throw new Error("torrent is destroyed");if(!t.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");if(t.client.blocked){var r;if("string"==typeof e){var n;try{n=addrToIPPort(e)}catch(r){return t._debug("ignoring peer: invalid %s",e),t.emit("invalidPeer",e),!1}r=n[0]}else"string"==typeof e.remoteAddress&&(r=e.remoteAddress);if(r&&t.client.blocked.contains(r))return t._debug("ignoring peer: blocked %s",e),"string"!=typeof e&&e.destroy(),t.emit("blockedPeer",e),!1}var i=!!t._addPeer(e);return i?t.emit("peer",e):t.emit("invalidPeer",e),i},Torrent.prototype._addPeer=function(e){var t=this;if(t.destroyed)return t._debug("ignoring peer: torrent is destroyed"),"string"!=typeof e&&e.destroy(),null;if("string"==typeof e&&!t._validAddr(e))return t._debug("ignoring peer: invalid %s",e),null;var r=e&&e.id||e;if(t._peers[r])return t._debug("ignoring peer: duplicate (%s)",r),"string"!=typeof e&&e.destroy(),null;if(t.paused)return t._debug("ignoring peer: torrent is paused"),"string"!=typeof e&&e.destroy(),null;t._debug("add peer %s",r);var n;return n="string"==typeof e?Peer.createTCPOutgoingPeer(e,t):Peer.createWebRTCPeer(e,t),t._peers[n.id]=n,t._peersLength+=1,"string"==typeof e&&(t._queue.push(n),t._drain()),n},Torrent.prototype.addWebSeed=function(e){if(this.destroyed)throw new Error("torrent is destroyed");if(!/^https?:\/\/.+/.test(e))return this._debug("ignoring invalid web seed %s",e),void this.emit("invalidPeer",e);if(this._peers[e])return this._debug("ignoring duplicate web seed %s",e),void this.emit("invalidPeer",e);this._debug("add web seed %s",e);var t=Peer.createWebSeedPeer(e,this);this._peers[t.id]=t,this._peersLength+=1,this.emit("peer",e)},Torrent.prototype._addIncomingPeer=function(e){var t=this;return t.destroyed?e.destroy(new Error("torrent is destroyed")):t.paused?e.destroy(new Error("torrent is paused")):(this._debug("add incoming peer %s",e.id),t._peers[e.id]=e,void(t._peersLength+=1))},Torrent.prototype.removePeer=function(e){var t=this,r=e&&e.id||e;(e=t._peers[r])&&(this._debug("removePeer %s",r),delete t._peers[r],t._peersLength-=1,e.destroy(),t._drain())},Torrent.prototype.select=function(e,t,r,n){var i=this;if(i.destroyed)throw new Error("torrent is destroyed");if(e<0||t<e||i.pieces.length<=t)throw new Error("invalid selection ",e,":",t);r=Number(r)||0,i._debug("select %s-%s (priority %s)",e,t,r),i._selections.push({from:e,to:t,offset:0,priority:r,notify:n||noop}),i._selections.sort(function(e,t){return t.priority-e.priority}),i._updateSelections()},Torrent.prototype.deselect=function(e,t,r){var n=this;if(n.destroyed)throw new Error("torrent is destroyed");r=Number(r)||0,n._debug("deselect %s-%s (priority %s)",e,t,r);for(var i=0;i<n._selections.length;++i){var o=n._selections[i];if(o.from===e&&o.to===t&&o.priority===r){n._selections.splice(i--,1);break}}n._updateSelections()},Torrent.prototype.critical=function(e,t){var r=this;if(r.destroyed)throw new Error("torrent is destroyed");r._debug("critical %s-%s",e,t);for(var n=e;n<=t;++n)r._critical[n]=!0;r._updateSelections()},Torrent.prototype._onWire=function(e,t){var r=this;if(r._debug("got wire %s (%s)",e._debugId,t||"Unknown"),e.on("download",function(e){r.destroyed||(r.received+=e,r._downloadSpeed(e),r.client._downloadSpeed(e),r.emit("download",e),r.client.emit("download",e))}),e.on("upload",function(e){r.destroyed||(r.uploaded+=e,r._uploadSpeed(e),r.client._uploadSpeed(e),r.emit("upload",e),r.client.emit("upload",e))}),r.wires.push(e),t){var n=addrToIPPort(t);e.remoteAddress=n[0],e.remotePort=n[1]}r.client.dht&&r.client.dht.listening&&e.on("port",function(n){if(!r.destroyed&&!r.client.dht.destroyed){if(!e.remoteAddress)return r._debug("ignoring PORT from peer with no address");if(0===n||n>65536)return r._debug("ignoring invalid PORT from peer");r._debug("port: %s (from %s)",n,t),r.client.dht.addNode({host:e.remoteAddress,port:n})}}),e.on("timeout",function(){r._debug("wire timeout (%s)",t),e.destroy()}),e.setTimeout(PIECE_TIMEOUT,!0),e.setKeepAlive(!0),e.use(utMetadata(r.metadata)),e.ut_metadata.on("warning",function(e){r._debug("ut_metadata warning: %s",e.message)}),r.metadata||(e.ut_metadata.on("metadata",function(e){r._debug("got metadata via ut_metadata"),r._onMetadata(e)}),e.ut_metadata.fetch()),"function"!=typeof utPex||r.private||(e.use(utPex()),e.ut_pex.on("peer",function(e){r.done||(r._debug("ut_pex: got peer: %s (from %s)",e,t),r.addPeer(e))}),e.ut_pex.on("dropped",function(e){var n=r._peers[e];n&&!n.connected&&(r._debug("ut_pex: dropped peer: %s (from %s)",e,t),r.removePeer(e))}),e.once("close",function(){e.ut_pex.reset()})),r.emit("wire",e,t),r.metadata&&process.nextTick(function(){r._onWireWithMetadata(e)})},Torrent.prototype._onWireWithMetadata=function(e){function t(){n.destroyed||e.destroyed||(n._numQueued>2*(n._numConns-n.numPeers)&&e.amInterested?e.destroy():(i=setTimeout(t,CHOKE_TIMEOUT),i.unref&&i.unref()))}function r(){if(e.peerPieces.length===n.pieces.length){for(;o<n.pieces.length;++o)if(!e.peerPieces.get(o))return;e.isSeeder=!0,e.choke()}}var n=this,i=null,o=0;e.on("bitfield",function(){r(),n._update()}),e.on("have",function(){r(),n._update()}),e.once("interested",function(){e.unchoke()}),e.once("close",function(){clearTimeout(i)}),e.on("choke",function(){clearTimeout(i),i=setTimeout(t,CHOKE_TIMEOUT),i.unref&&i.unref()}),e.on("unchoke",function(){clearTimeout(i),n._update()}),e.on("request",function(t,r,i,o){if(i>MAX_BLOCK_LENGTH)return e.destroy();n.pieces[t]||n.store.get(t,{offset:r,length:i},o)}),e.bitfield(n.bitfield),e.interested(),e.peerExtensions.dht&&n.client.dht&&n.client.dht.listening&&e.port(n.client.dht.address().port),i=setTimeout(t,CHOKE_TIMEOUT),i.unref&&i.unref(),e.isSeeder=!1,r()},Torrent.prototype._updateSelections=function(){var e=this;e.ready&&!e.destroyed&&(process.nextTick(function(){e._gcSelections()}),e._updateInterest(),e._update())},Torrent.prototype._gcSelections=function(){for(var e=this,t=0;t<e._selections.length;t++){for(var r=e._selections[t],n=r.offset;e.bitfield.get(r.from+r.offset)&&r.from+r.offset<r.to;)r.offset++;n!==r.offset&&r.notify(),r.to===r.from+r.offset&&(e.bitfield.get(r.from+r.offset)&&(e._selections.splice(t--,1),r.notify(),e._updateInterest()))}e._selections.length||e.emit("idle")},Torrent.prototype._updateInterest=function(){var e=this,t=e._amInterested;e._amInterested=!!e._selections.length,e.wires.forEach(function(t){e._amInterested?t.interested():t.uninterested()}),t!==e._amInterested&&(e._amInterested?e.emit("interested"):e.emit("uninterested"))},Torrent.prototype._update=function(){var e=this;if(!e.destroyed)for(var t,r=randomIterate(e.wires);t=r();)e._updateWire(t)},Torrent.prototype._updateWire=function(e){function t(t,r,n,i){return function(o){return o>=t&&o<=r&&!(o in n)&&e.peerPieces.get(o)&&(!i||i(o))}}function r(){var t=e.downloadSpeed()||1;if(t>SPEED_THRESHOLD)return function(){return!0};var r=Math.max(1,e.requests.length)*Piece.BLOCK_LENGTH/t,n=10,i=0;return function(e){if(!n||o.bitfield.get(e))return!0;for(var s=o.pieces[e].missing;i<o.wires.length;i++){var d=o.wires[i],a=d.downloadSpeed();if(!(a<SPEED_THRESHOLD)&&(!(a<=t)&&d.peerPieces.get(e)&&!((s-=a*r)>0)))return n--,!1}return!0}}function n(e){for(var t=e,r=e;r<o._selections.length&&o._selections[r].priority;r++)t=r;var n=o._selections[e];o._selections[e]=o._selections[t],o._selections[t]=n}function i(i){if(e.requests.length>=d)return!0;for(var s=r(),a=0;a<o._selections.length;a++){var u,c=o._selections[a];if("rarest"===o.strategy)for(var p=c.from+c.offset,l=c.to,f=l-p+1,h={},_=0,g=t(p,l,h,s);_<f&&!((u=o._rarityMap.getRarestPiece(g))<0);){for(;o._request(e,u,o._critical[u]||i););if(!(e.requests.length<d))return c.priority&&n(a),!0;h[u]=!0,_++}else for(u=c.from+c.offset;u<=c.to;u++)if(e.peerPieces.get(u)&&s(u)){for(;o._request(e,u,o._critical[u]||i););if(!(e.requests.length<d))return c.priority&&n(a),!0}}return!1}var o=this;if(!e.peerChoking){if(!e.downloaded)return function(){if(!e.requests.length)for(var r=o._selections.length;r--;){var n,i=o._selections[r];if("rarest"===o.strategy)for(var s=i.from+i.offset,d=i.to,a=d-s+1,u={},c=0,p=t(s,d,u);c<a&&!((n=o._rarityMap.getRarestPiece(p))<0);){if(o._request(e,n,!1))return;u[n]=!0,c+=1}else for(n=i.to;n>=i.from+i.offset;--n)if(e.peerPieces.get(n)&&o._request(e,n,!1))return}}();var s=getBlockPipelineLength(e,PIPELINE_MIN_DURATION);if(!(e.requests.length>=s)){var d=getBlockPipelineLength(e,PIPELINE_MAX_DURATION);i(!1)||i(!0)}}},Torrent.prototype._rechoke=function(){function e(e,t){return e.downloadSpeed!==t.downloadSpeed?t.downloadSpeed-e.downloadSpeed:e.uploadSpeed!==t.uploadSpeed?t.uploadSpeed-e.uploadSpeed:e.wire.amChoking!==t.wire.amChoking?e.wire.amChoking?1:-1:e.salt-t.salt}var t=this;if(t.ready){t._rechokeOptimisticTime>0?t._rechokeOptimisticTime-=1:t._rechokeOptimisticWire=null;var r=[];t.wires.forEach(function(e){e.isSeeder||e===t._rechokeOptimisticWire||r.push({wire:e,downloadSpeed:e.downloadSpeed(),uploadSpeed:e.uploadSpeed(),salt:Math.random(),isChoked:!0})}),r.sort(e);for(var n=0,i=0;i<r.length&&n<t._rechokeNumSlots;++i)r[i].isChoked=!1,r[i].wire.peerInterested&&(n+=1);if(!t._rechokeOptimisticWire&&i<r.length&&t._rechokeNumSlots){var o=r.slice(i).filter(function(e){return e.wire.peerInterested}),s=o[randomInt(o.length)];s&&(s.isChoked=!1,t._rechokeOptimisticWire=s.wire,t._rechokeOptimisticTime=RECHOKE_OPTIMISTIC_DURATION)}r.forEach(function(e){e.wire.amChoking!==e.isChoked&&(e.isChoked?e.wire.choke():e.wire.unchoke())})}},Torrent.prototype._hotswap=function(e,t){var r=this,n=e.downloadSpeed();if(n<Piece.BLOCK_LENGTH)return!1;if(!r._reservations[t])return!1;var i=r._reservations[t];if(!i)return!1;var o,s,d=1/0;for(s=0;s<i.length;s++){var a=i[s];if(a&&a!==e){var u=a.downloadSpeed();u>=SPEED_THRESHOLD||2*u>n||u>d||(o=a,d=u)}}if(!o)return!1;for(s=0;s<i.length;s++)i[s]===o&&(i[s]=null);for(s=0;s<o.requests.length;s++){var c=o.requests[s];c.piece===t&&r.pieces[t].cancel(c.offset/Piece.BLOCK_LENGTH|0)}return r.emit("hotswap",o,e,t),!0},Torrent.prototype._request=function(e,t,r){function n(){process.nextTick(function(){i._update()})}var i=this,o=e.requests.length,s="webSeed"===e.type;if(i.bitfield.get(t))return!1;if(o>=(s?Math.min(getPiecePipelineLength(e,PIPELINE_MAX_DURATION,i.pieceLength),i.maxWebConns):getBlockPipelineLength(e,PIPELINE_MAX_DURATION)))return!1;var d=i.pieces[t],a=s?d.reserveRemaining():d.reserve();if(-1===a&&r&&i._hotswap(e,t)&&(a=s?d.reserveRemaining():d.reserve()),-1===a)return!1;var u=i._reservations[t];u||(u=i._reservations[t]=[]);var c=u.indexOf(null);-1===c&&(c=u.length),u[c]=e;var p=d.chunkOffset(a),l=s?d.chunkLengthRemaining(a):d.chunkLength(a);return e.request(t,p,l,function r(o,f){if(!i.ready)return i.once("ready",function(){r(o,f)});if(u[c]===e&&(u[c]=null),d!==i.pieces[t])return n();if(o)return i._debug("error getting piece %s (offset: %s length: %s) from %s: %s",t,p,l,e.remoteAddress+":"+e.remotePort,o.message),s?d.cancelRemaining(a):d.cancel(a),void n();if(i._debug("got piece %s (offset: %s length: %s) from %s",t,p,l,e.remoteAddress+":"+e.remotePort),!d.set(a,f,e))return n();var h=d.flush();sha1(h,function(e){if(e===i._hashes[t]){if(!i.pieces[t])return;i._debug("piece verified %s",t),i.pieces[t]=null,i._reservations[t]=null,i.bitfield.set(t,!0),i.store.put(t,h),i.wires.forEach(function(e){e.have(t)}),i._checkDone()}else i.pieces[t]=new Piece(d.length),i.emit("warning",new Error("Piece "+t+" failed verification"));n()})}),!0},Torrent.prototype._checkDone=function(){var e=this;if(!e.destroyed){e.files.forEach(function(t){if(!t.done){for(var r=t._startPiece;r<=t._endPiece;++r)if(!e.bitfield.get(r))return;t.done=!0,t.emit("done"),e._debug("file done: "+t.name)}});for(var t=!0,r=0;r<e._selections.length;r++){for(var n=e._selections[r],i=n.from;i<=n.to;i++)if(!e.bitfield.get(i)){t=!1;break}if(!t)break}!e.done&&t&&(e.done=!0,e._debug("torrent done: "+e.infoHash),e.discovery.complete(),e.emit("done")),e._gcSelections()}},Torrent.prototype.load=function(e,t){var r=this;if(r.destroyed)throw new Error("torrent is destroyed");if(!r.ready)return r.once("ready",function(){r.load(e,t)});Array.isArray(e)||(e=[e]),t||(t=noop);var n=new MultiStream(e),i=new ChunkStoreWriteStream(r.store,r.pieceLength);pump(n,i,function(e){if(e)return t(e);r.pieces.forEach(function(e,t){r.pieces[t]=null,r._reservations[t]=null,r.bitfield.set(t,!0)}),r._checkDone(),t(null)})},Torrent.prototype.createServer=function(e){if("function"!=typeof Server)throw new Error("node.js-only method");if(this.destroyed)throw new Error("torrent is destroyed");var t=new Server(this,e);return this._servers.push(t),t},Torrent.prototype.pause=function(){this.destroyed||(this._debug("pause"),this.paused=!0)},Torrent.prototype.resume=function(){this.destroyed||(this._debug("resume"),this.paused=!1,this._drain())},Torrent.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._debugId+"] "+e[0],debug.apply(null,e)},Torrent.prototype._drain=function(){var e=this;if(this._debug("_drain numConns %s maxConns %s",e._numConns,e.client.maxConns),!("function"!=typeof net.connect||e.destroyed||e.paused||e._numConns>=e.client.maxConns)){this._debug("drain (%s queued, %s/%s peers)",e._numQueued,e.numPeers,e.client.maxConns);var t=e._queue.shift();if(t){this._debug("tcp connect attempt to %s",t.addr);var r=addrToIPPort(t.addr),n={host:r[0],port:r[1]},i=t.conn=net.connect(n);i.once("connect",function(){t.onConnect()}),i.once("error",function(e){t.destroy(e)}),t.startConnectTimeout(),i.on("close",function(){if(!e.destroyed){if(t.retries>=RECONNECT_WAIT.length)return void e._debug("conn %s closed: will not re-add (max %s attempts)",t.addr,RECONNECT_WAIT.length);var r=RECONNECT_WAIT[t.retries];e._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",t.addr,r,t.retries+1);var n=setTimeout(function(){var r=e._addPeer(t.addr);r&&(r.retries=t.retries+1)},r);n.unref&&n.unref()}})}}},Torrent.prototype._validAddr=function(e){var t;try{t=addrToIPPort(e)}catch(e){return!1}var r=t[0],n=t[1];return n>0&&n<65535&&!("127.0.0.1"===r&&n===this.client.torrentPort)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../package.json":319,"./file":314,"./peer":315,"./rarity-map":316,"./server":37,"_process":205,"addr-to-ip-port":1,"bitfield":20,"chunk-store-stream/write":68,"debug":88,"events":121,"fs":63,"fs-chunk-store":168,"immediate-chunk-store":142,"inherits":144,"multistream":181,"net":37,"os":37,"parse-torrent":196,"path":197,"pump":212,"random-iterate":222,"run-parallel":242,"run-parallel-limit":241,"simple-get":256,"simple-sha1":258,"speedometer":268,"torrent-discovery":284,"torrent-piece":290,"uniq":293,"ut_metadata":297,"ut_pex":37,"xtend":324,"xtend/mutable":325}],318:[function(require,module,exports){
function WebConn(e,t){Wire.call(this),this.url=e,this.webPeerId=sha1.sync(e),this._torrent=t,this._init()}module.exports=WebConn;var BitField=require("bitfield"),Buffer=require("safe-buffer").Buffer,debug=require("debug")("webtorrent:webconn"),get=require("simple-get"),inherits=require("inherits"),sha1=require("simple-sha1"),Wire=require("bittorrent-protocol"),VERSION=require("../package.json").version;inherits(WebConn,Wire),WebConn.prototype._init=function(){var e=this;e.setKeepAlive(!0),e.once("handshake",function(t,n){if(!e.destroyed){e.handshake(t,e.webPeerId);for(var r=e._torrent.pieces.length,o=new BitField(r),i=0;i<=r;i++)o.set(i,!0);e.bitfield(o)}}),e.once("interested",function(){debug("interested"),e.unchoke()}),e.on("uninterested",function(){debug("uninterested")}),e.on("choke",function(){debug("choke")}),e.on("unchoke",function(){debug("unchoke")}),e.on("bitfield",function(){debug("bitfield")}),e.on("request",function(t,n,r,o){debug("request pieceIndex=%d offset=%d length=%d",t,n,r),e.httpRequest(t,n,r,o)})},WebConn.prototype.httpRequest=function(e,t,n,r){var o,i=this,u=e*i._torrent.pieceLength,s=u+t,f=s+n-1,d=i._torrent.files;if(d.length<=1)o=[{url:i.url,start:s,end:f}];else{var l=d.filter(function(e){return e.offset<=f&&e.offset+e.length>s});if(l.length<1)return r(new Error("Could not find file corresponnding to web seed range request"));o=l.map(function(e){var t=e.offset+e.length-1;return{url:i.url+("/"===i.url[i.url.length-1]?"":"/")+e.path,fileOffsetInRange:Math.max(e.offset-s,0),start:Math.max(s-e.offset,0),end:Math.min(t,f-e.offset)}})}var h,a=0,c=!1;o.length>1&&(h=Buffer.alloc(n)),o.forEach(function(i){var u=i.url,s=i.start,f=i.end;debug("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",u,e,t,n,s,f);var d={url:u,method:"GET",headers:{"user-agent":"WebTorrent/"+VERSION+" (https://webtorrent.io)",range:"bytes="+s+"-"+f}};get.concat(d,function(e,t,n){if(!c){if(e)return c=!0,r(e);if(t.statusCode<200||t.statusCode>=300)return c=!0,r(new Error("Unexpected HTTP status code "+t.statusCode));debug("Got data of length %d",n.length),1===o.length?r(null,n):(n.copy(h,i.fileOffsetInRange),++a===o.length&&r(null,h))}})})},WebConn.prototype.destroy=function(){Wire.prototype.destroy.call(this),this._torrent=null};

},{"../package.json":319,"bitfield":20,"bittorrent-protocol":21,"debug":88,"inherits":144,"safe-buffer":244,"simple-get":256,"simple-sha1":258}],319:[function(require,module,exports){
module.exports={
  "version": "0.96.5"
}
},{}],320:[function(require,module,exports){
function wrappy(n,r){function e(){for(var r=new Array(arguments.length),e=0;e<r.length;e++)r[e]=arguments[e];var t=n.apply(this,r),o=r[r.length-1];return"function"==typeof t&&t!==o&&Object.keys(o).forEach(function(n){t[n]=o[n]}),t}if(n&&r)return wrappy(n)(r);if("function"!=typeof n)throw new TypeError("need wrapper function");return Object.keys(n).forEach(function(r){e[r]=n[r]}),e}module.exports=wrappy;

},{}],321:[function(require,module,exports){
module.exports=XMLHttpRequest;

},{}],322:[function(require,module,exports){
function XSalsa20(t,e){if(!(this instanceof XSalsa20))return new XSalsa20(t,e);if(!t||t.length<24)throw new Error("nonce must be at least 24 bytes");if(!e||e.length<32)throw new Error("key must be at least 32 bytes");this._xor=xsalsa20&&xsalsa20.exports?new WASM(t,e):new Fallback(t,e)}function WASM(t,e){free.length||(free.push(head),head+=64),this._pointer=free.pop(),this._nonce=this._pointer+8,this._key=this._nonce+24,this._overflow=0,xsalsa20.memory.fill(0,this._pointer,this._pointer+8),xsalsa20.memory.set(t,this._nonce),xsalsa20.memory.set(e,this._key)}function Fallback(t,e){this._s=new Uint8Array(32),this._z=new Uint8Array(16),this._overflow=0,core_hsalsa20(this._s,t,e,SIGMA);for(var s=0;s<8;s++)this._z[s]=t[s+16]}function core_salsa20(t,e,s,a){for(var o,r=255&a[0]|(255&a[1])<<8|(255&a[2])<<16|(255&a[3])<<24,i=255&s[0]|(255&s[1])<<8|(255&s[2])<<16|(255&s[3])<<24,l=255&s[4]|(255&s[5])<<8|(255&s[6])<<16|(255&s[7])<<24,n=255&s[8]|(255&s[9])<<8|(255&s[10])<<16|(255&s[11])<<24,h=255&s[12]|(255&s[13])<<8|(255&s[14])<<16|(255&s[15])<<24,f=255&a[4]|(255&a[5])<<8|(255&a[6])<<16|(255&a[7])<<24,_=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,p=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,y=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,u=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,c=255&a[8]|(255&a[9])<<8|(255&a[10])<<16|(255&a[11])<<24,w=255&s[16]|(255&s[17])<<8|(255&s[18])<<16|(255&s[19])<<24,x=255&s[20]|(255&s[21])<<8|(255&s[22])<<16|(255&s[23])<<24,m=255&s[24]|(255&s[25])<<8|(255&s[26])<<16|(255&s[27])<<24,S=255&s[28]|(255&s[29])<<8|(255&s[30])<<16|(255&s[31])<<24,d=255&a[12]|(255&a[13])<<8|(255&a[14])<<16|(255&a[15])<<24,v=r,A=i,b=l,k=n,X=h,g=f,z=_,M=p,E=y,U=u,F=c,G=w,I=x,W=m,B=S,Y=d,N=0;N<20;N+=2)o=v+I|0,X^=o<<7|o>>>25,o=X+v|0,E^=o<<9|o>>>23,o=E+X|0,I^=o<<13|o>>>19,o=I+E|0,v^=o<<18|o>>>14,o=g+A|0,U^=o<<7|o>>>25,o=U+g|0,W^=o<<9|o>>>23,o=W+U|0,A^=o<<13|o>>>19,o=A+W|0,g^=o<<18|o>>>14,o=F+z|0,B^=o<<7|o>>>25,o=B+F|0,b^=o<<9|o>>>23,o=b+B|0,z^=o<<13|o>>>19,o=z+b|0,F^=o<<18|o>>>14,o=Y+G|0,k^=o<<7|o>>>25,o=k+Y|0,M^=o<<9|o>>>23,o=M+k|0,G^=o<<13|o>>>19,o=G+M|0,Y^=o<<18|o>>>14,o=v+k|0,A^=o<<7|o>>>25,o=A+v|0,b^=o<<9|o>>>23,o=b+A|0,k^=o<<13|o>>>19,o=k+b|0,v^=o<<18|o>>>14,o=g+X|0,z^=o<<7|o>>>25,o=z+g|0,M^=o<<9|o>>>23,o=M+z|0,X^=o<<13|o>>>19,o=X+M|0,g^=o<<18|o>>>14,o=F+U|0,G^=o<<7|o>>>25,o=G+F|0,E^=o<<9|o>>>23,o=E+G|0,U^=o<<13|o>>>19,o=U+E|0,F^=o<<18|o>>>14,o=Y+B|0,I^=o<<7|o>>>25,o=I+Y|0,W^=o<<9|o>>>23,o=W+I|0,B^=o<<13|o>>>19,o=B+W|0,Y^=o<<18|o>>>14;v=v+r|0,A=A+i|0,b=b+l|0,k=k+n|0,X=X+h|0,g=g+f|0,z=z+_|0,M=M+p|0,E=E+y|0,U=U+u|0,F=F+c|0,G=G+w|0,I=I+x|0,W=W+m|0,B=B+S|0,Y=Y+d|0,t[0]=v>>>0&255,t[1]=v>>>8&255,t[2]=v>>>16&255,t[3]=v>>>24&255,t[4]=A>>>0&255,t[5]=A>>>8&255,t[6]=A>>>16&255,t[7]=A>>>24&255,t[8]=b>>>0&255,t[9]=b>>>8&255,t[10]=b>>>16&255,t[11]=b>>>24&255,t[12]=k>>>0&255,t[13]=k>>>8&255,t[14]=k>>>16&255,t[15]=k>>>24&255,t[16]=X>>>0&255,t[17]=X>>>8&255,t[18]=X>>>16&255,t[19]=X>>>24&255,t[20]=g>>>0&255,t[21]=g>>>8&255,t[22]=g>>>16&255,t[23]=g>>>24&255,t[24]=z>>>0&255,t[25]=z>>>8&255,t[26]=z>>>16&255,t[27]=z>>>24&255,t[28]=M>>>0&255,t[29]=M>>>8&255,t[30]=M>>>16&255,t[31]=M>>>24&255,t[32]=E>>>0&255,t[33]=E>>>8&255,t[34]=E>>>16&255,t[35]=E>>>24&255,t[36]=U>>>0&255,t[37]=U>>>8&255,t[38]=U>>>16&255,t[39]=U>>>24&255,t[40]=F>>>0&255,t[41]=F>>>8&255,t[42]=F>>>16&255,t[43]=F>>>24&255,t[44]=G>>>0&255,t[45]=G>>>8&255,t[46]=G>>>16&255,t[47]=G>>>24&255,t[48]=I>>>0&255,t[49]=I>>>8&255,t[50]=I>>>16&255,t[51]=I>>>24&255,t[52]=W>>>0&255,t[53]=W>>>8&255,t[54]=W>>>16&255,t[55]=W>>>24&255,t[56]=B>>>0&255,t[57]=B>>>8&255,t[58]=B>>>16&255,t[59]=B>>>24&255,t[60]=Y>>>0&255,t[61]=Y>>>8&255,t[62]=Y>>>16&255,t[63]=Y>>>24&255}function core_hsalsa20(t,e,s,a){for(var o,r=255&a[0]|(255&a[1])<<8|(255&a[2])<<16|(255&a[3])<<24,i=255&s[0]|(255&s[1])<<8|(255&s[2])<<16|(255&s[3])<<24,l=255&s[4]|(255&s[5])<<8|(255&s[6])<<16|(255&s[7])<<24,n=255&s[8]|(255&s[9])<<8|(255&s[10])<<16|(255&s[11])<<24,h=255&s[12]|(255&s[13])<<8|(255&s[14])<<16|(255&s[15])<<24,f=255&a[4]|(255&a[5])<<8|(255&a[6])<<16|(255&a[7])<<24,_=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,p=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,y=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,u=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,c=255&a[8]|(255&a[9])<<8|(255&a[10])<<16|(255&a[11])<<24,w=255&s[16]|(255&s[17])<<8|(255&s[18])<<16|(255&s[19])<<24,x=255&s[20]|(255&s[21])<<8|(255&s[22])<<16|(255&s[23])<<24,m=255&s[24]|(255&s[25])<<8|(255&s[26])<<16|(255&s[27])<<24,S=255&s[28]|(255&s[29])<<8|(255&s[30])<<16|(255&s[31])<<24,d=255&a[12]|(255&a[13])<<8|(255&a[14])<<16|(255&a[15])<<24,v=r,A=i,b=l,k=n,X=h,g=f,z=_,M=p,E=y,U=u,F=c,G=w,I=x,W=m,B=S,Y=d,N=0;N<20;N+=2)o=v+I|0,X^=o<<7|o>>>25,o=X+v|0,E^=o<<9|o>>>23,o=E+X|0,I^=o<<13|o>>>19,o=I+E|0,v^=o<<18|o>>>14,o=g+A|0,U^=o<<7|o>>>25,o=U+g|0,W^=o<<9|o>>>23,o=W+U|0,A^=o<<13|o>>>19,o=A+W|0,g^=o<<18|o>>>14,o=F+z|0,B^=o<<7|o>>>25,o=B+F|0,b^=o<<9|o>>>23,o=b+B|0,z^=o<<13|o>>>19,o=z+b|0,F^=o<<18|o>>>14,o=Y+G|0,k^=o<<7|o>>>25,o=k+Y|0,M^=o<<9|o>>>23,o=M+k|0,G^=o<<13|o>>>19,o=G+M|0,Y^=o<<18|o>>>14,o=v+k|0,A^=o<<7|o>>>25,o=A+v|0,b^=o<<9|o>>>23,o=b+A|0,k^=o<<13|o>>>19,o=k+b|0,v^=o<<18|o>>>14,o=g+X|0,z^=o<<7|o>>>25,o=z+g|0,M^=o<<9|o>>>23,o=M+z|0,X^=o<<13|o>>>19,o=X+M|0,g^=o<<18|o>>>14,o=F+U|0,G^=o<<7|o>>>25,o=G+F|0,E^=o<<9|o>>>23,o=E+G|0,U^=o<<13|o>>>19,o=U+E|0,F^=o<<18|o>>>14,o=Y+B|0,I^=o<<7|o>>>25,o=I+Y|0,W^=o<<9|o>>>23,o=W+I|0,B^=o<<13|o>>>19,o=B+W|0,Y^=o<<18|o>>>14;t[0]=v>>>0&255,t[1]=v>>>8&255,t[2]=v>>>16&255,t[3]=v>>>24&255,t[4]=g>>>0&255,t[5]=g>>>8&255,t[6]=g>>>16&255,t[7]=g>>>24&255,t[8]=F>>>0&255,t[9]=F>>>8&255,t[10]=F>>>16&255,t[11]=F>>>24&255,t[12]=Y>>>0&255,t[13]=Y>>>8&255,t[14]=Y>>>16&255,t[15]=Y>>>24&255,t[16]=z>>>0&255,t[17]=z>>>8&255,t[18]=z>>>16&255,t[19]=z>>>24&255,t[20]=M>>>0&255,t[21]=M>>>8&255,t[22]=M>>>16&255,t[23]=M>>>24&255,t[24]=E>>>0&255,t[25]=E>>>8&255,t[26]=E>>>16&255,t[27]=E>>>24&255,t[28]=U>>>0&255,t[29]=U>>>8&255,t[30]=U>>>16&255,t[31]=U>>>24&255}var xsalsa20=require("./xsalsa20")(),SIGMA=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]),head=144,top=head,free=[];module.exports=XSalsa20,XSalsa20.NONCEBYTES=24,XSalsa20.KEYBYTES=32,XSalsa20.prototype.update=function(t,e){if(!t)throw new Error("input must be Uint8Array or Buffer");return e||(e=new Uint8Array(t.length)),t.length&&this._xor.update(t,e),e},XSalsa20.prototype.final=XSalsa20.prototype.finalize=function(){this._xor.finalize(),this._xor=null},WASM.prototype.update=function(t,e){var s=this._overflow+t.length,a=head+this._overflow;top=head+s,top>=xsalsa20.memory.length&&xsalsa20.realloc(top),xsalsa20.memory.set(t,a),xsalsa20.exports.xsalsa20_xor(this._pointer,head,head,s,this._nonce,this._key),e.set(xsalsa20.memory.subarray(a,head+s)),this._overflow=63&s},WASM.prototype.finalize=function(){xsalsa20.memory.fill(0,this._pointer,this._key+32),top>head&&(xsalsa20.memory.fill(0,head,top),top=0),free.push(this._pointer)},Fallback.prototype.update=function(t,e){for(var s=new Uint8Array(64),a=0,o=this._overflow,r=t.length+this._overflow,i=this._z,l=-this._overflow,n=-this._overflow;r>=64;){for(core_salsa20(s,i,this._s,SIGMA);o<64;o++)e[n+o]=t[l+o]^s[o];for(a=1,o=8;o<16;o++)a+=255&i[o]|0,i[o]=255&a,a>>>=8;r-=64,n+=64,l+=64,o=0}if(r>0)for(core_salsa20(s,i,this._s,SIGMA);o<r;o++)e[n+o]=t[l+o]^s[o];this._overflow=63&r},Fallback.prototype.finalize=function(){this._s.fill(0),this._z.fill(0)};
},{"./xsalsa20":323}],323:[function(require,module,exports){
function loadWebAssembly(A){function I(A){o.exports.memory.grow(Math.ceil(Math.abs(A-o.memory.length)/65536)),o.memory=new Uint8Array(o.exports.memory.buffer)}function B(I){if(o.exports)return I();if(C)return void C.then(I.bind(null,null)).catch(I);try{if(A&&A.async)throw new Error("async");E({instance:new WebAssembly.Instance(new WebAssembly.Module(Q),g)})}catch(A){C=WebAssembly.instantiate(Q,g).then(E)}B(I)}function E(A){o.exports=A.instance.exports,o.memory=o.exports.memory&&o.exports.memory.buffer&&new Uint8Array(o.exports.memory.buffer)}if(!loadWebAssembly.supported)return null;var g=A&&A.imports,Q=toUint8Array("AGFzbQEAAAABGgNgBn9/f39/fwBgBn9/f39+fwF+YAN/f38AAwcGAAEBAgICBQUBAQroBwcoAwZtZW1vcnkCAAx4c2Fsc2EyMF94b3IAAAxjb3JlX3NhbHNhMjAABArqEQYYACAAIAEgAiADIAQgACkDACAFEAE3AwALPQBB8AAgAyAFEAMgACABIAIgA0EQaiAEQfAAEAJB8ABCADcDAEH4AEIANwMAQYABQgA3AwBBiAFCADcDAAuHBQEBfyACQQBGBEBCAA8LQdAAIAUpAwA3AwBB2AAgBUEIaikDADcDAEHgACAFQRBqKQMANwMAQegAIAVBGGopAwA3AwBBACADKQMANwMAQQggBDcDAAJAA0AgAkHAAEkNAUEQQQBB0AAQBSAAIAEpAwBBECkDAIU3AwAgAEEIaiABQQhqKQMAQRgpAwCFNwMAIABBEGogAUEQaikDAEEgKQMAhTcDACAAQRhqIAFBGGopAwBBKCkDAIU3AwAgAEEgaiABQSBqKQMAQTApAwCFNwMAIABBKGogAUEoaikDAEE4KQMAhTcDACAAQTBqIAFBMGopAwBBwAApAwCFNwMAIABBOGogAUE4aikDAEHIACkDAIU3AwBBCEEIKQMAQgF8NwMAIABBwABqIQAgAUHAAGohASACQcAAayECDAALC0EIKQMAIQQgAkEASwRAQRBBAEHQABAFAkACQAJAAkACQAJAAkACQCACQQhuDgcHBgUEAwIBAAsgAEE4aiABQThqKQMAQcgAKQMAhTcDAAsgAEEwaiABQTBqKQMAQcAAKQMAhTcDAAsgAEEoaiABQShqKQMAQTgpAwCFNwMACyAAQSBqIAFBIGopAwBBMCkDAIU3AwALIABBGGogAUEYaikDAEEoKQMAhTcDAAsgAEEQaiABQRBqKQMAQSApAwCFNwMACyAAQQhqIAFBCGopAwBBGCkDAIU3AwALIAAgASkDAEEQKQMAhTcDAAtBEEIANwMAQRhCADcDAEEgQgA3AwBBKEIANwMAQTBCADcDAEE4QgA3AwBBwABCADcDAEHIAEIANwMAQdAAQgA3AwBB2ABCADcDAEHgAEIANwMAQegAQgA3AwAgBA8LnQUBEX9B5fDBiwYhA0HuyIGZAyEIQbLaiMsHIQ1B9MqB2QYhEiACKAIAIQQgAkEEaigCACEFIAJBCGooAgAhBiACQQxqKAIAIQcgAkEQaigCACEOIAJBFGooAgAhDyACQRhqKAIAIRAgAkEcaigCACERIAEoAgAhCSABQQRqKAIAIQogAUEIaigCACELIAFBDGooAgAhDEEUIRMCQANAIBNBAEYNASAHIAMgD2pBB3dzIQcgCyAHIANqQQl3cyELIA8gCyAHakENd3MhDyADIA8gC2pBEndzIQMgDCAIIARqQQd3cyEMIBAgDCAIakEJd3MhECAEIBAgDGpBDXdzIQQgCCAEIBBqQRJ3cyEIIBEgDSAJakEHd3MhESAFIBEgDWpBCXdzIQUgCSAFIBFqQQ13cyEJIA0gCSAFakESd3MhDSAGIBIgDmpBB3dzIQYgCiAGIBJqQQl3cyEKIA4gCiAGakENd3MhDiASIA4gCmpBEndzIRIgBCADIAZqQQd3cyEEIAUgBCADakEJd3MhBSAGIAUgBGpBDXdzIQYgAyAGIAVqQRJ3cyEDIAkgCCAHakEHd3MhCSAKIAkgCGpBCXdzIQogByAKIAlqQQ13cyEHIAggByAKakESd3MhCCAOIA0gDGpBB3dzIQ4gCyAOIA1qQQl3cyELIAwgCyAOakENd3MhDCANIAwgC2pBEndzIQ0gDyASIBFqQQd3cyEPIBAgDyASakEJd3MhECARIBAgD2pBDXdzIREgEiARIBBqQRJ3cyESIBNBAmshEwwACwsgACADNgIAIABBBGogCDYCACAAQQhqIA02AgAgAEEMaiASNgIAIABBEGogCTYCACAAQRRqIAo2AgAgAEEYaiALNgIAIABBHGogDDYCAAsKACAAIAEgAhAFC90GASF/QeXwwYsGIQNB7siBmQMhCEGy2ojLByENQfTKgdkGIRIgAigCACEEIAJBBGooAgAhBSACQQhqKAIAIQYgAkEMaigCACEHIAJBEGooAgAhDiACQRRqKAIAIQ8gAkEYaigCACEQIAJBHGooAgAhESABKAIAIQkgAUEEaigCACEKIAFBCGooAgAhCyABQQxqKAIAIQwgAyETIAQhFCAFIRUgBiEWIAchFyAIIRggCSEZIAohGiALIRsgDCEcIA0hHSAOIR4gDyEfIBAhICARISEgEiEiQRQhIwJAA0AgI0EARg0BIAcgAyAPakEHd3MhByALIAcgA2pBCXdzIQsgDyALIAdqQQ13cyEPIAMgDyALakESd3MhAyAMIAggBGpBB3dzIQwgECAMIAhqQQl3cyEQIAQgECAMakENd3MhBCAIIAQgEGpBEndzIQggESANIAlqQQd3cyERIAUgESANakEJd3MhBSAJIAUgEWpBDXdzIQkgDSAJIAVqQRJ3cyENIAYgEiAOakEHd3MhBiAKIAYgEmpBCXdzIQogDiAKIAZqQQ13cyEOIBIgDiAKakESd3MhEiAEIAMgBmpBB3dzIQQgBSAEIANqQQl3cyEFIAYgBSAEakENd3MhBiADIAYgBWpBEndzIQMgCSAIIAdqQQd3cyEJIAogCSAIakEJd3MhCiAHIAogCWpBDXdzIQcgCCAHIApqQRJ3cyEIIA4gDSAMakEHd3MhDiALIA4gDWpBCXdzIQsgDCALIA5qQQ13cyEMIA0gDCALakESd3MhDSAPIBIgEWpBB3dzIQ8gECAPIBJqQQl3cyEQIBEgECAPakENd3MhESASIBEgEGpBEndzIRIgI0ECayEjDAALCyAAIAMgE2o2AgAgAEEEaiAEIBRqNgIAIABBCGogBSAVajYCACAAQQxqIAYgFmo2AgAgAEEQaiAHIBdqNgIAIABBFGogCCAYajYCACAAQRhqIAkgGWo2AgAgAEEcaiAKIBpqNgIAIABBIGogCyAbajYCACAAQSRqIAwgHGo2AgAgAEEoaiANIB1qNgIAIABBLGogDiAeajYCACAAQTBqIA8gH2o2AgAgAEE0aiAQICBqNgIAIABBOGogESAhajYCACAAQTxqIBIgImo2AgAL"),C=null,o={buffer:Q,memory:null,exports:null,realloc:I,onload:B};return B(function(){}),o}function toUint8Array(A){return"function"==typeof atob?new Uint8Array(atob(A).split("").map(charCodeAt)):new(require("buffer").Buffer)(A,"base64")}function charCodeAt(A){return A.charCodeAt(0)}module.exports=loadWebAssembly,loadWebAssembly.supported="undefined"!=typeof WebAssembly;
},{"buffer":66}],324:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],325:[function(require,module,exports){
function extend(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],326:[function(require,module,exports){
module.exports=function n(t,o,r){return void 0===o?function(o,r){return n(t,o,r)}:(void 0===r&&(r="0"),t-=o.toString().length,t>0?new Array(t+(/\./.test(o)?2:1)).join(r)+o:o+"")};

},{}],327:[function(require,module,exports){
module.exports={trackerURL:"wss://tracker.openwebtorrent.com",chat:{messageTemplate:"#chatMessageTmpl",chatBody:"#chat .panel-body",chatList:"#chat-list",chatInput:"#chat-text",chatEnterButton:"#chat-enter"},rtc:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",username:"peertunes.turn@gmail.com",credential:"peertunes-turn"},{urls:"turn:w3.xirsys.com:80?transport=udp",username:"3bb9834c-642a-11e7-9004-cef4158965a4",credential:"3bb983ce-642a-11e7-aa80-1fb2cc031dcb"}]},selectors:{likeButton:"#like-button",dislikeButton:"#dislike-button",joinQueueButton:"#btn-join-queue",volumeSlider:"#volume-slider"},moshpit:{selector:"#moshpit"},songQueue:{queue:"#my-queue-list",localstorageKey:"queue",queueItem:".queue-item",itemTemplate:"#queueItemTmpl"},player:{audio:"#vid2",video:"#vid1"},navBar:{leaveButton:"#btn-leave-room"}};
},{}],328:[function(require,module,exports){
function ChatController(t,e){var i=this;this.view=t,this.model=e,this.model.on("new-chat",this.view.onMessage.bind(this.view)),this.model.on("delete-all-messages",this.view.clear.bind(this.view)),this.DOM=this.view.getDOM(),this.DOM.$chatEnterButton.click(function(t){i._submitMessage()});this._onKeydown=function(t){13===t.keyCode&&i._submitMessage()},this.DOM.$chatInput.on("keydown",this._onKeydown)}var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits;module.exports=ChatController,inherits(ChatController,EventEmitter),ChatController.prototype.destroy=function(){this.DOM.$chatInput.off("keydown",this._onKeydown)},ChatController.prototype._submitMessage=function(){var t=this.DOM.$chatInput.val();this.emit("chat:submit",t)};

},{"events":121,"util":304}],329:[function(require,module,exports){
function LobbyController(o){var t=this;this.identity=o.identity,this.router=o.router,this.view=new LobbyView({roomRowTemplate:"#roomRowTmpl",roomList:"#room-list"}),this._onLobbyAddRoom=function(o){console.log("new room added to lobby: ",o),t.view.addRoom(o)},this.lobby=this._joinLobby(),this.lobby.on("rooms:add",this._onLobbyAddRoom),this.$createRoomButton=$("#btn-create-room"),this.$roomList=$("#room-list"),this.$createRoomModal=$("#createRoomModal"),this.$modalCreateRoomButton=$("#modal-btn-create-room"),this.$modalRoomNameInput=$("#roomNameInput"),this.$createRoomForm=$("#create-room-form"),this._initClickHandlers(),this.$createRoomForm.submit(function(o){console.log("form submitted"),o.preventDefault(),t._onSubmitCreateRoomForm()})}var Lobby=require("../modules/lobby"),LobbyView=require("../views/lobby-view"),localforage=require("localforage");module.exports=LobbyController,LobbyController.prototype.destroy=function(){this.$createRoomButton.off(),this.$modalCreateRoomButton.off(),this.$createRoomForm.off(),this.$roomList.empty(),console.log("lobby controller destroy, lobby: ",this.lobby),this.lobby.removeListener("rooms:add",this._onLobbyAddRoom),this.lobby.destroy(),this.lobby=null},LobbyController.prototype._initClickHandlers=function(){var o=this;this.$createRoomButton.click(function(t){o.$createRoomModal.modal("show")})},LobbyController.prototype._onSubmitCreateRoomForm=function(){var o=this;if(console.log("room name val: ",o.$modalRoomNameInput.val()),o.$modalRoomNameInput.val().length<1)return console.log("invalid room name length"),void $("#create-room-form-group").addClass("has-error");$("#create-room-form-group").removeClass("has-error");var t=o.$modalRoomNameInput.val();o.$modalRoomNameInput.val(""),o.router.route("#room/"+o.identity.keypair.public.toString("hex"),{room:{name:t}}),o.$createRoomModal.modal("hide")},LobbyController.prototype._joinLobby=function(){var o=this;return console.log("joining lobby"),new Lobby({maxPeers:6,public:o.identity.keypair.public,private:o.identity.keypair.private,nicename:o.identity.username})};
},{"../modules/lobby":340,"../views/lobby-view":347,"localforage":165}],330:[function(require,module,exports){
function MoshpitController(t,e){this.view=t,this.model=e,this._onAvatarAdd=this.view.addAvatar.bind(this.view),this._onAvatarRemove=this.view.removeAvatar.bind(this.view),this._onAvatarHeadbob=this.view.setHeadbobbing.bind(this.view),this.model.on("avatar:add",this._onAvatarAdd),this.model.on("avatar:remove",this._onAvatarRemove),this.model.on("avatar:headbob",this._onAvatarHeadbob)}module.exports=MoshpitController,MoshpitController.prototype.destroy=function(){this.model.removeListener("avatar:add",this._onAvatarAdd),this.model.removeListener("avatar:remove",this._onAvatarRemove),this.model.removeListener("avatar:headbob",this._onAvatarHeadbob),this.view.destroy()};

},{}],331:[function(require,module,exports){
function QueueController(e,o,t){function i(e){function o(o){SongDuration.get(e,function(i){n._calculateInfoHash(e,function(e,r){if(r)return void console.log("Error calculating infoHash: ",r);var s={title:o.combinedTitle,source:"MP3",id:t,infoHash:e,duration:i};n.model.addSong(s),console.log("Added song to queue model: ",s)})})}var t=e.name;console.log("Reading tags"),n.tagReader.tagsFromFile(e,o),n._saveFileWithKey(e,t)}var n=this;this.view=e,this.model=o,this.model.restore(this.view.render.bind(this.view)),this.queueItem=t.queueItem;var r=this.view.DOM;this._onAddSong=this.view.appendSong.bind(this.view),this._onCycle=this.view.cycle.bind(this.view),this._onRemoveSong=this.view.removeSong.bind(this.view),this._onMoveToTop=this.view.moveToTop.bind(this.view),this.model.on("add-song",this._onAddSong),this.model.on("cycle",this._onCycle),this.model.on("remove-song",this._onRemoveSong),this.model.on("move-to-top",this._onMoveToTop),this.tagReader=new TagReader,r.$songQueue.on("click",".song-remove",function(e){var o=$(this).closest(n.queueItem).index();n.model.removeSongAtPosition(o)}),r.$songQueue.on("click",".song-top-control",function(e){var o=$(this).closest(n.queueItem).index();n.model.moveToTop(o)}),this._dragDropRemove=dragDrop("#my-queue",function(e){e.forEach(i)}),r.$songQueue.sortable({scrollSpeed:14,start:function(e,o){$(this).data("original-index",o.item.index())},update:function(e,o){var t=o.item.index(),i=$(this).data("original-index");$(this).removeData("original-index"),n.model.move(i,t)}})}var dragDrop=require("drag-drop"),localforage=require("localforage"),createTorrent=require("create-torrent"),parseTorrent=require("parse-torrent"),TagReader=require("../lib/tag-reader"),SongDuration=require("../lib/song-duration");module.exports=QueueController,QueueController.prototype.destroy=function(){this._dragDropRemove(),this.model.removeListener("add-song",this._onAddSong),this.model.removeListener("cycle",this._onCycle),this.model.removeListener("remove-song",this._onRemoveSong),this.model.removeListener("move-to-top",this._onMoveToTop);var e=this.view.DOM;e.$songQueue.sortable("destroy"),e.$songQueue.empty()},QueueController.prototype._calculateInfoHash=function(e,o){console.log("calc infoHash of file ",e),createTorrent(e,function(e,t){var i=parseTorrent(t);o(i.infoHash,e)})},QueueController.prototype._saveFileWithKey=function(e,o){var t=new Blob([e]);localforage.setItem(o,t).then(function(){console.log("Done saving file to localstorage")}).catch(function(e){console.log("Error saving file:",e)})};

},{"../lib/song-duration":333,"../lib/tag-reader":334,"create-torrent":83,"drag-drop":101,"localforage":165,"parse-torrent":196}],332:[function(require,module,exports){
var queryString=require("query-string");module.exports=function(){function t(t){return moment.duration(t).asSeconds()}function i(i,r){var o=i.join(","),a={part:"snippet,contentDetails",id:o,key:e.apiKey},s=n+"videos?"+queryString.stringify(a);$.getJSON(s,function(i){var e=i.items.map(function(i){return{title:i.snippet.title,id:i.id,duration:t(i.contentDetails.duration),thumbnail:i.snippet.thumbnails.medium.url}});r(e)})}var e={apiKey:"AIzaSyCw4x0rg8P-R-7ecZzc57Il8ZqTJc_ybNY",maxResults:35},n="https://www.googleapis.com/youtube/v3/";return{getVideoMeta:function(i,r){var o={id:i,title:"",description:"",duration:0},a=n+"videos?id="+i+"&key="+e.apiKey+"&part=snippet,contentDetails";$.getJSON(a,function(i){var e=i.items[0];o.title=e.snippet.title,o.description=e.snippet.description,o.duration=t(e.contentDetails.duration),r(o)})},getSearchResults:function(t,r){var o={part:"id",maxResults:e.maxResults,q:t,type:"video",videoDefinition:"any",videoEmbeddable:!0,key:e.apiKey},a=n+"search?"+queryString.stringify(o);$.getJSON(a,function(t){t=t.items.map(function(t){return t.id.videoId}),i(t,r)})}}}();

},{"query-string":214}],333:[function(require,module,exports){
var SongDuration={get:function(o,e){var r=URL.createObjectURL(o),n=$('<audio id="sd-temp"></audio>');n.css("display","none"),n.on("canplaythrough",function(o){var n=o.currentTarget.duration;URL.revokeObjectURL(r),$(this).remove(),e(n)}),$("body").append(n),n.prop("src",r)}};module.exports=SongDuration;

},{}],334:[function(require,module,exports){
function TagReader(){}var mediaTags=require("jsmediatags");module.exports=TagReader,TagReader.prototype.tagsFromFile=function(e,t){mediaTags.read(e,{onSuccess:function(e){if(e=e.tags,e.picture){for(var a="",r=0;r<e.picture.data.length;r++)a+=String.fromCharCode(e.picture.data[r]);var i="data:image/jpeg;base64,"+window.btoa(a);e.picture=i}else e.picture=null;var o={artist:e.artist,title:e.title,cover:e.picture,combinedTitle:e.title+" - "+e.artist};t(o)},onError:function(e){console.log("Error reading MP3 tags: ",e)}})};
},{"jsmediatags":163}],335:[function(require,module,exports){
var Router=require("./modules/router"),config=require("./config");$(document).ready(function(){new Router});
},{"./config":327,"./modules/router":344}],336:[function(require,module,exports){
function ChatModel(e){this.maxMessageLength=e.maxMessageLength,this.messages=[],this.username=e.username,EventEmitter.call(this)}module.exports=ChatModel;var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits;inherits(ChatModel,EventEmitter),ChatModel.prototype.selfMessage=function(e){e.message=this.filter(e.message),this.addMessage(e),this.emit("new-chat-self",e)},ChatModel.prototype.receiveMessage=function(e){e.message=this.filter(e.message),this.addMessage(e),this.emit("new-chat-peer",e)},ChatModel.prototype.addMessage=function(e){this.messages.push(e),this.emit("new-chat",e)},ChatModel.prototype.deleteAllMessages=function(){this.messages.length=0,this.emit("delete-all-messages")},ChatModel.prototype.filter=function(e){return e.length>this.maxMessageLength&&(e=e.substring(0,this.maxMessageLength)),e=$("<p>").html(e).text()},ChatModel.prototype.getUsername=function(){return this.username};

},{"events":121,"util":304}],337:[function(require,module,exports){
function MoshpitModel(t){this.users={},EventEmitter.call(this)}module.exports=MoshpitModel;var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits;inherits(MoshpitModel,EventEmitter),MoshpitModel.prototype.addAvatar=function(t){this.users[t.id]||(this.users[t.id]=t,this.emit("avatar:add",t))},MoshpitModel.prototype.removeAvatar=function(t){this.users[t]&&(this.emit("avatar:remove",this.users[t]),delete this.users[t])},MoshpitModel.prototype.removeAllAvatars=function(){var t=this;Object.keys(this.users).forEach(function(e){t.emit("avatar:remove",t.users[e])}),this.users={}},MoshpitModel.prototype.setHeadbobbing=function(t,e){this.users[t]&&(this.users[t].headbob=e,this.emit("avatar:headbob",t,e))},MoshpitModel.prototype.stopAllHeadbobs=function(){var t=this;Object.keys(this.users).forEach(function(e){t.setHeadbobbing(e,!1)})};

},{"events":121,"util":304}],338:[function(require,module,exports){
function QueueModel(e){this.songs=[],this.localstorageKey=e.localstorageKey,EventEmitter.call(this)}module.exports=QueueModel;var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,localforage=require("localforage");inherits(QueueModel,EventEmitter),QueueModel.prototype.getSongs=function(){return this.songs},QueueModel.prototype.addSong=function(e){this.songs.push(e),this._save(),this.emit("add-song",e),this.emit("queue:change",this.songs)},QueueModel.prototype.cycle=function(){if(!(this.songs.length<=1)){var e=this.songs.shift();this.songs.push(e),this._save(),this.emit("cycle"),this.emit("queue:change",this.songs)}},QueueModel.prototype.length=function(){return this.songs.length},QueueModel.prototype.front=function(){return this.songs.length>0?this.songs[0]:null},QueueModel.prototype.removeSongAtPosition=function(e){var t=this.songs.splice(e,1),o=t[0];this._save(),"MP3"===o.source&&localforage.removeItem(o.id).then(function(){console.log("MP3 file deleted")}).catch(function(e){console.log("Error deleting mp3 from storage: ",e)}),this.emit("remove-song",e),this.emit("queue:change",this.songs)},QueueModel.prototype.moveToTop=function(e){this.move(e,0),this.emit("move-to-top",e),this.emit("queue:change",this.songs)},QueueModel.prototype.move=function(e,t){var o=this.songs.splice(e,1),s=o[0];this.songs.splice(t,0,s),this._save(),this.emit("queue:change",this.songs)},QueueModel.prototype._save=function(){var e={queue:this.songs};localforage.setItem(this.localstorageKey,e).then(function(e){}).catch(function(e){console.log("Error saving queue: ",e)})},QueueModel.prototype.restore=function(e){var t=this;localforage.getItem(this.localstorageKey).then(function(o){o&&Array.isArray(o.queue)&&(t.songs=o.queue,e())}).catch(function(e){console.log("Error retreiving queue from localstorage, maybe this is the first use"),console.log(e)})};

},{"events":121,"localforage":165,"util":304}],339:[function(require,module,exports){
(function (Buffer){
function HostedRoom(e){var t=this;this.isHost=e.public.toString("hex")===e.hostKey,this.id=crypto.createHash("sha1").update(e.public).digest("hex"),this.hostKey=e.hostKey||null,"string"==typeof this.hostKey&&(this.hostKey=new Buffer(this.hostKey,"hex")),this.hostId=crypto.createHash("sha1").update(this.hostKey).digest("hex"),console.log("hosted room hostId: ",this.hostId),this.nicename=e.nicename,Room.call(this,{id:t.id,roomID:crypto.createHash("sha1").update(t.hostKey).digest("hex")||new Buffer(20).fill("p2p-lobby"),maxPeers:e.maxPeers||6}),this._doc=new Doc,this._heartbeats=this._doc.createSet("type","heartbeat"),this._onHeartbeatAdd=function(e){console.log("heartbeat add: ",e.toJSON()),t.emit("user:join",e.toJSON())},this._onHeartbeatRemove=function(e){e=e.toJSON(),console.log("heartbeat remove: ",e),t.emit("user:leave",e),t.isHost||e.id!==t.hostId||(console.log("host left room"),t.emit("host:leave"))},this._onPeerConnect=function(e){var o=e.mux,r=o.createSharedStream("_crdt");pump(r,t._doc.createStream(),r,function(e){})},this._heartbeats.on("add",this._onHeartbeatAdd),this._heartbeats.on("remove",this._onHeartbeatRemove),this._myHeartbeat=this._doc.add({id:t.id,type:"heartbeat",time:Date.now(),nicename:t.nicename}),this._heartbeatInterval=setInterval(function(){t._myHeartbeat.set("time",Date.now())},HEARTBEAT_INTERVAL),this.on("peer:connect",this._onPeerConnect),this._reaperInterval=null,this._hostHeartbeatCheckInterval=null,this.isHost?this._initReaper():this._initHostHeartbeatChecker()}module.exports=HostedRoom;var Doc=require("crdt").Doc,inherits=require("util").inherits,Room=require("./room"),crypto=require("crypto-browserify"),pump=require("pump"),HEARTBEAT_INTERVAL=3e4,REAPER_INTERVAL=4e4,EXPIRATION_TIME=4e4,HOST_CHECK_INTERVAL=2e4;inherits(HostedRoom,Room),HostedRoom.prototype.destroy=function(){this._doc.rm(this.id),this.removeListener("peer:connect",this._onPeerConnect),this._heartbeats.removeListener("add",this._onHeartbeatAdd),this._heartbeats.removeListener("remove",this._onHeartbeatRemove),clearInterval(this._heartbeatInterval),this._reaperInterval&&clearInterval(this._reaperInterval),this._hostHeartbeatCheckInterval&&clearInterval(this._hostHeartbeatCheckInterval),Room.prototype.destroy.call(this)},HostedRoom.prototype.users=function(){return this._heartbeats.asArray()},HostedRoom.prototype.leave=function(){console.log("leaving hosted room"),this.destroy()},HostedRoom.prototype._initReaper=function(){function e(){for(var e=t._heartbeats.asArray(),o=e.length-1;o>=0;o--){var r=e[o],s=r.get("time");Date.now()-s>EXPIRATION_TIME&&(console.log("reaping: ",r.id),t._doc.rm(r.id))}}var t=this;this._reaperInterval=setInterval(e,REAPER_INTERVAL)},HostedRoom.prototype._initHostHeartbeatChecker=function(){function e(){var e=t._heartbeats.get(t.hostId);(!e||Date.now()-e.get("time")>EXPIRATION_TIME)&&(console.log("host heartbeat expired"),t.emit("host:leave"))}var t=this;this._hostHeartbeatCheckInterval=setInterval(e,HOST_CHECK_INTERVAL)};

}).call(this,require("buffer").Buffer)
},{"./room":343,"buffer":66,"crdt":73,"crypto-browserify":87,"pump":212,"util":304}],340:[function(require,module,exports){
(function (Buffer){
function P2PLobby(o){var e=this;this.private=o.private,this.public=o.public,this.id=crypto.createHash("sha1").update(this.public).digest("hex"),console.log("my lobby id: ",this.id),this.nicename=o.nicename,Room.call(this,{id:e.id,roomID:o.lobbyID||new Buffer(20).fill("p2p-lobby"),maxPeers:o.maxPeers||6}),this._doc=new Doc,this._rooms=this._doc.createSet("type","room"),this._onRoomAdd=function(o){e.emit("rooms:add",o.toJSON())},this._onRoomRemove=function(o){e.emit("rooms:remove",o.toJSON())},this._rooms.on("add",this._onRoomAdd),this._rooms.on("remove",this._onRoomRemove),this.myRoomId=null,this._onPeerConnect=function(o){var t=o.mux,i=t.createSharedStream("_doc");pump(i,e._doc.createStream(),i,function(o){}),i.on("end",function(){console.log("docStream ended")})},this.on("peer:connect",this._onPeerConnect)}var Doc=require("crdt").Doc,multiplex=require("multiplex"),inherits=require("util").inherits,Room=require("./room"),HostedRoom=require("./hosted-room"),crypto=require("crypto-browserify"),pump=require("pump");module.exports=P2PLobby;var MS_IN_MINUTE=6e4;inherits(P2PLobby,Room),P2PLobby.prototype.destroy=function(){this._rooms.removeListener("add",this._onRoomAdd),this._rooms.removeListener("remove",this._onRoomRemove),this.removeListener("peer:connect",this._onPeerConnect),Room.prototype.destroy.call(this)},P2PLobby.prototype.createRoom=function(o){var e=this;null!=this.roomInterval&&clearInterval(this.roomInterval);var t=this._doc.add({type:"room",pubkey:e.public.toString("hex"),name:o,creator:e.nicename});return this.myRoomId=t.toJSON().id,new HostedRoom({hostKey:e.public.toString("hex"),private:e.private,public:e.public,nicename:e.nicename})},P2PLobby.prototype.closeRoom=function(){null!=this.myRoomId&&(this._doc.rm(this.myRoomId),this.myRoomId=null)},P2PLobby.prototype.getRooms=function(){return this._rooms.toJSON()};

}).call(this,require("buffer").Buffer)
},{"./hosted-room":339,"./room":343,"buffer":66,"crdt":73,"crypto-browserify":87,"multiplex":180,"pump":212,"util":304}],341:[function(require,module,exports){
(function (global){
function PeerTunes(e){var o=this,t=e.identity.keypair.public.toString("hex")===e.roomPubkey;return t&&!e.room?void console.error("user is host, but is missing room parameters"):Peer.WEBRTC_SUPPORT?(this.config=config,this.router=e.router,this.identity=e.identity,this.keys=this.identity.keypair,this.chatModel=new ChatModel({username:e.username,maxMessageLength:400}),this.chatView=new ChatView(this.chatModel,config.chat),this.chatController=new ChatController(this.chatView,this.chatModel),this.chatModel.on("new-chat",function(e){o.moshpitView.chatPopover(e.userId,e.message)}),this.queueModel=new QueueModel({localstorageKey:config.songQueue.localstorageKey}),this.queueView=new QueueView(this.queueModel,{itemTemplate:config.songQueue.itemTemplate,songQueue:config.songQueue.queue}),this.queueController=new QueueController(this.queueView,this.queueModel,{queueItem:config.songQueue.queueItem}),this._onQueueModelChange=function(e){if(o.isInDJQueue()){var t=o._djSeq.get("dj-"+o.id).toJSON(),n=e[0];if(n&&(n.id!==t.song.id||n.source!==t.song.source)){t.song=n;var i=o._djSeq.get("dj-"+o.id);"MP3"===n.source?o.seedFileWithKey(n.id,function(e){i.set(t)}):i.set(t)}}},this.queueModel.on("queue:change",this._onQueueModelChange),this.moshpitModel=new MoshpitModel,this.moshpitView=new MoshpitView({selector:config.moshpit.selector}),this.moshpitController=new MoshpitController(this.moshpitView,this.moshpitModel),this.tracker=null,this.activeTorrents=[],global.WEBTORRENT_ANNOUNCE=[this.config.trackerURL],this.torrentClient=new WebTorrent({tracker:{rtcConfig:o.config.rtc,announce:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz"]}}),this._onTorrent=function(e){console.log("[Torrent client] torrent ready: ",e)},this._onTorrentError=function(e){console.log("[Torrent client] error: ",e)},this.torrentClient.on("torrent",this._onTorrent),this.torrentClient.on("error",this._onTorrentError),this.username=e.identity.username,this.id=crypto.createHash("sha1").update(this.identity.keypair.public).digest("hex"),config.player.torrentClient=this.torrentClient,this.player=new Player(config.player),this.songManager=new SongManager,this.songManager.on("song-end",this.onSongEnd.bind(this)),emojione.ascii=!0,this._doc=null,this._chatSet=null,this._djSeq=null,this._moodSet=null,this._currentSong=null,this.docStreams={},this.room=null,this.lobby=null,this._onHostLeave=function(){o.router.route("#lobby")},t?(this.lobby=o._joinLobby(),this.room=this.lobby.createRoom(e.room.name),this._onJoinRoom(this.room)):(this.room=o.joinRoom(e.roomPubkey),this.room.on("host:leave",this._onHostLeave)),this.$songSearchInput=$("#song-search-input"),this.$songSearchSubmitButton=$("#song-search-submit-button"),this.$likeButton=$(config.selectors.likeButton),this.$dislikeButton=$(config.selectors.dislikeButton),this.$joinQueueButton=$(config.selectors.joinQueueButton),this.$volumeSlider=$(config.selectors.volumeSlider),this.$volumeButton=$("#volume-button"),this.$leaveButton=$(config.navBar.leaveButton),this.$addSongButton=$("#add-song-button"),this.$DJQueueList=$("#dj-queue-list"),void this.initClickHandlers()):void window.alert("This browser is unsupported. Please use a browser with WebRTC support.")}var Peer=require("simple-peer"),Tracker=require("bittorrent-tracker/client"),Mustache=require("mustache"),WebTorrent=require("webtorrent"),localforage=require("localforage"),Doc=require("crdt").Doc,crypto=require("crypto-browserify"),pump=require("pump"),Value=require("r-value"),config=require("../config"),YT=require("../lib/YT"),Player=require("./player"),SongManager=require("./song-manager"),Lobby=require("./lobby"),HostedRoom=require("./hosted-room"),ChatController=require("../controllers/chat-controller"),ChatView=require("../views/chat-view"),ChatModel=require("../models/chat-model"),QueueController=require("../controllers/queue-controller"),QueueView=require("../views/queue-view"),QueueModel=require("../models/queue-model"),MoshpitController=require("../controllers/moshpit-controller"),MoshpitView=require("../views/moshpit-view"),MoshpitModel=require("../models/moshpit-model");PeerTunes.prototype.destroy=function(){console.log("destroying room"),this.isInDJQueue()&&this.leaveDJQueue(),this.songManager.end(),this.closeStreams(),this.room&&(this.room.destroy(),this.room=null),this.$songSearchInput.off(),this.$songSearchSubmitButton.off(),this.$likeButton.off(),this.$dislikeButton.off(),this.$joinQueueButton.off(),this.$volumeSlider.off(),this.$volumeButton.off(),this.$leaveButton.off(),this.$addSongButton.off(),this.queueModel.removeListener("queue:change",this._onQueueModelChange),this.songManager.removeListener("song-end",this.onSongEnd),this.torrentClient.removeListener("torrent",this._onTorrent),this.torrentClient.removeListener("error",this._onTorrentError),this.torrentClient.destroy(),this.player.destroy(),this.songManager.destroy(),this.chatController.destroy(),this.moshpitController.destroy(),this.queueController.destroy(),this.activeTorrents=[],this._doc=null,this._chatSet=null,this._djSeq,this.router=null,this.resetRoom()},PeerTunes.prototype.initClickHandlers=function(){var e=this;this.$songSearchInput.keydown(function(o){13===o.keyCode&&e.doSongSearch()}),this.$volumeSlider.on("change mousemove",function(){var o=$(this).val()/100;e.player.setVolume(o)}),this.$songSearchSubmitButton.click(function(o){e.doSongSearch()}),this.$volumeButton.click(function(o){if(e.player.getVolume()>0)return e.player.setVolume(0),void e.$volumeSlider.val(0);e.player.setVolume(1),e.$volumeSlider.val(100)}),this.$addSongButton.click(function(e){$("#song-search-results").html(""),$("#song-search-input").val("")}),this.$joinQueueButton.click(function(o){return console.log("join dj queue button clicked"),e._djSeq?e._djSeq.has("dj-"+e.id)?(console.log("already in dj queue"),void e.leaveDJQueue()):void(e.joinDJQueue()&&$(this).removeClass("btn-primary").addClass("btn-info").text("Leave DJ Queue")):void console.log("dj queue not defined, probably not in a room")}),this.$likeButton.click(function(o){e._moodSet&&e._doc.set("mood-"+e.id,{type:"mood",userId:e.id,like:!0})}),this.$dislikeButton.click(function(o){e._moodSet&&e._doc.set("mood-"+e.id,{type:"mood",userId:e.id,like:!1})})},PeerTunes.prototype._joinLobby=function(){var e=this;console.log("joining lobby");var o=new Lobby({maxPeers:6,public:e.keys.public,private:e.keys.private,nicename:e.username});return o.on("rooms:add",function(e){console.log("new room added to lobby: ",e)}),o},PeerTunes.prototype.joinRoom=function(e){var o=this;console.log("joining room with key ",e);var t=new HostedRoom({hostKey:e,public:o.keys.public,private:o.keys.private,nicename:o.username});return this._onJoinRoom(t),t},PeerTunes.prototype._onJoinRoom=function(e){var o=this;console.log("onJoinRoom"),this.joinDocForRoom(e),this.moshpitModel.addAvatar({id:o.id,nicename:o.username,avatar:1,headbob:!1}),e.on("user:join",function(e){o.moshpitModel.addAvatar({id:e.id,nicename:e.nicename,avatar:1,headbob:!1})}),e.on("user:leave",function(e){o.moshpitModel.removeAvatar(e.id),o.room.isHost&&(o._doc.rm("dj-"+e.id),o._doc.rm("mood-"+e.id))})},PeerTunes.prototype.closeStreams=function(){var e=this;Object.keys(this.docStreams).forEach(function(o){e.docStreams[o].destroy()})},PeerTunes.prototype.joinDocForRoom=function(e){var o=this;this.initReplicationModels(e),e.on("peer:connect",function(e){var t=e.mux,n=o._doc.createStream();o.docStreams[e.id]=n;var i=t.createSharedStream("peertunes-doc");pump(i,n,i,function(e){});var r=o._currentSong.createStream(),s=t.createSharedStream("current-song");pump(s,r,s,function(e){})}),e.on("peer:disconnect",function(e){o.docStreams[e.id]&&(o.docStreams[e.id].destroy(),delete o.docStreams[e.id])})},PeerTunes.prototype.initReplicationModels=function(e){var o=this;this._doc=new Doc,console.log("_doc: ",this._doc),this._currentSong=new Value,this._chatSeq=this._doc.createSeq("type","chat"),this._moodSet=this._doc.createSet("type","mood"),this._djSeq=this._doc.createSeq("type","djQueue"),this._chatSeq.on("add",function(e){e=e.toJSON(),o.chatModel.addMessage({userId:e.userId,username:e.username,message:e.message})}),this.chatController.on("chat:submit",function(e){o._doc.add({type:"chat",userId:o.id,username:o.username,message:e})}),this._currentSong.on("update",function(e){if(console.log("current song update",e),null==e||!e.song)return console.log("current song set to null, ending"),void o.songManager.end();var t=Date.now()-e.startTime;if(t/1e3>=e.song.duration)return void console.log("skipping song that already ended");var n=e.userId===o.id;o.player.end(),o.player.play(e.song,t,n),o.songManager.play(e.song),n&&(console.log("user is now DJ, cycling song queue"),o.queueModel.cycle())}),o._djSeq.on("remove",function(){console.log("djseq remove",o._djSeq),o.renderDJQueue()}),o._djSeq.on("add",function(){console.log("djseq add",o._djSeq)}),o._djSeq.on("changes",function(){console.log("djseq changes",o._djSeq),o.renderDJQueue()}),e.isHost&&(o._djSeq.on("add",function(e){console.log("djSeq add"),e=e.toJSON(),1===o._djSeq.length()&&o.playNextDJSong()}),o._djSeq.on("remove",function(e){console.log("djSeq remove"),e=e.toJSON();var t=o._currentSong.get();t&&t.userId===e.userId&&o.songManager.end()})),this._moodSet.on("add",function(e){e=e.toJSON(),o.moshpitModel.setHeadbobbing(e.userId,e.like)}),this._moodSet.on("changes",function(e,t){e=e.toJSON(),o.moshpitModel.setHeadbobbing(e.userId,e.like)})},PeerTunes.prototype.renderDJQueue=function(){console.log("render dj queue");var e=$("#dj-queue-list");e.empty(),this._djSeq.asArray().forEach(function(o){e.append('<li class="list-group-item">'+o.get("username")+"</li>")}),e.find("li").first().addClass("active")},PeerTunes.prototype.resetRoom=function(){this.moshpitModel.removeAllAvatars(),this.chatModel.deleteAllMessages(),this.$leaveButton.hide(),this.$DJQueueList.empty()},PeerTunes.prototype.removeDJFromQueue=function(e){this._djSeq||console.log("djSeq doesn't exist, can't remove dj"),this._djSeq.rm("dj-"+e)},PeerTunes.prototype.leaveDJQueue=function(){this.removeDJFromQueue(this.id),console.log("left DJ queue"),this.$joinQueueButton.removeClass("btn-info").addClass("btn-primary").text("Join DJ Queue")},PeerTunes.prototype.isInDJQueue=function(e){return e||(e=this.id),!!this._djSeq&&this._djSeq.has("dj-"+e)},PeerTunes.prototype.joinDJQueue=function(){var e=this;if(0===this.queueModel.length()||!this._djSeq||this._djSeq.has("dj-"+this.id))return console.log("unable to join DJ queue"),!1;var o=e.queueModel.front();return"MP3"===o.source?(console.log("on queue join, front is mp3 => seeding"),e.seedFileWithKey(o.id,function(t){e._djSeq.push({id:"dj-"+e.id,userId:e.id,username:e.username,song:o})})):this._djSeq.push({id:"dj-"+e.id,userId:e.id,username:e.username,song:e.queueModel.front()}),!0},PeerTunes.prototype.cycleDJQueue=function(){!this._djSeq||this._djSeq.length()<=1||this._djSeq.after(this._djSeq.first(),this._djSeq.last())},PeerTunes.prototype.onSongEnd=function(){this.player.end(),this.player.setTitle(""),this.room&&this.room.isHost&&(this._djSeq.length()>1&&(console.log("cycling DJs"),this.cycleDJQueue()),this.playNextDJSong())},PeerTunes.prototype.playNextDJSong=function(){var e=this;if(this.room&&this.room.isHost){if(0===this._djSeq.length())return console.log("no DJs in queue, nothing to play"),void e._currentSong.set(null);console.log("playing next dj song");var o=this._djSeq.first().toJSON(),t=o.song;this._currentSong.set({startTime:Date.now(),song:t,userId:o.userId,username:o.username})}},PeerTunes.prototype.seedFileWithKey=function(e,o){for(var t=this,n=0;n<this.activeTorrents.length;n++)if(this.activeTorrents[n].key===e)return console.log("torrent already exists, skipping"),void o(this.activeTorrents[n]);if(this.activeTorrents.length>=2){console.log("too many active torrents, removing oldest");var i=this._currentSong.get();if(i.song&&"MP3"===i.song.source){for(var n=0;n<this.activeTorrents.length;n++)if(this.activeTorrents[n].key!==i.song.id){var r=this.activeTorrents[n];this.activeTorrents.splice(n,1),this.torrentClient.remove(r.torrent.infoHash);break}}else{var r=this.activeTorrents.shift();this.torrentClient.remove(r.torrent.infoHash)}}console.log("Seeding file with key ",e),localforage.getItem(e).then(function(n){var i=new File([n],e,{type:"audio/mp3",lastModified:Date.now()});t.torrentClient.seed(i,function(n){console.log("Client is seeding file "+e,", infoHash: ",n.infoHash),t.activeTorrents.push({key:e,torrent:n}),n.on("wire",function(e){console.log("torrent: connected to new peer")}),o(n)})}).catch(function(e){console.log("Error retrieving mp3: ",e)})},PeerTunes.prototype.doSongSearch=function(){var e=this,o=$("#song-search-input").val();o.length<1||YT.getSearchResults(o,function(o){var t=$("#songSearchResultTmpl").html();Mustache.parse(t),$("#song-search-results").html("");var n="";o.forEach(function(e){var o=e.duration>=3600?"HH:mm:ss":"mm:ss",i=moment.utc(1e3*e.duration).format(o),r={title:e.title,id:e.id,duration:e.duration,formattedDuration:i,thumbnail:e.thumbnail},s=Mustache.render(t,r);n+=s}),$("#song-search-results").append(n),$(".song-search-result").click(function(o){o.preventDefault(),$(this).addClass("active");var t=$(this).data("id"),n=$(this).data("title"),i=$(this).data("duration"),r={title:n,id:t,source:"YOUTUBE",duration:i};e.queueModel.addSong(r)})})},module.exports=PeerTunes;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config":327,"../controllers/chat-controller":328,"../controllers/moshpit-controller":330,"../controllers/queue-controller":331,"../lib/YT":332,"../models/chat-model":336,"../models/moshpit-model":337,"../models/queue-model":338,"../views/chat-view":346,"../views/moshpit-view":348,"../views/queue-view":349,"./hosted-room":339,"./lobby":340,"./player":342,"./song-manager":345,"bittorrent-tracker/client":25,"crdt":73,"crypto-browserify":87,"localforage":165,"mustache":182,"pump":212,"r-value":218,"simple-peer":257,"webtorrent":312}],342:[function(require,module,exports){
function Player(e){var t=this;this.$audio=$(e.audio),this.$video=$(e.video),this.audioPlayer=videojs(e.audio),this.videoPlayer=videojs(e.video),this.audioEl=this.audioPlayer.contentEl().getElementsByTagName("audio")[0],this.players=[this.audioPlayer,this.videoPlayer],this.player=this.videoPlayer,this.volume=1,this.tagReader=new TagReader,this.torrentClient=e.torrentClient,this.$volumeButton=$("#volume-button"),this.$songProgressBar=$("#song-progress-bar"),this.$songCurrentTime=$("#song-time-current"),this.$bottomBarCover=$("#bottom-bar-cover"),this.$videoFrame=$("#video-frame"),this.currentTorrent=null,this.currentlyPlaying=null,this._fileURL=null,this._onPlayerEnded=null,this._onPlayerPlay=null,this._onPlayerTimeUpdate=null,this.players.forEach(function(e){e.ready(function(){e.on("ended",function(){t.$videoFrame.hide(),e.off("timeupdate")}),e.on("play",function(){t.$videoFrame.show(),e.on("timeupdate",function(){var e=1e3*this.currentTime(),o=this.currentTime()>=3600?"HH:mm:ss":"mm:ss";t.$songCurrentTime.text(moment.utc(e).format(o)),t.currentlyPlaying&&t.updateProgress(this.currentTime()/t.currentlyPlaying.duration)})})})})}var TagReader=require("../lib/tag-reader"),localforage=require("localforage");module.exports=Player,Player.prototype.destroy=function(){this.end(),this.players.forEach(function(e){e.off()}),this.currentTorrent=null,this.torrentClient=null,this._fileURL&&window.URL.revokeObjectURL(this._fileURL)},Player.prototype.play=function(e,t,o){if(!e)return void console.log("Play error: song = null");switch(null==t&&(t=0),null==o&&(o=!1),this.currentlyPlaying=e,console.log("play data: ",e),this.setTitle(e.title),e.source){case"YOUTUBE":this.playYouTube(e,t);break;case"MP3":this.playMp3(e,t,o);break;default:console.error("Error: Can't play unknown source type ",e.source)}},Player.prototype.end=function(){console.log("player song end"),null!=this.player&&(this.player.trigger("ended"),this.player.pause(),this.setCover(null)),this.setTitle(""),this.$songCurrentTime.text("00:00"),this.updateProgress(0),this.currentTorrent&&this.currentTorrent&&(this.torrentClient.remove(this.currentTorrent.infoHash),this.currentTorrent=null)},Player.prototype.playMp3=function(e,t,o){var r=this;if(this.player=this.audioPlayer,r.setCover(null),this.setVisiblePlayer("audio"),o)console.log("Host is DJ, retrieving MP3 from localstorage"),localforage.getItem(e.id).then(function(o){var i=new File([o],e.id,{type:"audio/mp3",lastModified:Date.now()});r._fileURL&&window.URL.revokeObjectURL(r._fileURL),r._fileURL=window.URL.createObjectURL(i),r.player.src({type:"audio/mp3",src:r._fileURL}),r.player.currentTime(t/1e3),r.player.play(),r.setVolume(r.volume),r.tagReader.tagsFromFile(i,function(e){r.setTitle(e.combinedTitle),r.setCover(e.cover)})}).catch(function(e){console.log("Error retrieving mp3: ",e)});else{console.log("Song has infoHash, leeching"),this.currentTorrent&&(this.torrentClient.remove(this.currentTorrent.infoHash),this.currentTorrent=null);var i=r.torrentClient.add(e.infoHash,function(e){r.currentTorrent=e;var t=e.files[0];console.log("started downloading file: ",t),t.renderTo(r.audioEl),r.player.play(),r.setVolume(r.volume)});i.on("warning",function(e){console.log("torrent warning: ",e)}),i.on("metadata",function(){console.log("torrent metadata loaded")}),i.on("noPeers",function(e){console.log("torrent has no peers from source ",e)}),i.on("wire",function(e){console.log("torrent: connected to new peer")}),i.on("done",function(){console.log("torrent finished downloading");i.files[0].getBlob(function(e,t){if(e)return void console.log(e);r.tagReader.tagsFromFile(t,function(e){r.setCover(e.cover)})})})}},Player.prototype.playYouTube=function(e,t){var o=this,r=e.id;this.player=this.videoPlayer,this.player.src({type:"video/youtube",src:"https://www.youtube.com/watch?v="+r}),this.player.ready(function(){o.player.currentTime(t/1e3),o.player.play()}),this.setVolume(this.volume),this.setVisiblePlayer("video"),this.setCover("https://img.youtube.com/vi/"+r+"/mqdefault.jpg")},Player.prototype.setVisiblePlayer=function(e){switch(e){case"video":this.$video.removeClass("hide"),this.$audio.addClass("hide");break;case"audio":this.$audio.removeClass("hide"),this.$video.addClass("hide");break;default:console.log("Error: Cannot set visible player with id ",e)}},Player.prototype.setVolume=function(e){this.volume=e,this.players.forEach(function(t){t.volume(e)}),0===this.volume?this.$volumeButton.removeClass("glyphicon-volume-up").addClass("glyphicon-volume-off"):this.$volumeButton.removeClass("glyphicon-volume-off").addClass("glyphicon-volume-up")},Player.prototype.getVolume=function(){return this.volume},Player.prototype.setTitle=function(e){$("#song-title").text(e)},Player.prototype.setCover=function(e){if(null==this.player||null==e)return this.player.posterImage.hide(),void this.$bottomBarCover.removeAttr("style");var t="url("+e+")";this.player===this.audioPlayer&&(this.$audio.find(".vjs-poster").css("background-image",t),this.player.posterImage.show()),this.$bottomBarCover.css("background-image",t)},Player.prototype.updateProgress=function(e){var t=100*e+"%";this.$songProgressBar.css("width",t)};

},{"../lib/tag-reader":334,"localforage":165}],343:[function(require,module,exports){
(function (Buffer){
function Room(e){this.roomId=e.roomID,this.peerId=e.id,this.peers={},this.maxPeers=e.maxPeers||6,this.tracker=null,this._trackerInit(e),EventEmitter.call(this)}function distance(e,r){Buffer.isBuffer(e)||(e=new Buffer(e)),Buffer.isBuffer(r)||(r=new Buffer(r));var t,o=[];if(e.length>r.length)for(t=0;t<r.length;t++)o.push(e[t]^r[t]);else for(t=0;t<e.length;t++)o.push(e[t]^r[t]);var n=0;for(t=0;t<o.length;t++)n+=o[t];return n}var Tracker=require("bittorrent-tracker"),EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,crypto=require("crypto-browserify"),multiplex=require("multiplex"),pump=require("pump");module.exports=Room;var TRACKER_URLS=["wss://tracker.btorrent.xyz"];inherits(Room,EventEmitter),Room.prototype.destroy=function(){var e=this;Object.keys(this.peers).forEach(function(r,t){var o=e.peers[r];o.mux&&o.mux.destroy(),o.destroy(),delete e.peers[r]}),this.tracker.stop(),this.tracker.destroy(),this.tracker=null},Room.prototype.leave=function(){console.log("leaving room"),this.destroy()},Room.prototype._destroyFurthestPeer=function(){var e=this,r=Object.keys(e.peers);if(0!==r.length){console.log("too many peers, destroying furthest");var t=null,o=-1;r.forEach(function(r){var n=e.peers[r],s=distance(n.id,e.peerId);s>o&&(t=n,o=s)}),t.destroy(function(){console.log("destroyed furthest peer",t.id),delete e.peers[t.id]})}},Room.prototype._trackerInit=function(e){var r=this;this.tracker=new Tracker({infoHash:e.roomID||new Buffer(20).fill("p2p-room"),peerId:r.peerId,announce:e.trackers||TRACKER_URLS}),this.tracker.on("error",function(e){console.log(e.message)}),this.tracker.on("warning",function(e){console.log(e.message)}),this.tracker.on("update",function(e){}),this.tracker.on("peer",function(e){function t(){e.once("close",function(){console.log("peer closed: ",e.id),e.mux.destroy(),r.emit("peer:disconnect",e),delete r.peers[e.id]}),e.on("error",function(){console.log("peer error")}),console.log("connected to peer "+e.id),r.peers[e.id]=e;var t=multiplex();e.mux=t,t.on("error",function(e){console.log("multiplex error: ",e)}),pump(e,t,e,function(e){}),r.emit("peer:connect",e),Object.keys(r.peers).length>r.maxPeers&&r._destroyFurthestPeer()}e.id in r.peers||(console.log("found a peer: ",e.id),e.connected?t():e.once("connect",t))}),this.tracker.start()};
}).call(this,require("buffer").Buffer)
},{"bittorrent-tracker":26,"buffer":66,"crypto-browserify":87,"events":121,"multiplex":180,"pump":212,"util":304}],344:[function(require,module,exports){
(function (Buffer){
function Router(){var e=this;console.log("init Router"),this.identity=null,this.previousPage=null,e.render(decodeURI(window.location.hash)),$(window).bind("popstate",function(o){console.log("Router: popstate ",o),e.render(decodeURI(window.location.hash))})}function encodeKeypair(e){return{public:e.public.toString("base64"),private:e.private.toString("base64")}}function decodeKeypair(e){return{public:Buffer.from(e.public,"base64"),private:Buffer.from(e.private,"base64")}}var localforage=require("localforage"),sodium=require("sodium-universal"),config=require("../config"),LobbyController=require("../controllers/lobby-controller"),Peertunes=require("./peertunes");module.exports=Router,Router.prototype.route=function(e,o){console.log("Router: route ",e,o),history.pushState(null,null,e),this.render(e,o)},Router.prototype.render=function(e,o){function t(e,o){var t=e.split("/"),n=t[0];i.previousPage?(console.log("Router: previous page exists, destroying"),i.previousPage.destroy(),i.previousPage=null):console.log("Router: no previous page exists");var r={"":function(){i.redirect("#lobby")},"#login":function(){i.renderLoginView()},"#lobby":function(e){$(".page#lobby").show(),$("#btn-create-room").show();var o=new LobbyController({router:i,identity:i.identity});i.previousPage=o},"#room":function(e){if(2!==t.length)return console.log("missing room id param"),void i.redirect("#lobby");$(".page#room").show(),$("#btn-room-listing").show(),e.roomPubkey=t[1],e.username=i.identity.username,e.keys=i.identity.keypair,e.identity=i.identity,e.router=i;var o=new Peertunes(e);i.previousPage=o}};$("#main-content .page").hide(),$(".navbar-btn").hide(),r[n]?r[n](o):(console.log("Router: invalid route ",e),i.redirect("#lobby"))}var i=this;if(o=o||{},!this.identity&&"#login"!==e)return void this.getIdentity(function(n){if(!n)return console.log("No identity"),void i.redirect("#login");i.identity=n,t(e,o)});t(e,o)},Router.prototype.redirect=function(e){console.log("Router: redirecting to ",e),this.route(e)},Router.prototype.getIdentity=function(e){console.log("getting identity"),localforage.getItem("identity").then(function(o){console.log("got encoded identity: ",o),o&&(o.keypair=decodeKeypair(o.keypair)),e(o)}).catch(function(e){console.log(e)})},Router.prototype.renderLoginView=function(){function e(){console.log("generating keypair...");var e=Buffer.alloc(sodium.crypto_sign_SECRETKEYBYTES),o=Buffer.alloc(sodium.crypto_sign_PUBLICKEYBYTES);return sodium.crypto_sign_keypair(o,e),{public:o,private:e}}function o(e,o){var t={keypair:encodeKeypair(e.keypair),username:e.username};localforage.setItem("identity",t).then(function(){o()}).catch(function(e){console.log(e)})}var t=this;console.log("render login"),$(".page#login").show(),$("#btn-login").click(function(i){console.log("login button clicked");var n=$("#input-username").val();if(0===n.length)return void console.log("Error: Username field empty");var r=e(),l={username:n,keypair:r};t.identity=l,console.log("generated identity ",l),o(l,function(){t.redirect("#lobby")})})};

}).call(this,require("buffer").Buffer)
},{"../config":327,"../controllers/lobby-controller":329,"./peertunes":341,"buffer":66,"localforage":165,"sodium-universal":267}],345:[function(require,module,exports){
function SongManager(){this.meta={},this.updater=null,this.timeout=null,this.playing=!1,EventEmitter.call(this)}module.exports=SongManager;var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,SONG_END_TIME_BUFFER=2;inherits(SongManager,EventEmitter),SongManager.prototype.destroy=function(){this.updater&&clearInterval(this.updater),this.timeout&&clearTimeout(this.timeout),this.meta=null,this.playing=!1},SongManager.prototype.play=function(t){var e=this;this.emit("song-start"),this.playing=!0,this.meta=t,this.meta.currentTime=0,this.updater=setInterval(function(){e.meta.currentTime+=500},500),clearTimeout(this.timeout),this.timeout=setTimeout(function(){clearInterval(e.updater),e.end()},1e3*(t.duration+SONG_END_TIME_BUFFER))},SongManager.prototype.end=function(){this.playing&&(clearTimeout(this.timeout),clearInterval(this.updater),this.meta={},this.playing=!1,this.emit("song-end"))},SongManager.prototype.isPlaying=function(){return this.playing},SongManager.prototype.getMeta=function(){return this.meta},SongManager.prototype.setInfoHash=function(t){this.meta.infoHash=t},SongManager.prototype.getInfoHash=function(){return this.meta.infoHash};

},{"events":121,"util":304}],346:[function(require,module,exports){
function ChatView(t,e){this.model=t,this.messageTemplate=$(e.messageTemplate).html(),this.DOM={$chatInput:$(e.chatInput),$chatBody:$(e.chatBody),$chatEnterButton:$(e.chatEnterButton),$chatList:$(e.chatList)},Mustache.parse(this.messageTemplate)}var Mustache=require("mustache");module.exports=ChatView,ChatView.prototype.getDOM=function(){return this.DOM},ChatView.prototype.onMessage=function(t){this._appendMessage(t),this.clearInput()},ChatView.prototype.clearInput=function(){this.DOM.$chatInput.val("")},ChatView.prototype._appendMessage=function(t){t.message=emojione.shortnameToImage(t.message);var e=Mustache.render(this.messageTemplate,t),o=this._isScrolledToBottom();this.DOM.$chatList.append(e),o&&this._scrollToBottom()},ChatView.prototype.clear=function(){this.DOM.$chatList.html("")},ChatView.prototype._scrollToBottom=function(){var t=this.DOM.$chatBody[0].scrollHeight;this.DOM.$chatBody.scrollTop(t)},ChatView.prototype._isScrolledToBottom=function(){var t=this.DOM.$chatBody[0];return t.scrollHeight-t.offsetHeight-t.scrollTop<5};

},{"mustache":182}],347:[function(require,module,exports){
function LobbyView(o){this.roomRowTemplate=$(o.roomRowTemplate).html(),Mustache.parse(this.roomRowTemplate),this.DOM={$roomList:$(o.roomList)},this.DOM.$roomList.html("")}var Mustache=require("mustache");module.exports=LobbyView,LobbyView.prototype.addRoom=function(o){var e={host:o.creator,title:o.name,id:o.pubkey},t=$(Mustache.render(this.roomRowTemplate,e));this.DOM.$roomList.append(t)},LobbyView.prototype.removeRoom=function(o){console.log("Lobby view removeRoom not implemented yet!")};
},{"mustache":182}],348:[function(require,module,exports){
function MoshpitView(e){this.avatarTemplate=$("#avatarTmpl").html(),this.DOM={$moshpit:$(e.selector)},Mustache.parse(this.avatarTemplate)}var Mustache=require("mustache");module.exports=MoshpitView,MoshpitView.prototype.destroy=function(){this.DOM.$moshpit.empty()},MoshpitView.prototype.addAvatar=function(e){var t=80*Math.random()+10,o=100*Math.random()+5,a="user-"+e.id,i={userId:a,avatar:e.avatar,x:t,y:o,z:Math.floor(o)},r=Mustache.render(this.avatarTemplate,i),p=$(r);e.headbob&&p.find(".audience-head").addClass("headbob-animation"),this._initPopover(e,p),this.DOM.$moshpit.append(p)},MoshpitView.prototype.removeAvatar=function(e){var t=$("#user-"+e.id);t.remove(),t.webuiPopover("destroy")},MoshpitView.prototype.setHeadbobbing=function(e,t){$("#user-"+e+" .audience-head").toggleClass("headbob-animation",t)},MoshpitView.prototype._initPopover=function(e,t){var o=$("#popoverTmpl").html();Mustache.parse(o);var a={nicename:e.nicename},i=Mustache.render(o,a);t.webuiPopover({title:"",content:i,placement:"top",trigger:"hover",padding:!1})},MoshpitView.prototype.chatPopover=function(e,t){t='<div class="text-center">'+t+"</div>";var o="#user-"+e+" .audience-head";$user=$(o);var a={title:"",placement:"top",content:t,trigger:"manual",width:190,animation:"pop",multi:!0,cache:!1,autoHide:2600,onHide:function(e){$user.webuiPopover("destroy")}};$user.webuiPopover(a),$user.webuiPopover("show")};

},{"mustache":182}],349:[function(require,module,exports){
function QueueView(e,t){this.model=e,this.itemTemplate=$(t.itemTemplate).html(),this.queueSelector=t.songQueue,this.DOM={songQueue:t.songQueue,$songQueue:$(this.queueSelector)},Mustache.parse(this.itemTemplate)}var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,Mustache=require("mustache");module.exports=QueueView,inherits(QueueView,EventEmitter),QueueView.prototype.render=function(){var e=this,t=this.model.getSongs(),i=this.itemTemplate,u="";t.forEach(function(t){var o={title:t.title,source:t.source,id:t.id,duration:t.duration,prettyDuration:e._prettyDuration(t.duration)};u+=Mustache.render(i,o)}),this.DOM.$songQueue.html(u)},QueueView.prototype.cycle=function(){this.DOM.$songQueue.find("li").first().detach().appendTo(this.DOM.$songQueue)},QueueView.prototype.appendSong=function(e){var t=this.itemTemplate,i={title:e.title,source:e.source,id:e.id,duration:e.duration,prettyDuration:this._prettyDuration(e.duration)},u=$(Mustache.render(t,i));this.DOM.$songQueue.append(u)},QueueView.prototype.removeSong=function(e){this._songAtIndex(e).remove()},QueueView.prototype.moveToTop=function(e){var t=this._songAtIndex(e).detach();this.DOM.$songQueue.prepend(t)},QueueView.prototype._prettyDuration=function(e){var t=moment.duration(e,"seconds"),i=t.seconds(),u=t.minutes(),o=t.hours();i=("0"+i).slice(-2);var n=u+":"+i;return o>0&&(o=("0"+o).slice(-2),n=o+":"+n),n},QueueView.prototype._songAtIndex=function(e){return this.DOM.$songQueue.children().eq(e)};

},{"events":121,"mustache":182,"util":304}]},{},[335]);
